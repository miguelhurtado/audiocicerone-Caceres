/*! jQuery v1.6.3 http://jquery.com/ | http://jquery.org/license */
(function(a,b){function cu(a){return f.isWindow(a)?a:a.nodeType===9?a.defaultView||a.parentWindow:!1}function cr(a){if(!cg[a]){var b=c.body,d=f("<"+a+">").appendTo(b),e=d.css("display");d.remove();if(e==="none"||e===""){ch||(ch=c.createElement("iframe"),ch.frameBorder=ch.width=ch.height=0),b.appendChild(ch);if(!ci||!ch.createElement)ci=(ch.contentWindow||ch.contentDocument).document,ci.write((c.compatMode==="CSS1Compat"?"<!doctype html>":"")+"<html><body>"),ci.close();d=ci.createElement(a),ci.body.appendChild(d),e=f.css(d,"display"),b.removeChild(ch)}cg[a]=e}return cg[a]}function cq(a,b){var c={};f.each(cm.concat.apply([],cm.slice(0,b)),function(){c[this]=a});return c}function cp(){cn=b}function co(){setTimeout(cp,0);return cn=f.now()}function cf(){try{return new a.ActiveXObject("Microsoft.XMLHTTP")}catch(b){}}function ce(){try{return new a.XMLHttpRequest}catch(b){}}function b$(a,c){a.dataFilter&&(c=a.dataFilter(c,a.dataType));var d=a.dataTypes,e={},g,h,i=d.length,j,k=d[0],l,m,n,o,p;for(g=1;g<i;g++){if(g===1)for(h in a.converters)typeof h=="string"&&(e[h.toLowerCase()]=a.converters[h]);l=k,k=d[g];if(k==="*")k=l;else if(l!=="*"&&l!==k){m=l+" "+k,n=e[m]||e["* "+k];if(!n){p=b;for(o in e){j=o.split(" ");if(j[0]===l||j[0]==="*"){p=e[j[1]+" "+k];if(p){o=e[o],o===!0?n=p:p===!0&&(n=o);break}}}}!n&&!p&&f.error("No conversion from "+m.replace(" "," to ")),n!==!0&&(c=n?n(c):p(o(c)))}}return c}function bZ(a,c,d){var e=a.contents,f=a.dataTypes,g=a.responseFields,h,i,j,k;for(i in g)i in d&&(c[g[i]]=d[i]);while(f[0]==="*")f.shift(),h===b&&(h=a.mimeType||c.getResponseHeader("content-type"));if(h)for(i in e)if(e[i]&&e[i].test(h)){f.unshift(i);break}if(f[0]in d)j=f[0];else{for(i in d){if(!f[0]||a.converters[i+" "+f[0]]){j=i;break}k||(k=i)}j=j||k}if(j){j!==f[0]&&f.unshift(j);return d[j]}}function bY(a,b,c,d){if(f.isArray(b))f.each(b,function(b,e){c||bA.test(a)?d(a,e):bY(a+"["+(typeof e=="object"||f.isArray(e)?b:"")+"]",e,c,d)});else if(!c&&b!=null&&typeof b=="object")for(var e in b)bY(a+"["+e+"]",b[e],c,d);else d(a,b)}function bX(a,c){var d,e,g=f.ajaxSettings.flatOptions||{};for(d in c)c[d]!==b&&((g[d]?a:e||(e={}))[d]=c[d]);e&&f.extend(!0,a,e)}function bW(a,c,d,e,f,g){f=f||c.dataTypes[0],g=g||{},g[f]=!0;var h=a[f],i=0,j=h?h.length:0,k=a===bP,l;for(;i<j&&(k||!l);i++)l=h[i](c,d,e),typeof l=="string"&&(!k||g[l]?l=b:(c.dataTypes.unshift(l),l=bW(a,c,d,e,l,g)));(k||!l)&&!g["*"]&&(l=bW(a,c,d,e,"*",g));return l}function bV(a){return function(b,c){typeof b!="string"&&(c=b,b="*");if(f.isFunction(c)){var d=b.toLowerCase().split(bL),e=0,g=d.length,h,i,j;for(;e<g;e++)h=d[e],j=/^\+/.test(h),j&&(h=h.substr(1)||"*"),i=a[h]=a[h]||[],i[j?"unshift":"push"](c)}}}function by(a,b,c){var d=b==="width"?a.offsetWidth:a.offsetHeight,e=b==="width"?bt:bu;if(d>0){c!=="border"&&f.each(e,function(){c||(d-=parseFloat(f.css(a,"padding"+this))||0),c==="margin"?d+=parseFloat(f.css(a,c+this))||0:d-=parseFloat(f.css(a,"border"+this+"Width"))||0});return d+"px"}d=bv(a,b,b);if(d<0||d==null)d=a.style[b]||0;d=parseFloat(d)||0,c&&f.each(e,function(){d+=parseFloat(f.css(a,"padding"+this))||0,c!=="padding"&&(d+=parseFloat(f.css(a,"border"+this+"Width"))||0),c==="margin"&&(d+=parseFloat(f.css(a,c+this))||0)});return d+"px"}function bl(a,b){b.src?f.ajax({url:b.src,async:!1,dataType:"script"}):f.globalEval((b.text||b.textContent||b.innerHTML||"").replace(bd,"/*$0*/")),b.parentNode&&b.parentNode.removeChild(b)}function bk(a){f.nodeName(a,"input")?bj(a):"getElementsByTagName"in a&&f.grep(a.getElementsByTagName("input"),bj)}function bj(a){if(a.type==="checkbox"||a.type==="radio")a.defaultChecked=a.checked}function bi(a){return"getElementsByTagName"in a?a.getElementsByTagName("*"):"querySelectorAll"in a?a.querySelectorAll("*"):[]}function bh(a,b){var c;if(b.nodeType===1){b.clearAttributes&&b.clearAttributes(),b.mergeAttributes&&b.mergeAttributes(a),c=b.nodeName.toLowerCase();if(c==="object")b.outerHTML=a.outerHTML;else if(c!=="input"||a.type!=="checkbox"&&a.type!=="radio"){if(c==="option")b.selected=a.defaultSelected;else if(c==="input"||c==="textarea")b.defaultValue=a.defaultValue}else a.checked&&(b.defaultChecked=b.checked=a.checked),b.value!==a.value&&(b.value=a.value);b.removeAttribute(f.expando)}}function bg(a,b){if(b.nodeType===1&&!!f.hasData(a)){var c=f.expando,d=f.data(a),e=f.data(b,d);if(d=d[c]){var g=d.events;e=e[c]=f.extend({},d);if(g){delete e.handle,e.events={};for(var h in g)for(var i=0,j=g[h].length;i<j;i++)f.event.add(b,h+(g[h][i].namespace?".":"")+g[h][i].namespace,g[h][i],g[h][i].data)}}}}function bf(a,b){return f.nodeName(a,"table")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a}function V(a,b,c){b=b||0;if(f.isFunction(b))return f.grep(a,function(a,d){var e=!!b.call(a,d,a);return e===c});if(b.nodeType)return f.grep(a,function(a,d){return a===b===c});if(typeof b=="string"){var d=f.grep(a,function(a){return a.nodeType===1});if(Q.test(b))return f.filter(b,d,!c);b=f.filter(b,d)}return f.grep(a,function(a,d){return f.inArray(a,b)>=0===c})}function U(a){return!a||!a.parentNode||a.parentNode.nodeType===11}function M(a,b){return(a&&a!=="*"?a+".":"")+b.replace(y,"`").replace(z,"&")}function L(a){var b,c,d,e,g,h,i,j,k,l,m,n,o,p=[],q=[],r=f._data(this,"events");if(!(a.liveFired===this||!r||!r.live||a.target.disabled||a.button&&a.type==="click")){a.namespace&&(n=new RegExp("(^|\\.)"+a.namespace.split(".").join("\\.(?:.*\\.)?")+"(\\.|$)")),a.liveFired=this;var s=r.live.slice(0);for(i=0;i<s.length;i++)g=s[i],g.origType.replace(w,"")===a.type?q.push(g.selector):s.splice(i--,1);e=f(a.target).closest(q,a.currentTarget);for(j=0,k=e.length;j<k;j++){m=e[j];for(i=0;i<s.length;i++){g=s[i];if(m.selector===g.selector&&(!n||n.test(g.namespace))&&!m.elem.disabled){h=m.elem,d=null;if(g.preType==="mouseenter"||g.preType==="mouseleave")a.type=g.preType,d=f(a.relatedTarget).closest(g.selector)[0],d&&f.contains(h,d)&&(d=h);(!d||d!==h)&&p.push({elem:h,handleObj:g,level:m.level})}}}for(j=0,k=p.length;j<k;j++){e=p[j];if(c&&e.level>c)break;a.currentTarget=e.elem,a.data=e.handleObj.data,a.handleObj=e.handleObj,o=e.handleObj.origHandler.apply(e.elem,arguments);if(o===!1||a.isPropagationStopped()){c=e.level,o===!1&&(b=!1);if(a.isImmediatePropagationStopped())break}}return b}}function J(a,c,d){var e=f.extend({},d[0]);e.type=a,e.originalEvent={},e.liveFired=b,f.event.handle.call(c,e),e.isDefaultPrevented()&&d[0].preventDefault()}function D(){return!0}function C(){return!1}function m(a,c,d){var e=c+"defer",g=c+"queue",h=c+"mark",i=f.data(a,e,b,!0);i&&(d==="queue"||!f.data(a,g,b,!0))&&(d==="mark"||!f.data(a,h,b,!0))&&setTimeout(function(){!f.data(a,g,b,!0)&&!f.data(a,h,b,!0)&&(f.removeData(a,e,!0),i.resolve())},0)}function l(a){for(var b in a)if(b!=="toJSON")return!1;return!0}function k(a,c,d){if(d===b&&a.nodeType===1){var e="data-"+c.replace(j,"$1-$2").toLowerCase();d=a.getAttribute(e);if(typeof d=="string"){try{d=d==="true"?!0:d==="false"?!1:d==="null"?null:f.isNaN(d)?i.test(d)?f.parseJSON(d):d:parseFloat(d)}catch(g){}f.data(a,c,d)}else d=b}return d}var c=a.document,d=a.navigator,e=a.location,f=function(){function K(){if(!e.isReady){try{c.documentElement.doScroll("left")}catch(a){setTimeout(K,1);return}e.ready()}}var e=function(a,b){return new e.fn.init(a,b,h)},f=a.jQuery,g=a.$,h,i=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,j=/\S/,k=/^\s+/,l=/\s+$/,m=/\d/,n=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,o=/^[\],:{}\s]*$/,p=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,q=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,r=/(?:^|:|,)(?:\s*\[)+/g,s=/(webkit)[ \/]([\w.]+)/,t=/(opera)(?:.*version)?[ \/]([\w.]+)/,u=/(msie) ([\w.]+)/,v=/(mozilla)(?:.*? rv:([\w.]+))?/,w=/-([a-z]|[0-9])/ig,x=/^-ms-/,y=function(a,b){return(b+"").toUpperCase()},z=d.userAgent,A,B,C,D=Object.prototype.toString,E=Object.prototype.hasOwnProperty,F=Array.prototype.push,G=Array.prototype.slice,H=String.prototype.trim,I=Array.prototype.indexOf,J={};e.fn=e.prototype={constructor:e,init:function(a,d,f){var g,h,j,k;if(!a)return this;if(a.nodeType){this.context=this[0]=a,this.length=1;return this}if(a==="body"&&!d&&c.body){this.context=c,this[0]=c.body,this.selector=a,this.length=1;return this}if(typeof a=="string"){a.charAt(0)!=="<"||a.charAt(a.length-1)!==">"||a.length<3?g=i.exec(a):g=[null,a,null];if(g&&(g[1]||!d)){if(g[1]){d=d instanceof e?d[0]:d,k=d?d.ownerDocument||d:c,j=n.exec(a),j?e.isPlainObject(d)?(a=[c.createElement(j[1])],e.fn.attr.call(a,d,!0)):a=[k.createElement(j[1])]:(j=e.buildFragment([g[1]],[k]),a=(j.cacheable?e.clone(j.fragment):j.fragment).childNodes);return e.merge(this,a)}h=c.getElementById(g[2]);if(h&&h.parentNode){if(h.id!==g[2])return f.find(a);this.length=1,this[0]=h}this.context=c,this.selector=a;return this}return!d||d.jquery?(d||f).find(a):this.constructor(d).find(a)}if(e.isFunction(a))return f.ready(a);a.selector!==b&&(this.selector=a.selector,this.context=a.context);return e.makeArray(a,this)},selector:"",jquery:"1.6.3",length:0,size:function(){return this.length},toArray:function(){return G.call(this,0)},get:function(a){return a==null?this.toArray():a<0?this[this.length+a]:this[a]},pushStack:function(a,b,c){var d=this.constructor();e.isArray(a)?F.apply(d,a):e.merge(d,a),d.prevObject=this,d.context=this.context,b==="find"?d.selector=this.selector+(this.selector?" ":"")+c:b&&(d.selector=this.selector+"."+b+"("+c+")");return d},each:function(a,b){return e.each(this,a,b)},ready:function(a){e.bindReady(),B.done(a);return this},eq:function(a){return a===-1?this.slice(a):this.slice(a,+a+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(G.apply(this,arguments),"slice",G.call(arguments).join(","))},map:function(a){return this.pushStack(e.map(this,function(b,c){return a.call(b,c,b)}))},end:function(){return this.prevObject||this.constructor(null)},push:F,sort:[].sort,splice:[].splice},e.fn.init.prototype=e.fn,e.extend=e.fn.extend=function(){var a,c,d,f,g,h,i=arguments[0]||{},j=1,k=arguments.length,l=!1;typeof i=="boolean"&&(l=i,i=arguments[1]||{},j=2),typeof i!="object"&&!e.isFunction(i)&&(i={}),k===j&&(i=this,--j);for(;j<k;j++)if((a=arguments[j])!=null)for(c in a){d=i[c],f=a[c];if(i===f)continue;l&&f&&(e.isPlainObject(f)||(g=e.isArray(f)))?(g?(g=!1,h=d&&e.isArray(d)?d:[]):h=d&&e.isPlainObject(d)?d:{},i[c]=e.extend(l,h,f)):f!==b&&(i[c]=f)}return i},e.extend({noConflict:function(b){a.$===e&&(a.$=g),b&&a.jQuery===e&&(a.jQuery=f);return e},isReady:!1,readyWait:1,holdReady:function(a){a?e.readyWait++:e.ready(!0)},ready:function(a){if(a===!0&&!--e.readyWait||a!==!0&&!e.isReady){if(!c.body)return setTimeout(e.ready,1);e.isReady=!0;if(a!==!0&&--e.readyWait>0)return;B.resolveWith(c,[e]),e.fn.trigger&&e(c).trigger("ready").unbind("ready")}},bindReady:function(){if(!B){B=e._Deferred();if(c.readyState==="complete")return setTimeout(e.ready,1);if(c.addEventListener)c.addEventListener("DOMContentLoaded",C,!1),a.addEventListener("load",e.ready,!1);else if(c.attachEvent){c.attachEvent("onreadystatechange",C),a.attachEvent("onload",e.ready);var b=!1;try{b=a.frameElement==null}catch(d){}c.documentElement.doScroll&&b&&K()}}},isFunction:function(a){return e.type(a)==="function"},isArray:Array.isArray||function(a){return e.type(a)==="array"},isWindow:function(a){return a&&typeof a=="object"&&"setInterval"in a},isNaN:function(a){return a==null||!m.test(a)||isNaN(a)},type:function(a){return a==null?String(a):J[D.call(a)]||"object"},isPlainObject:function(a){if(!a||e.type(a)!=="object"||a.nodeType||e.isWindow(a))return!1;try{if(a.constructor&&!E.call(a,"constructor")&&!E.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(c){return!1}var d;for(d in a);return d===b||E.call(a,d)},isEmptyObject:function(a){for(var b in a)return!1;return!0},error:function(a){throw a},parseJSON:function(b){if(typeof b!="string"||!b)return null;b=e.trim(b);if(a.JSON&&a.JSON.parse)return a.JSON.parse(b);if(o.test(b.replace(p,"@").replace(q,"]").replace(r,"")))return(new Function("return "+b))();e.error("Invalid JSON: "+b)},parseXML:function(c){var d,f;try{a.DOMParser?(f=new DOMParser,d=f.parseFromString(c,"text/xml")):(d=new ActiveXObject("Microsoft.XMLDOM"),d.async="false",d.loadXML(c))}catch(g){d=b}(!d||!d.documentElement||d.getElementsByTagName("parsererror").length)&&e.error("Invalid XML: "+c);return d},noop:function(){},globalEval:function(b){b&&j.test(b)&&(a.execScript||function(b){a.eval.call(a,b)})(b)},camelCase:function(a){return a.replace(x,"ms-").replace(w,y)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toUpperCase()===b.toUpperCase()},each:function(a,c,d){var f,g=0,h=a.length,i=h===b||e.isFunction(a);if(d){if(i){for(f in a)if(c.apply(a[f],d)===!1)break}else for(;g<h;)if(c.apply(a[g++],d)===!1)break}else if(i){for(f in a)if(c.call(a[f],f,a[f])===!1)break}else for(;g<h;)if(c.call(a[g],g,a[g++])===!1)break;return a},trim:H?function(a){return a==null?"":H.call(a)}:function(a){return a==null?"":(a+"").replace(k,"").replace(l,"")},makeArray:function(a,b){var c=b||[];if(a!=null){var d=e.type(a);a.length==null||d==="string"||d==="function"||d==="regexp"||e.isWindow(a)?F.call(c,a):e.merge(c,a)}return c},inArray:function(a,b){if(!b)return-1;if(I)return I.call(b,a);for(var c=0,d=b.length;c<d;c++)if(b[c]===a)return c;return-1},merge:function(a,c){var d=a.length,e=0;if(typeof c.length=="number")for(var f=c.length;e<f;e++)a[d++]=c[e];else while(c[e]!==b)a[d++]=c[e++];a.length=d;return a},grep:function(a,b,c){var d=[],e;c=!!c;for(var f=0,g=a.length;f<g;f++)e=!!b(a[f],f),c!==e&&d.push(a[f]);return d},map:function(a,c,d){var f,g,h=[],i=0,j=a.length,k=a instanceof e||j!==b&&typeof j=="number"&&(j>0&&a[0]&&a[j-1]||j===0||e.isArray(a));if(k)for(;i<j;i++)f=c(a[i],i,d),f!=null&&(h[h.length]=f);else for(g in a)f=c(a[g],g,d),f!=null&&(h[h.length]=f);return h.concat.apply([],h)},guid:1,proxy:function(a,c){if(typeof c=="string"){var d=a[c];c=a,a=d}if(!e.isFunction(a))return b;var f=G.call(arguments,2),g=function(){return a.apply(c,f.concat(G.call(arguments)))};g.guid=a.guid=a.guid||g.guid||e.guid++;return g},access:function(a,c,d,f,g,h){var i=a.length;if(typeof c=="object"){for(var j in c)e.access(a,j,c[j],f,g,d);return a}if(d!==b){f=!h&&f&&e.isFunction(d);for(var k=0;k<i;k++)g(a[k],c,f?d.call(a[k],k,g(a[k],c)):d,h);return a}return i?g(a[0],c):b},now:function(){return(new Date).getTime()},uaMatch:function(a){a=a.toLowerCase();var b=s.exec(a)||t.exec(a)||u.exec(a)||a.indexOf("compatible")<0&&v.exec(a)||[];return{browser:b[1]||"",version:b[2]||"0"}},sub:function(){function a(b,c){return new a.fn.init(b,c)}e.extend(!0,a,this),a.superclass=this,a.fn=a.prototype=this(),a.fn.constructor=a,a.sub=this.sub,a.fn.init=function(d,f){f&&f instanceof e&&!(f instanceof a)&&(f=a(f));return e.fn.init.call(this,d,f,b)},a.fn.init.prototype=a.fn;var b=a(c);return a},browser:{}}),e.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(a,b){J["[object "+b+"]"]=b.toLowerCase()}),A=e.uaMatch(z),A.browser&&(e.browser[A.browser]=!0,e.browser.version=A.version),e.browser.webkit&&(e.browser.safari=!0),j.test(" ")&&(k=/^[\s\xA0]+/,l=/[\s\xA0]+$/),h=e(c),c.addEventListener?C=function(){c.removeEventListener("DOMContentLoaded",C,!1),e.ready()}:c.attachEvent&&(C=function(){c.readyState==="complete"&&(c.detachEvent("onreadystatechange",C),e.ready())});return e}(),g="done fail isResolved isRejected promise then always pipe".split(" "),h=[].slice;f.extend({_Deferred:function(){var a=[],b,c,d,e={done:function(){if(!d){var c=arguments,g,h,i,j,k;b&&(k=b,b=0);for(g=0,h=c.length;g<h;g++)i=c[g],j=f.type(i),j==="array"?e.done.apply(e,i):j==="function"&&a.push(i);k&&e.resolveWith(k[0],k[1])}return this},resolveWith:function(e,f){if(!d&&!b&&!c){f=f||[],c=1;try{while(a[0])a.shift().apply(e,f)}finally{b=[e,f],c=0}}return this},resolve:function(){e.resolveWith(this,arguments);return this},isResolved:function(){return!!c||!!b},cancel:function(){d=1,a=[];return this}};return e},Deferred:function(a){var b=f._Deferred(),c=f._Deferred(),d;f.extend(b,{then:function(a,c){b.done(a).fail(c);return this},always:function(){return b.done.apply(b,arguments).fail.apply(this,arguments)},fail:c.done,rejectWith:c.resolveWith,reject:c.resolve,isRejected:c.isResolved,pipe:function(a,c){return f.Deferred(function(d){f.each({done:[a,"resolve"],fail:[c,"reject"]},function(a,c){var e=c[0],g=c[1],h;f.isFunction(e)?b[a](function(){h=e.apply(this,arguments),h&&f.isFunction(h.promise)?h.promise().then(d.resolve,d.reject):d[g+"With"](this===b?d:this,[h])}):b[a](d[g])})}).promise()},promise:function(a){if(a==null){if(d)return d;d=a={}}var c=g.length;while(c--)a[g[c]]=b[g[c]];return a}}),b.done(c.cancel).fail(b.cancel),delete b.cancel,a&&a.call(b,b);return b},when:function(a){function i(a){return function(c){b[a]=arguments.length>1?h.call(arguments,0):c,--e||g.resolveWith(g,h.call(b,0))}}var b=arguments,c=0,d=b.length,e=d,g=d<=1&&a&&f.isFunction(a.promise)?a:f.Deferred();if(d>1){for(;c<d;c++)b[c]&&f.isFunction(b[c].promise)?b[c].promise().then(i(c),g.reject):--e;e||g.resolveWith(g,b)}else g!==a&&g.resolveWith(g,d?[a]:[]);return g.promise()}}),f.support=function(){var a=c.createElement("div"),b=c.documentElement,d,e,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u;a.setAttribute("className","t"),a.innerHTML="   <link><table></table><a href='/a' style='top:1px;float:left;opacity:.55;'>a</a><input type=checkbox>",d=a.getElementsByTagName("*"),e=a.getElementsByTagName("a")[0];if(!d||!d.length||!e)return{};g=c.createElement("select"),h=g.appendChild(c.createElement("option")),i=a.getElementsByTagName("input")[0],k={leadingWhitespace:a.firstChild.nodeType===3,tbody:!a.getElementsByTagName("tbody").length,htmlSerialize:!!a.getElementsByTagName("link").length,style:/top/.test(e.getAttribute("style")),hrefNormalized:e.getAttribute("href")==="/a",opacity:/^0.55$/.test(e.style.opacity),cssFloat:!!e.style.cssFloat,checkOn:i.value==="on",optSelected:h.selected,getSetAttribute:a.className!=="t",submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0},i.checked=!0,k.noCloneChecked=i.cloneNode(!0).checked,g.disabled=!0,k.optDisabled=!h.disabled;try{delete a.test}catch(v){k.deleteExpando=!1}!a.addEventListener&&a.attachEvent&&a.fireEvent&&(a.attachEvent("onclick",function(){k.noCloneEvent=!1}),a.cloneNode(!0).fireEvent("onclick")),i=c.createElement("input"),i.value="t",i.setAttribute("type","radio"),k.radioValue=i.value==="t",i.setAttribute("checked","checked"),a.appendChild(i),l=c.createDocumentFragment(),l.appendChild(a.firstChild),k.checkClone=l.cloneNode(!0).cloneNode(!0).lastChild.checked,a.innerHTML="",a.style.width=a.style.paddingLeft="1px",m=c.getElementsByTagName("body")[0],o=c.createElement(m?"div":"body"),p={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},m&&f.extend(p,{position:"absolute",left:"-1000px",top:"-1000px"});for(t in p)o.style[t]=p[t];o.appendChild(a),n=m||b,n.insertBefore(o,n.firstChild),k.appendChecked=i.checked,k.boxModel=a.offsetWidth===2,"zoom"in a.style&&(a.style.display="inline",a.style.zoom=1,k.inlineBlockNeedsLayout=a.offsetWidth===2,a.style.display="",a.innerHTML="<div style='width:4px;'></div>",k.shrinkWrapBlocks=a.offsetWidth!==2),a.innerHTML="<table><tr><td style='padding:0;border:0;display:none'></td><td>t</td></tr></table>",q=a.getElementsByTagName("td"),u=q[0].offsetHeight===0,q[0].style.display="",q[1].style.display="none",k.reliableHiddenOffsets=u&&q[0].offsetHeight===0,a.innerHTML="",c.defaultView&&c.defaultView.getComputedStyle&&(j=c.createElement("div"),j.style.width="0",j.style.marginRight="0",a.appendChild(j),k.reliableMarginRight=(parseInt((c.defaultView.getComputedStyle(j,null)||{marginRight:0}).marginRight,10)||0)===0),o.innerHTML="",n.removeChild(o);if(a.attachEvent)for(t in{submit:1,change:1,focusin:1})s="on"+t,u=s in a,u||(a.setAttribute(s,"return;"),u=typeof a[s]=="function"),k[t+"Bubbles"]=u;o=l=g=h=m=j=a=i=null;return k}(),f.boxModel=f.support.boxModel;var i=/^(?:\{.*\}|\[.*\])$/,j=/([a-z])([A-Z])/g;f.extend({cache:{},uuid:0,expando:"jQuery"+(f.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(a){a=a.nodeType?f.cache[a[f.expando]]:a[f.expando];return!!a&&!l(a)},data:function(a,c,d,e){if(!!f.acceptData(a)){var g,h,i=f.expando,j=typeof c=="string",k=a.nodeType,l=k?f.cache:a,m=k?a[f.expando]:a[f.expando]&&f.expando;if((!m||e&&m&&l[m]&&!l[m][i])&&j&&d===b)return;m||(k?a[f.expando]=m=++f.uuid:m=f.expando),l[m]||(l[m]={},k||(l[m].toJSON=f.noop));if(typeof c=="object"||typeof c=="function")e?l[m][i]=f.extend(l[m][i],c):l[m]=f.extend(l[m],c);g=l[m],e&&(g[i]||(g[i]={}),g=g[i]),d!==b&&(g[f.camelCase(c)]=d);if(c==="events"&&!g[c])return g[i]&&g[i].events;j?(h=g[c],h==null&&(h=g[f.camelCase(c)])):h=g;return h}},removeData:function(a,b,c){if(!!f.acceptData(a)){var d,e=f.expando,g=a.nodeType,h=g?f.cache:a,i=g?a[f.expando]:f.expando;if(!h[i])return;if(b){d=c?h[i][e]:h[i];if(d){d[b]||(b=f.camelCase(b)),delete d[b];if(!l(d))return}}if(c){delete h[i][e];if(!l(h[i]))return}var j=h[i][e];f.support.deleteExpando||!h.setInterval?delete h[i]:h[i]=null,j?(h[i]={},g||(h[i].toJSON=f.noop),h[i][e]=j):g&&(f.support.deleteExpando?delete a[f.expando]:a.removeAttribute?a.removeAttribute(f.expando):a[f.expando]=null)}},_data:function(a,b,c){return f.data(a,b,c,!0)},acceptData:function(a){if(a.nodeName){var b=f.noData[a.nodeName.toLowerCase()];if(b)return b!==!0&&a.getAttribute("classid")===b}return!0}}),f.fn.extend({data:function(a,c){var d=null;if(typeof a=="undefined"){if(this.length){d=f.data(this[0]);if(this[0].nodeType===1){var e=this[0].attributes,g;for(var h=0,i=e.length;h<i;h++)g=e[h].name,g.indexOf("data-")===0&&(g=f.camelCase(g.substring(5)),k(this[0],g,d[g]))}}return d}if(typeof a=="object")return this.each(function(){f.data(this,a)});var j=a.split(".");j[1]=j[1]?"."+j[1]:"";if(c===b){d=this.triggerHandler("getData"+j[1]+"!",[j[0]]),d===b&&this.length&&(d=f.data(this[0],a),d=k(this[0],a,d));return d===b&&j[1]?this.data(j[0]):d}return this.each(function(){var b=f(this),d=[j[0],c];b.triggerHandler("setData"+j[1]+"!",d),f.data(this,a,c),b.triggerHandler("changeData"+j[1]+"!",d)})},removeData:function(a){return this.each(function(){f.removeData(this,a)})}}),f.extend({_mark:function(a,c){a&&(c=(c||"fx")+"mark",f.data(a,c,(f.data(a,c,b,!0)||0)+1,!0))},_unmark:function(a,c,d){a!==!0&&(d=c,c=a,a=!1);if(c){d=d||"fx";var e=d+"mark",g=a?0:(f.data(c,e,b,!0)||1)-1;g?f.data(c,e,g,!0):(f.removeData(c,e,!0),m(c,d,"mark"))}},queue:function(a,c,d){if(a){c=(c||"fx")+"queue";var e=f.data(a,c,b,!0);d&&(!e||f.isArray(d)?e=f.data(a,c,f.makeArray(d),!0):e.push(d));return e||[]}},dequeue:function(a,b){b=b||"fx";var c=f.queue(a,b),d=c.shift(),e;d==="inprogress"&&(d=c.shift()),d&&(b==="fx"&&c.unshift("inprogress"),d.call(a,function(){f.dequeue(a,b)})),c.length||(f.removeData(a,b+"queue",!0),m(a,b,"queue"))}}),f.fn.extend({queue:function(a,c){typeof a!="string"&&(c=a,a="fx");if(c===b)return f.queue(this[0],a);return this.each(function(){var b=f.queue(this,a,c);a==="fx"&&b[0]!=="inprogress"&&f.dequeue(this,a)})},dequeue:function(a){return this.each(function(){f.dequeue(this,a)})},delay:function(a,b){a=f.fx?f.fx.speeds[a]||a:a,b=b||"fx";return this.queue(b,function(){var c=this;setTimeout(function(){f.dequeue(c,b)},a)})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,c){function m(){--h||d.resolveWith(e,[e])}typeof a!="string"&&(c=a,a=b),a=a||"fx";var d=f.Deferred(),e=this,g=e.length,h=1,i=a+"defer",j=a+"queue",k=a+"mark",l;while(g--)if(l=f.data(e[g],i,b,!0)||(f.data(e[g],j,b,!0)||f.data(e[g],k,b,!0))&&f.data(e[g],i,f._Deferred(),!0))h++,l.done(m);m();return d.promise()}});var n=/[\n\t\r]/g,o=/\s+/,p=/\r/g,q=/^(?:button|input)$/i,r=/^(?:button|input|object|select|textarea)$/i,s=/^a(?:rea)?$/i,t=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,u,v;f.fn.extend({attr:function(a,b){return f.access(this,a,b,!0,f.attr)},removeAttr:function(a){return this.each(function(){f.removeAttr(this,a)})},prop:function(a,b){return f.access(this,a,b,!0,f.prop)},removeProp:function(a){a=f.propFix[a]||a;return this.each(function(){try{this[a]=b,delete this[a]}catch(c){}})},addClass:function(a){var b,c,d,e,g,h,i;if(f.isFunction(a))return this.each(function(b){f(this).addClass(a.call(this,b,this.className))});if(a&&typeof a=="string"){b=a.split(o);for(c=0,d=this.length;c<d;c++){e=this[c];if(e.nodeType===1)if(!e.className&&b.length===1)e.className=a;else{g=" "+e.className+" ";for(h=0,i=b.length;h<i;h++)~g.indexOf(" "+b[h]+" ")||(g+=b[h]+" ");e.className=f.trim(g)}}}return this},removeClass:function(a){var c,d,e,g,h,i,j;if(f.isFunction(a))return this.each(function(b){f(this).removeClass(a.call(this,b,this.className))});if(a&&typeof a=="string"||a===b){c=(a||"").split(o);for(d=0,e=this.length;d<e;d++){g=this[d];if(g.nodeType===1&&g.className)if(a){h=(" "+g.className+" ").replace(n," ");for(i=0,j=c.length;i<j;i++)h=h.replace(" "+c[i]+" "," ");g.className=f.trim(h)}else g.className=""}}return this},toggleClass:function(a,b){var c=typeof a,d=typeof b=="boolean";if(f.isFunction(a))return this.each(function(c){f(this).toggleClass(a.call(this,c,this.className,b),b)});return this.each(function(){if(c==="string"){var e,g=0,h=f(this),i=b,j=a.split(o);while(e=j[g++])i=d?i:!h.hasClass(e),h[i?"addClass":"removeClass"](e)}else if(c==="undefined"||c==="boolean")this.className&&f._data(this,"__className__",this.className),this.className=this.className||a===!1?"":f._data(this,"__className__")||""})},hasClass:function(a){var b=" "+a+" ";for(var c=0,d=this.length;c<d;c++)if(this[c].nodeType===1&&(" "+this[c].className+" ").replace(n," ").indexOf(b)>-1)return!0;return!1},val:function(a){var c,d,e=this[0];if(!arguments.length){if(e){c=f.valHooks[e.nodeName.toLowerCase()]||f.valHooks[e.type];if(c&&"get"in c&&(d=c.get(e,"value"))!==b)return d;d=e.value;return typeof d=="string"?d.replace(p,""):d==null?"":d}return b}var g=f.isFunction(a);return this.each(function(d){var e=f(this),h;if(this.nodeType===1){g?h=a.call(this,d,e.val()):h=a,h==null?h="":typeof h=="number"?h+="":f.isArray(h)&&(h=f.map(h,function(a){return a==null?"":a+""})),c=f.valHooks[this.nodeName.toLowerCase()]||f.valHooks[this.type];if(!c||!("set"in c)||c.set(this,h,"value")===b)this.value=h}})}}),f.extend({valHooks:{option:{get:function(a){var b=a.attributes.value;return!b||b.specified?a.value:a.text}},select:{get:function(a){var b,c=a.selectedIndex,d=[],e=a.options,g=a.type==="select-one";if(c<0)return null;for(var h=g?c:0,i=g?c+1:e.length;h<i;h++){var j=e[h];if(j.selected&&(f.support.optDisabled?!j.disabled:j.getAttribute("disabled")===null)&&(!j.parentNode.disabled||!f.nodeName(j.parentNode,"optgroup"))){b=f(j).val();if(g)return b;d.push(b)}}if(g&&!d.length&&e.length)return f(e[c]).val();return d},set:function(a,b){var c=f.makeArray(b);f(a).find("option").each(function(){this.selected=f.inArray(f(this).val(),c)>=0}),c.length||(a.selectedIndex=-1);return c}}},attrFn:{val:!0,css:!0,html:!0,text:!0,data:!0,width:!0,height:!0,offset:!0},attrFix:{tabindex:"tabIndex"},attr:function(a,c,d,e){var g=a.nodeType;if(!a||g===3||g===8||g===2)return b;if(e&&c in f.attrFn)return f(a)[c](d);if(!("getAttribute"in a))return f.prop(a,c,d);var h,i,j=g!==1||!f.isXMLDoc(a);j&&(c=f.attrFix[c]||c,i=f.attrHooks[c],i||(t.test(c)?i=v:u&&(i=u)));if(d!==b){if(d===null){f.removeAttr(a,c);return b}if(i&&"set"in i&&j&&(h=i.set(a,d,c))!==b)return h;a.setAttribute(c,""+d);return d}if(i&&"get"in i&&j&&(h=i.get(a,c))!==null)return h;h=a.getAttribute(c);return h===null?b:h},removeAttr:function(a,b){var c;a.nodeType===1&&(b=f.attrFix[b]||b,f.attr(a,b,""),a.removeAttribute(b),t.test(b)&&(c=f.propFix[b]||b)in a&&(a[c]=!1))},attrHooks:{type:{set:function(a,b){if(q.test(a.nodeName)&&a.parentNode)f.error("type property can't be changed");else if(!f.support.radioValue&&b==="radio"&&f.nodeName(a,"input")){var c=a.value;a.setAttribute("type",b),c&&(a.value=c);return b}}},value:{get:function(a,b){if(u&&f.nodeName(a,"button"))return u.get(a,b);return b in a?a.value:null},set:function(a,b,c){if(u&&f.nodeName(a,"button"))return u.set(a,b,c);a.value=b}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(a,c,d){var e=a.nodeType;if(!a||e===3||e===8||e===2)return b;var g,h,i=e!==1||!f.isXMLDoc(a);i&&(c=f.propFix[c]||c,h=f.propHooks[c]);return d!==b?h&&"set"in h&&(g=h.set(a,d,c))!==b?g:a[c]=d:h&&"get"in h&&(g=h.get(a,c))!==null?g:a[c]},propHooks:{tabIndex:{get:function(a){var c=a.getAttributeNode("tabindex");return c&&c.specified?parseInt(c.value,10):r.test(a.nodeName)||s.test(a.nodeName)&&a.href?0:b}}}}),f.attrHooks.tabIndex=f.propHooks.tabIndex,v={get:function(a,c){var d;return f.prop(a,c)===!0||(d=a.getAttributeNode(c))&&d.nodeValue!==!1?c.toLowerCase():b},set:function(a,b,c){var d;b===!1?f.removeAttr(a,c):(d=f.propFix[c]||c,d in a&&(a[d]=!0),a.setAttribute(c,c.toLowerCase()));return c}},f.support.getSetAttribute||(u=f.valHooks.button={get:function(a,c){var d;d=a.getAttributeNode(c);return d&&d.nodeValue!==""?d.nodeValue:b},set:function(a,b,d){var e=a.getAttributeNode(d);e||(e=c.createAttribute(d),a.setAttributeNode(e));return e.nodeValue=b+""}},f.each(["width","height"],function(a,b){f.attrHooks[b]=f.extend(f.attrHooks[b],{set:function(a,c){if(c===""){a.setAttribute(b,"auto");return c}}})})),f.support.hrefNormalized||f.each(["href","src","width","height"],function(a,c){f.attrHooks[c]=f.extend(f.attrHooks[c],{get:function(a){var d=a.getAttribute(c,2);return d===null?b:d}})}),f.support.style||(f.attrHooks.style={get:function(a){return a.style.cssText.toLowerCase()||b},set:function(a,b){return a.style.cssText=""+b}}),f.support.optSelected||(f.propHooks.selected=f.extend(f.propHooks.selected,{get:function(a){var b=a.parentNode;b&&(b.selectedIndex,b.parentNode&&b.parentNode.selectedIndex);return null}})),f.support.checkOn||f.each(["radio","checkbox"],function(){f.valHooks[this]={get:function(a){return a.getAttribute("value")===null?"on":a.value}}}),f.each(["radio","checkbox"],function(){f.valHooks[this]=f.extend(f.valHooks[this],{set:function(a,b){if(f.isArray(b))return a.checked=f.inArray(f(a).val(),b)>=0}})});var w=/\.(.*)$/,x=/^(?:textarea|input|select)$/i,y=/\./g,z=/ /g,A=/[^\w\s.|`]/g,B=function(a){return a.replace(A,"\\$&")};f.event={add:function(a,c,d,e){if(a.nodeType!==3&&a.nodeType!==8){if(d===!1)d=C;else if(!d)return;var g,h;d.handler&&(g=d,d=g.handler),d.guid||(d.guid=f.guid++);var i=f._data(a);if(!i)return;var j=i.events,k=i.handle;j||(i.events=j={}),k||(i.handle=k=function(a){return typeof f!="undefined"&&(!a||f.event.triggered!==a.type)?f.event.handle.apply(k.elem,arguments):b}),k.elem=a,c=c.split(" ");var l,m=0,n;while(l=c[m++]){h=g?f.extend({},g):{handler:d,data:e},l.indexOf(".")>-1?(n=l.split("."),l=n.shift(),h.namespace=n.slice(0).sort().join(".")):(n=[],h.namespace=""),h.type=l,h.guid||(h.guid=d.guid);var o=j[l],p=f.event.special[l]||{};if(!o){o=j[l]=[];if(!p.setup||p.setup.call(a,e,n,k)===!1)a.addEventListener?a.addEventListener(l,k,!1):a.attachEvent&&a.attachEvent("on"+l,k)}p.add&&(p.add.call(a,h),h.handler.guid||(h.handler.guid=d.guid)),o.push(h),f.event.global[l]=!0}a=null}},global:{},remove:function(a,c,d,e){if(a.nodeType!==3&&a.nodeType!==8){d===!1&&(d=C);var g,h,i,j,k=0,l,m,n,o,p,q,r,s=f.hasData(a)&&f._data(a),t=s&&s.events;if(!s||!t)return;c&&c.type&&(d=c.handler,c=c.type);if(!c||typeof c=="string"&&c.charAt(0)==="."){c=c||"";for(h in t)f.event.remove(a,h+c);return}c=c.split(" ");while(h=c[k++]){r=h,q=null,l=h.indexOf(".")<0,m=[],l||(m=h.split("."),h=m.shift(),n=new RegExp("(^|\\.)"+f.map(m.slice(0).sort(),B).join("\\.(?:.*\\.)?")+"(\\.|$)")),p=t[h];if(!p)continue;if(!d){for(j=0;j<p.length;j++){q=p[j];if(l||n.test(q.namespace))f.event.remove(a,r,q.handler,j),p.splice(j--,1)}continue}o=f.event.special[h]||{};for(j=e||0;j<p.length;j++){q=p[j];if(d.guid===q.guid){if(l||n.test(q.namespace))e==null&&p.splice(j--,1),o.remove&&o.remove.call(a,q);if(e!=null)break}}if(p.length===0||e!=null&&p.length===1)(!o.teardown||o.teardown.call(a,m)===!1)&&f.removeEvent(a,h,s.handle),g=null
,delete t[h]}if(f.isEmptyObject(t)){var u=s.handle;u&&(u.elem=null),delete s.events,delete s.handle,f.isEmptyObject(s)&&f.removeData(a,b,!0)}}},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(c,d,e,g){var h=c.type||c,i=[],j;h.indexOf("!")>=0&&(h=h.slice(0,-1),j=!0),h.indexOf(".")>=0&&(i=h.split("."),h=i.shift(),i.sort());if(!!e&&!f.event.customEvent[h]||!!f.event.global[h]){c=typeof c=="object"?c[f.expando]?c:new f.Event(h,c):new f.Event(h),c.type=h,c.exclusive=j,c.namespace=i.join("."),c.namespace_re=new RegExp("(^|\\.)"+i.join("\\.(?:.*\\.)?")+"(\\.|$)");if(g||!e)c.preventDefault(),c.stopPropagation();if(!e){f.each(f.cache,function(){var a=f.expando,b=this[a];b&&b.events&&b.events[h]&&f.event.trigger(c,d,b.handle.elem)});return}if(e.nodeType===3||e.nodeType===8)return;c.result=b,c.target=e,d=d!=null?f.makeArray(d):[],d.unshift(c);var k=e,l=h.indexOf(":")<0?"on"+h:"";do{var m=f._data(k,"handle");c.currentTarget=k,m&&m.apply(k,d),l&&f.acceptData(k)&&k[l]&&k[l].apply(k,d)===!1&&(c.result=!1,c.preventDefault()),k=k.parentNode||k.ownerDocument||k===c.target.ownerDocument&&a}while(k&&!c.isPropagationStopped());if(!c.isDefaultPrevented()){var n,o=f.event.special[h]||{};if((!o._default||o._default.call(e.ownerDocument,c)===!1)&&(h!=="click"||!f.nodeName(e,"a"))&&f.acceptData(e)){try{l&&e[h]&&(n=e[l],n&&(e[l]=null),f.event.triggered=h,e[h]())}catch(p){}n&&(e[l]=n),f.event.triggered=b}}return c.result}},handle:function(c){c=f.event.fix(c||a.event);var d=((f._data(this,"events")||{})[c.type]||[]).slice(0),e=!c.exclusive&&!c.namespace,g=Array.prototype.slice.call(arguments,0);g[0]=c,c.currentTarget=this;for(var h=0,i=d.length;h<i;h++){var j=d[h];if(e||c.namespace_re.test(j.namespace)){c.handler=j.handler,c.data=j.data,c.handleObj=j;var k=j.handler.apply(this,g);k!==b&&(c.result=k,k===!1&&(c.preventDefault(),c.stopPropagation()));if(c.isImmediatePropagationStopped())break}}return c.result},props:"altKey attrChange attrName bubbles button cancelable charCode clientX clientY ctrlKey currentTarget data detail eventPhase fromElement handler keyCode layerX layerY metaKey newValue offsetX offsetY pageX pageY prevValue relatedNode relatedTarget screenX screenY shiftKey srcElement target toElement view wheelDelta which".split(" "),fix:function(a){if(a[f.expando])return a;var d=a;a=f.Event(d);for(var e=this.props.length,g;e;)g=this.props[--e],a[g]=d[g];a.target||(a.target=a.srcElement||c),a.target.nodeType===3&&(a.target=a.target.parentNode),!a.relatedTarget&&a.fromElement&&(a.relatedTarget=a.fromElement===a.target?a.toElement:a.fromElement);if(a.pageX==null&&a.clientX!=null){var h=a.target.ownerDocument||c,i=h.documentElement,j=h.body;a.pageX=a.clientX+(i&&i.scrollLeft||j&&j.scrollLeft||0)-(i&&i.clientLeft||j&&j.clientLeft||0),a.pageY=a.clientY+(i&&i.scrollTop||j&&j.scrollTop||0)-(i&&i.clientTop||j&&j.clientTop||0)}a.which==null&&(a.charCode!=null||a.keyCode!=null)&&(a.which=a.charCode!=null?a.charCode:a.keyCode),!a.metaKey&&a.ctrlKey&&(a.metaKey=a.ctrlKey),!a.which&&a.button!==b&&(a.which=a.button&1?1:a.button&2?3:a.button&4?2:0);return a},guid:1e8,proxy:f.proxy,special:{ready:{setup:f.bindReady,teardown:f.noop},live:{add:function(a){f.event.add(this,M(a.origType,a.selector),f.extend({},a,{handler:L,guid:a.handler.guid}))},remove:function(a){f.event.remove(this,M(a.origType,a.selector),a)}},beforeunload:{setup:function(a,b,c){f.isWindow(this)&&(this.onbeforeunload=c)},teardown:function(a,b){this.onbeforeunload===b&&(this.onbeforeunload=null)}}}},f.removeEvent=c.removeEventListener?function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)}:function(a,b,c){a.detachEvent&&a.detachEvent("on"+b,c)},f.Event=function(a,b){if(!this.preventDefault)return new f.Event(a,b);a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||a.returnValue===!1||a.getPreventDefault&&a.getPreventDefault()?D:C):this.type=a,b&&f.extend(this,b),this.timeStamp=f.now(),this[f.expando]=!0},f.Event.prototype={preventDefault:function(){this.isDefaultPrevented=D;var a=this.originalEvent;!a||(a.preventDefault?a.preventDefault():a.returnValue=!1)},stopPropagation:function(){this.isPropagationStopped=D;var a=this.originalEvent;!a||(a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=D,this.stopPropagation()},isDefaultPrevented:C,isPropagationStopped:C,isImmediatePropagationStopped:C};var E=function(a){var b=a.relatedTarget,c=!1,d=a.type;a.type=a.data,b!==this&&(b&&(c=f.contains(this,b)),c||(f.event.handle.apply(this,arguments),a.type=d))},F=function(a){a.type=a.data,f.event.handle.apply(this,arguments)};f.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,b){f.event.special[a]={setup:function(c){f.event.add(this,b,c&&c.selector?F:E,a)},teardown:function(a){f.event.remove(this,b,a&&a.selector?F:E)}}}),f.support.submitBubbles||(f.event.special.submit={setup:function(a,b){if(!f.nodeName(this,"form"))f.event.add(this,"click.specialSubmit",function(a){var b=a.target,c=f.nodeName(b,"input")?b.type:"";(c==="submit"||c==="image")&&f(b).closest("form").length&&J("submit",this,arguments)}),f.event.add(this,"keypress.specialSubmit",function(a){var b=a.target,c=f.nodeName(b,"input")?b.type:"";(c==="text"||c==="password")&&f(b).closest("form").length&&a.keyCode===13&&J("submit",this,arguments)});else return!1},teardown:function(a){f.event.remove(this,".specialSubmit")}});if(!f.support.changeBubbles){var G,H=function(a){var b=f.nodeName(a,"input")?a.type:"",c=a.value;b==="radio"||b==="checkbox"?c=a.checked:b==="select-multiple"?c=a.selectedIndex>-1?f.map(a.options,function(a){return a.selected}).join("-"):"":f.nodeName(a,"select")&&(c=a.selectedIndex);return c},I=function(c){var d=c.target,e,g;if(!!x.test(d.nodeName)&&!d.readOnly){e=f._data(d,"_change_data"),g=H(d),(c.type!=="focusout"||d.type!=="radio")&&f._data(d,"_change_data",g);if(e===b||g===e)return;if(e!=null||g)c.type="change",c.liveFired=b,f.event.trigger(c,arguments[1],d)}};f.event.special.change={filters:{focusout:I,beforedeactivate:I,click:function(a){var b=a.target,c=f.nodeName(b,"input")?b.type:"";(c==="radio"||c==="checkbox"||f.nodeName(b,"select"))&&I.call(this,a)},keydown:function(a){var b=a.target,c=f.nodeName(b,"input")?b.type:"";(a.keyCode===13&&!f.nodeName(b,"textarea")||a.keyCode===32&&(c==="checkbox"||c==="radio")||c==="select-multiple")&&I.call(this,a)},beforeactivate:function(a){var b=a.target;f._data(b,"_change_data",H(b))}},setup:function(a,b){if(this.type==="file")return!1;for(var c in G)f.event.add(this,c+".specialChange",G[c]);return x.test(this.nodeName)},teardown:function(a){f.event.remove(this,".specialChange");return x.test(this.nodeName)}},G=f.event.special.change.filters,G.focus=G.beforeactivate}f.support.focusinBubbles||f.each({focus:"focusin",blur:"focusout"},function(a,b){function e(a){var c=f.event.fix(a);c.type=b,c.originalEvent={},f.event.trigger(c,null,c.target),c.isDefaultPrevented()&&a.preventDefault()}var d=0;f.event.special[b]={setup:function(){d++===0&&c.addEventListener(a,e,!0)},teardown:function(){--d===0&&c.removeEventListener(a,e,!0)}}}),f.each(["bind","one"],function(a,c){f.fn[c]=function(a,d,e){var g;if(typeof a=="object"){for(var h in a)this[c](h,d,a[h],e);return this}if(arguments.length===2||d===!1)e=d,d=b;c==="one"?(g=function(a){f(this).unbind(a,g);return e.apply(this,arguments)},g.guid=e.guid||f.guid++):g=e;if(a==="unload"&&c!=="one")this.one(a,d,e);else for(var i=0,j=this.length;i<j;i++)f.event.add(this[i],a,g,d);return this}}),f.fn.extend({unbind:function(a,b){if(typeof a=="object"&&!a.preventDefault)for(var c in a)this.unbind(c,a[c]);else for(var d=0,e=this.length;d<e;d++)f.event.remove(this[d],a,b);return this},delegate:function(a,b,c,d){return this.live(b,c,d,a)},undelegate:function(a,b,c){return arguments.length===0?this.unbind("live"):this.die(b,null,c,a)},trigger:function(a,b){return this.each(function(){f.event.trigger(a,b,this)})},triggerHandler:function(a,b){if(this[0])return f.event.trigger(a,b,this[0],!0)},toggle:function(a){var b=arguments,c=a.guid||f.guid++,d=0,e=function(c){var e=(f.data(this,"lastToggle"+a.guid)||0)%d;f.data(this,"lastToggle"+a.guid,e+1),c.preventDefault();return b[e].apply(this,arguments)||!1};e.guid=c;while(d<b.length)b[d++].guid=c;return this.click(e)},hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)}});var K={focus:"focusin",blur:"focusout",mouseenter:"mouseover",mouseleave:"mouseout"};f.each(["live","die"],function(a,c){f.fn[c]=function(a,d,e,g){var h,i=0,j,k,l,m=g||this.selector,n=g?this:f(this.context);if(typeof a=="object"&&!a.preventDefault){for(var o in a)n[c](o,d,a[o],m);return this}if(c==="die"&&!a&&g&&g.charAt(0)==="."){n.unbind(g);return this}if(d===!1||f.isFunction(d))e=d||C,d=b;a=(a||"").split(" ");while((h=a[i++])!=null){j=w.exec(h),k="",j&&(k=j[0],h=h.replace(w,""));if(h==="hover"){a.push("mouseenter"+k,"mouseleave"+k);continue}l=h,K[h]?(a.push(K[h]+k),h=h+k):h=(K[h]||h)+k;if(c==="live")for(var p=0,q=n.length;p<q;p++)f.event.add(n[p],"live."+M(h,m),{data:d,selector:m,handler:e,origType:h,origHandler:e,preType:l});else n.unbind("live."+M(h,m),e)}return this}}),f.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error".split(" "),function(a,b){f.fn[b]=function(a,c){c==null&&(c=a,a=null);return arguments.length>0?this.bind(b,a,c):this.trigger(b)},f.attrFn&&(f.attrFn[b]=!0)}),function(){function u(a,b,c,d,e,f){for(var g=0,h=d.length;g<h;g++){var i=d[g];if(i){var j=!1;i=i[a];while(i){if(i.sizcache===c){j=d[i.sizset];break}if(i.nodeType===1){f||(i.sizcache=c,i.sizset=g);if(typeof b!="string"){if(i===b){j=!0;break}}else if(k.filter(b,[i]).length>0){j=i;break}}i=i[a]}d[g]=j}}}function t(a,b,c,d,e,f){for(var g=0,h=d.length;g<h;g++){var i=d[g];if(i){var j=!1;i=i[a];while(i){if(i.sizcache===c){j=d[i.sizset];break}i.nodeType===1&&!f&&(i.sizcache=c,i.sizset=g);if(i.nodeName.toLowerCase()===b){j=i;break}i=i[a]}d[g]=j}}}var a=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,d=0,e=Object.prototype.toString,g=!1,h=!0,i=/\\/g,j=/\W/;[0,0].sort(function(){h=!1;return 0});var k=function(b,d,f,g){f=f||[],d=d||c;var h=d;if(d.nodeType!==1&&d.nodeType!==9)return[];if(!b||typeof b!="string")return f;var i,j,n,o,q,r,s,t,u=!0,w=k.isXML(d),x=[],y=b;do{a.exec(""),i=a.exec(y);if(i){y=i[3],x.push(i[1]);if(i[2]){o=i[3];break}}}while(i);if(x.length>1&&m.exec(b))if(x.length===2&&l.relative[x[0]])j=v(x[0]+x[1],d);else{j=l.relative[x[0]]?[d]:k(x.shift(),d);while(x.length)b=x.shift(),l.relative[b]&&(b+=x.shift()),j=v(b,j)}else{!g&&x.length>1&&d.nodeType===9&&!w&&l.match.ID.test(x[0])&&!l.match.ID.test(x[x.length-1])&&(q=k.find(x.shift(),d,w),d=q.expr?k.filter(q.expr,q.set)[0]:q.set[0]);if(d){q=g?{expr:x.pop(),set:p(g)}:k.find(x.pop(),x.length===1&&(x[0]==="~"||x[0]==="+")&&d.parentNode?d.parentNode:d,w),j=q.expr?k.filter(q.expr,q.set):q.set,x.length>0?n=p(j):u=!1;while(x.length)r=x.pop(),s=r,l.relative[r]?s=x.pop():r="",s==null&&(s=d),l.relative[r](n,s,w)}else n=x=[]}n||(n=j),n||k.error(r||b);if(e.call(n)==="[object Array]")if(!u)f.push.apply(f,n);else if(d&&d.nodeType===1)for(t=0;n[t]!=null;t++)n[t]&&(n[t]===!0||n[t].nodeType===1&&k.contains(d,n[t]))&&f.push(j[t]);else for(t=0;n[t]!=null;t++)n[t]&&n[t].nodeType===1&&f.push(j[t]);else p(n,f);o&&(k(o,h,f,g),k.uniqueSort(f));return f};k.uniqueSort=function(a){if(r){g=h,a.sort(r);if(g)for(var b=1;b<a.length;b++)a[b]===a[b-1]&&a.splice(b--,1)}return a},k.matches=function(a,b){return k(a,null,null,b)},k.matchesSelector=function(a,b){return k(b,null,null,[a]).length>0},k.find=function(a,b,c){var d;if(!a)return[];for(var e=0,f=l.order.length;e<f;e++){var g,h=l.order[e];if(g=l.leftMatch[h].exec(a)){var j=g[1];g.splice(1,1);if(j.substr(j.length-1)!=="\\"){g[1]=(g[1]||"").replace(i,""),d=l.find[h](g,b,c);if(d!=null){a=a.replace(l.match[h],"");break}}}}d||(d=typeof b.getElementsByTagName!="undefined"?b.getElementsByTagName("*"):[]);return{set:d,expr:a}},k.filter=function(a,c,d,e){var f,g,h=a,i=[],j=c,m=c&&c[0]&&k.isXML(c[0]);while(a&&c.length){for(var n in l.filter)if((f=l.leftMatch[n].exec(a))!=null&&f[2]){var o,p,q=l.filter[n],r=f[1];g=!1,f.splice(1,1);if(r.substr(r.length-1)==="\\")continue;j===i&&(i=[]);if(l.preFilter[n]){f=l.preFilter[n](f,j,d,i,e,m);if(!f)g=o=!0;else if(f===!0)continue}if(f)for(var s=0;(p=j[s])!=null;s++)if(p){o=q(p,f,s,j);var t=e^!!o;d&&o!=null?t?g=!0:j[s]=!1:t&&(i.push(p),g=!0)}if(o!==b){d||(j=i),a=a.replace(l.match[n],"");if(!g)return[];break}}if(a===h)if(g==null)k.error(a);else break;h=a}return j},k.error=function(a){throw"Syntax error, unrecognized expression: "+a};var l=k.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\(\s*(even|odd|(?:[+\-]?\d+|(?:[+\-]?\d*)?n\s*(?:[+\-]\s*\d+)?))\s*\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(a){return a.getAttribute("href")},type:function(a){return a.getAttribute("type")}},relative:{"+":function(a,b){var c=typeof b=="string",d=c&&!j.test(b),e=c&&!d;d&&(b=b.toLowerCase());for(var f=0,g=a.length,h;f<g;f++)if(h=a[f]){while((h=h.previousSibling)&&h.nodeType!==1);a[f]=e||h&&h.nodeName.toLowerCase()===b?h||!1:h===b}e&&k.filter(b,a,!0)},">":function(a,b){var c,d=typeof b=="string",e=0,f=a.length;if(d&&!j.test(b)){b=b.toLowerCase();for(;e<f;e++){c=a[e];if(c){var g=c.parentNode;a[e]=g.nodeName.toLowerCase()===b?g:!1}}}else{for(;e<f;e++)c=a[e],c&&(a[e]=d?c.parentNode:c.parentNode===b);d&&k.filter(b,a,!0)}},"":function(a,b,c){var e,f=d++,g=u;typeof b=="string"&&!j.test(b)&&(b=b.toLowerCase(),e=b,g=t),g("parentNode",b,f,a,e,c)},"~":function(a,b,c){var e,f=d++,g=u;typeof b=="string"&&!j.test(b)&&(b=b.toLowerCase(),e=b,g=t),g("previousSibling",b,f,a,e,c)}},find:{ID:function(a,b,c){if(typeof b.getElementById!="undefined"&&!c){var d=b.getElementById(a[1]);return d&&d.parentNode?[d]:[]}},NAME:function(a,b){if(typeof b.getElementsByName!="undefined"){var c=[],d=b.getElementsByName(a[1]);for(var e=0,f=d.length;e<f;e++)d[e].getAttribute("name")===a[1]&&c.push(d[e]);return c.length===0?null:c}},TAG:function(a,b){if(typeof b.getElementsByTagName!="undefined")return b.getElementsByTagName(a[1])}},preFilter:{CLASS:function(a,b,c,d,e,f){a=" "+a[1].replace(i,"")+" ";if(f)return a;for(var g=0,h;(h=b[g])!=null;g++)h&&(e^(h.className&&(" "+h.className+" ").replace(/[\t\n\r]/g," ").indexOf(a)>=0)?c||d.push(h):c&&(b[g]=!1));return!1},ID:function(a){return a[1].replace(i,"")},TAG:function(a,b){return a[1].replace(i,"").toLowerCase()},CHILD:function(a){if(a[1]==="nth"){a[2]||k.error(a[0]),a[2]=a[2].replace(/^\+|\s*/g,"");var b=/(-?)(\d*)(?:n([+\-]?\d*))?/.exec(a[2]==="even"&&"2n"||a[2]==="odd"&&"2n+1"||!/\D/.test(a[2])&&"0n+"+a[2]||a[2]);a[2]=b[1]+(b[2]||1)-0,a[3]=b[3]-0}else a[2]&&k.error(a[0]);a[0]=d++;return a},ATTR:function(a,b,c,d,e,f){var g=a[1]=a[1].replace(i,"");!f&&l.attrMap[g]&&(a[1]=l.attrMap[g]),a[4]=(a[4]||a[5]||"").replace(i,""),a[2]==="~="&&(a[4]=" "+a[4]+" ");return a},PSEUDO:function(b,c,d,e,f){if(b[1]==="not")if((a.exec(b[3])||"").length>1||/^\w/.test(b[3]))b[3]=k(b[3],null,null,c);else{var g=k.filter(b[3],c,d,!0^f);d||e.push.apply(e,g);return!1}else if(l.match.POS.test(b[0])||l.match.CHILD.test(b[0]))return!0;return b},POS:function(a){a.unshift(!0);return a}},filters:{enabled:function(a){return a.disabled===!1&&a.type!=="hidden"},disabled:function(a){return a.disabled===!0},checked:function(a){return a.checked===!0},selected:function(a){a.parentNode&&a.parentNode.selectedIndex;return a.selected===!0},parent:function(a){return!!a.firstChild},empty:function(a){return!a.firstChild},has:function(a,b,c){return!!k(c[3],a).length},header:function(a){return/h\d/i.test(a.nodeName)},text:function(a){var b=a.getAttribute("type"),c=a.type;return a.nodeName.toLowerCase()==="input"&&"text"===c&&(b===c||b===null)},radio:function(a){return a.nodeName.toLowerCase()==="input"&&"radio"===a.type},checkbox:function(a){return a.nodeName.toLowerCase()==="input"&&"checkbox"===a.type},file:function(a){return a.nodeName.toLowerCase()==="input"&&"file"===a.type},password:function(a){return a.nodeName.toLowerCase()==="input"&&"password"===a.type},submit:function(a){var b=a.nodeName.toLowerCase();return(b==="input"||b==="button")&&"submit"===a.type},image:function(a){return a.nodeName.toLowerCase()==="input"&&"image"===a.type},reset:function(a){var b=a.nodeName.toLowerCase();return(b==="input"||b==="button")&&"reset"===a.type},button:function(a){var b=a.nodeName.toLowerCase();return b==="input"&&"button"===a.type||b==="button"},input:function(a){return/input|select|textarea|button/i.test(a.nodeName)},focus:function(a){return a===a.ownerDocument.activeElement}},setFilters:{first:function(a,b){return b===0},last:function(a,b,c,d){return b===d.length-1},even:function(a,b){return b%2===0},odd:function(a,b){return b%2===1},lt:function(a,b,c){return b<c[3]-0},gt:function(a,b,c){return b>c[3]-0},nth:function(a,b,c){return c[3]-0===b},eq:function(a,b,c){return c[3]-0===b}},filter:{PSEUDO:function(a,b,c,d){var e=b[1],f=l.filters[e];if(f)return f(a,c,b,d);if(e==="contains")return(a.textContent||a.innerText||k.getText([a])||"").indexOf(b[3])>=0;if(e==="not"){var g=b[3];for(var h=0,i=g.length;h<i;h++)if(g[h]===a)return!1;return!0}k.error(e)},CHILD:function(a,b){var c=b[1],d=a;switch(c){case"only":case"first":while(d=d.previousSibling)if(d.nodeType===1)return!1;if(c==="first")return!0;d=a;case"last":while(d=d.nextSibling)if(d.nodeType===1)return!1;return!0;case"nth":var e=b[2],f=b[3];if(e===1&&f===0)return!0;var g=b[0],h=a.parentNode;if(h&&(h.sizcache!==g||!a.nodeIndex)){var i=0;for(d=h.firstChild;d;d=d.nextSibling)d.nodeType===1&&(d.nodeIndex=++i);h.sizcache=g}var j=a.nodeIndex-f;return e===0?j===0:j%e===0&&j/e>=0}},ID:function(a,b){return a.nodeType===1&&a.getAttribute("id")===b},TAG:function(a,b){return b==="*"&&a.nodeType===1||a.nodeName.toLowerCase()===b},CLASS:function(a,b){return(" "+(a.className||a.getAttribute("class"))+" ").indexOf(b)>-1},ATTR:function(a,b){var c=b[1],d=l.attrHandle[c]?l.attrHandle[c](a):a[c]!=null?a[c]:a.getAttribute(c),e=d+"",f=b[2],g=b[4];return d==null?f==="!=":f==="="?e===g:f==="*="?e.indexOf(g)>=0:f==="~="?(" "+e+" ").indexOf(g)>=0:g?f==="!="?e!==g:f==="^="?e.indexOf(g)===0:f==="$="?e.substr(e.length-g.length)===g:f==="|="?e===g||e.substr(0,g.length+1)===g+"-":!1:e&&d!==!1},POS:function(a,b,c,d){var e=b[2],f=l.setFilters[e];if(f)return f(a,c,b,d)}}},m=l.match.POS,n=function(a,b){return"\\"+(b-0+1)};for(var o in l.match)l.match[o]=new RegExp(l.match[o].source+/(?![^\[]*\])(?![^\(]*\))/.source),l.leftMatch[o]=new RegExp(/(^(?:.|\r|\n)*?)/.source+l.match[o].source.replace(/\\(\d+)/g,n));var p=function(a,b){a=Array.prototype.slice.call(a,0);if(b){b.push.apply(b,a);return b}return a};try{Array.prototype.slice.call(c.documentElement.childNodes,0)[0].nodeType}catch(q){p=function(a,b){var c=0,d=b||[];if(e.call(a)==="[object Array]")Array.prototype.push.apply(d,a);else if(typeof a.length=="number")for(var f=a.length;c<f;c++)d.push(a[c]);else for(;a[c];c++)d.push(a[c]);return d}}var r,s;c.documentElement.compareDocumentPosition?r=function(a,b){if(a===b){g=!0;return 0}if(!a.compareDocumentPosition||!b.compareDocumentPosition)return a.compareDocumentPosition?-1:1;return a.compareDocumentPosition(b)&4?-1:1}:(r=function(a,b){if(a===b){g=!0;return 0}if(a.sourceIndex&&b.sourceIndex)return a.sourceIndex-b.sourceIndex;var c,d,e=[],f=[],h=a.parentNode,i=b.parentNode,j=h;if(h===i)return s(a,b);if(!h)return-1;if(!i)return 1;while(j)e.unshift(j),j=j.parentNode;j=i;while(j)f.unshift(j),j=j.parentNode;c=e.length,d=f.length;for(var k=0;k<c&&k<d;k++)if(e[k]!==f[k])return s(e[k],f[k]);return k===c?s(a,f[k],-1):s(e[k],b,1)},s=function(a,b,c){if(a===b)return c;var d=a.nextSibling;while(d){if(d===b)return-1;d=d.nextSibling}return 1}),k.getText=function(a){var b="",c;for(var d=0;a[d];d++)c=a[d],c.nodeType===3||c.nodeType===4?b+=c.nodeValue:c.nodeType!==8&&(b+=k.getText(c.childNodes));return b},function(){var a=c.createElement("div"),d="script"+(new Date).getTime(),e=c.documentElement;a.innerHTML="<a name='"+d+"'/>",e.insertBefore(a,e.firstChild),c.getElementById(d)&&(l.find.ID=function(a,c,d){if(typeof c.getElementById!="undefined"&&!d){var e=c.getElementById(a[1]);return e?e.id===a[1]||typeof e.getAttributeNode!="undefined"&&e.getAttributeNode("id").nodeValue===a[1]?[e]:b:[]}},l.filter.ID=function(a,b){var c=typeof a.getAttributeNode!="undefined"&&a.getAttributeNode("id");return a.nodeType===1&&c&&c.nodeValue===b}),e.removeChild(a),e=a=null}(),function(){var a=c.createElement("div");a.appendChild(c.createComment("")),a.getElementsByTagName("*").length>0&&(l.find.TAG=function(a,b){var c=b.getElementsByTagName(a[1]);if(a[1]==="*"){var d=[];for(var e=0;c[e];e++)c[e].nodeType===1&&d.push(c[e]);c=d}return c}),a.innerHTML="<a href='#'></a>",a.firstChild&&typeof a.firstChild.getAttribute!="undefined"&&a.firstChild.getAttribute("href")!=="#"&&(l.attrHandle.href=function(a){return a.getAttribute("href",2)}),a=null}(),c.querySelectorAll&&function(){var a=k,b=c.createElement("div"),d="__sizzle__";b.innerHTML="<p class='TEST'></p>";if(!b.querySelectorAll||b.querySelectorAll(".TEST").length!==0){k=function(b,e,f,g){e=e||c;if(!g&&!k.isXML(e)){var h=/^(\w+$)|^\.([\w\-]+$)|^#([\w\-]+$)/.exec(b);if(h&&(e.nodeType===1||e.nodeType===9)){if(h[1])return p(e.getElementsByTagName(b),f);if(h[2]&&l.find.CLASS&&e.getElementsByClassName)return p(e.getElementsByClassName(h[2]),f)}if(e.nodeType===9){if(b==="body"&&e.body)return p([e.body],f);if(h&&h[3]){var i=e.getElementById(h[3]);if(!i||!i.parentNode)return p([],f);if(i.id===h[3])return p([i],f)}try{return p(e.querySelectorAll(b),f)}catch(j){}}else if(e.nodeType===1&&e.nodeName.toLowerCase()!=="object"){var m=e,n=e.getAttribute("id"),o=n||d,q=e.parentNode,r=/^\s*[+~]/.test(b);n?o=o.replace(/'/g,"\\$&"):e.setAttribute("id",o),r&&q&&(e=e.parentNode);try{if(!r||q)return p(e.querySelectorAll("[id='"+o+"'] "+b),f)}catch(s){}finally{n||m.removeAttribute("id")}}}return a(b,e,f,g)};for(var e in a)k[e]=a[e];b=null}}(),function(){var a=c.documentElement,b=a.matchesSelector||a.mozMatchesSelector||a.webkitMatchesSelector||a.msMatchesSelector;if(b){var d=!b.call(c.createElement("div"),"div"),e=!1;try{b.call(c.documentElement,"[test!='']:sizzle")}catch(f){e=!0}k.matchesSelector=function(a,c){c=c.replace(/\=\s*([^'"\]]*)\s*\]/g,"='$1']");if(!k.isXML(a))try{if(e||!l.match.PSEUDO.test(c)&&!/!=/.test(c)){var f=b.call(a,c);if(f||!d||a.document&&a.document.nodeType!==11)return f}}catch(g){}return k(c,null,null,[a]).length>0}}}(),function(){var a=c.createElement("div");a.innerHTML="<div class='test e'></div><div class='test'></div>";if(!!a.getElementsByClassName&&a.getElementsByClassName("e").length!==0){a.lastChild.className="e";if(a.getElementsByClassName("e").length===1)return;l.order.splice(1,0,"CLASS"),l.find.CLASS=function(a,b,c){if(typeof b.getElementsByClassName!="undefined"&&!c)return b.getElementsByClassName(a[1])},a=null}}(),c.documentElement.contains?k.contains=function(a,b){return a!==b&&(a.contains?a.contains(b):!0)}:c.documentElement.compareDocumentPosition?k.contains=function(a,b){return!!(a.compareDocumentPosition(b)&16)}:k.contains=function(){return!1},k.isXML=function(a){var b=(a?a.ownerDocument||a:0).documentElement;return b?b.nodeName!=="HTML":!1};var v=function(a,b){var c,d=[],e="",f=b.nodeType?[b]:b;while(c=l.match.PSEUDO.exec(a))e+=c[0],a=a.replace(l.match.PSEUDO,"");a=l.relative[a]?a+"*":a;for(var g=0,h=f.length;g<h;g++)k(a,f[g],d);return k.filter(e,d)};f.find=k,f.expr=k.selectors,f.expr[":"]=f.expr.filters,f.unique=k.uniqueSort,f.text=k.getText,f.isXMLDoc=k.isXML,f.contains=k.contains}();var N=/Until$/,O=/^(?:parents|prevUntil|prevAll)/,P=/,/,Q=/^.[^:#\[\.,]*$/,R=Array.prototype.slice,S=f.expr.match.POS,T={children:!0,contents:!0,next:!0,prev:!0};f.fn.extend({find:function(a){var b=this,c,d;if(typeof a!="string")return f(a).filter(function(){for(c=0,d=b.length;c<d;c++)if(f.contains(b[c],this))return!0});var e=this.pushStack("","find",a),g,h,i;for(c=0,d=this.length;c<d;c++){g=e.length,f.find(a,this[c],e);if(c>0)for(h=g;h<e.length;h++)for(i=0;i<g;i++)if(e[i]===e[h]){e.splice(h--,1);break}}return e},has:function(a){var b=f(a);return this.filter(function(){for(var a=0,c=b.length;a<c;a++)if(f.contains(this,b[a]))return!0})},not:function(a){return this.pushStack(V(this,a,!1),"not",a)},filter:function(a){return this.pushStack(V(this,a,!0),"filter",a)},is:function(a){return!!a&&(typeof a=="string"?f.filter(a,this).length>0:this.filter(a).length>0)},closest:function(a,b){var c=[],d,e,g=this[0];if(f.isArray(a)){var h,i,j={},k=1;if(g&&a.length){for(d=0,e=a.length;d<e;d++)i=a[d],j[i]||(j[i]=S.test(i)?f(i,b||this.context):i);while(g&&g.ownerDocument&&g!==b){for(i in j)h=j[i],(h.jquery?h.index(g)>-1:f(g).is(h))&&c.push({selector:i,elem:g,level:k});g=g.parentNode,k++}}return c}var l=S.test(a)||typeof a!="string"?f(a,b||this.context):0;for(d=0,e=this.length;d<e;d++){g=this[d];while(g){if(l?l.index(g)>-1:f.find.matchesSelector(g,a)){c.push(g);break}g=g.parentNode;if(!g||!g.ownerDocument||g===b||g.nodeType===11)break}}c=c.length>1?f.unique(c):c;return this.pushStack(c,"closest",a)},index:function(a){if(!a)return this[0]&&this[0].parentNode?this.prevAll().length:-1;if(typeof a=="string")return f.inArray(this[0],f(a));return f.inArray(a.jquery?a[0]:a,this)},add:function(a,b){var c=typeof a=="string"?f(a,b):f.makeArray(a&&a.nodeType?[a]:a),d=f.merge(this.get(),c);return this.pushStack(U(c[0])||U(d[0])?d:f.unique(d))},andSelf:function(){return this.add(this.prevObject)}}),f.each({parent:function(a){var b=a.parentNode;return b&&b.nodeType!==11?b:null},parents:function(a){return f.dir(a,"parentNode")},parentsUntil:function(a,b,c){return f.dir(a,"parentNode",c)},next:function(a){return f.nth(a,2,"nextSibling")},prev:function(a){return f.nth(a,2,"previousSibling")},nextAll:function(a){return f.dir(a,"nextSibling")},prevAll:function(a){return f.dir(a,"previousSibling")},nextUntil:function(a,b,c){return f.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return f.dir(a,"previousSibling",c)},siblings:function(a){return f.sibling(a.parentNode.firstChild,a)},children:function(a){return f.sibling(a.firstChild)},contents:function(a){return f.nodeName(a,"iframe")?a.contentDocument||a.contentWindow.document:f.makeArray(a.childNodes)}},function(a,b){f.fn[a]=function(c,d){var e=f.map(this,b,c),g=R.call(arguments);N.test(a)||(d=c),d&&typeof d=="string"&&(e=f.filter(d,e)),e=this.length>1&&!T[a]?f.unique(e):e,(this.length>1||P.test(d))&&O.test(a)&&(e=e.reverse());return this.pushStack(e,a,g.join(","))}}),f.extend({filter:function(a,b,c){c&&(a=":not("+a+")");return b.length===1?f.find.matchesSelector(b[0],a)?[b[0]]:[]:f.find.matches(a,b)},dir:function(a,c,d){var e=[],g=a[c];while(g&&g.nodeType!==9&&(d===b||g.nodeType!==1||!f(g).is(d)))g.nodeType===1&&e.push(g),g=g[c];return e},nth:function(a,b,c,d){b=b||1;var e=0;for(;a;a=a[c])if(a.nodeType===1&&++e===b)break;return a},sibling:function(a,b){var c=[];for(;a;a=a.nextSibling)a.nodeType===1&&a!==b&&c.push(a);return c}});var W=/ jQuery\d+="(?:\d+|null)"/g,X=/^\s+/,Y=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig,Z=/<([\w:]+)/,$=/<tbody/i,_=/<|&#?\w+;/,ba=/<(?:script|object|embed|option|style)/i,bb=/checked\s*(?:[^=]|=\s*.checked.)/i,bc=/\/(java|ecma)script/i,bd=/^\s*<!(?:\[CDATA\[|\-\-)/,be={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]};be.optgroup=be.option,be.tbody=be.tfoot=be.colgroup=be.caption=be.thead,be.th=be.td,f.support.htmlSerialize||(be._default=[1,"div<div>","</div>"]),f.fn.extend({text:function(a){if(f.isFunction(a))return this.each(function(b){var c=f(this);c.text(a.call(this,b,c.text()))});if(typeof a!="object"&&a!==b)return this.empty().append((this[0]&&this[0].ownerDocument||c).createTextNode(a));return f.text(this)},wrapAll:function(a){if(f.isFunction(a))return this.each(function(b){f(this).wrapAll(a.call(this,b))});if(this[0]){var b=f(a,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){var a=this;while(a.firstChild&&a.firstChild.nodeType===1)a=a.firstChild;return a}).append(this)}return this},wrapInner:function(a){if(f.isFunction(a))return this.each(function(b){f(this).wrapInner(a.call(this,b))});return this.each(function(){var b=f(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){return this.each(function(){f(this).wrapAll(a)})},unwrap:function(){return this.parent().each(function(){f.nodeName(this,"body")||f(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(a){this.nodeType===1&&this.appendChild(a)})},prepend:function(){return this.domManip(arguments,!0,function(a){this.nodeType===1&&this.insertBefore(a,this.firstChild)})},before:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this)});if(arguments.length){var a=f(arguments[0]);a.push.apply(a,this.toArray());return this.pushStack(a,"before",arguments)}},after:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this.nextSibling)});if(arguments.length){var a=this.pushStack(this,"after",arguments);a.push.apply(a,f(arguments[0]).toArray());return a}},remove:function(a,b){for(var c=0,d;(d=this[c])!=null;c++)if(!a||f.filter(a,[d]).length)!b&&d.nodeType===1&&(f.cleanData(d.getElementsByTagName("*")),f.cleanData([d])),d.parentNode&&d.parentNode.removeChild(d);return this},empty:function(){for(var a=0,b;(b=this[a])!=null;a++){b.nodeType===1&&f.cleanData(b.getElementsByTagName("*"));while(b.firstChild)b.removeChild(b.firstChild)}return this},clone:function(a,b){a=a==null?!1:a,b=b==null?a:b;return this.map(function(){return f.clone(this,a,b)})},html:function(a){if(a===b)return this[0]&&this[0].nodeType===1?this[0].innerHTML.replace(W,""):null;if(typeof a=="string"&&!ba.test(a)&&(f.support.leadingWhitespace||!X.test(a))&&!be[(Z.exec(a)||["",""])[1].toLowerCase()]){a=a.replace(Y,"<$1></$2>");try{for(var c=0,d=this.length;c<d;c++)this[c].nodeType===1&&(f.cleanData(this[c].getElementsByTagName("*")),this[c].innerHTML=a)}catch(e){this.empty().append(a)}}else f.isFunction(a)?this.each(function(b){var c=f(this);c.html(a.call(this,b,c.html()))}):this.empty().append(a);return this},replaceWith:function(a){if(this[0]&&this[0].parentNode){if(f.isFunction(a))return this.each(function(b){var c=f(this),d=c.html();c.replaceWith(a.call(this,b,d))});typeof a!="string"&&(a=f(a).detach());return this.each(function(){var b=this.nextSibling,c=this.parentNode;f(this).remove(),b?f(b).before(a):f(c).append(a)})}return this.length?this.pushStack(f(f.isFunction(a)?a():a),"replaceWith",a):this},detach:function(a){return this.remove(a,!0)},domManip:function(a,c,d){var e,g,h,i,j=a[0],k=[];if(!f.support.checkClone&&arguments.length===3&&typeof j=="string"&&bb.test(j))return this.each(function(){f(this).domManip(a,c,d,!0)});if(f.isFunction(j))return this.each(function(e){var g=f(this);a[0]=j.call(this,e,c?g.html():b),g.domManip(a,c,d)});if(this[0]){i=j&&j.parentNode,f.support.parentNode&&i&&i.nodeType===11&&i.childNodes.length===this.length?e={fragment:i}:e=f.buildFragment(a,this,k),h=e.fragment,h.childNodes.length===1?g=h=h.firstChild:g=h.firstChild;if(g){c=c&&f.nodeName(g,"tr");for(var l=0,m=this.length,n=m-1;l<m;l++)d.call(c?bf(this[l],g):this[l],e.cacheable||m>1&&l<n?f.clone(h,!0,!0):h)}k.length&&f.each(k,bl)}return this}}),f.buildFragment=function(a,b,d){var e,g,h,i;b&&b[0]&&(i=b[0].ownerDocument||b[0]),i.createDocumentFragment||(i=c),a.length===1&&typeof a[0]=="string"&&a[0].length<512&&i===c&&a[0].charAt(0)==="<"&&!ba.test(a[0])&&(f.support.checkClone||!bb.test(a[0]))&&(g=!0,h=f.fragments[a[0]],h&&h!==1&&(e=h)),e||(e=i.createDocumentFragment(),f.clean(a,i,e,d)),g&&(f.fragments[a[0]]=h?e:1);
return{fragment:e,cacheable:g}},f.fragments={},f.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){f.fn[a]=function(c){var d=[],e=f(c),g=this.length===1&&this[0].parentNode;if(g&&g.nodeType===11&&g.childNodes.length===1&&e.length===1){e[b](this[0]);return this}for(var h=0,i=e.length;h<i;h++){var j=(h>0?this.clone(!0):this).get();f(e[h])[b](j),d=d.concat(j)}return this.pushStack(d,a,e.selector)}}),f.extend({clone:function(a,b,c){var d=a.cloneNode(!0),e,g,h;if((!f.support.noCloneEvent||!f.support.noCloneChecked)&&(a.nodeType===1||a.nodeType===11)&&!f.isXMLDoc(a)){bh(a,d),e=bi(a),g=bi(d);for(h=0;e[h];++h)g[h]&&bh(e[h],g[h])}if(b){bg(a,d);if(c){e=bi(a),g=bi(d);for(h=0;e[h];++h)bg(e[h],g[h])}}e=g=null;return d},clean:function(a,b,d,e){var g;b=b||c,typeof b.createElement=="undefined"&&(b=b.ownerDocument||b[0]&&b[0].ownerDocument||c);var h=[],i;for(var j=0,k;(k=a[j])!=null;j++){typeof k=="number"&&(k+="");if(!k)continue;if(typeof k=="string")if(!_.test(k))k=b.createTextNode(k);else{k=k.replace(Y,"<$1></$2>");var l=(Z.exec(k)||["",""])[1].toLowerCase(),m=be[l]||be._default,n=m[0],o=b.createElement("div");o.innerHTML=m[1]+k+m[2];while(n--)o=o.lastChild;if(!f.support.tbody){var p=$.test(k),q=l==="table"&&!p?o.firstChild&&o.firstChild.childNodes:m[1]==="<table>"&&!p?o.childNodes:[];for(i=q.length-1;i>=0;--i)f.nodeName(q[i],"tbody")&&!q[i].childNodes.length&&q[i].parentNode.removeChild(q[i])}!f.support.leadingWhitespace&&X.test(k)&&o.insertBefore(b.createTextNode(X.exec(k)[0]),o.firstChild),k=o.childNodes}var r;if(!f.support.appendChecked)if(k[0]&&typeof (r=k.length)=="number")for(i=0;i<r;i++)bk(k[i]);else bk(k);k.nodeType?h.push(k):h=f.merge(h,k)}if(d){g=function(a){return!a.type||bc.test(a.type)};for(j=0;h[j];j++)if(e&&f.nodeName(h[j],"script")&&(!h[j].type||h[j].type.toLowerCase()==="text/javascript"))e.push(h[j].parentNode?h[j].parentNode.removeChild(h[j]):h[j]);else{if(h[j].nodeType===1){var s=f.grep(h[j].getElementsByTagName("script"),g);h.splice.apply(h,[j+1,0].concat(s))}d.appendChild(h[j])}}return h},cleanData:function(a){var b,c,d=f.cache,e=f.expando,g=f.event.special,h=f.support.deleteExpando;for(var i=0,j;(j=a[i])!=null;i++){if(j.nodeName&&f.noData[j.nodeName.toLowerCase()])continue;c=j[f.expando];if(c){b=d[c]&&d[c][e];if(b&&b.events){for(var k in b.events)g[k]?f.event.remove(j,k):f.removeEvent(j,k,b.handle);b.handle&&(b.handle.elem=null)}h?delete j[f.expando]:j.removeAttribute&&j.removeAttribute(f.expando),delete d[c]}}}});var bm=/alpha\([^)]*\)/i,bn=/opacity=([^)]*)/,bo=/([A-Z]|^ms)/g,bp=/^-?\d+(?:px)?$/i,bq=/^-?\d/,br=/^([\-+])=([\-+.\de]+)/,bs={position:"absolute",visibility:"hidden",display:"block"},bt=["Left","Right"],bu=["Top","Bottom"],bv,bw,bx;f.fn.css=function(a,c){if(arguments.length===2&&c===b)return this;return f.access(this,a,c,!0,function(a,c,d){return d!==b?f.style(a,c,d):f.css(a,c)})},f.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=bv(a,"opacity","opacity");return c===""?"1":c}return a.style.opacity}}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":f.support.cssFloat?"cssFloat":"styleFloat"},style:function(a,c,d,e){if(!!a&&a.nodeType!==3&&a.nodeType!==8&&!!a.style){var g,h,i=f.camelCase(c),j=a.style,k=f.cssHooks[i];c=f.cssProps[i]||i;if(d===b){if(k&&"get"in k&&(g=k.get(a,!1,e))!==b)return g;return j[c]}h=typeof d,h==="string"&&(g=br.exec(d))&&(d=+(g[1]+1)*+g[2]+parseFloat(f.css(a,c)),h="number");if(d==null||h==="number"&&isNaN(d))return;h==="number"&&!f.cssNumber[i]&&(d+="px");if(!k||!("set"in k)||(d=k.set(a,d))!==b)try{j[c]=d}catch(l){}}},css:function(a,c,d){var e,g;c=f.camelCase(c),g=f.cssHooks[c],c=f.cssProps[c]||c,c==="cssFloat"&&(c="float");if(g&&"get"in g&&(e=g.get(a,!0,d))!==b)return e;if(bv)return bv(a,c)},swap:function(a,b,c){var d={};for(var e in b)d[e]=a.style[e],a.style[e]=b[e];c.call(a);for(e in b)a.style[e]=d[e]}}),f.curCSS=f.css,f.each(["height","width"],function(a,b){f.cssHooks[b]={get:function(a,c,d){var e;if(c){if(a.offsetWidth!==0)return by(a,b,d);f.swap(a,bs,function(){e=by(a,b,d)});return e}},set:function(a,b){if(!bp.test(b))return b;b=parseFloat(b);if(b>=0)return b+"px"}}}),f.support.opacity||(f.cssHooks.opacity={get:function(a,b){return bn.test((b&&a.currentStyle?a.currentStyle.filter:a.style.filter)||"")?parseFloat(RegExp.$1)/100+"":b?"1":""},set:function(a,b){var c=a.style,d=a.currentStyle,e=f.isNaN(b)?"":"alpha(opacity="+b*100+")",g=d&&d.filter||c.filter||"";c.zoom=1;if(b>=1&&f.trim(g.replace(bm,""))===""){c.removeAttribute("filter");if(d&&!d.filter)return}c.filter=bm.test(g)?g.replace(bm,e):g+" "+e}}),f(function(){f.support.reliableMarginRight||(f.cssHooks.marginRight={get:function(a,b){var c;f.swap(a,{display:"inline-block"},function(){b?c=bv(a,"margin-right","marginRight"):c=a.style.marginRight});return c}})}),c.defaultView&&c.defaultView.getComputedStyle&&(bw=function(a,c){var d,e,g;c=c.replace(bo,"-$1").toLowerCase();if(!(e=a.ownerDocument.defaultView))return b;if(g=e.getComputedStyle(a,null))d=g.getPropertyValue(c),d===""&&!f.contains(a.ownerDocument.documentElement,a)&&(d=f.style(a,c));return d}),c.documentElement.currentStyle&&(bx=function(a,b){var c,d=a.currentStyle&&a.currentStyle[b],e=a.runtimeStyle&&a.runtimeStyle[b],f=a.style;!bp.test(d)&&bq.test(d)&&(c=f.left,e&&(a.runtimeStyle.left=a.currentStyle.left),f.left=b==="fontSize"?"1em":d||0,d=f.pixelLeft+"px",f.left=c,e&&(a.runtimeStyle.left=e));return d===""?"auto":d}),bv=bw||bx,f.expr&&f.expr.filters&&(f.expr.filters.hidden=function(a){var b=a.offsetWidth,c=a.offsetHeight;return b===0&&c===0||!f.support.reliableHiddenOffsets&&(a.style.display||f.css(a,"display"))==="none"},f.expr.filters.visible=function(a){return!f.expr.filters.hidden(a)});var bz=/%20/g,bA=/\[\]$/,bB=/\r?\n/g,bC=/#.*$/,bD=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,bE=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,bF=/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/,bG=/^(?:GET|HEAD)$/,bH=/^\/\//,bI=/\?/,bJ=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,bK=/^(?:select|textarea)/i,bL=/\s+/,bM=/([?&])_=[^&]*/,bN=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/,bO=f.fn.load,bP={},bQ={},bR,bS,bT=["*/"]+["*"];try{bR=e.href}catch(bU){bR=c.createElement("a"),bR.href="",bR=bR.href}bS=bN.exec(bR.toLowerCase())||[],f.fn.extend({load:function(a,c,d){if(typeof a!="string"&&bO)return bO.apply(this,arguments);if(!this.length)return this;var e=a.indexOf(" ");if(e>=0){var g=a.slice(e,a.length);a=a.slice(0,e)}var h="GET";c&&(f.isFunction(c)?(d=c,c=b):typeof c=="object"&&(c=f.param(c,f.ajaxSettings.traditional),h="POST"));var i=this;f.ajax({url:a,type:h,dataType:"html",data:c,complete:function(a,b,c){c=a.responseText,a.isResolved()&&(a.done(function(a){c=a}),i.html(g?f("<div>").append(c.replace(bJ,"")).find(g):c)),d&&i.each(d,[c,b,a])}});return this},serialize:function(){return f.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?f.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||bK.test(this.nodeName)||bE.test(this.type))}).map(function(a,b){var c=f(this).val();return c==null?null:f.isArray(c)?f.map(c,function(a,c){return{name:b.name,value:a.replace(bB,"\r\n")}}):{name:b.name,value:c.replace(bB,"\r\n")}}).get()}}),f.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(a,b){f.fn[b]=function(a){return this.bind(b,a)}}),f.each(["get","post"],function(a,c){f[c]=function(a,d,e,g){f.isFunction(d)&&(g=g||e,e=d,d=b);return f.ajax({type:c,url:a,data:d,success:e,dataType:g})}}),f.extend({getScript:function(a,c){return f.get(a,b,c,"script")},getJSON:function(a,b,c){return f.get(a,b,c,"json")},ajaxSetup:function(a,b){b?bX(a,f.ajaxSettings):(b=a,a=f.ajaxSettings),bX(a,b);return a},ajaxSettings:{url:bR,isLocal:bF.test(bS[1]),global:!0,type:"GET",contentType:"application/x-www-form-urlencoded",processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":bT},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":a.String,"text html":!0,"text json":f.parseJSON,"text xml":f.parseXML},flatOptions:{context:!0,url:!0}},ajaxPrefilter:bV(bP),ajaxTransport:bV(bQ),ajax:function(a,c){function w(a,c,l,m){if(s!==2){s=2,q&&clearTimeout(q),p=b,n=m||"",v.readyState=a>0?4:0;var o,r,u,w=c,x=l?bZ(d,v,l):b,y,z;if(a>=200&&a<300||a===304){if(d.ifModified){if(y=v.getResponseHeader("Last-Modified"))f.lastModified[k]=y;if(z=v.getResponseHeader("Etag"))f.etag[k]=z}if(a===304)w="notmodified",o=!0;else try{r=b$(d,x),w="success",o=!0}catch(A){w="parsererror",u=A}}else{u=w;if(!w||a)w="error",a<0&&(a=0)}v.status=a,v.statusText=""+(c||w),o?h.resolveWith(e,[r,w,v]):h.rejectWith(e,[v,w,u]),v.statusCode(j),j=b,t&&g.trigger("ajax"+(o?"Success":"Error"),[v,d,o?r:u]),i.resolveWith(e,[v,w]),t&&(g.trigger("ajaxComplete",[v,d]),--f.active||f.event.trigger("ajaxStop"))}}typeof a=="object"&&(c=a,a=b),c=c||{};var d=f.ajaxSetup({},c),e=d.context||d,g=e!==d&&(e.nodeType||e instanceof f)?f(e):f.event,h=f.Deferred(),i=f._Deferred(),j=d.statusCode||{},k,l={},m={},n,o,p,q,r,s=0,t,u,v={readyState:0,setRequestHeader:function(a,b){if(!s){var c=a.toLowerCase();a=m[c]=m[c]||a,l[a]=b}return this},getAllResponseHeaders:function(){return s===2?n:null},getResponseHeader:function(a){var c;if(s===2){if(!o){o={};while(c=bD.exec(n))o[c[1].toLowerCase()]=c[2]}c=o[a.toLowerCase()]}return c===b?null:c},overrideMimeType:function(a){s||(d.mimeType=a);return this},abort:function(a){a=a||"abort",p&&p.abort(a),w(0,a);return this}};h.promise(v),v.success=v.done,v.error=v.fail,v.complete=i.done,v.statusCode=function(a){if(a){var b;if(s<2)for(b in a)j[b]=[j[b],a[b]];else b=a[v.status],v.then(b,b)}return this},d.url=((a||d.url)+"").replace(bC,"").replace(bH,bS[1]+"//"),d.dataTypes=f.trim(d.dataType||"*").toLowerCase().split(bL),d.crossDomain==null&&(r=bN.exec(d.url.toLowerCase()),d.crossDomain=!(!r||r[1]==bS[1]&&r[2]==bS[2]&&(r[3]||(r[1]==="http:"?80:443))==(bS[3]||(bS[1]==="http:"?80:443)))),d.data&&d.processData&&typeof d.data!="string"&&(d.data=f.param(d.data,d.traditional)),bW(bP,d,c,v);if(s===2)return!1;t=d.global,d.type=d.type.toUpperCase(),d.hasContent=!bG.test(d.type),t&&f.active++===0&&f.event.trigger("ajaxStart");if(!d.hasContent){d.data&&(d.url+=(bI.test(d.url)?"&":"?")+d.data,delete d.data),k=d.url;if(d.cache===!1){var x=f.now(),y=d.url.replace(bM,"$1_="+x);d.url=y+(y===d.url?(bI.test(d.url)?"&":"?")+"_="+x:"")}}(d.data&&d.hasContent&&d.contentType!==!1||c.contentType)&&v.setRequestHeader("Content-Type",d.contentType),d.ifModified&&(k=k||d.url,f.lastModified[k]&&v.setRequestHeader("If-Modified-Since",f.lastModified[k]),f.etag[k]&&v.setRequestHeader("If-None-Match",f.etag[k])),v.setRequestHeader("Accept",d.dataTypes[0]&&d.accepts[d.dataTypes[0]]?d.accepts[d.dataTypes[0]]+(d.dataTypes[0]!=="*"?", "+bT+"; q=0.01":""):d.accepts["*"]);for(u in d.headers)v.setRequestHeader(u,d.headers[u]);if(d.beforeSend&&(d.beforeSend.call(e,v,d)===!1||s===2)){v.abort();return!1}for(u in{success:1,error:1,complete:1})v[u](d[u]);p=bW(bQ,d,c,v);if(!p)w(-1,"No Transport");else{v.readyState=1,t&&g.trigger("ajaxSend",[v,d]),d.async&&d.timeout>0&&(q=setTimeout(function(){v.abort("timeout")},d.timeout));try{s=1,p.send(l,w)}catch(z){s<2?w(-1,z):f.error(z)}}return v},param:function(a,c){var d=[],e=function(a,b){b=f.isFunction(b)?b():b,d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};c===b&&(c=f.ajaxSettings.traditional);if(f.isArray(a)||a.jquery&&!f.isPlainObject(a))f.each(a,function(){e(this.name,this.value)});else for(var g in a)bY(g,a[g],c,e);return d.join("&").replace(bz,"+")}}),f.extend({active:0,lastModified:{},etag:{}});var b_=f.now(),ca=/(\=)\?(&|$)|\?\?/i;f.ajaxSetup({jsonp:"callback",jsonpCallback:function(){return f.expando+"_"+b_++}}),f.ajaxPrefilter("json jsonp",function(b,c,d){var e=b.contentType==="application/x-www-form-urlencoded"&&typeof b.data=="string";if(b.dataTypes[0]==="jsonp"||b.jsonp!==!1&&(ca.test(b.url)||e&&ca.test(b.data))){var g,h=b.jsonpCallback=f.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,i=a[h],j=b.url,k=b.data,l="$1"+h+"$2";b.jsonp!==!1&&(j=j.replace(ca,l),b.url===j&&(e&&(k=k.replace(ca,l)),b.data===k&&(j+=(/\?/.test(j)?"&":"?")+b.jsonp+"="+h))),b.url=j,b.data=k,a[h]=function(a){g=[a]},d.always(function(){a[h]=i,g&&f.isFunction(i)&&a[h](g[0])}),b.converters["script json"]=function(){g||f.error(h+" was not called");return g[0]},b.dataTypes[0]="json";return"script"}}),f.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(a){f.globalEval(a);return a}}}),f.ajaxPrefilter("script",function(a){a.cache===b&&(a.cache=!1),a.crossDomain&&(a.type="GET",a.global=!1)}),f.ajaxTransport("script",function(a){if(a.crossDomain){var d,e=c.head||c.getElementsByTagName("head")[0]||c.documentElement;return{send:function(f,g){d=c.createElement("script"),d.async="async",a.scriptCharset&&(d.charset=a.scriptCharset),d.src=a.url,d.onload=d.onreadystatechange=function(a,c){if(c||!d.readyState||/loaded|complete/.test(d.readyState))d.onload=d.onreadystatechange=null,e&&d.parentNode&&e.removeChild(d),d=b,c||g(200,"success")},e.insertBefore(d,e.firstChild)},abort:function(){d&&d.onload(0,1)}}}});var cb=a.ActiveXObject?function(){for(var a in cd)cd[a](0,1)}:!1,cc=0,cd;f.ajaxSettings.xhr=a.ActiveXObject?function(){return!this.isLocal&&ce()||cf()}:ce,function(a){f.extend(f.support,{ajax:!!a,cors:!!a&&"withCredentials"in a})}(f.ajaxSettings.xhr()),f.support.ajax&&f.ajaxTransport(function(c){if(!c.crossDomain||f.support.cors){var d;return{send:function(e,g){var h=c.xhr(),i,j;c.username?h.open(c.type,c.url,c.async,c.username,c.password):h.open(c.type,c.url,c.async);if(c.xhrFields)for(j in c.xhrFields)h[j]=c.xhrFields[j];c.mimeType&&h.overrideMimeType&&h.overrideMimeType(c.mimeType),!c.crossDomain&&!e["X-Requested-With"]&&(e["X-Requested-With"]="XMLHttpRequest");try{for(j in e)h.setRequestHeader(j,e[j])}catch(k){}h.send(c.hasContent&&c.data||null),d=function(a,e){var j,k,l,m,n;try{if(d&&(e||h.readyState===4)){d=b,i&&(h.onreadystatechange=f.noop,cb&&delete cd[i]);if(e)h.readyState!==4&&h.abort();else{j=h.status,l=h.getAllResponseHeaders(),m={},n=h.responseXML,n&&n.documentElement&&(m.xml=n),m.text=h.responseText;try{k=h.statusText}catch(o){k=""}!j&&c.isLocal&&!c.crossDomain?j=m.text?200:404:j===1223&&(j=204)}}}catch(p){e||g(-1,p)}m&&g(j,k,m,l)},!c.async||h.readyState===4?d():(i=++cc,cb&&(cd||(cd={},f(a).unload(cb)),cd[i]=d),h.onreadystatechange=d)},abort:function(){d&&d(0,1)}}}});var cg={},ch,ci,cj=/^(?:toggle|show|hide)$/,ck=/^([+\-]=)?([\d+.\-]+)([a-z%]*)$/i,cl,cm=[["height","marginTop","marginBottom","paddingTop","paddingBottom"],["width","marginLeft","marginRight","paddingLeft","paddingRight"],["opacity"]],cn;f.fn.extend({show:function(a,b,c){var d,e;if(a||a===0)return this.animate(cq("show",3),a,b,c);for(var g=0,h=this.length;g<h;g++)d=this[g],d.style&&(e=d.style.display,!f._data(d,"olddisplay")&&e==="none"&&(e=d.style.display=""),e===""&&f.css(d,"display")==="none"&&f._data(d,"olddisplay",cr(d.nodeName)));for(g=0;g<h;g++){d=this[g];if(d.style){e=d.style.display;if(e===""||e==="none")d.style.display=f._data(d,"olddisplay")||""}}return this},hide:function(a,b,c){if(a||a===0)return this.animate(cq("hide",3),a,b,c);for(var d=0,e=this.length;d<e;d++)if(this[d].style){var g=f.css(this[d],"display");g!=="none"&&!f._data(this[d],"olddisplay")&&f._data(this[d],"olddisplay",g)}for(d=0;d<e;d++)this[d].style&&(this[d].style.display="none");return this},_toggle:f.fn.toggle,toggle:function(a,b,c){var d=typeof a=="boolean";f.isFunction(a)&&f.isFunction(b)?this._toggle.apply(this,arguments):a==null||d?this.each(function(){var b=d?a:f(this).is(":hidden");f(this)[b?"show":"hide"]()}):this.animate(cq("toggle",3),a,b,c);return this},fadeTo:function(a,b,c,d){return this.filter(":hidden").css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){var e=f.speed(b,c,d);if(f.isEmptyObject(a))return this.each(e.complete,[!1]);a=f.extend({},a);return this[e.queue===!1?"each":"queue"](function(){e.queue===!1&&f._mark(this);var b=f.extend({},e),c=this.nodeType===1,d=c&&f(this).is(":hidden"),g,h,i,j,k,l,m,n,o;b.animatedProperties={};for(i in a){g=f.camelCase(i),i!==g&&(a[g]=a[i],delete a[i]),h=a[g],f.isArray(h)?(b.animatedProperties[g]=h[1],h=a[g]=h[0]):b.animatedProperties[g]=b.specialEasing&&b.specialEasing[g]||b.easing||"swing";if(h==="hide"&&d||h==="show"&&!d)return b.complete.call(this);c&&(g==="height"||g==="width")&&(b.overflow=[this.style.overflow,this.style.overflowX,this.style.overflowY],f.css(this,"display")==="inline"&&f.css(this,"float")==="none"&&(f.support.inlineBlockNeedsLayout?(j=cr(this.nodeName),j==="inline"?this.style.display="inline-block":(this.style.display="inline",this.style.zoom=1)):this.style.display="inline-block"))}b.overflow!=null&&(this.style.overflow="hidden");for(i in a)k=new f.fx(this,b,i),h=a[i],cj.test(h)?k[h==="toggle"?d?"show":"hide":h]():(l=ck.exec(h),m=k.cur(),l?(n=parseFloat(l[2]),o=l[3]||(f.cssNumber[i]?"":"px"),o!=="px"&&(f.style(this,i,(n||1)+o),m=(n||1)/k.cur()*m,f.style(this,i,m+o)),l[1]&&(n=(l[1]==="-="?-1:1)*n+m),k.custom(m,n,o)):k.custom(m,h,""));return!0})},stop:function(a,b){a&&this.queue([]),this.each(function(){var a=f.timers,c=a.length;b||f._unmark(!0,this);while(c--)a[c].elem===this&&(b&&a[c](!0),a.splice(c,1))}),b||this.dequeue();return this}}),f.each({slideDown:cq("show",1),slideUp:cq("hide",1),slideToggle:cq("toggle",1),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){f.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),f.extend({speed:function(a,b,c){var d=a&&typeof a=="object"?f.extend({},a):{complete:c||!c&&b||f.isFunction(a)&&a,duration:a,easing:c&&b||b&&!f.isFunction(b)&&b};d.duration=f.fx.off?0:typeof d.duration=="number"?d.duration:d.duration in f.fx.speeds?f.fx.speeds[d.duration]:f.fx.speeds._default,d.old=d.complete,d.complete=function(a){f.isFunction(d.old)&&d.old.call(this),d.queue!==!1?f.dequeue(this):a!==!1&&f._unmark(this)};return d},easing:{linear:function(a,b,c,d){return c+d*a},swing:function(a,b,c,d){return(-Math.cos(a*Math.PI)/2+.5)*d+c}},timers:[],fx:function(a,b,c){this.options=b,this.elem=a,this.prop=c,b.orig=b.orig||{}}}),f.fx.prototype={update:function(){this.options.step&&this.options.step.call(this.elem,this.now,this),(f.fx.step[this.prop]||f.fx.step._default)(this)},cur:function(){if(this.elem[this.prop]!=null&&(!this.elem.style||this.elem.style[this.prop]==null))return this.elem[this.prop];var a,b=f.css(this.elem,this.prop);return isNaN(a=parseFloat(b))?!b||b==="auto"?0:b:a},custom:function(a,b,c){function g(a){return d.step(a)}var d=this,e=f.fx;this.startTime=cn||co(),this.start=a,this.end=b,this.unit=c||this.unit||(f.cssNumber[this.prop]?"":"px"),this.now=this.start,this.pos=this.state=0,g.elem=this.elem,g()&&f.timers.push(g)&&!cl&&(cl=setInterval(e.tick,e.interval))},show:function(){this.options.orig[this.prop]=f.style(this.elem,this.prop),this.options.show=!0,this.custom(this.prop==="width"||this.prop==="height"?1:0,this.cur()),f(this.elem).show()},hide:function(){this.options.orig[this.prop]=f.style(this.elem,this.prop),this.options.hide=!0,this.custom(this.cur(),0)},step:function(a){var b=cn||co(),c=!0,d=this.elem,e=this.options,g,h;if(a||b>=e.duration+this.startTime){this.now=this.end,this.pos=this.state=1,this.update(),e.animatedProperties[this.prop]=!0;for(g in e.animatedProperties)e.animatedProperties[g]!==!0&&(c=!1);if(c){e.overflow!=null&&!f.support.shrinkWrapBlocks&&f.each(["","X","Y"],function(a,b){d.style["overflow"+b]=e.overflow[a]}),e.hide&&f(d).hide();if(e.hide||e.show)for(var i in e.animatedProperties)f.style(d,i,e.orig[i]);e.complete.call(d)}return!1}e.duration==Infinity?this.now=b:(h=b-this.startTime,this.state=h/e.duration,this.pos=f.easing[e.animatedProperties[this.prop]](this.state,h,0,1,e.duration),this.now=this.start+(this.end-this.start)*this.pos),this.update();return!0}},f.extend(f.fx,{tick:function(){for(var a=f.timers,b=0;b<a.length;++b)a[b]()||a.splice(b--,1);a.length||f.fx.stop()},interval:13,stop:function(){clearInterval(cl),cl=null},speeds:{slow:600,fast:200,_default:400},step:{opacity:function(a){f.style(a.elem,"opacity",a.now)},_default:function(a){a.elem.style&&a.elem.style[a.prop]!=null?a.elem.style[a.prop]=(a.prop==="width"||a.prop==="height"?Math.max(0,a.now):a.now)+a.unit:a.elem[a.prop]=a.now}}}),f.expr&&f.expr.filters&&(f.expr.filters.animated=function(a){return f.grep(f.timers,function(b){return a===b.elem}).length});var cs=/^t(?:able|d|h)$/i,ct=/^(?:body|html)$/i;"getBoundingClientRect"in c.documentElement?f.fn.offset=function(a){var b=this[0],c;if(a)return this.each(function(b){f.offset.setOffset(this,a,b)});if(!b||!b.ownerDocument)return null;if(b===b.ownerDocument.body)return f.offset.bodyOffset(b);try{c=b.getBoundingClientRect()}catch(d){}var e=b.ownerDocument,g=e.documentElement;if(!c||!f.contains(g,b))return c?{top:c.top,left:c.left}:{top:0,left:0};var h=e.body,i=cu(e),j=g.clientTop||h.clientTop||0,k=g.clientLeft||h.clientLeft||0,l=i.pageYOffset||f.support.boxModel&&g.scrollTop||h.scrollTop,m=i.pageXOffset||f.support.boxModel&&g.scrollLeft||h.scrollLeft,n=c.top+l-j,o=c.left+m-k;return{top:n,left:o}}:f.fn.offset=function(a){var b=this[0];if(a)return this.each(function(b){f.offset.setOffset(this,a,b)});if(!b||!b.ownerDocument)return null;if(b===b.ownerDocument.body)return f.offset.bodyOffset(b);f.offset.initialize();var c,d=b.offsetParent,e=b,g=b.ownerDocument,h=g.documentElement,i=g.body,j=g.defaultView,k=j?j.getComputedStyle(b,null):b.currentStyle,l=b.offsetTop,m=b.offsetLeft;while((b=b.parentNode)&&b!==i&&b!==h){if(f.offset.supportsFixedPosition&&k.position==="fixed")break;c=j?j.getComputedStyle(b,null):b.currentStyle,l-=b.scrollTop,m-=b.scrollLeft,b===d&&(l+=b.offsetTop,m+=b.offsetLeft,f.offset.doesNotAddBorder&&(!f.offset.doesAddBorderForTableAndCells||!cs.test(b.nodeName))&&(l+=parseFloat(c.borderTopWidth)||0,m+=parseFloat(c.borderLeftWidth)||0),e=d,d=b.offsetParent),f.offset.subtractsBorderForOverflowNotVisible&&c.overflow!=="visible"&&(l+=parseFloat(c.borderTopWidth)||0,m+=parseFloat(c.borderLeftWidth)||0),k=c}if(k.position==="relative"||k.position==="static")l+=i.offsetTop,m+=i.offsetLeft;f.offset.supportsFixedPosition&&k.position==="fixed"&&(l+=Math.max(h.scrollTop,i.scrollTop),m+=Math.max(h.scrollLeft,i.scrollLeft));return{top:l,left:m}},f.offset={initialize:function(){var a=c.body,b=c.createElement("div"),d,e,g,h,i=parseFloat(f.css(a,"marginTop"))||0,j="<div style='position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;'><div></div></div><table style='position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;' cellpadding='0' cellspacing='0'><tr><td></td></tr></table>";f.extend(b.style,{position:"absolute",top:0,left:0,margin:0,border:0,width:"1px",height:"1px",visibility:"hidden"}),b.innerHTML=j,a.insertBefore(b,a.firstChild),d=b.firstChild,e=d.firstChild,h=d.nextSibling.firstChild.firstChild,this.doesNotAddBorder=e.offsetTop!==5,this.doesAddBorderForTableAndCells=h.offsetTop===5,e.style.position="fixed",e.style.top="20px",this.supportsFixedPosition=e.offsetTop===20||e.offsetTop===15,e.style.position=e.style.top="",d.style.overflow="hidden",d.style.position="relative",this.subtractsBorderForOverflowNotVisible=e.offsetTop===-5,this.doesNotIncludeMarginInBodyOffset=a.offsetTop!==i,a.removeChild(b),f.offset.initialize=f.noop},bodyOffset:function(a){var b=a.offsetTop,c=a.offsetLeft;f.offset.initialize(),f.offset.doesNotIncludeMarginInBodyOffset&&(b+=parseFloat(f.css(a,"marginTop"))||0,c+=parseFloat(f.css(a,"marginLeft"))||0);return{top:b,left:c}},setOffset:function(a,b,c){var d=f.css(a,"position");d==="static"&&(a.style.position="relative");var e=f(a),g=e.offset(),h=f.css(a,"top"),i=f.css(a,"left"),j=(d==="absolute"||d==="fixed")&&f.inArray("auto",[h,i])>-1,k={},l={},m,n;j?(l=e.position(),m=l.top,n=l.left):(m=parseFloat(h)||0,n=parseFloat(i)||0),f.isFunction(b)&&(b=b.call(a,c,g)),b.top!=null&&(k.top=b.top-g.top+m),b.left!=null&&(k.left=b.left-g.left+n),"using"in b?b.using.call(a,k):e.css(k)}},f.fn.extend({position:function(){if(!this[0])return null;var a=this[0],b=this.offsetParent(),c=this.offset(),d=ct.test(b[0].nodeName)?{top:0,left:0}:b.offset();c.top-=parseFloat(f.css(a,"marginTop"))||0,c.left-=parseFloat(f.css(a,"marginLeft"))||0,d.top+=parseFloat(f.css(b[0],"borderTopWidth"))||0,d.left+=parseFloat(f.css(b[0],"borderLeftWidth"))||0;return{top:c.top-d.top,left:c.left-d.left}},offsetParent:function(){return this.map(function(){var a=this.offsetParent||c.body;while(a&&!ct.test(a.nodeName)&&f.css(a,"position")==="static")a=a.offsetParent;return a})}}),f.each(["Left","Top"],function(a,c){var d="scroll"+c;f.fn[d]=function(c){var e,g;if(c===b){e=this[0];if(!e)return null;g=cu(e);return g?"pageXOffset"in g?g[a?"pageYOffset":"pageXOffset"]:f.support.boxModel&&g.document.documentElement[d]||g.document.body[d]:e[d]}return this.each(function(){g=cu(this),g?g.scrollTo(a?f(g).scrollLeft():c,a?c:f(g).scrollTop()):this[d]=c})}}),f.each(["Height","Width"],function(a,c){var d=c.toLowerCase();f.fn["inner"+c]=function(){var a=this[0];return a&&a.style?parseFloat(f.css(a,d,"padding")):null},f.fn["outer"+c]=function(a){var b=this[0];return b&&b.style?parseFloat(f.css(b,d,a?"margin":"border")):null},f.fn[d]=function(a){var e=this[0];if(!e)return a==null?null:this;if(f.isFunction(a))return this.each(function(b){var c=f(this);c[d](a.call(this,b,c[d]()))});if(f.isWindow(e)){var g=e.document.documentElement["client"+c],h=e.document.body;return e.document.compatMode==="CSS1Compat"&&g||h&&h["client"+c]||g}if(e.nodeType===9)return Math.max(e.documentElement["client"+c],e.body["scroll"+c],e.documentElement["scroll"+c],e.body["offset"+c],e.documentElement["offset"+c]);if(a===b){var i=f.css(e,d),j=parseFloat(i);return f.isNaN(j)?i:j}return this.css(d,typeof a=="string"?a:a+"px")}}),a.jQuery=a.$=f})(window); var JSON;if(!JSON){JSON={}}(function(){function f(n){return n<10?"0"+n:n}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key)}if(typeof rep==="function"){value=rep.call(holder,key,value)}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null"}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){if(typeof rep[i]==="string"){k=rep[i];v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}else{for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}if(typeof JSON.stringify!=="function"){JSON.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" "}}else{if(typeof space==="string"){indent=space}}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":value})}}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return reviver.call(holder,key,value)}text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}}()); (function(){var x=this;var t=x._;var b={};var j=Array.prototype,D=Object.prototype,G=Function.prototype;var v=j.slice,z=j.unshift,y=D.toString,p=D.hasOwnProperty;var n=j.forEach,i=j.map,B=j.reduce,e=j.reduceRight,m=j.filter,a=j.every,A=j.some,w=j.indexOf,f=j.lastIndexOf,c=Array.isArray,C=Object.keys,k=G.bind;var F=function(I){return new g(I)};if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports){exports=module.exports=F}exports._=F}else{x._=F}F.VERSION="1.3.1";var d=F.each=F.forEach=function(N,M,L){if(N==null){return}if(n&&N.forEach===n){N.forEach(M,L)}else{if(N.length===+N.length){for(var K=0,I=N.length;K<I;K++){if(K in N&&M.call(L,N[K],K,N)===b){return}}}else{for(var J in N){if(F.has(N,J)){if(M.call(L,N[J],J,N)===b){return}}}}}};F.map=F.collect=function(L,K,J){var I=[];if(L==null){return I}if(i&&L.map===i){return L.map(K,J)}d(L,function(O,M,N){I[I.length]=K.call(J,O,M,N)});if(L.length===+L.length){I.length=L.length}return I};F.reduce=F.foldl=F.inject=function(M,L,I,K){var J=arguments.length>2;if(M==null){M=[]}if(B&&M.reduce===B){if(K){L=F.bind(L,K)}return J?M.reduce(L,I):M.reduce(L)}d(M,function(P,N,O){if(!J){I=P;J=true}else{I=L.call(K,I,P,N,O)}});if(!J){throw new TypeError("Reduce of empty array with no initial value")}return I};F.reduceRight=F.foldr=function(M,L,I,K){var J=arguments.length>2;if(M==null){M=[]}if(e&&M.reduceRight===e){if(K){L=F.bind(L,K)}return J?M.reduceRight(L,I):M.reduceRight(L)}var N=F.toArray(M).reverse();if(K&&!J){L=F.bind(L,K)}return J?F.reduce(N,L,I,K):F.reduce(N,L)};F.find=F.detect=function(L,K,J){var I;r(L,function(O,M,N){if(K.call(J,O,M,N)){I=O;return true}});return I};F.filter=F.select=function(L,K,J){var I=[];if(L==null){return I}if(m&&L.filter===m){return L.filter(K,J)}d(L,function(O,M,N){if(K.call(J,O,M,N)){I[I.length]=O}});return I};F.reject=function(L,K,J){var I=[];if(L==null){return I}d(L,function(O,M,N){if(!K.call(J,O,M,N)){I[I.length]=O}});return I};F.every=F.all=function(L,K,J){var I=true;if(L==null){return I}if(a&&L.every===a){return L.every(K,J)}d(L,function(O,M,N){if(!(I=I&&K.call(J,O,M,N))){return b}});return I};var r=F.some=F.any=function(L,K,J){K||(K=F.identity);var I=false;if(L==null){return I}if(A&&L.some===A){return L.some(K,J)}d(L,function(O,M,N){if(I||(I=K.call(J,O,M,N))){return b}});return !!I};F.include=F.contains=function(K,J){var I=false;if(K==null){return I}if(w&&K.indexOf===w){return K.indexOf(J)!=-1}I=r(K,function(L){return L===J});return I};F.invoke=function(J,K){var I=v.call(arguments,2);return F.map(J,function(L){return(F.isFunction(K)?K||L:L[K]).apply(L,I)})};F.pluck=function(J,I){return F.map(J,function(K){return K[I]})};F.max=function(L,K,J){if(!K&&F.isArray(L)){return Math.max.apply(Math,L)}if(!K&&F.isEmpty(L)){return -Infinity}var I={computed:-Infinity};d(L,function(P,M,O){var N=K?K.call(J,P,M,O):P;N>=I.computed&&(I={value:P,computed:N})});return I.value};F.min=function(L,K,J){if(!K&&F.isArray(L)){return Math.min.apply(Math,L)}if(!K&&F.isEmpty(L)){return Infinity}var I={computed:Infinity};d(L,function(P,M,O){var N=K?K.call(J,P,M,O):P;N<I.computed&&(I={value:P,computed:N})});return I.value};F.shuffle=function(K){var I=[],J;d(K,function(N,L,M){if(L==0){I[0]=N}else{J=Math.floor(Math.random()*(L+1));I[L]=I[J];I[J]=N}});return I};F.sortBy=function(K,J,I){return F.pluck(F.map(K,function(N,L,M){return{value:N,criteria:J.call(I,N,L,M)}}).sort(function(O,N){var M=O.criteria,L=N.criteria;return M<L?-1:M>L?1:0}),"value")};F.groupBy=function(K,L){var I={};var J=F.isFunction(L)?L:function(M){return M[L]};d(K,function(O,M){var N=J(O,M);(I[N]||(I[N]=[])).push(O)});return I};F.sortedIndex=function(N,M,K){K||(K=F.identity);var I=0,L=N.length;while(I<L){var J=(I+L)>>1;K(N[J])<K(M)?I=J+1:L=J}return I};F.toArray=function(I){if(!I){return[]}if(I.toArray){return I.toArray()}if(F.isArray(I)){return v.call(I)}if(F.isArguments(I)){return v.call(I)}return F.values(I)};F.size=function(I){return F.toArray(I).length};F.first=F.head=function(K,J,I){return(J!=null)&&!I?v.call(K,0,J):K[0]};F.initial=function(K,J,I){return v.call(K,0,K.length-((J==null)||I?1:J))};F.last=function(K,J,I){if((J!=null)&&!I){return v.call(K,Math.max(K.length-J,0))}else{return K[K.length-1]}};F.rest=F.tail=function(K,I,J){return v.call(K,(I==null)||J?1:I)};F.compact=function(I){return F.filter(I,function(J){return !!J})};F.flatten=function(J,I){return F.reduce(J,function(K,L){if(F.isArray(L)){return K.concat(I?L:F.flatten(L))}K[K.length]=L;return K},[])};F.without=function(I){return F.difference(I,v.call(arguments,1))};F.uniq=F.unique=function(M,L,K){var J=K?F.map(M,K):M;var I=[];F.reduce(J,function(N,P,O){if(0==O||(L===true?F.last(N)!=P:!F.include(N,P))){N[N.length]=P;I[I.length]=M[O]}return N},[]);return I};F.union=function(){return F.uniq(F.flatten(arguments,true))};F.intersection=F.intersect=function(J){var I=v.call(arguments,1);return F.filter(F.uniq(J),function(K){return F.every(I,function(L){return F.indexOf(L,K)>=0})})};F.difference=function(J){var I=F.flatten(v.call(arguments,1));return F.filter(J,function(K){return !F.include(I,K)})};F.zip=function(){var I=v.call(arguments);var L=F.max(F.pluck(I,"length"));var K=new Array(L);for(var J=0;J<L;J++){K[J]=F.pluck(I,""+J)}return K};F.indexOf=function(M,K,L){if(M==null){return -1}var J,I;if(L){J=F.sortedIndex(M,K);return M[J]===K?J:-1}if(w&&M.indexOf===w){return M.indexOf(K)}for(J=0,I=M.length;J<I;J++){if(J in M&&M[J]===K){return J}}return -1};F.lastIndexOf=function(K,J){if(K==null){return -1}if(f&&K.lastIndexOf===f){return K.lastIndexOf(J)}var I=K.length;while(I--){if(I in K&&K[I]===J){return I}}return -1};F.range=function(N,L,M){if(arguments.length<=1){L=N||0;N=0}M=arguments[2]||1;var J=Math.max(Math.ceil((L-N)/M),0);var I=0;var K=new Array(J);while(I<J){K[I++]=N;N+=M}return K};var h=function(){};F.bind=function H(L,J){var K,I;if(L.bind===k&&k){return k.apply(L,v.call(arguments,1))}if(!F.isFunction(L)){throw new TypeError}I=v.call(arguments,2);return K=function(){if(!(this instanceof K)){return L.apply(J,I.concat(v.call(arguments)))}h.prototype=L.prototype;var N=new h;var M=L.apply(N,I.concat(v.call(arguments)));if(Object(M)===M){return M}return N}};F.bindAll=function(J){var I=v.call(arguments,1);if(I.length==0){I=F.functions(J)}d(I,function(K){J[K]=F.bind(J[K],J)});return J};F.memoize=function(K,J){var I={};J||(J=F.identity);return function(){var L=J.apply(this,arguments);return F.has(I,L)?I[L]:(I[L]=K.apply(this,arguments))}};F.delay=function(J,K){var I=v.call(arguments,2);return setTimeout(function(){return J.apply(J,I)},K)};F.defer=function(I){return F.delay.apply(F,[I,1].concat(v.call(arguments,1)))};F.throttle=function(N,P){var L,I,O,M,K;var J=F.debounce(function(){K=M=false},P);return function(){L=this;I=arguments;var Q=function(){O=null;if(K){N.apply(L,I)}J()};if(!O){O=setTimeout(Q,P)}if(M){K=true}else{N.apply(L,I)}J();M=true}};F.debounce=function(I,K){var J;return function(){var N=this,M=arguments;var L=function(){J=null;I.apply(N,M)};clearTimeout(J);J=setTimeout(L,K)}};F.once=function(K){var I=false,J;return function(){if(I){return J}I=true;return J=K.apply(this,arguments)}};F.wrap=function(I,J){return function(){var K=[I].concat(v.call(arguments,0));return J.apply(this,K)}};F.compose=function(){var I=arguments;return function(){var J=arguments;for(var K=I.length-1;K>=0;K--){J=[I[K].apply(this,J)]}return J[0]}};F.after=function(J,I){if(J<=0){return I()}return function(){if(--J<1){return I.apply(this,arguments)}}};F.keys=C||function(K){if(K!==Object(K)){throw new TypeError("Invalid object")}var J=[];for(var I in K){if(F.has(K,I)){J[J.length]=I}}return J};F.values=function(I){return F.map(I,F.identity)};F.functions=F.methods=function(K){var J=[];for(var I in K){if(F.isFunction(K[I])){J.push(I)}}return J.sort()};F.extend=function(I){d(v.call(arguments,1),function(J){for(var K in J){I[K]=J[K]}});return I};F.defaults=function(I){d(v.call(arguments,1),function(J){for(var K in J){if(I[K]==null){I[K]=J[K]}}});return I};F.clone=function(I){if(!F.isObject(I)){return I}return F.isArray(I)?I.slice():F.extend({},I)};F.tap=function(J,I){I(J);return J};function E(L,K,J){if(L===K){return L!==0||1/L==1/K}if(L==null||K==null){return L===K}if(L._chain){L=L._wrapped}if(K._chain){K=K._wrapped}if(L.isEqual&&F.isFunction(L.isEqual)){return L.isEqual(K)}if(K.isEqual&&F.isFunction(K.isEqual)){return K.isEqual(L)}var O=y.call(L);if(O!=y.call(K)){return false}switch(O){case"[object String]":return L==String(K);case"[object Number]":return L!=+L?K!=+K:(L==0?1/L==1/K:L==+K);case"[object Date]":case"[object Boolean]":return +L==+K;case"[object RegExp]":return L.source==K.source&&L.global==K.global&&L.multiline==K.multiline&&L.ignoreCase==K.ignoreCase}if(typeof L!="object"||typeof K!="object"){return false}var P=J.length;while(P--){if(J[P]==L){return true}}J.push(L);var N=0,I=true;if(O=="[object Array]"){N=L.length;I=N==K.length;if(I){while(N--){if(!(I=N in L==N in K&&E(L[N],K[N],J))){break}}}}else{if("constructor" in L!="constructor" in K||L.constructor!=K.constructor){return false}for(var M in L){if(F.has(L,M)){N++;if(!(I=F.has(K,M)&&E(L[M],K[M],J))){break}}}if(I){for(M in K){if(F.has(K,M)&&!(N--)){break}}I=!N}}J.pop();return I}F.isEqual=function(J,I){return E(J,I,[])};F.isEmpty=function(J){if(F.isArray(J)||F.isString(J)){return J.length===0}for(var I in J){if(F.has(J,I)){return false}}return true};F.isElement=function(I){return !!(I&&I.nodeType==1)};F.isArray=c||function(I){return y.call(I)=="[object Array]"};F.isObject=function(I){return I===Object(I)};F.isArguments=function(I){return y.call(I)=="[object Arguments]"};if(!F.isArguments(arguments)){F.isArguments=function(I){return !!(I&&F.has(I,"callee"))}}F.isFunction=function(I){return y.call(I)=="[object Function]"};F.isString=function(I){return y.call(I)=="[object String]"};F.isNumber=function(I){return y.call(I)=="[object Number]"};F.isNaN=function(I){return I!==I};F.isFinite=function(I){return isFinite(I)&&!isNaN(parseFloat(I))};F.isBoolean=function(I){return I===true||I===false||y.call(I)=="[object Boolean]"};F.isDate=function(I){return y.call(I)=="[object Date]"};F.isRegExp=function(I){return y.call(I)=="[object RegExp]"};F.isNull=function(I){return I===null};F.isUndefined=function(I){return I===void 0};F.has=function(J,I){return p.call(J,I)};F.noConflict=function(){x._=t;return this};F.identity=function(I){return I};F.times=function(L,K,J){for(var I=0;I<L;I++){K.call(J,I)}};F.escape=function(I){return(""+I).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")};F.mixin=function(I){d(F.functions(I),function(J){s(J,F[J]=I[J])})};var l=0;F.uniqueId=function(I){var J=l++;return I?I+J:J};F.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var u=/.^/;var q=function(I){return I.replace(/\\\\/g,"\\").replace(/\\'/g,"'")};F.template=function(L,K){var M=F.templateSettings;var I="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+L.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(M.escape||u,function(N,O){return"',_.escape("+q(O)+"),'"}).replace(M.interpolate||u,function(N,O){return"',"+q(O)+",'"}).replace(M.evaluate||u,function(N,O){return"');"+q(O).replace(/[\r\n\t]/g," ")+";__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');";var J=new Function("obj","_",I);if(K){return J(K,F)}return function(N){return J.call(this,N,F)}};F.chain=function(I){return F(I).chain()};var g=function(I){this._wrapped=I};F.prototype=g.prototype;var o=function(J,I){return I?F(J).chain():J};var s=function(I,J){g.prototype[I]=function(){var K=v.call(arguments);z.call(K,this._wrapped);return o(J.apply(F,K),this._chain)}};F.mixin(F);d(["pop","push","reverse","shift","sort","splice","unshift"],function(I){var J=j[I];g.prototype[I]=function(){var K=this._wrapped;J.apply(K,arguments);var L=K.length;if((I=="shift"||I=="splice")&&L===0){delete K[0]}return o(K,this._chain)}});d(["concat","join","slice"],function(I){var J=j[I];g.prototype[I]=function(){return o(J.apply(this._wrapped,arguments),this._chain)}});g.prototype.chain=function(){this._chain=true;return this};g.prototype.value=function(){return this._wrapped}}).call(this); (function(){var n=this;var l=n.Backbone;var m=Array.prototype.slice;var u=Array.prototype.splice;var b;if(typeof exports!=="undefined"){b=exports}else{b=n.Backbone={}}b.VERSION="0.9.0";var v=n._;if(!v&&(typeof require!=="undefined")){v=require("underscore")}var e=n.jQuery||n.Zepto||n.ender;b.noConflict=function(){n.Backbone=l;return this};b.emulateHTTP=false;b.emulateJSON=false;b.Events={on:function(z,C,y){var A;z=z.split(/\s+/);var x=this._callbacks||(this._callbacks={});while(A=z.shift()){var B=x[A]||(x[A]={});var w=B.tail||(B.tail=B.next={});w.callback=C;w.context=y;B.tail=w.next={}}return this},off:function(y,B,x){var A,w,z;if(!y){delete this._callbacks}else{if(w=this._callbacks){y=y.split(/\s+/);while(A=y.shift()){z=w[A];delete w[A];if(!B||!z){continue}while((z=z.next)&&z.next){if(z.callback===B&&(!x||z.context===x)){continue}this.on(A,z.callback,z.context)}}}}return this},trigger:function(z){var D,C,y,x,w,B,A;if(!(y=this._callbacks)){return this}B=y.all;(z=z.split(/\s+/)).push(null);while(D=z.shift()){if(B){z.push({next:B.next,tail:B.tail,event:D})}if(!(C=y[D])){continue}z.push({next:C.next,tail:C.tail})}A=m.call(arguments,1);while(C=z.pop()){x=C.tail;w=C.event?[C.event].concat(A):A;while((C=C.next)!==x){C.callback.apply(C.context||this,w)}}return this}};b.Events.bind=b.Events.on;b.Events.unbind=b.Events.off;b.Model=function(w,x){var y;w||(w={});if(x&&x.parse){w=this.parse(w)}if(y=c(this,"defaults")){w=v.extend({},y,w)}if(x&&x.collection){this.collection=x.collection}this.attributes={};this._escapedAttributes={};this.cid=v.uniqueId("c");this._changed={};if(!this.set(w,{silent:true})){throw new Error("Can't create an invalid model")}this._changed={};this._previousAttributes=v.clone(this.attributes);this.initialize.apply(this,arguments)};v.extend(b.Model.prototype,b.Events,{idAttribute:"id",initialize:function(){},toJSON:function(){return v.clone(this.attributes)},get:function(w){return this.attributes[w]},escape:function(w){var x;if(x=this._escapedAttributes[w]){return x}var y=this.attributes[w];return this._escapedAttributes[w]=v.escape(y==null?"":""+y)},has:function(w){return this.attributes[w]!=null},set:function(D,C,F){var E,B,z;if(v.isObject(D)||D==null){E=D;F=C}else{E={};E[D]=C}F||(F={});if(!E){return this}if(E instanceof b.Model){E=E.attributes}if(F.unset){for(var B in E){E[B]=void 0}}if(this.validate&&!this._performValidation(E,F)){return false}if(this.idAttribute in E){this.id=E[this.idAttribute]}var x=this.attributes;var w=this._escapedAttributes;var A=this._previousAttributes||{};var y=this._changing;this._changing=true;for(B in E){z=E[B];if(!v.isEqual(x[B],z)){delete w[B]}F.unset?delete x[B]:x[B]=z;delete this._changed[B];if(!v.isEqual(A[B],z)||(v.has(x,B)!=v.has(A,B))){this._changed[B]=z}}if(!y){if(!F.silent&&this.hasChanged()){this.change(F)}this._changing=false}return this},unset:function(w,x){(x||(x={})).unset=true;return this.set(w,null,x)},clear:function(w){(w||(w={})).unset=true;return this.set(v.clone(this.attributes),w)},fetch:function(x){x=x?v.clone(x):{};var w=this;var y=x.success;x.success=function(B,z,A){if(!w.set(w.parse(B,A),x)){return false}if(y){y(w,B)}};x.error=b.wrapError(x.error,w,x);return(this.sync||b.sync).call(this,"read",this,x)},save:function(z,A,y){var x;if(v.isObject(z)||z==null){x=z;y=A}else{x={};x[z]=A}y=y?v.clone(y):{};if(x&&!this[y.wait?"_performValidation":"set"](x,y)){return false}var w=this;var B=y.success;y.success=function(G,D,F){var E=w.parse(G,F);if(y.wait){E=v.extend(x||{},E)}if(!w.set(E,y)){return false}if(B){B(w,G)}else{w.trigger("sync",w,G,y)}};y.error=b.wrapError(y.error,w,y);var C=this.isNew()?"create":"update";return(this.sync||b.sync).call(this,C,this,y)},destroy:function(x){x=x?v.clone(x):{};var w=this;var A=x.success;var z=function(){w.trigger("destroy",w,w.collection,x)};if(this.isNew()){return z()}x.success=function(B){if(x.wait){z()}if(A){A(w,B)}else{w.trigger("sync",w,B,x)}};x.error=b.wrapError(x.error,w,x);var y=(this.sync||b.sync).call(this,"delete",this,x);if(!x.wait){z()}return y},url:function(){var w=c(this.collection,"url")||c(this,"urlRoot")||p();if(this.isNew()){return w}return w+(w.charAt(w.length-1)=="/"?"":"/")+encodeURIComponent(this.id)},parse:function(x,w){return x},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return this.id==null},change:function(x){for(var w in this._changed){this.trigger("change:"+w,this,this._changed[w],x)}this.trigger("change",this,x);this._previousAttributes=v.clone(this.attributes);this._changed={}},hasChanged:function(w){if(w){return v.has(this._changed,w)}return !v.isEmpty(this._changed)},changedAttributes:function(y){if(!y){return this.hasChanged()?v.clone(this._changed):false}var A,z=false,x=this._previousAttributes;for(var w in y){if(v.isEqual(x[w],(A=y[w]))){continue}(z||(z={}))[w]=A}return z},previous:function(w){if(!w||!this._previousAttributes){return null}return this._previousAttributes[w]},previousAttributes:function(){return v.clone(this._previousAttributes)},_performValidation:function(y,x){var z=v.extend({},this.attributes,y);var w=this.validate(z,x);if(w){if(x.error){x.error(this,w,x)}else{this.trigger("error",this,w,x)}return false}return true}});b.Collection=function(x,w){w||(w={});if(w.comparator){this.comparator=w.comparator}this._reset();this.initialize.apply(this,arguments);if(x){this.reset(x,{silent:true,parse:w.parse})}};v.extend(b.Collection.prototype,b.Events,{model:b.Model,initialize:function(){},toJSON:function(){return this.map(function(w){return w.toJSON()})},add:function(x,F){var B,D,z,C,E,y,A={},w={};F||(F={});x=v.isArray(x)?x.slice():[x];for(B=0,z=x.length;B<z;B++){if(!(C=x[B]=this._prepareModel(x[B],F))){throw new Error("Can't add an invalid model to a collection")}if(A[E=C.cid]||this._byCid[E]||(((y=C.id)!=null)&&(w[y]||this._byId[y]))){throw new Error("Can't add the same model to a collection twice")}A[E]=w[y]=C}for(B=0;B<z;B++){(C=x[B]).on("all",this._onModelEvent,this);this._byCid[C.cid]=C;if(C.id!=null){this._byId[C.id]=C}}this.length+=z;D=F.at!=null?F.at:this.models.length;u.apply(this.models,[D,0].concat(x));if(this.comparator){this.sort({silent:true})}if(F.silent){return this}for(B=0,z=this.models.length;B<z;B++){if(!A[(C=this.models[B]).cid]){continue}F.index=B;C.trigger("add",C,this,F)}return this},remove:function(B,z){var A,w,y,x;z||(z={});B=v.isArray(B)?B.slice():[B];for(A=0,w=B.length;A<w;A++){x=this.getByCid(B[A])||this.get(B[A]);if(!x){continue}delete this._byId[x.id];delete this._byCid[x.cid];y=this.indexOf(x);this.models.splice(y,1);this.length--;if(!z.silent){z.index=y;x.trigger("remove",x,this,z)}this._removeReference(x)}return this},get:function(w){if(w==null){return null}return this._byId[w.id!=null?w.id:w]},getByCid:function(w){return w&&this._byCid[w.cid||w]},at:function(w){return this.models[w]},sort:function(x){x||(x={});if(!this.comparator){throw new Error("Cannot sort a set without a comparator")}var w=v.bind(this.comparator,this);if(this.comparator.length==1){this.models=this.sortBy(w)}else{this.models.sort(w)}if(!x.silent){this.trigger("reset",this,x)}return this},pluck:function(w){return v.map(this.models,function(x){return x.get(w)})},reset:function(z,x){z||(z=[]);x||(x={});for(var y=0,w=this.models.length;y<w;y++){this._removeReference(this.models[y])}this._reset();this.add(z,{silent:true,parse:x.parse});if(!x.silent){this.trigger("reset",this,x)}return this},fetch:function(w){w=w?v.clone(w):{};if(w.parse===undefined){w.parse=true}var y=this;var x=w.success;w.success=function(B,z,A){y[w.add?"add":"reset"](y.parse(B,A),w);if(x){x(y,B)}};w.error=b.wrapError(w.error,y,w);return(this.sync||b.sync).call(this,"read",this,w)},create:function(x,w){var y=this;w=w?v.clone(w):{};x=this._prepareModel(x,w);if(!x){return false}if(!w.wait){y.add(x,w)}var z=w.success;w.success=function(A,C,B){if(w.wait){y.add(A,w)}if(z){z(A,C)}else{A.trigger("sync",x,C,w)}};x.save(null,w);return x},parse:function(x,w){return x},chain:function(){return v(this.models).chain()},_reset:function(w){this.length=0;this.models=[];this._byId={};this._byCid={}},_prepareModel:function(y,x){if(!(y instanceof b.Model)){var w=y;x.collection=this;y=new this.model(w,x);if(y.validate&&!y._performValidation(y.attributes,x)){y=false}}else{if(!y.collection){y.collection=this}}return y},_removeReference:function(w){if(this==w.collection){delete w.collection}w.off("all",this._onModelEvent,this)},_onModelEvent:function(y,x,z,w){if((y=="add"||y=="remove")&&z!=this){return}if(y=="destroy"){this.remove(x,w)}if(x&&y==="change:"+x.idAttribute){delete this._byId[x.previous(x.idAttribute)];this._byId[x.id]=x}this.trigger.apply(this,arguments)}});var s=["forEach","each","map","reduce","reduceRight","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","sortBy","sortedIndex","toArray","size","first","initial","rest","last","without","indexOf","shuffle","lastIndexOf","isEmpty","groupBy"];v.each(s,function(w){b.Collection.prototype[w]=function(){return v[w].apply(v,[this.models].concat(v.toArray(arguments)))}});b.Router=function(w){w||(w={});if(w.routes){this.routes=w.routes}this._bindRoutes();this.initialize.apply(this,arguments)};var g=/:\w+/g;var t=/\*\w+/g;var d=/[-[\]{}()+?.,\\^$|#\s]/g;v.extend(b.Router.prototype,b.Events,{initialize:function(){},route:function(w,x,y){b.history||(b.history=new b.History);if(!v.isRegExp(w)){w=this._routeToRegExp(w)}if(!y){y=this[x]}b.history.route(w,v.bind(function(A){var z=this._extractParameters(w,A);y&&y.apply(this,z);this.trigger.apply(this,["route:"+x].concat(z));b.history.trigger("route",this,x,z)},this));return this},navigate:function(x,w){b.history.navigate(x,w)},_bindRoutes:function(){if(!this.routes){return}var x=[];for(var y in this.routes){x.unshift([y,this.routes[y]])}for(var z=0,w=x.length;z<w;z++){this.route(x[z][0],x[z][1],this[x[z][1]])}},_routeToRegExp:function(w){w=w.replace(d,"\\$&").replace(g,"([^/]+)").replace(t,"(.*?)");return new RegExp("^"+w+"$")},_extractParameters:function(w,x){return w.exec(x).slice(1)}});b.History=function(){this.handlers=[];v.bindAll(this,"checkUrl")};var k=/^[#\/]/;var h=/msie [\w.]+/;var j=false;v.extend(b.History.prototype,b.Events,{interval:50,getFragment:function(x,w){if(x==null){if(this._hasPushState||w){x=window.location.pathname;var y=window.location.search;if(y){x+=y}}else{x=window.location.hash}}x=decodeURIComponent(x.replace(k,""));if(!x.indexOf(this.options.root)){x=x.substr(this.options.root.length)}return x},start:function(y){if(j){throw new Error("Backbone.history has already been started")}this.options=v.extend({},{root:"/"},this.options,y);this._wantsHashChange=this.options.hashChange!==false;this._wantsPushState=!!this.options.pushState;this._hasPushState=!!(this.options.pushState&&window.history&&window.history.pushState);var x=this.getFragment();var w=document.documentMode;var A=(h.exec(navigator.userAgent.toLowerCase())&&(!w||w<=7));if(A){this.iframe=e('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow;this.navigate(x)}if(this._hasPushState){e(window).bind("popstate",this.checkUrl)}else{if(this._wantsHashChange&&("onhashchange" in window)&&!A){e(window).bind("hashchange",this.checkUrl)}else{if(this._wantsHashChange){this._checkUrlInterval=setInterval(this.checkUrl,this.interval)}}}this.fragment=x;j=true;var B=window.location;var z=B.pathname==this.options.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!z){this.fragment=this.getFragment(null,true);window.location.replace(this.options.root+"#"+this.fragment);return true}else{if(this._wantsPushState&&this._hasPushState&&z&&B.hash){this.fragment=B.hash.replace(k,"");window.history.replaceState({},document.title,B.protocol+"//"+B.host+this.options.root+this.fragment)}}if(!this.options.silent){return this.loadUrl()}},stop:function(){e(window).unbind("popstate",this.checkUrl).unbind("hashchange",this.checkUrl);clearInterval(this._checkUrlInterval);j=false},route:function(w,x){this.handlers.unshift({route:w,callback:x})},checkUrl:function(x){var w=this.getFragment();if(w==this.fragment&&this.iframe){w=this.getFragment(this.iframe.location.hash)}if(w==this.fragment||w==decodeURIComponent(this.fragment)){return false}if(this.iframe){this.navigate(w)}this.loadUrl()||this.loadUrl(window.location.hash)},loadUrl:function(y){var x=this.fragment=this.getFragment(y);var w=v.any(this.handlers,function(z){if(z.route.test(x)){z.callback(x);return true}});return w},navigate:function(x,w){if(!j){return false}if(!w||w===true){w={trigger:w}}var y=(x||"").replace(k,"");if(this.fragment==y||this.fragment==decodeURIComponent(y)){return}if(this._hasPushState){if(y.indexOf(this.options.root)!=0){y=this.options.root+y}this.fragment=y;window.history[w.replace?"replaceState":"pushState"]({},document.title,y)}else{if(this._wantsHashChange){this.fragment=y;this._updateHash(window.location,y,w.replace);if(this.iframe&&(y!=this.getFragment(this.iframe.location.hash))){if(!w.replace){this.iframe.document.open().close()}this._updateHash(this.iframe.location,y,w.replace)}}else{window.location.assign(this.options.root+x)}}if(w.trigger){this.loadUrl(x)}},_updateHash:function(w,x,y){if(y){w.replace(w.toString().replace(/(javascript:|#).*$/,"")+"#"+x)}else{w.hash=x}}});b.View=function(w){this.cid=v.uniqueId("view");this._configure(w||{});this._ensureElement();this.initialize.apply(this,arguments);this.delegateEvents()};var a=/^(\S+)\s*(.*)$/;var q=["model","collection","el","id","attributes","className","tagName"];v.extend(b.View.prototype,b.Events,{tagName:"div",$:function(w){return this.$el.find(w)},initialize:function(){},render:function(){return this},remove:function(){this.$el.remove();return this},make:function(x,w,z){var y=document.createElement(x);if(w){e(y).attr(w)}if(z){e(y).html(z)}return y},setElement:function(w,x){this.$el=e(w);this.el=this.$el[0];if(x!==false){this.delegateEvents()}},delegateEvents:function(A){if(!(A||(A=c(this,"events")))){return}this.undelegateEvents();for(var z in A){var B=A[z];if(!v.isFunction(B)){B=this[A[z]]}if(!B){throw new Error('Event "'+A[z]+'" does not exist')}var y=z.match(a);var x=y[1],w=y[2];B=v.bind(B,this);x+=".delegateEvents"+this.cid;if(w===""){this.$el.bind(x,B)}else{this.$el.delegate(w,x,B)}}},undelegateEvents:function(){this.$el.unbind(".delegateEvents"+this.cid)},_configure:function(y){if(this.options){y=v.extend({},this.options,y)}for(var z=0,x=q.length;z<x;z++){var w=q[z];if(y[w]){this[w]=y[w]}}this.options=y},_ensureElement:function(){if(!this.el){var w=c(this,"attributes")||{};if(this.id){w.id=this.id}if(this.className){w["class"]=this.className}this.setElement(this.make(this.tagName,w),false)}else{this.setElement(this.el,false)}}});var r=function(w,x){var y=i(this,w,x);y.extend=this.extend;return y};b.Model.extend=b.Collection.extend=b.Router.extend=b.View.extend=r;var o={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};b.sync=function(A,x,w){var y=o[A];var z={type:y,dataType:"json"};if(!w.url){z.url=c(x,"url")||p()}if(!w.data&&x&&(A=="create"||A=="update")){z.contentType="application/json";z.data=JSON.stringify(x.toJSON())}if(b.emulateJSON){z.contentType="application/x-www-form-urlencoded";z.data=z.data?{model:z.data}:{}}if(b.emulateHTTP){if(y==="PUT"||y==="DELETE"){if(b.emulateJSON){z.data._method=y}z.type="POST";z.beforeSend=function(B){B.setRequestHeader("X-HTTP-Method-Override",y)}}}if(z.type!=="GET"&&!b.emulateJSON){z.processData=false}return e.ajax(v.extend(z,w))};b.wrapError=function(x,y,w){return function(z,A){var A=z===y?A:z;if(x){x(z,A,w)}else{y.trigger("error",z,A,w)}}};var f=function(){};var i=function(x,w,y){var z;if(w&&w.hasOwnProperty("constructor")){z=w.constructor}else{z=function(){x.apply(this,arguments)}}v.extend(z,x);f.prototype=x.prototype;z.prototype=new f();if(w){v.extend(z.prototype,w)}if(y){v.extend(z,y)}z.prototype.constructor=z;z.__super__=x.prototype;return z};var c=function(w,x){if(!(w&&w[x])){return null}return v.isFunction(w[x])?w[x]():w[x]};var p=function(){throw new Error('A "url" property or function must be specified')}}).call(this); Backbone.Model.prototype.toJSON=function(a){var b=_.clone(this.attributes);a&&_.each(b,function(e,c){e&&_.isFunction(e.toJSON)&&(b[c]=e.toJSON());if(_.isArray(e)){var d=[];_.each(e,function(g,f){_.isFunction(g.toJSON)&&(g=g.toJSON());d[f]=g});b[c]=d}});return b}; var dateFormat=function(){var a=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZ]|"[^"]*"|'[^']*'/g,b=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,d=/[^-+\dA-Z]/g,c=function(f,e){f=String(f);e=e||2;while(f.length<e){f="0"+f}return f};return function(i,v,q){var g=dateFormat;if(arguments.length==1&&Object.prototype.toString.call(i)=="[object String]"&&!/\d/.test(i)){v=i;i=undefined}i=i?new Date(i):new Date;if(isNaN(i)){throw SyntaxError("invalid date")}v=String(g.masks[v]||v||g.masks["default"]);if(v.slice(0,4)=="UTC:"){v=v.slice(4);q=true}var t=q?"getUTC":"get",l=i[t+"Date"](),e=i[t+"Day"](),j=i[t+"Month"](),p=i[t+"FullYear"](),r=i[t+"Hours"](),k=i[t+"Minutes"](),u=i[t+"Seconds"](),n=i[t+"Milliseconds"](),f=q?0:i.getTimezoneOffset(),h={d:l,dd:c(l),ddd:g.i18n.dayNames[e],dddd:g.i18n.dayNames[e+7],m:j+1,mm:c(j+1),mmm:g.i18n.monthNames[j],mmmm:g.i18n.monthNames[j+12],yy:String(p).slice(2),yyyy:p,h:r%12||12,hh:c(r%12||12),H:r,HH:c(r),M:k,MM:c(k),s:u,ss:c(u),l:c(n,3),L:c(n>99?Math.round(n/10):n),t:r<12?"a":"p",tt:r<12?"am":"pm",T:r<12?"A":"P",TT:r<12?"AM":"PM",Z:q?"UTC":(String(i).match(b)||[""]).pop().replace(d,""),o:(f>0?"-":"+")+c(Math.floor(Math.abs(f)/60)*100+Math.abs(f)%60,4),S:["th","st","nd","rd"][l%10>3?0:(l%100-l%10!=10)*l%10]};return v.replace(a,function(m){return m in h?h[m]:m.slice(1,m.length-1)})}}();dateFormat.masks={"default":"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:ss",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'"};dateFormat.i18n={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"]};Date.prototype.format=function(a,b){return dateFormat(this,a,b)}; String.prototype.endsWith=function(a){return(this.match(a+"$")==a)};String.prototype.startsWith=function(a){return(this.match("^"+a)==a)}; Utils=window.Utils||{};Utils.Colors={hexToColor:function(d){if(!d){return null}if(d.substring(0,1)=="#"){d=d.substring(1)}var b=null;if(d.length===6||d.length===8){var e=(d.length===8);var a=(e)?2:0;b={r:Utils.Numbers.hexToDecimal(d.substring(a,a+2)),g:Utils.Numbers.hexToDecimal(d.substring(a+2,a+4)),b:Utils.Numbers.hexToDecimal(d.substring(a+4,a+6))};if(e){var c=Utils.Numbers.hexToDecimal(d.substring(0,2));b.a=Utils.Numbers.minMax(c/255,0,1);b.a=b.a.toFixed(2)}}return b},colorToHex:function(b,g){var f=Utils.Numbers.decimalToHex(b.r);var d=Utils.Numbers.decimalToHex(b.g);var a=Utils.Numbers.decimalToHex(b.b);var e="";if(b.a&&g){var c=parseInt(Utils.Numbers.minMax(b.a*255,0,255));e=Utils.Numbers.decimalToHex(c);Utils.String.addLeadingZeros(e,2)}f=Utils.String.addLeadingZeros(f,2);d=Utils.String.addLeadingZeros(d,2);a=Utils.String.addLeadingZeros(a,2);var b=e+f+d+a;return b},modifyColor:function(b,c){c=1+c;var a={r:parseInt(Utils.Numbers.minMax(b.r*c,0,255)),g:parseInt(Utils.Numbers.minMax(b.g*c,0,255)),b:parseInt(Utils.Numbers.minMax(b.b*c,0,255)),a:b.a};return a}}; Utils=window.Utils||{};Utils.Helpers=(function(){var a={};a.generateGUID=function(){var c=function(){return(((1+Math.random())*65536)|0).toString(16).substring(1)};var b=c()+c()+"-"+c()+"-"+c()+"-"+c()+"-"+c()+c()+c();return b};a.isValidEmail=function(b){var c=new RegExp(/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/);return c.test(b)};a.funcWrapper=function(b){if(typeof(b)!=="function"){b=function(){}}return b};a.compareVersions=function(g,e){if(!g&&!e){return 0}if(!g){return 1}if(!e){return -1}var c=g.split(".");var b=e.split(".");var j=Math.max(c.length,c.length);for(var d=0;d<j;d++){var h=parseInt(c[d]||0,10);var f=parseInt(b[d]||0,10);if(h>f){return -1}else{if(h<f){return 1}}}return 0};a.isPlainObject=function(d){var b=Object.prototype.hasOwnProperty;if(!d||typeof d!=="object"||d.nodeType){return false}if(d.constructor&&!b.call(d,"constructor")&&!b.call(d.constructor.prototype,"isPrototypeOf")){return false}var c;for(c in d){}return c===undefined||b.call(d,c)};a.deepClone=function(){var l,d,b,c,h,j,g=arguments[0]||{},f=1,e=arguments.length,k=false;if(typeof g==="boolean"){k=g;g=arguments[1]||{};f=2}if(typeof g!=="object"&&!_.isFunction(g)){g={}}if(e===f){g=this;--f}for(;f<e;f++){if((l=arguments[f])!==null){for(d in l){b=g[d];c=l[d];if(g===c){continue}if(k&&c&&(Utils.Helpers.isPlainObject(c)||(h=_.isArray(c)))){if(h){h=false;j=b&&_.isArray(b)?b:[]}else{j=b&&Utils.Helpers.isPlainObject(b)?b:{}}g[d]=Utils.Helpers.deepClone(k,j,c)}else{if(c!==undefined){g[d]=c}}}}}return g};a.cbWrapper=function(b){if(typeof(b)==="function"){b()}};a.inverseDict=function(d){var c={};for(var b in d){if(d.hasOwnProperty(b)){c[d[b]]=b}}return c};a.getPath=function(d,g){if(typeof(g)!=="string"||typeof(d)!=="object"){return null}var f=g.split("."),b=f.length,c=d;for(var e=0;e<b;e++){c=c[f[e]];if(typeof(c)==="undefined"||c===null){return null}}return c};a.getStoreName=function(){if(DEVICE&deviceTypeEnum.android){var b=Utils.Helpers.inverseDict(deviceVariantEnum)[DEVICE_VARIANT];return{"default":storesEnum.googlePlay,amazon:storesEnum.amazon}[b]}if(DEVICE&deviceTypeEnum.iphone){return storesEnum.appStore}};a.getStoreLink=function(){if(typeof(STORE_LINKS)==="undefined"||!STORE_LINKS){return null}var b=a.getStoreName();if(!b){return null}return STORE_LINKS[b]};return a}()); Utils=window.Utils||{};Utils.Numbers={decimalToHex:function(a){return a.toString(16)},hexToDecimal:function(a){return parseInt(a,16)},minMax:function(c,b,a){if(c<b){c=b}if(c>a){c=a}return c},formatNumber:function(c,a){if(typeof(c)==="undefined"||c===null){return}c+="";x=c.split(".");x1=x[0];x2=x.length>1?a.decimalSymbol+x[1]:"";var b=/(\d+)(\d{3})/;while(b.test(x1)){x1=x1.replace(b,"$1"+a.digitGroupingSymbol+"$2")}return x1+x2}}; Utils=window.Utils||{};Utils.String={translateIfNeed:function(a){if(a&&a.substring(0,2)=="{$"&&a.substring(a.length-1)=="}"){return _T(a.substring(2,a.length-1))}else{return a}},addLeadingZeros:function(c,d){var e=c.toString();var a=e.length;for(var b=a;b<d;b++){e="0"+e}return e},trailString:function(f,e,c){f=f||"";if(f.length>e){f=f.substring(0,e-4);if(c&&c.charStop){for(var d=0;d<c.charStop.length;d++){var g=c.charStop[d].charStop;var b=c.charStop[d].threshold;var a=f.lastIndexOf(g);if(a>(e-b)){f=f.substring(0,a);break}}}f=f+"..."}return f},desanitize:function(a){a=a.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#39;/g,"'");a=a.replace(/&amp;/g,"&").replace(/&nbsp;/g," ");return a},sanitizeText:function(a,f,h){var c,m,b,k,n,l,d,j,g,e;if(!a||typeof(a)!="string"){return""}d=function(){k=a.charAt(c);c+=1};j=function(){n=n.join("");if(f){n=n.replace(/(^ )|( $)/g,"&nbsp;")}l.push(n);n=[]};g=function(){if(b<" "||b>"~"){n.push("&#"+b.charCodeAt(0)+";")}else{n.push(b)}};h=(h>=0)?Math.floor(h):4;l=[];n=[];c=0;d();while(c<=a.length){b=k;d();switch(b){case"<":n.push("&lt;");break;case">":n.push("&gt;");break;case"&":n.push("&amp;");break;case'"':n.push("&quot;");break;case"'":n.push("&#39;");break;default:if(f){switch(b){case"\r":if(k==="\n"){d()}j();break;case"\n":j();break;case"\t":e=h-(n.length%h);for(m=0;m<e;m+=1){n.push(" ")}break;default:g()}}else{g()}}}j();l=l.join("<br />");if(f){l=l.replace(/ {2}/g," &nbsp;")}return l},breakLongText:function(g,e){var d="";var c;var a=g.length;var b=0;var f=30;if(e){f=e}for(c=0;c<a;c++){if(g[c]===" "){b=0}else{if(++b>f){d+=" ";b=0}}d+=g[c]}return d},removeHTMLTags:function(a){var b="";if(a){b=a.replace(/(<([^>]+)>)/ig,"")}return b},normalizeWhiteSpace:function(a){var b="";if(a){b=a.replace(/^\s*|\s(?=\s)|\s*$/g," ")}return b},removeHTMLAndWhitespace:function(a){a=this.removeHTMLTags(a);a=this.normalizeWhiteSpace(a);return a},stripTags:function(a){if(!a||a===""){return""}a=a.replace(/<br>/g,"\n");a=a.replace(/<br\/>/g,"\n");a=Utils.String.removeHTMLTags(a);var b=a.substring(0,1);while(b==="\n"||b==="\t"||b===" "){a=a.substring(1,a.length);b=a.substring(0,1)}return a},trim:function(a){if(!a){return""}return a.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}}; Utils=window.Utils||{};Utils.TimeDate={timeAsText:function(f){if(f===null||f===""||f<=0){return""}var h=new Date();var b=parseInt(h.getTime()/1000);var g=(b-f);var a="";if(g<=0){if(g>=-120){a=_T("SSecondsAgo")}else{return""}}else{if(g<60){if(g<2){a=_T("SSecondAgo")}else{a=_T("SNumberSecondsAgo",{number:g})}}else{if(g<3600){var c=parseInt(g/60);if(c<2){a=_T("SMinuteAgo")}else{a=_T("SNumberMinutesAgo",{number:c})}}else{if(g<3600*24){var j=parseInt(g/3600);if(j<2){a=_T("SHourAgo")}else{a=_T("SNumberHoursAgo",{number:j})}}else{if(g<3600*24*7){var i=parseInt(g/(3600*24));if(i<2){a=_T("SDayAgo")}else{a=_T("SNumberDaysAgo",{number:i})}}else{if(g<(3600*24*7*4.2)){var e=parseInt(g/(3600*24*7));if(e<2){a=_T("SWeekAgo")}else{a=_T("SNumberWeeksAgo",{number:e})}}else{if(g<(3600*24*7*52)){var k=parseInt(g/(3600*24*7*4.2));if(k<2){a=_T("SMonthAgo")}else{a=_T("SNumberMonthsAgo",{number:k})}}else{var d=parseInt(g/(3600*24*7*52));if(d<2){a=_T("SYearAgo")}else{a=_T("SNumberYearsAgo",{number:d})}}}}}}}}return a},durationDisplayTime:function(d){var a=parseInt(d/3600);var b=parseInt((d/60)%60);d=parseInt(d%60);if(d<10){d="0"+d}if(a>0){if(b<10){b="0"+b}var c=a+":"+b+":"+d}else{var c=b+":"+d}return c},daysInMonth:function(b,a){return 32-new Date(a,b,32).getDate()},toLocalTime:function(a){return a-((new Date(a)).getTimezoneOffset()*60*1000)},toUTCTime:function(a){a*=1000;return a+((new Date(a)).getTimezoneOffset()*60*1000)},secondsToTime:function(c){var b=Math.floor(c/60);var a=Math.floor(b/60);b=b%60;return Utils.String.addLeadingZeros(a,2)+":"+Utils.String.addLeadingZeros(b,2)},timeToSeconds:function(d){var a=d.split(":");if(a.length<2){return 0}var c=parseInt(a[1]);var b=parseInt(a[0]);return(b*60+c)*60}}; Utils=window.Utils||{};Utils.Url={_getObject:function(e){var g={};var c=e.indexOf("?");if(c>=0){e=e.substring(c+1)}var f=e.split("&");for(var d=0;d<f.length;d++){var b=f[d].indexOf("=");var a=f[d].substring(0,b);var h=f[d].substring(b+1);g[decodeURIComponent(a)]=decodeURIComponent(h)}return g},getQueryObject:function(a){var b=window.location.search.substring(1);if(a){b=a}return this._getObject(b)},getHashObject:function(a){var b=window.location.hash.substring(1);if(a){b=a}return this._getObject(b)},getHashValue:function(b,a){return this.getHashObject(a)[b]},clearHash:function(){window.location.hash=""},getQueryValue:function(b,a){return this.getQueryObject(a)[b]},addQueryParamToUrl:function(b,c,d){if(b){var a="?";if(b.indexOf("?")>0){a="&"}var e=encodeURIComponent(c)+"="+encodeURIComponent(d);b+=a+e}return b}}; var _childItem={Super:function(){var c;if(this.Super.caller.constructor===this.Super.caller){c=this.Super.caller.prototype}c=c||this.Super.caller.__base;if(!c){return}var d=this.Super.caller.__baseMethod;if(!d){if(this.Super.caller.constructor===this.Super.caller){d=this.Super.caller.__baseMethod=this.__base}else{var b=this.Super.caller.__methodName;if(!b){for(var a in this){if(this[a]==this.Super.caller){b=a;break}}}if(b!=null&&typeof c[b]=="function"){d=this.Super.caller.__baseMethod=c[b];d.__methodName=b}}}if(d){return d.apply(this,arguments)}}};Function.prototype.extend=function(){var k=this;var h=[new k()];for(var g=0;g<arguments.length;g++){h.push(arguments[g])}h.push(_childItem);var f=h[0];var c,d,a,e=h.length;for(var g=0;g<e;g++){a=h[g];for(d in a){c=a[d];if(f===c){continue}else{if(c!==undefined){f[d]=c}}}}for(var j in f){if(typeof f[j]==="function"&&!f[j].__base){f[j].__base=k.prototype}}this.prototype.__base=k;return f};Function.prototype.hitch=function(a){var b=this;return !a?b:function(){return b.apply(a,arguments||[])}}; function string_to_array(d){var a=d.length;var c=new Array(a);for(var b=0;b<a;b++){c[b]=d.charCodeAt(b)}return c}function array_to_hex_string(c){var b="";for(var a=0;a<c.length;a++){b+=SHA256_hexchars[c[a]>>4]+SHA256_hexchars[c[a]&15]}return b}function SHA256_init(){SHA256_H=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225);SHA256_buf=new Array();SHA256_len=0}function SHA256_write(b){if(typeof(b)=="string"){SHA256_buf=SHA256_buf.concat(string_to_array(b))}else{SHA256_buf=SHA256_buf.concat(b)}for(var a=0;a+64<=SHA256_buf.length;a+=64){SHA256_Hash_Byte_Block(SHA256_H,SHA256_buf.slice(a,a+64))}SHA256_buf=SHA256_buf.slice(a);SHA256_len+=b.length}function SHA256_finalize(){SHA256_buf[SHA256_buf.length]=128;if(SHA256_buf.length>64-8){for(var b=SHA256_buf.length;b<64;b++){SHA256_buf[b]=0}SHA256_Hash_Byte_Block(SHA256_H,SHA256_buf);SHA256_buf.length=0}for(var b=SHA256_buf.length;b<64-5;b++){SHA256_buf[b]=0}SHA256_buf[59]=(SHA256_len>>>29)&255;SHA256_buf[60]=(SHA256_len>>>21)&255;SHA256_buf[61]=(SHA256_len>>>13)&255;SHA256_buf[62]=(SHA256_len>>>5)&255;SHA256_buf[63]=(SHA256_len<<3)&255;SHA256_Hash_Byte_Block(SHA256_H,SHA256_buf);var a=new Array(32);for(var b=0;b<8;b++){a[4*b+0]=SHA256_H[b]>>>24;a[4*b+1]=(SHA256_H[b]>>16)&255;a[4*b+2]=(SHA256_H[b]>>8)&255;a[4*b+3]=SHA256_H[b]&255}delete SHA256_H;delete SHA256_buf;delete SHA256_len;return a}function SHA256_hash(b){var a;SHA256_init();SHA256_write(b);a=SHA256_finalize();return array_to_hex_string(a)}function HMAC_SHA256_init(b){if(typeof(b)=="string"){HMAC_SHA256_key=string_to_array(b)}else{HMAC_SHA256_key=new Array().concat(b)}if(HMAC_SHA256_key.length>64){SHA256_init();SHA256_write(HMAC_SHA256_key);HMAC_SHA256_key=SHA256_finalize()}for(var a=HMAC_SHA256_key.length;a<64;a++){HMAC_SHA256_key[a]=0}for(var a=0;a<64;a++){HMAC_SHA256_key[a]^=54}SHA256_init();SHA256_write(HMAC_SHA256_key)}function HMAC_SHA256_write(a){SHA256_write(a)}function HMAC_SHA256_finalize(){var b=SHA256_finalize();for(var a=0;a<64;a++){HMAC_SHA256_key[a]^=54^92}SHA256_init();SHA256_write(HMAC_SHA256_key);SHA256_write(b);for(var a=0;a<64;a++){HMAC_SHA256_key[a]=0}delete HMAC_SHA256_key;return SHA256_finalize()}function HMAC_SHA256_MAC(b,c){var a;HMAC_SHA256_init(b);HMAC_SHA256_write(c);a=HMAC_SHA256_finalize();return array_to_hex_string(a)}SHA256_hexchars=new Array("0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f");SHA256_K=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298);function SHA256_sigma0(a){return((a>>>7)|(a<<25))^((a>>>18)|(a<<14))^(a>>>3)}function SHA256_sigma1(a){return((a>>>17)|(a<<15))^((a>>>19)|(a<<13))^(a>>>10)}function SHA256_Sigma0(a){return((a>>>2)|(a<<30))^((a>>>13)|(a<<19))^((a>>>22)|(a<<10))}function SHA256_Sigma1(a){return((a>>>6)|(a<<26))^((a>>>11)|(a<<21))^((a>>>25)|(a<<7))}function SHA256_Ch(a,c,b){return b^(a&(c^b))}function SHA256_Maj(a,c,b){return(a&c)^(b&(a^c))}function SHA256_Hash_Word_Block(c,a){for(var b=16;b<64;b++){a[b]=(SHA256_sigma1(a[b-2])+a[b-7]+SHA256_sigma0(a[b-15])+a[b-16])&4294967295}var e=new Array().concat(c);for(var b=0;b<64;b++){var f=e[7]+SHA256_Sigma1(e[4])+SHA256_Ch(e[4],e[5],e[6])+SHA256_K[b]+a[b];var d=SHA256_Sigma0(e[0])+SHA256_Maj(e[0],e[1],e[2]);e.pop();e.unshift((f+d)&4294967295);e[4]=(e[4]+f)&4294967295}for(var b=0;b<8;b++){c[b]=(c[b]+e[b])&4294967295}}function SHA256_Hash_Byte_Block(d,b){var a=new Array(16);for(var c=0;c<16;c++){a[c]=b[4*c+0]<<24|b[4*c+1]<<16|b[4*c+2]<<8|b[4*c+3]}SHA256_Hash_Word_Block(d,a)}; Utils=window.Utils||{};Utils.ShareInfo={getFaceBookShareOptions:function(c){var b=c.imageUrl||"";if(b.indexOf("facebook.com/")>0||b.indexOf("fbcdn.")>0){b=""}var a={method:"feed",caption:c.title,description:Utils.String.stripTags(c.fbDesc||c.shortDesc),link:c.url,picture:b};return a},getEMailBody:function(e){var h=AppManager.app().get("appLink");var f=Utils.String.stripTags(e.emailDesc||e.shortDesc||"");var d=AppSettingsManager.getSettings();var a=d.get("brand");var g=a.link;var i=a.name;if(PLATFORM===platformEnum.nativeApp&&DEVICE===deviceTypeEnum.iphone){f=f.replace(/\n/g,"<br/>");if(e.imageUrl){f+='<br/><img src="'+e.imageUrl+'">'}if(e.url){f+='<br/><br/><a href="'+e.url+'">'+_T("SShareEmailLink")+"</a>"}var b="";var c="";if(h){c='<a href="'+h+'">'+_T("SShareMobileApp")+"</a>";b="<br/><br/>"+_T("SShareMailApplinkHtml",{htmlLink:c})}f+=b;if(i){if(g){c='<a href="'+g+'">'+i+"</a>"}else{c=i}f+="<br/><br/>"+_T("SShareMailPowerByBrand",{brand:c})}}else{var b="";if(h){b+="\n\n"+_T("SShareMailApplinkSimple",{appLink:h})}if(e.url){f+="\n\n"+e.url}f+=b;if(i){f+="\n\n"+_T("SShareMailPowerByBrand",{brand:i});if(g){f+=": "+g}}}f=encodeURIComponent(f);return f},shareAppInfo:function(){var b={};if(typeof(AppManager.app().get("appLink"))!="undefined"){b.url=AppManager.app().get("appLink")}var a=AppManager.app().get("appLabel");b.title=_T("SShareAppMailSubject");b.shortDesc=_T("SShareAppMailBody",{appName:a});b.twitterTitle=_T("SShareApp",{appName:a});return b}}; window.DeviceToken=(function(){var a={};a.getDeviceToken=function(){var b=0;if(window.LAYOUT===layoutFormat.wide){b=b|(1<<7)}if(window.PLATFORM===platformEnum.gadget){b=b|(1<<8)}else{b=b|window.DEVICE;if(window.PLATFORM===platformEnum.webApp){b=b|(1<<6)}}return b};a.parseDeviceToken=function(b){var e={layout:window.LAYOUT,device:deviceTypeEnum.unknown,platform:window.PLATFORM},c=null;for(c in deviceTypeEnum){if(!deviceTypeEnum.hasOwnProperty(c)){continue}var d=deviceTypeEnum[c];if(b&d){e.device=d;break}}if(b&(1<<6)){e.platform=platformEnum.webApp}if(b&(1<<8)){e.platform=platformEnum.gadget}if(b&(1<<7)){e.layout=layoutFormat.wide}else{e.layout=layoutFormat.narrow}return e};a.setupEnvironment=function(){if(window.DEVICE_TOKEN){var b=a.parseDeviceToken(window.DEVICE_TOKEN);window.DEVICE=b.device;window.PLATFORM=b.platform;window.LAYOUT=b.layout}if(typeof(window.PLATFORM)!=="undefined"&&typeof(window.DEVICE!=="undefined")){if(window.PLATFORM===platformEnum.nativeApp&&window.DEVICE===deviceTypeEnum.iphone){if(window.navigator.userAgent.indexOf("iPad")>0){window.LAYOUT=layoutFormat.wide}}}};a.setupEnvironment();return a}()); window.DeviceInfo=(function(){var b={};function a(){var d=null,c=null;var e=navigator.userAgent;if(e){if(DEVICE===deviceTypeEnum.iphone){c=e.match(/iPhone OS (\d)/);if(c&&c.length===2){d=parseInt(c[1],10)+""}else{c=e.match(/OS (\d)/);if(c&&c.length===2){d=parseInt(c[1],10)+""}}}else{if(DEVICE===deviceTypeEnum.android){c=e.match(/\bAndroid (\d+(?:\.\d+){1,2});/);if(c&&c.length===2){d=c[1]}}}}return d}b.init=function(){b.osVersion=a()};return b}()); var DeviceSupport=(function(){var d={};function c(){c=true;if(DEVICE===deviceTypeEnum.android&&PLATFORM!==platformEnum.simulator){var g=DeviceInfo.osVersion;c=false}return c}function b(){return !!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect}function e(){if(DEVICE===deviceTypeEnum.android){if(PLATFORM===platformEnum.nativeapp){return true}if(PLATFORM===platformEnum.webApp){var g=DeviceInfo.osVersion;if(Utils.Helpers.compareVersions("2.3.6",g)>=0){return true}}}return false}function f(){return((DEVICE!==deviceTypeEnum.android)&&jQuery.browser.webkit)}function a(){return(!!jQuery.browser.webkit)}d.init=function(){d.isTransitionSupported=c();d.isPositionFixed=e();d.isMaskSupported=f();d.isSimpleMaskSupported=a();d.isSvgSupported=b()};return d}()); /*
 * jQuery Mobile v@VERSION
 * http://jquerymobile.com/
 *
 * Copyright 2010, jQuery Project
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 */
$.mobile=$.mobile||{};(function(b,a,c){b.extend(b.mobile,{activePageClass:"ui-page-active",defaultPageTransition:"slide"})})(jQuery,this); (function(b,d){var c=b(window),a=b("html");b.mobile.media=(function(){var e={},f=b("<div id='jquery-mediatest'>"),g=b("<body>").append(f);return function(j){if(!(j in e)){var h=document.createElement("style"),i="@media "+j+" { #jquery-mediatest { position:absolute; } }";h.type="text/css";if(h.styleSheet){h.styleSheet.cssText=i}else{h.appendChild(document.createTextNode(i))}a.prepend(g).prepend(h);e[j]=f.css("position")==="absolute";g.add(h).remove()}return e[j]}})()})(jQuery); (function(g,b){var a=g(window),f=g("html"),i=g("head"),e=null,h=null,n={urlParseRE:/^(((([^:\/#\?]+:)?(?:\/\/((?:(([^:@\/#\?]+)(?:\:([^:@\/#\?]+))?)@)?(([^:\/#\?\]\[]+|\[[^\/\]@#?]+\])(?:\:([0-9]+))?))?)?)?((\/?(?:[^\/\?#]+\/+)*)([^\?#]*)))?(\?[^#]+)?)(#.*)?/,parseUrl:function(p){if(g.type(p)==="object"){return p}var o=p||"",r=n.urlParseRE.exec(p),q;if(r){q={href:r[0]||"",hrefNoHash:r[1]||"",hrefNoSearch:r[2]||"",domain:r[3]||"",protocol:r[4]||"",authority:r[5]||"",username:r[7]||"",password:r[8]||"",host:r[9]||"",hostname:r[10]||"",port:r[11]||"",pathname:r[12]||"",directory:r[13]||"",filename:r[14]||"",search:r[15]||"",hash:r[16]||""}}return q||{}},makePathAbsolute:function(r,q){if(r&&r.charAt(0)==="/"){return r}r=r||"";q=q?q.replace(/^\/|(\/[^\/]*|[^\/]+)$/g,""):"";var o=q?q.split("/"):[],t=r.split("/");for(var p=0;p<t.length;p++){var s=t[p];switch(s){case".":break;case"..":if(o.length){o.pop()}break;default:o.push(s);break}}return"/"+o.join("/")},isSameDomain:function(p,o){return n.parseUrl(p).domain===n.parseUrl(o).domain},isRelativeUrl:function(o){return n.parseUrl(o).protocol===""},isAbsoluteUrl:function(o){return n.parseUrl(o).protocol!==""},makeUrlAbsolute:function(p,q){if(!n.isRelativeUrl(p)){return p}var s=n.parseUrl(p),v=n.parseUrl(q),w=s.protocol||v.protocol,t=s.authority||v.authority,u=s.pathname!=="",o=n.makePathAbsolute(s.pathname||v.filename,v.pathname),x=s.search||(!u&&v.search)||"",r=s.hash;return w+"//"+t+o+x+r},addSearchParams:function(q,v){var o=n.parseUrl(q),t=(typeof v==="object")?g.param(v):v,r=o.search||"?";return o.hrefNoSearch+r+(r.charAt(r.length-1)!=="?"?"&":"")+t+(o.hash||"")},convertUrlToDataUrl:function(p){var o=n.parseUrl(p);if(n.isEmbeddedPage(o)){return o.hash.split(dialogHashKey)[0].replace(/^#/,"")}else{if(n.isSameDomain(o,documentBase)){return o.hrefNoHash.replace(documentBase.domain,"")}}return p},get:function(o){if(o===b){o=location.hash}return n.stripHash(o).replace(/[^\/]*\.[^\/*]+$/,"")},getFilePath:function(p){var o="&"+g.mobile.subPageUrlKey;return p&&p.split(o)[0].split(dialogHashKey)[0]},set:function(o){location.hash="cqm_"+o},isPath:function(o){return(/\//).test(o)},clean:function(o){return o.replace(documentBase.domain,"")},stripHash:function(o){return o.replace(/^#/,"")},cleanHash:function(o){return n.stripHash(o.replace(/\?.*$/,"").replace(dialogHashKey,""))},isExternal:function(p){var o=n.parseUrl(p);return o.protocol&&o.domain!==documentUrl.domain?true:false},hasProtocol:function(o){return(/^(:?\w+:)/).test(o)},isEmbeddedPage:function(p){var o=n.parseUrl(p);if(o.protocol!==""){return(o.hash&&(o.hrefNoHash===documentUrl.hrefNoHash||(documentBaseDiffers&&o.hrefNoHash===documentBase.hrefNoHash)))}return(/^#/).test(o.href)}},d={stack:[],activeIndex:0,getActive:function(){return d.stack[d.activeIndex]},getPrev:function(){return d.stack[d.activeIndex-1]},getNext:function(){return d.stack[d.activeIndex+1]},addNew:function(o){if(d.getNext()){d.clearForward()}d.stack.push(o);d.activeIndex=d.stack.length-1},clearForward:function(){d.stack=d.stack.slice(0,d.activeIndex+1)},directHashChange:function(r){var o,p,s,q=this.getActive();g.each(d.stack,function(t,u){if(r.currentUrl===u.pageId){o=t<d.activeIndex;p=!o;s=t}});this.activeIndex=s!==b?s:this.activeIndex;if(o){(r.either||r.isBack)(true)}else{if(p){(r.either||r.isForward)(false)}}},ignoreNextHashChange:false},l=[],m=false;isPageScrolling=false;g.mobile.urlstack=d.stack;var c=null;var j=null;var k=null;g.mobile.openDialog=function(o){if(location.hash.substring(0,11)=="#PhotoSwipe"){j=o}else{if(location.hash!="#dialog"){d.ignoreNextHashChange=true;location.hash="dialog"}c=o}};g.mobile.closeDialog=function(p){if(location.hash.substring(0,11)=="#PhotoSwipe"){p();j=null}else{k=p;c=null;if(PLATFORM!==platformEnum.simulator){history.back()}else{if(g.mobile.urlstack.length>1){var o=g.mobile.urlstack[g.mobile.urlstack.length-1];location.hash="cqm_"+o.pageId}else{location.hash=""}}}};g.mobile.resetNavigation=function(){e=null;h=null;m=false;g.mobile.urlstack=d.stack=[];d.ignoreNextHashChange=false;d.activeIndex=0;h=location.hash.replace("cqm_","")};g.mobile.isPageTransitioning=function(){return m};g.mobile.isPageScrolling=function(){return isPageScrolling};g.mobile.setPageScrolling=function(o){isPageScrolling=o};g.mobile.getActivePage=function(p){var o;if(p){o=p.children("."+g.mobile.activePageClass)}else{o=g("."+g.mobile.activePageClass)}return o};g.mobile.changePage=function(C,D){m=true;var v=g.extend({},g.mobile.changePage.defaults,D);var y=g.mobile.getActivePage(v.parentContainer);var x=g(C);if(e===null&&x.length){e=x;h=location.hash.replace("cqm_","")}if(!x.length){if(h===C){x=e}}y.trigger("pagebeforehide");x.trigger("pagebeforeshow");if(DeviceSupport.isTransitionSupported){var q=v.transition||g.mobile.defaultPageTransition}else{var q="none"}var r=x.attr("id");var s=0;if(v.fromHashChange){d.directHashChange({currentUrl:r,isBack:function(){s=-1},isForward:function(){s=1}})}if(v.changeHash!==false&&r){d.ignoreNextHashChange=true;n.set(r)}if(!s){var u=DeviceSupport.isTransitionSupported?q:v.transition||g.mobile.defaultPageTransition;var t={parentContainer:v.parentContainer,pageId:r,transition:u,reverse:v.reverse};d.addNew(t)}var w=v.reverse?" reverse":"";var z="ui-mobile-viewport-transitioning viewport-"+q;var A=function(){if(y&&(x.attr("id")!==y.attr("id"))){y.removeClass(g.mobile.activePageClass)}x.trigger("pageshow");y.trigger("pagehide");m=false};var p=function(){x.add(y).removeClass("out in reverse "+q);x.parent().removeClass(z);A()};var B=function(){x.addClass(g.mobile.activePageClass);A()};var o=((q!=="none")&&(g.support.cssTransitions));if(o){x.one("webkitAnimationEnd",p);x.parent().addClass(z);if(y){y.addClass(q+" out"+w)}x.addClass(g.mobile.activePageClass+" "+q+" in"+w)}else{B()}};g.mobile.changePage.defaults={transition:b,reverse:false,changeHash:true,fromHashChange:false,role:b,duplicateCachedPage:b,pageContainer:b,showLoadMsg:true};g.mobile._registerInternalEvents=function(){g.mobile._handleHashChange=function(r){if(j){j();j=null;return}var t=n.stripHash(r);if(DEVICE!==deviceTypeEnum.android||PLATFORM!==platformEnum.nativeApp){if(t.substring(0,10)=="PhotoSwipe"){d.ignoreNextHashChangePS=true;return}if(d.ignoreNextHashChangePS){if(t.substring(0,10)!="PhotoSwipe"){d.ignoreNextHashChangePS=false}return}}t=t.replace("cqm_","");if(d.ignoreNextHashChange){d.ignoreNextHashChange=false;return}if(k){c=null;k();k=null;return}if(c){c();c=null;return}var s=d.getActive();if(t=="dialog"||(s&&(s.pageId==t))){return}if(d.stack.length>0){var q=d.stack.pop();if(t){var p="#"+t}else{var p=g("*[data-role=page]").first()}var o={parentContainer:q.parentContainer,transition:q.transition,reverse:!(q.reverse),changeHash:false,fromHashChange:true};g.mobile.changePage(p,o)}};a.bind("hashchange",function(p,o){g.mobile._handleHashChange(location.hash)})};g.mobile._registerInternalEvents()})(jQuery); (function(g,c){var d=g("<body>").prependTo("html"),k=d[0].style,m=["Webkit","Moz","O"],n="palmGetResource" in window,l=window.operamini&&({}).toString.call(window.operamini)==="[object OperaMini]",j=window.blackberry;function b(r){var q=r.charAt(0).toUpperCase()+r.substr(1),p=(r+" "+m.join(q+" ")+q).split(" ");for(var o in p){if(k[p[o]]!==c){return true}}}function f(o,t,q){var p=document.createElement("div"),w=function(x){return x.charAt(0).toUpperCase()+x.substr(1)},v=function(x){return"-"+x.charAt(0).toLowerCase()+x.substr(1)+"-"},u=function(A){var x=v(A)+o+": "+t+";",z=w(A),y=z+w(o);p.setAttribute("style",x);if(!!p.style[y]){s=true}},r=q?[q]:m,s;for(i=0;i<r.length;i++){u(r[i])}return !!s}function e(){var o="transform-3d";return f("perspective","10px","moz")||g.mobile.media("(-"+m.join("-"+o+"),(-")+"-"+o+"),("+o+")")}function a(){var s=location.protocol+"//"+location.host+location.pathname+"ui-dir/",r=g("head base"),t=null,o="",q,p;if(!r.length){r=t=g("<base>",{href:s}).appendTo("head")}else{o=r.attr("href")}q=g("<a href='testurl' />").prependTo(d);p=q[0].href;r[0].href=o||location.pathname;if(t){t.remove()}return p.indexOf(s)===0}g.extend(g.mobile,{browser:{}});g.mobile.browser.ie=(function(){var p=3,q=document.createElement("div"),o=q.all||[];while(q.innerHTML="<!--[if gt IE "+(++p)+"]><br><![endif]-->",o[0]){}return p>4?p:!p})();g.extend(g.support,{orientation:"orientation" in window&&"onorientationchange" in window,touch:"ontouchend" in document,cssTransitions:"WebKitTransitionEvent" in window,pushState:"pushState" in history&&"replaceState" in history,mediaquery:g.mobile.media("only all"),cssPseudoElement:!!b("content"),touchOverflow:!!b("overflowScrolling"),cssTransform3d:e(),boxShadow:!!b("boxShadow")&&!j,scrollTop:("pageXOffset" in window||"scrollTop" in document.documentElement||"scrollTop" in d[0])&&!n&&!l,dynamicBaseTag:a()});d.remove();var h=(function(){var o=window.navigator.userAgent;return o.indexOf("Nokia")>-1&&(o.indexOf("Symbian/3")>-1||o.indexOf("Series60/5")>-1)&&o.indexOf("AppleWebKit")>-1&&o.match(/(BrowserNG|NokiaBrowser)\/7\.[0-3]/)})();g.mobile.ajaxBlacklist=window.blackberry&&!window.WebKitPoint||l||h;if(h){g(function(){g("head link[rel='stylesheet']").attr("rel","alternate stylesheet").attr("rel","stylesheet")})}if(!g.support.boxShadow){g("html").addClass("ui-mobile-nosupport-boxshadow")}})(jQuery); (function(c,h,a){c.each(("touchstart touchmove touchend orientationchange throttledresize tap taphold swipe swipeleft swiperight scrollstart scrollstop").split(" "),function(k,j){c.fn[j]=function(l){return l?this.bind(j,l):this.trigger(j)};c.attrFn[j]=true});var d=c.support.touch,e="touchmove scroll",i=d?"touchstart":"mousedown",g=d?"touchend":"mouseup",b=d?"touchmove":"mousemove";function f(m,j,l){var k=l.type;l.type=j;c.event.handle.call(m,l);l.type=k}c.event.special.scrollstart={enabled:true,setup:function(){var j=this,m=c(j),l,n;function k(o,p){l=p;f(j,l?"scrollstart":"scrollstop",o)}m.bind(e,function(o){if(!c.event.special.scrollstart.enabled){return}if(!l){k(o,true)}clearTimeout(n);n=setTimeout(function(){k(o,false)},200)})}};c.event.special.tap={setup:function(){var j=this,k=c(j);k.bind("vmousedown",function(o){if(o.which&&o.which!==1){return false}var n=o.target,l=o.originalEvent,r;function m(){clearTimeout(r)}function q(){m();k.unbind("vclick",p).unbind("vmouseup",m);c(document).unbind("vmousecancel",q)}function p(s){q();if(c.mobile.isPageTransitioning()){return}if(n==s.target){f(j,"tap",s)}}k.bind("vmouseup",m).bind("vclick",p).bind("vmousemove",function(){setTimeout(q,100)});c(document).bind("vmousecancel",q);r=setTimeout(function(){f(j,"taphold",c.Event("taphold"))},750)})}};c.event.special.swipe={scrollSupressionThreshold:10,durationThreshold:1000,horizontalDistanceThreshold:30,verticalDistanceThreshold:75,setup:function(){var j=this,k=c(j);k.bind(i,function(m){var o=m.originalEvent.touches?m.originalEvent.touches[0]:m,p={time:(new Date()).getTime(),coords:[o.pageX,o.pageY],origin:c(m.target)},l;function n(q){if(!p){return}var r=q.originalEvent.touches?q.originalEvent.touches[0]:q;l={time:(new Date()).getTime(),coords:[r.pageX,r.pageY]};if(Math.abs(p.coords[0]-l.coords[0])>c.event.special.swipe.scrollSupressionThreshold){q.preventDefault()}}k.bind(b,n).one(g,function(q){k.unbind(b,n);if(p&&l){if(l.time-p.time<c.event.special.swipe.durationThreshold&&Math.abs(p.coords[0]-l.coords[0])>c.event.special.swipe.horizontalDistanceThreshold&&Math.abs(p.coords[1]-l.coords[1])<c.event.special.swipe.verticalDistanceThreshold){p.origin.trigger("swipe").trigger(p.coords[0]>l.coords[0]?"swipeleft":"swiperight")}}p=l=a})})}};(function(m,q){var o=m(q),j,k,n,l,r,p={"0":true,"180":true};if(m.support.orientation){l=m.mobile.media("all and (orientation: landscape)");r=p[q.orientation];if((l&&r)||(!l&&!r)){p={"-90":true,"90":true}}}m.event.special.orientationchange=j={setup:function(){if(m.support.orientation){return false}n=k();o.bind("throttledresize",s)},teardown:function(){if(m.support.orientation){return false}o.unbind("throttledresize",s)},add:function(t){var u=t.handler;t.handler=function(v){v.orientation=k();return u.apply(this,arguments)}}};function s(){var t=k();if(t!==n){n=t;o.trigger("orientationchange")}}m.event.special.orientationchange.orientation=k=function(){var t=document.documentElement;return t&&t.clientWidth/t.clientHeight<1.1?"portrait":"landscape"}})(jQuery,h);(function(){c.event.special.throttledresize={setup:function(){c(this).bind("resize",l)},teardown:function(){c(this).unbind("resize",l)}};var m=250,l=function(){o=(new Date()).getTime();n=o-k;if(n>=m){k=o;c(this).trigger("throttledresize")}else{if(j){clearTimeout(j)}j=setTimeout(l,m-n)}},k=0,j,o,n})();c.each({scrollstop:"scrollstart",taphold:"tap",swipeleft:"swipe",swiperight:"swipe"},function(k,j){c.event.special[k]={setup:function(){c(this).bind(j,c.noop)}}})})(jQuery,this); (function(d,f,b){var c="hashchange",i=document,g,h=d.event.special,j=i.documentMode,e="on"+c in f&&(j===b||j>7);function a(k){k=k||location.href;return"#"+k.replace(/^[^#]*#?(.*)$/,"$1")}d.fn[c]=function(k){return k?this.bind(c,k):this.trigger(c)};d.fn[c].delay=50;h[c]=d.extend(h[c],{setup:function(){if(e){return false}d(g.start)},teardown:function(){if(e){return false}d(g.stop)}});g=(function(){var k={},q,n=a(),l=function(r){return r},m=l,p=l;k.start=function(){q||o()};k.stop=function(){q&&clearTimeout(q);q=b};function o(){var s=a(),r=p(n);if(s!==n){m(n=s,r);d(f).trigger(c)}else{if(r!==n){location.href=location.href.replace(/#.*/,"")+r}}q=setTimeout(o,d.fn[c].delay)}d.browser.msie&&!e&&(function(){var r,s;k.start=function(){if(!r){s=d.fn[c].src;s=s&&s+a();r=d('<iframe tabindex="-1" title="empty"/>').hide().one("load",function(){s||m(a());o()}).attr("src",s||"javascript:0").insertAfter("body")[0].contentWindow;i.onpropertychange=function(){try{if(event.propertyName==="title"){r.document.title=i.title}}catch(t){}}}};k.stop=l;p=function(){return a(r.location.href)};m=function(w,t){var v=r.document,u=d.fn[c].domain;if(w!==t){v.title=i.title;v.open();u&&v.write('<script>document.domain="'+u+'"<\/script>');v.close();r.location.hash=w}}})();return k})()})(jQuery,this); (function(w,F,d,l){var E="virtualMouseBindings",b="virtualTouchID",a="vmouseover vmousedown vmousemove vmouseup vclick vmouseout vmousecancel".split(" "),v="clientX clientY pageX pageY screenX screenY".split(" "),B=w.event.mouseHooks?w.event.mouseHooks.props:[],x=w.event.props.concat(B),z={},G=0,r=0,q=0,o=false,J=[],f=false,Q=false,t="addEventListener" in d,s=w(d),D=1,M=0;w.vmouse={moveDistanceThreshold:10,clickDistanceThreshold:10,resetTimerDuration:1500};function p(i){while(i&&typeof i.originalEvent!=="undefined"){i=i.originalEvent}return i}function g(S,T){var aa=S.type,ab,Z,U,R,Y,X,W,V;S=w.Event(S);S.type=T;ab=S.originalEvent;Z=w.event.props;if(aa.search(/mouse/)>-1){Z=x}if(ab){for(W=Z.length,R;W;){R=Z[--W];S[R]=ab[R]}}if(aa.search(/mouse(down|up)|click/)>-1&&!S.which){S.which=1}if(aa.search(/^touch/)!==-1){U=p(ab);aa=U.touches;Y=U.changedTouches;X=(aa&&aa.length)?aa[0]:((Y&&Y.length)?Y[0]:l);if(X){for(V=0,len=v.length;V<len;V++){R=v[V];S[R]=X[R]}}}return S}function O(T){var R={},i,S;while(T){i=w.data(T,E);for(S in i){if(i[S]){R[S]=R.hasVirtualBinding=true}}T=T.parentNode}return R}function A(S,R){var i;while(S){i=w.data(S,E);if(i&&(!R||i[R])){return S}S=S.parentNode}return null}function I(){Q=false}function j(){Q=true}function P(){M=0;J.length=0;f=false;j()}function n(){I()}function u(){y();G=setTimeout(function(){G=0;P()},w.vmouse.resetTimerDuration)}function y(){if(G){clearTimeout(G);G=0}}function m(S,T,i){var R;if((i&&i[S])||(!i&&A(T.target,S))){R=g(T,S);w(T.target).trigger(R)}return R}function h(R){var S=w.data(R.target,b);if(!f&&(!M||M!==S)){var i=m("v"+R.type,R);if(i){if(i.isDefaultPrevented()){R.preventDefault()}if(i.isPropagationStopped()){R.stopPropagation()}if(i.isImmediatePropagationStopped()){R.stopImmediatePropagation()}}}}function N(S){var U=p(S).touches,T,i;if(U&&U.length===1){T=S.target;i=O(T);if(i.hasVirtualBinding){M=D++;w.data(T,b,M);y();n();o=false;var R=p(S).touches[0];r=R.pageX;q=R.pageY;m("vmouseover",S,i);m("vmousedown",S,i)}}}function H(i){if(Q){return}if(!o){m("vmousecancel",i,O(i.target))}o=true;u()}function c(T){if(Q){return}var R=p(T).touches[0],i=o,S=w.vmouse.moveDistanceThreshold;o=o||(Math.abs(R.pageX-r)>S||Math.abs(R.pageY-q)>S),flags=O(T.target);if(o&&!i){m("vmousecancel",T,flags)}m("vmousemove",T,flags);u()}function e(T){if(Q){return}j();var i=O(T.target),S;m("vmouseup",T,i);if(!o){var R=m("vclick",T,i);if(R&&R.isDefaultPrevented()){S=p(T).changedTouches[0];J.push({touchID:M,x:S.clientX,y:S.clientY});f=true}}m("vmouseout",T,i);o=false;u()}function C(R){var S=w.data(R,E),i;if(S){for(i in S){if(S[i]){return true}}}return false}function L(){}function k(i){var R=i.substr(1);return{setup:function(T,S){if(!C(this)){w.data(this,E,{})}var U=w.data(this,E);U[i]=true;z[i]=(z[i]||0)+1;if(z[i]===1){s.bind(R,h)}w(this).bind(R,L);if(t){z.touchstart=(z.touchstart||0)+1;if(z.touchstart===1){s.bind("touchstart",N).bind("touchend",e).bind("touchmove",c).bind("scroll",H)}}},teardown:function(T,S){--z[i];if(!z[i]){s.unbind(R,h)}if(t){--z.touchstart;if(!z.touchstart){s.unbind("touchstart",N).unbind("touchmove",c).unbind("touchend",e).unbind("scroll",H)}}var U=w(this),V=w.data(this,E);if(V){V[i]=false}U.unbind(R,L);if(!C(this)){U.removeData(E)}}}}for(var K=0;K<a.length;K++){w.event.special[a[K]]=k(a[K])}if(t){d.addEventListener("click",function(V){var S=J.length,W=V.target,Y,X,Z,U,R,T;if(S){Y=V.clientX;X=V.clientY;threshold=w.vmouse.clickDistanceThreshold;Z=W;while(Z){for(U=0;U<S;U++){R=J[U];T=0;if((Z===W&&Math.abs(R.x-Y)<threshold&&Math.abs(R.y-X)<threshold)||w.data(Z,b)===R.touchID){V.preventDefault();V.stopPropagation();return}}Z=Z.parentNode}}},true)}})(jQuery,window,document); (function(b,c){function d(e){while(e){var f=b(e);if(f.attr("data-role")==="button"){break}e=e.parentNode}return e}var a=function(){var f=200,g,e;b(document).bind({vmousedown:function(j){var h=d(j.target),i;if(h){i=b(h);if(b.support.touch){g=setTimeout(function(){i.removeClass("ui-btn-up").addClass("ui-btn-down")},f)}else{i.removeClass("ui-btn-up").addClass("ui-btn-down")}}},"vmousecancel vmouseup":function(j){var h=d(j.target),i;if(h){i=b(h);i.removeClass("ui-btn-down").addClass("ui-btn-up")}},"vmouseover focus":function(j){var h=d(j.target),i;if(h){i=b(h);if(b.support.touch){e=setTimeout(function(){i.removeClass("ui-btn-up").addClass("ui-btn-hover")},f)}else{i.removeClass("ui-btn-up").addClass("ui-btn-hover")}}},"vmouseout blur scrollstart":function(j){var h=d(j.target),i;if(h){i=b(h);i.removeClass("ui-btn-hover ui-btn-down").addClass("ui-btn-up");g&&clearTimeout(g);e&&clearTimeout(e)}}});a=null};if(a){a()}})(jQuery); var cqm=(function(){var d={};var b="loading_src";var a="error_src";var g=false;function e(h){if(g){h()}else{$(function(){h()})}}d.setSrcConditional=function(m,o,i){m.addClass(b);var j=function(p){if(!i){p()}else{if(i.hasClass("in")){i.one("pageshow",p)}else{if(i.hasClass("out")){i.one("pagehide",p)}else{p()}}}};var h=function(){m.removeClass(b);m.attr("src",o)};var n=function(){m.removeClass(b).addClass(a);m.attr("src","")};var k=new Image();k.onload=function(){j(h)};var l=function(){j(n)};k.onerror=l;k.onabort=l;k.src=o};d.showLoading=function(j,h,i){setTimeout(function(){e(function(){j=j||_T("IndicatorLoading");h=c(h);if(!h){return}if(i){var k=$("<div class='ui-loader small'><div class='horizontalCenter'><div class='dialog ui-corner-all'><span class='loading-icon mask_sprite sprite-ajax-loader_small spin clr_appGeneral_loadingSmallIcn'></span><h1>"+j+"</h1></div></div></div>");k.css({top:window.pageYOffset+Utils.Html.getInnerSize().height*3/4||100})}else{var k=$("<div class='ui-loader big ui-body-a ui-corner-all'><span class='ui-icon ui-icon-loading spin'></span><h1>"+j+"</h1></div>");k.css({top:window.pageYOffset+Utils.Html.getInnerSize().height/2||100})}k.appendTo(h)})},0)};d.hideLoading=function(h){setTimeout(function(){e(function(){h=c(h);if(!h){return}h.find(".ui-loader").remove()})},0)};d.showToastMessage=function(j,h,i){i=i||1500;h=c(h);if(!h){return}$("<div class='ui-loader big ui-overlay-shadow ui-body-e ui-corner-all'><h1>"+j+"</h1></div>").css({display:"block",opacity:0.96,top:window.pageYOffset+100}).appendTo(h).delay(i).fadeOut(500,function(){$(this).remove()})};var c=function(h){while(h&&h.attr("data-role")!=="page"){h=h.parent();if(h.length===0){return null}}return h||$("body")};d.showDialogBox=function(l,k,i,h){if(typeof h==="undefined"){h={}}var j={parse_text_as_html:false};h=$.extend({},j,h);e(function(){if(!h.parse_text_as_html){k=Utils.String.sanitizeText(k,true)}var r=$('<div class="ui-overlay"></div>');var q=$('<div class="dialog-box t3d"><h1 class="ui-dialog-bar ui-corner-top ui-title ui-overlay-shadow">'+l+'</h1><div class="ui-corner-bottom ui-content ui-body-c ui-overlay-shadow"><p class="ui-dialog-box-text">'+k+'</p><div class="ui-button-container"></div></div></div>').css("top",window.pageYOffset+100);var o=q.find(".ui-button-container");for(var n=0;n<i.length;n++){var m=i[n];if(m&&m.text){var p=$('<div data-id="'+n+'" data-role="button" class="ui-btn ui-btn-inline ui-btn-corner-all ui-shadow ui-btn-up"><span class="ui-btn-inner">'+m.text+"</span></div>").appendTo(o);p.tap(function(u){u.preventDefault();$("html").removeClass("ui-dialog");q.remove();r.remove();var t=$(this).attr("data-id");var s=i[t];if(s){if(typeof(s.cb)=="function"){setTimeout(s.cb,0)}}})}}$("html").addClass("ui-dialog");q.prependTo($("body"));r.prependTo($("body"))})};function f(){$(window).bind("orientationchange throttledresize",function(h){if(h.orientation){$("html").removeClass("portrait landscape").addClass(h.orientation)}});$(function(){$(window).trigger("orientationchange")});$(function(){$.mobile.defaultHomeScroll=(!$.support.scrollTop||$(window).scrollTop()===1)?0:1;g=true})}f();return d})(); Utils=window.Utils||{};Utils.Html={addCssStyle:function(b,g,d){if(!g){return}var c="";$.each(b,function(h,i){c+=" "+h+" "+i});if(d){var a=g.getElementById(d);if(a){a.parentNode.removeChild(a)}}a=g.createElement("style");a.type="text/css";if(d){a.id=d}var f=g.createTextNode(c);if(a.styleSheet){a.styleSheet.cssText=f.nodeValue}else{a.appendChild(f)}var e=g.getElementsByTagName("head")[0];if(e){e.appendChild(a)}},getInnerSize:function(c){if(!c){c=window}var b=c.document;var a={width:0,height:0};if(typeof(c.innerWidth)=="number"){a.width=c.innerWidth;a.height=c.innerHeight}else{if(b.documentElement&&(b.documentElement.clientWidth||b.documentElement.clientHeight)){a.width=b.documentElement.clientWidth;a.height=b.documentElement.clientHeight}else{if(b.body&&(b.body.clientWidth||b.body.clientHeight)){a.width=b.body.clientWidth;a.height=b.body.clientHeight}}}return a},getInnerHeight:function(b){var a={includeHeader:false,includeFooter:false};b=$.extend({},a,b);var e=this.getInnerSize(window);var d=e.height;var f=this.getHeaderHeight();var c=this.getFooterHeight();if(f>0||c>0){if(!b.includeHeader){d-=f}if(!b.includeFooter){d-=c}}return d},getHeaderHeight:function(){var a=AppSettingsManager.getSettings();if(a&&a.get("isHeaderScrollable")){return 0}else{return this.getElementHeight($(".app_header"))}},getFooterHeight:function(){return this.getElementHeight($("#app_footer"))},getElementHeight:function(a){var b=0;if(a&&a.length>0&&a.is(":visible")){b=Math.max(a.outerHeight(),0)}return b},preloadImages:function(a){if(!a||a.length===0){return}for(var b=a.length-1;b>=0;b--){(new Image()).src=a[b]}},setGridMargin:function(b,h){var c=b.children();if(c&&c.length>0){h=h||{};if(typeof(h.minMargin)==="undefined"){h.minMargin=5}if(typeof(h.alsoTop)==="undefined"){h.alsoTop=true}if(typeof(h.centerFewItems)==="undefined"){h.centerFewItems=false}var f=b.width();var d=c.first().width();if(f>0&&d>0){var i=Math.floor(f/(d+h.minMargin));if(i>0){if(h.centerFewItems&&i>c.length){i=c.length}var a=f-(i*d);var e=Math.floor(a/(i+1));if(e<h.minMargin){i--;a=f-(i*d);e=Math.floor(a/(i+1))}if(IS_RTL){c.css({marginRight:e})}else{c.css({marginLeft:e})}if(h.alsoTop){c.css({marginTop:e})}var g=b.parents(".scroll_wrapper");if(g.length>0){Scrolling.onContentChanged(g)}}}}},setGridSizes:function(b,h){var c=b.children();if(c&&c.length>0){var a={minWidth:80,maxWidth:99999,margin:4,setAlsoMargin:true,setAlsoMarginTop:false,setAlsoHeight:true};h=_.extend({},a,h);var e=h.margin;var d=h.minWidth+e;var f=b.width()-e;if(f>0&&d>0){var i=Math.floor(f/d);if(i>0){f=f-(i*e);d=Math.floor(f/i);c.css({width:d});if(h.setAlsoHeight){c.css({height:d})}if(h.setAlsoMargin){if(IS_RTL){c.css({marginRight:e})}else{c.css({marginLeft:e})}}if(h.setAlsoMarginTop){c.css({marginTop:e})}var g=b.parents(".scroll_wrapper");if(g.length>0){Scrolling.onContentChanged(g)}}}}},_mergeSvg:function(c,l,f,j,h,e){j.remove();var k=e.documentElement.attributes;if(!c.data("initialized")){for(var d=0;d<k.length;d++){var g=k[d];c.attr(g.name,g.value)}c.data("initialized",true)}var a=$(e.documentElement).children();for(var d=0;d<a.length;d++){var b=a[d];$(b).attr("class",f);l.append(b)}if(h){h()}},appendLayeredImage:function(n,a,j,c,i,k){var m=$('<div class="image_loader_icon mask_sprite sprite-ajax-loader_small spin clr_contTypeA_btn_icn"></div>');n.append(m);var f=function(o){if(c){c.appendTo(n)}m.remove();if(i){i(o)}};if(!a){f("no url");return}var e=a.endsWith(".svg");if(a.endsWith(".svg")){if(!DeviceSupport.isSvgSupported){f("svg is not supported");return}var d=n.find("svg");if(!d.length){var d=$('<svg class="layered_svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" xml:space="preserve">');d.appendTo(n)}n.append(d);var b=document.createElementNS("http://www.w3.org/2000/svg","g");d.append(b);var h=_.bind(Utils.Html._mergeSvg,this,d,$(b),j,m,k);$.ajax({type:"GET",url:a,dataType:"xml",contentType:"image/svg+xml"}).done(h).fail(f)}else{var g=$('<img class="layered_image"  src="'+a+'">').addClass(j);var l=function(){m.remove();if(k){k()}};g.bind("error",f);g.bind("load",l);n.append(g)}},replaceUrlsRegex:new RegExp(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig),replaceURLWithHTMLLinks:function(a){if(a){return a.replace(this.replaceUrlsRegex,'<a href="$1">$1</a>')}}}; Utils=window.Utils||{};Utils.ImageLoader={load:function(b,c){if(!b||b===""){return}var a=new Image();if(typeof(c)==="function"){a.onload=function(){c()}}a.src=b}}; window.console=window.console||(function(){var c=function(){},d="log info warn error assert dir clear profile profileEnd".split(" "),b=0,a=null,e={};for(b=0;a=d[b];b+=1){e[a]=c}return e}()); console.trace=function(a){console.log(printStackTrace().join("\n"));console.log(a)};window.onerror=function(c,b,a){console.trace("JavaScript error: "+c+" on line "+a+" for "+b)};function printStackTrace(c){c=c||{guess:true};var e=c.e||null,h=!!c.guess;var f=new printStackTrace.implementation(),a=f.run(e);var a=(h)?f.guessAnonymousFunctions(a):a;var b=[];for(var d=a.length-1;d>=0;d--){var g=a[d];if(!~g.indexOf("createException")&&!~g.indexOf("print-stack")&&!~g.indexOf(".fn")&&!~g.indexOf("Object.printStackTrace.impl")){b.push(a[d])}}return b}if(typeof module!=="undefined"&&module.exports){module.exports=printStackTrace}printStackTrace.implementation=function(){};printStackTrace.implementation.prototype={run:function(a,b){a=a||this.createException();b=b||this.mode(a);if(b==="other"){return this.other(arguments.callee)}else{return this[b](a)}},createException:function(){try{this.undef()}catch(a){return a}},mode:function(a){if(a["arguments"]&&a.stack){return"chrome"}else{if(a.stack&&a.sourceURL){return"safari"}else{if(a.stack&&a.number){return"ie"}else{if(typeof a.message==="string"&&typeof window!=="undefined"&&window.opera){if(!a.stacktrace){return"opera9"}if(a.message.indexOf("\n")>-1&&a.message.split("\n").length>a.stacktrace.split("\n").length){return"opera9"}if(!a.stack){return"opera10a"}if(a.stacktrace.indexOf("called from line")<0){return"opera10b"}return"opera11"}else{if(a.stack){return"firefox"}}}}}return"other"},instrumentFunction:function(b,d,e){b=b||window;var a=b[d];b[d]=function c(){e.call(this,printStackTrace().slice(4));return b[d]._instrumented.apply(this,arguments)};b[d]._instrumented=a},deinstrumentFunction:function(a,b){if(a[b].constructor===Function&&a[b]._instrumented&&a[b]._instrumented.constructor===Function){a[b]=a[b]._instrumented}},chrome:function(b){var a=(b.stack+"\n").replace(/^\S[^\(]+?[\n$]/gm,"").replace(/^\s+(at eval )?at\s+/gm,"").replace(/^([^\(]+?)([\n$])/gm,"{anonymous}()@$1$2").replace(/^Object.<anonymous>\s*\(([^\)]+)\)/gm,"{anonymous}()@$1").split("\n");a.pop();return a},safari:function(a){return a.stack.replace(/\[native code\]\n/m,"").replace(/^(?=\w+Error\:).*$\n/m,"").replace(/^@/gm,"{anonymous}()@").split("\n")},ie:function(b){var a=/^.*at (\w+) \(([^\)]+)\)$/gm;return b.stack.replace(/at Anonymous function /gm,"{anonymous}()@").replace(/^(?=\w+Error\:).*$\n/m,"").replace(a,"$1@$2").split("\n")},firefox:function(a){return a.stack.replace(/(?:\n@:0)?\s+$/m,"").replace(/^[\(@]/gm,"{anonymous}()@").split("\n")},opera11:function(g){var a="{anonymous}",h=/^.*line (\d+), column (\d+)(?: in (.+))? in (\S+):$/;var k=g.stacktrace.split("\n"),l=[];for(var c=0,f=k.length;c<f;c+=2){var d=h.exec(k[c]);if(d){var j=d[4]+":"+d[1]+":"+d[2];var b=d[3]||"global code";b=b.replace(/<anonymous function: (\S+)>/,"$1").replace(/<anonymous function>/,a);l.push(b+"@"+j+" -- "+k[c+1].replace(/^\s+/,""))}}return l},opera10b:function(h){var g=/^(.*)@(.+):(\d+)$/;var c=h.stacktrace.split("\n"),b=[];for(var f=0,a=c.length;f<a;f++){var d=g.exec(c[f]);if(d){var j=d[1]?(d[1]+"()"):"global code";b.push(j+"@"+d[2]+":"+d[3])}}return b},opera10a:function(g){var a="{anonymous}",h=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i;var j=g.stacktrace.split("\n"),k=[];for(var c=0,f=j.length;c<f;c+=2){var d=h.exec(j[c]);if(d){var b=d[3]||a;k.push(b+"()@"+d[2]+":"+d[1]+" -- "+j[c+1].replace(/^\s+/,""))}}return k},opera9:function(j){var d="{anonymous}",h=/Line (\d+).*script (?:in )?(\S+)/i;var c=j.message.split("\n"),b=[];for(var g=2,a=c.length;g<a;g+=2){var f=h.exec(c[g]);if(f){b.push(d+"()@"+f[2]+":"+f[1]+" -- "+c[g+1].replace(/^\s+/,""))}}return b},other:function(g){var b="{anonymous}",f=/function\s*([\w\-$]+)?\s*\(/i,a=[],d,c,e=10;while(g&&g["arguments"]&&a.length<e){d=f.test(g.toString())?RegExp.$1||b:b;c=Array.prototype.slice.call(g["arguments"]||[]);a[a.length]=d+"("+this.stringifyArguments(c)+")";g=g.caller}return a},stringifyArguments:function(c){var b=[];var e=Array.prototype.slice;for(var d=0;d<c.length;++d){var a=c[d];if(a===undefined){b[d]="undefined"}else{if(a===null){b[d]="null"}else{if(a.constructor){if(a.constructor===Array){if(a.length<3){b[d]="["+this.stringifyArguments(a)+"]"}else{b[d]="["+this.stringifyArguments(e.call(a,0,1))+"..."+this.stringifyArguments(e.call(a,-1))+"]"}}else{if(a.constructor===Object){b[d]="#object"}else{if(a.constructor===Function){b[d]="#function"}else{if(a.constructor===String){b[d]='"'+a+'"'}else{if(a.constructor===Number){b[d]=a}}}}}}}}}return b.join(",")},sourceCache:{},ajax:function(a){var b=this.createXMLHTTPObject();if(b){try{b.open("GET",a,false);b.send(null);return b.responseText}catch(c){}}return""},createXMLHTTPObject:function(){var c,a=[function(){return new XMLHttpRequest()},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}];for(var b=0;b<a.length;b++){try{c=a[b]();this.createXMLHTTPObject=a[b];return c}catch(d){}}},isSameDomain:function(a){return typeof location!=="undefined"&&a.indexOf(location.hostname)!==-1},getSource:function(a){if(!(a in this.sourceCache)){this.sourceCache[a]=this.ajax(a).split("\n")}return this.sourceCache[a]},guessAnonymousFunctions:function(k){for(var g=0;g<k.length;++g){var f=/\{anonymous\}\(.*\)@(.*)/,l=/^(.*?)(?::(\d+))(?::(\d+))?(?: -- .+)?$/,b=k[g],c=f.exec(b);if(c){var e=l.exec(c[1]);if(e){var d=e[1],a=e[2],j=e[3]||0;if(d&&this.isSameDomain(d)&&a){var h=this.guessAnonymousFunction(d,a,j);k[g]=b.replace("{anonymous}",h)}}}}return k},guessAnonymousFunction:function(c,f,a){var b;try{b=this.findFunctionName(this.getSource(c),f)}catch(d){b="getSource failed with url: "+c+", exception: "+d.toString()}return b},findFunctionName:function(a,e){var g=/function\s+([^(]*?)\s*\(([^)]*)\)/;var k=/['"]?([$_A-Za-z][$_A-Za-z0-9]*)['"]?\s*[:=]\s*function\b/;var h=/['"]?([$_A-Za-z][$_A-Za-z0-9]*)['"]?\s*[:=]\s*(?:eval|new Function)\b/;var b="",l,j=Math.min(e,20),d,c;for(var f=0;f<j;++f){l=a[e-f-1];c=l.indexOf("//");if(c>=0){l=l.substr(0,c)}if(l){b=l+b;d=k.exec(b);if(d&&d[1]){return d[1]}d=g.exec(b);if(d&&d[1]){return d[1]}d=h.exec(b);if(d&&d[1]){return d[1]}}}return"(?)"}}; var Localization=function(a){this.localizationData=a;a.numberFormat={decimalSymbol:a.stringsDictionary._decimalSymbol,digitGroupingSymbol:a.stringsDictionary._digitGroupingSymbol};dateFormat.masks.shortDate=a.stringsDictionary._shortDate;dateFormat.masks.longDate=a.stringsDictionary._longDate;dateFormat.masks.fullDate=a.stringsDictionary._fullDate;dateFormat.masks.shortTime=a.stringsDictionary._shortTime;dateFormat.masks.longTime=a.stringsDictionary._longTime;dateFormat.masks.dateTime=a.stringsDictionary._dateTime;dateFormat.i18n={dayNames:[a.stringsDictionary._day1s,a.stringsDictionary._day2s,a.stringsDictionary._day3s,a.stringsDictionary._day4s,a.stringsDictionary._day5s,a.stringsDictionary._day6s,a.stringsDictionary._day7s,a.stringsDictionary._day1,a.stringsDictionary._day2,a.stringsDictionary._day3,a.stringsDictionary._day4,a.stringsDictionary._day5,a.stringsDictionary._day6,a.stringsDictionary._day7],monthNames:[a.stringsDictionary._month1s,a.stringsDictionary._month2s,a.stringsDictionary._month3s,a.stringsDictionary._month4s,a.stringsDictionary._month5s,a.stringsDictionary._month6s,a.stringsDictionary._month7s,a.stringsDictionary._month8s,a.stringsDictionary._month9s,a.stringsDictionary._month10s,a.stringsDictionary._month11s,a.stringsDictionary._month12s,a.stringsDictionary._month1,a.stringsDictionary._month2,a.stringsDictionary._month3,a.stringsDictionary._month4,a.stringsDictionary._month5,a.stringsDictionary._month6,a.stringsDictionary._month7,a.stringsDictionary._month8,a.stringsDictionary._month9,a.stringsDictionary._month10,a.stringsDictionary._month11,a.stringsDictionary._month12]}};Localization.constructor=Localization;Localization.prototype={wrapString:function(c,b){if(!this.highlightStrings){return b}var a="rgba(255,255,0,0.8)";if(!LocalizationManager.isTranslated(c)){a="rgba(255,0,0,0.8)"}htmlStr='<span style="color:black !important; background:'+a+' !important;" onmouseover="$(this).html(\''+c+"');\" onmouseout=\"$(this).html('"+b+"');\">"+b+"</span>";return htmlStr},getTranslatedString:function(b,c){if(!this.localizationData.stringsDictionary[b]){return""}var f=this.localizationData.stringsDictionary[b];if(!c){return this.wrapString(b,f)}var j="";var d=0;var e=-1;var a;while(d<f.length){a=f[d];if(!a){a=f.substring(d,d+1)}if(a==="{"){if(d===e){j+="{";e=-1}else{e=d+1}}else{if(a==="}"&&e>0){var h=f.substring(e,d);var g="";if(c&&c[h]){g=c[h]}j+=g;e=-1}else{if(e<0){j+=a}}}d++}return this.wrapString(b,j)},formatNumber:function(a){return Utils.Numbers.formatNumber(a,this.localizationData.numberFormat)},getLocalizationData:function(){return this.localizationData}}; var LocalizationManager=(function(){var e={};var f="mobile.client,mobile.localeFormat";var h="LocalizationData";var g=false;var b={};var a=null;var c=null;e.addOverrideTranslation=function(i){b=i;$.extend(localizationData.stringsDictionary,i)};e.getCulture=function(){return c||"en-US"};e.initLocalizationData=function(){var i=null;a=Utils.Helpers.deepClone(true,{},localizationData);if(conduitApi.platform.storage.isSupported()){i=conduitApi.platform.storage.getItem(null,null,h,true);if(i){i=JSON.parse(i)}}d(i)};e.updateLocalizationData=function(i,l){c=i;if(!conduitApi.platform.storage.isSupported()){Utils.Helpers.funcWrapper(l)();return}var j={culture:i||"default",product:f};var m=function(p,n){var o=p;if(o){d(o);o=JSON.stringify(o);conduitApi.platform.storage.setItem(null,null,h,o,true);if(l){g=false;l()}}};var k=function(n){if(l){g=false;l()}};Services.executeService("AMS_TRANSLATION_GET",j,m,k)};e.isTranslated=function(i){if(c!="en-US"){if(a.stringsDictionary[i]&&localizationData.stringsDictionary[i]){if(a.stringsDictionary[i]==localizationData.stringsDictionary[i]){return false}}}return true};var d=function(i){if(g){return}if(i){g=true;localizationData.isRtl=i.isRtl;_.extend(localizationData.stringsDictionary,i.items,b)}localization=new Localization(localizationData);if(navigator&&navigator.appManager){navigator.appManager.setLocalizationData(localizationData)}_T=localization.getTranslatedString.hitch(localization);IS_RTL=localization.localizationData.isRtl};return e})(); var localizationData={isRtl:false,stringsDictionary:{_decimalSymbol:".",_digitGroupingSymbol:",",_shortDate:"m/d/yyyy",_longDate:"mmmm dd, yyyy",_fullDate:"dddd, mmmm dd, yyyy",_shortTime:"h:MMTT",_longTime:"h:MM:ss tt",_dateTime:"m/d/yyyy h:MM:ss tt",_day1:"Sunday",_day2:"Monday",_day3:"Tuesday",_day4:"Wednesday",_day5:"Thursday",_day6:"Friday",_day7:"Saturday",_day1s:"Sun",_day2s:"Mon",_day3s:"Tue",_day4s:"Wed",_day5s:"Thu",_day6s:"Fri",_day7s:"Sat",_month1:"January",_month2:"February",_month3:"March",_month4:"April",_month5:"May",_month6:"June",_month7:"July",_month8:"August",_month9:"September",_month10:"October",_month11:"November",_month12:"December",_month1s:"Jan",_month2s:"Feb",_month3s:"Mar",_month4s:"Apr",_month5s:"May",_month6s:"Jun",_month7s:"Jul",_month8s:"Aug",_month9s:"Sep",_month10s:"Oct",_month11s:"Nov",_month12s:"Dec",_firstDayOfWeek:"1",ButtonOk:"OK",ButtonCancel:"Cancel",ButtonClose:"Close",ButtonRetry:"Retry",PushNotificationTitle:"Notification",DialogMessageFailGetAppNormal:"Failed to load application data.\n\nYou must connect to a Wi-Fi or cellular data network to access this data.",DialogMessageFailGetAppDisabled:"We're sorry, this app has been temporarily disabled due to a content violation.\n\nPlease check on this app again in a few days.",DialogMessageFailGetAppId:"Please check your application\ncode and try again",DialogMessageFailGetServiceMap:"Failed to initialize network communication",DialogMessageFacebookLogoutFail:"Unable to log out from Facebook at the moment\nPlease try again later",DialogMessageMediaNotSupported:"Audio is not supported by the browser",DialogCaptionError:"Error",DialogCaptionSuccess:"Success",DialogCaptionConfirm:"Confirm",SSecondsAgo:"seconds ago",SSecondAgo:"a second ago",SNumberSecondsAgo:"{number} seconds ago",SMinuteAgo:"a minute ago",SNumberMinutesAgo:"{number} minutes ago",SHourAgo:"an hour ago",SNumberHoursAgo:"{number} hours ago",SDayAgo:"a day ago",SNumberDaysAgo:"{number} days ago",SWeekAgo:"a week ago",SNumberWeeksAgo:"{number} weeks ago",SMonthAgo:"a month ago",SNumberMonthsAgo:"{number} months ago",SYearAgo:"a year ago",SNumberYearsAgo:"{number} years ago",IndicatorLoading:"Loading...",HtmlTextMorePages:"More",DialogMessageLeaveWarning:"You are about to leave the app.\n\nPress OK to continue.",DialogCaptionNavigate:"Navigate",DialogMessageAlbumAddedToFavorites:"Album's tracks added to favorites",DialogMessageFacebookRequiresPermissions:"This action requires permissions",DialogCaptionShare:"Share",DialogCaptionShareControlDialog:"Share on",DialogCaptionFacebook:"Facebook",DialogCaptionTwitter:"Twitter",DialogCaptionEmail:"Email",DialogCaptionFacebookLogout:"Facebook Logout",DialogCaptionFacebookLogin:"Facebook Login",DialogCaptionTwitterLogout:"Twitter Logout",DialogCaptionTwitterLogin:"Twitter Login",DialogCaptionAddedToFavorites:"Add to favorites",DialogCaptionFacebookRequiresPermissions:"Facebook",TitleShareVia:"Share via",IndicatorShareLogOut:"Log out...",IndicatorSharePublishing:"Publishing...",HtmlTextShareTwitterChangeUserButton:"change user",HtmlTextShareFacebookChangeUserButton:"change user",HtmlTextShareTwitterWriteCommentPlaceholder:"Write your comment",HtmlTextShareFacebookWriteCommentPlaceholder:"Write your comment",HtmlTextShareChangeUserName:"not {name}?",HtmlTextAddAlbumToFavorites:"Add tracks to your favorites list now",HtmlTextAddTrackToFavorites:"Add track to your favorites list now",HtmlTextRemoveTrackFromFavorites:"Remove track from your favorites list now",SShareFavoritesPlaylistTitle:"I'v created my favorites playlist!",SShareTweetedFromLink:"tweeted from {appLink}",SShareMobileApp:"mobile app",SShareMailApplinkHtml:"Shared from my: {htmlLink}",SShareMailApplinkSimple:"Shared from my mobile app: {appLink}",SShareFromMobile:"shared from my mobile app",SShareFromMobileWithLink:"Shared from my mobile app {appLink}",SShareEmailLink:"Read more",SShareMailPowerByBrand:"Powered by {brand}",SShareAppMailBody:"Hey,\nCheck out the {appName} mobile app that i just used!",SShareAppMailSubject:"Check out this great new app!",SSharePhotoSubject:"Look at this awesome pic!",SSharePhotoSubjectWithTitle:"Look at this awesome pic: {title}",DialogMessageShareFailConectTwitter:"Sorry, failed to connect Twitter service, please try again shortly.",DialogMessageShareFailConectFacebook:"Sorry, failed to connect Facebook service, please try again shortly.",DialogMessageShareFailPostFacebook:"Sorry, failed to post. Facebook is not responding.",DialogMessageShareFailTweet:"Failed to tweet",HtmlTextViewOriginalPageBtnText:"View Original Version",HtmlTextCommentDialogButtonOk:"Post on Facebook",HtmlTextCommentDialogButtonOkShort:"Post",HtmlTextCommentDialogTitle:"Comment",HtmlTextCommentDialogButtonCancel:"Cancel",HtmlTextCommentDialogPlaceholder:"write something...",HtmlTextInputPanelButtonSendMessage:"Send",HtmlTextInputPanelPlaceholder:"write something...",HtmlTextChatHeaderChattingWith:"Chatting with",HtmlTextLoginOverlayTitle:"Login to start networking",HtmlTextLoginOverlayLogin:"Login",HtmlTextDatePickerDialogButtonOk:"OK",HtmlTextDatePickerDialogButtonCancel:"Cancel",HtmlTextDatePickerDialogButtonClear:"Clear",HtmlTextMapLoading:"Loading...",HtmlTextShareButtonText:"Share",HtmlTextPurchaseItemBuy:"Buy",HtmlTextPurchaseItemBuyAlbum:"Buy Album",DialogCaptionPurchaseChooseMethod:"Purchase:",DialogMessagePurchaseFail:"Purchase failed, please try again shortly.  If you run into any additional problems, feel free to contact us.",HtmlTextPaginationShowMoreItems:"Show more...",HtmlTextPaginationLoadingItems:"Loading...",HtmlTextPaginationRefreshItems:"Loading...",ToastMessagePaginationFailedGetItems:"failed to get data",ToastMessageTrackAddedToFavorites:"Track added to favorites",ToastMessageTrackRemovedFromFavorites:"Track removed from favorites",DialogMessageAudioNotSupportedDevice:"Your device doesn't support HTML5 audio",DialogMessageAudioNotSupportedSimulator:"Your browser (of the simulator) doesn't support audio",DialogMessageAudioTypeNotSupportedDevice:"Your device doesn't support playing this type of audio file",DialogMessageAudioTypeNotSupportedSimulator:"Your browser (of the simulator) doesn't support playing this type of audio file",ToastMessageAudioInitFail:"Failed to initiate the audio player",HtmlTextAudioDetails:"Details",HtmlTextAudioTrackNumber:"Track {number}",HtmlTextAudioVocals:"Vocals",HtmlTextAudioWriters:"Writers",HtmlTextAudioLyrics:"Lyrics",HtmlTextBlogShowMorePosts:"Show more",HtmlTextBlogLoadingPosts:"Loading...",HtmlTextBlogViewOriginalPost:"view original post",HtmlTextBlogViewOriginalSite:"view original site",HtmlTextBlogbyAuthor:"by {author}",ToastMessageBlogFailedGetPosts:"failed to get posts",HtmlTextInstagramUserLikePhoto:"Like this",HtmlTextInstagramPhotosCount:"photos",HtmlTextInstagramLikes:"Likes",HtmlTextInstagramComments:"Comments",HtmlTextInstagramFollowersCount:"followers",HtmlTextInstagramFollowingCount:"following",HtmlTextInstagramPrivateUserMainText:"This is a private user",HtmlTextInstagramPrivateUserSecondaryText:"Cannot view this page",SFacebookShareEmailSubject:"Check out this post from {user} Facebook page",SFacebookShareTwitterFrom:" from {user} Facebook wall",HtmlTextFacebookPageLikesCount:"like this",HtmlTextFacebookShowMorePosts:"Show more posts",HtmlTextFacebookLoadingPosts:"Loading posts...",HtmlTextFacebookPostCommentsCount:"{number} comments",HtmlTextFacebookAddCommentButton:"Comment",HtmlTextFacebookLikePostButton:"Like",HtmlTextFacebookUnikePostButton:"Unlike",HtmlTextFacebookLikeComment:"Like",HtmlTextFacebookUnikeComment:"Unlike",HtmlTextFacebookPostLikesCount:"{number} people like this",HtmlTextFacebookPostLikesCountIncludeYou:"You and {number} others like this",HtmlTextFacebookPostLikesOnlyYou:"You like this",ToastMessageFacebookFailedGetComments:"failed to get data",HtmlTextQuizStartQuizButton:"Start the Quiz",HtmlTextQuizQuestionPosition:"{index} of {total}",HtmlTextQuizHowManyCorrect:"You answered on {count} correct",HtmlTextQuizRetryButton:"Replay the quiz",SQuizShareTitle:"I played the quiz: {title}",SQuizShareBody:"I played the quiz: {title}, and my grade is: {grade}",DialogMessageFormSendSuccess:"Data sent",DialogMessageFormSendFail:"Failed to send data",HtmlTextFormSendButton:"Submit",ToastMessageFormFieldMandatory:"Field {fieldName} can't be empty",DialogMessageLiveAlbumCameraNotSupported:"Camera is not supported",DialogMessageLiveAlbumTakePhotoFailed:"Take photo failed ({message})",DialogMessageLiveAlbumPostPhotoFailed:"Post photo failed",ToastMessageLiveAlbumPublishingPhoto:"Image was uploaded successfully, stream will be updated shortly.",IndicatorLiveAlbumPostingImage:"Posting Image...",HtmlTextLiveAlbumByUploader:"by {name}",HtmlTextLiveAlbumPhotos:"photos",HtmlTextLiveAlbumShareCheckbox:"Share on Facebook",HtmlTextLiveAlbumNoImages:"BE THE FIRST TO POST A PHOTO",HtmlTextLiveAlbumLoadingAlbum:"Loading...",HtmlTextLiveAlbumLoadingImage:"Loading...",HtmlTextLiveAlbumLoadingShowMore:"Loading...",HtmlTextLiveAlbumShowMore:"Show more",HtmlTextLiveAlbumErrorLoadingImage:"Unable to load image",HtmlTextLiveAlbumFacebookLoginLiveAlbum:"LiveAlbum",HtmlTextLiveAlbumFacebookLogin:"Share your photos with your friends on facebook",HtmlTextLiveAlbumFacebookLoginComment:"(requires that you connect to your facebook account)",HtmlTextLiveAlbumEula:"Terms of Use",HtmlTextLiveAlbumAddComment:"add comment",HtmlTextLiveAlbumUploadingImage:"Uploading Image...",HtmlTextLiveAlbumUploadingFailed:"Failed uploading image",HtmlTextLiveAlbumUploadedByYou:"You",DialogCaptionLiveAlbumPostPhoto:"Post Photo",DialogButtonLiveAlbumPostPhotoOk:"post",DialogButtonLiveAlbumPostPhotoCancel:"cancel",DialogButtonLiveAlbumChoosePhotoChoose:"Choose photo",DialogButtonLiveAlbumChoosePhotoTake:"Take photo",DialogButtonLiveAlbumChoosePhotoCancel:"Cancel",UploadStatusLiveAlbumImageUploading:"Uploading image",UploadStatusLiveAlbumImageSent:"Image sent ",UploadStatusLiveAlbumProcessFailed:"Process failed",SLivePersonUserName:"me",DialogMessageLivePersonNoAnswer:"There was no answer. Try again later",DialogMessageLivePersonErrorClosing:"Error in closing chat",DialogMessageLivePersonNoAvailability:"Account is offline",HtmlTextLivePersonStart:"Start",HtmlTextLivePersonEnd:"End",HtmlTextLivePersonSend:"Send",HtmlTextLivePersonInputPlaceholder:"Write a message...",HtmlTextLivePersonStatusInit:"To initiate a chat session click:",HtmlTextLivePersonStatusChatting:"Chatting with {agentName}",HtmlTextLivePersonStatusCheckingAvailability:"Checking availability...",HtmlTextLivePersonStatusCheckingAvailabilityMinorText:"connecting",HtmlTextLivePersonStatusClosingChat:"Closing chat...",HtmlTextLivePersonStatusWaitingAgent:"Waiting for an agent...",HtmlTextLivePersonStatusWaitingAgentMinorText:"calling",HtmlTextLivePersonStatusAgentTyping:"{agentName} is typing...",DialogCaptionLivePersonChatEnded:"Chat ended",DialogCaptionLivePersonNoAvailability:"No Availability",DialogCaptionLivePersonTimeOut:"Time Out",HtmlTextAgendaSpeakersCount:"{number} Speakers",HtmlTextAgendaOneSpeaker:"Speaker",HtmlTextAgendaSessionDetails:"Details",HtmlTextAgendaAddToFav:"Add to Fav",HtmlTextAgendaRemoveFromFav:"Remove from Fav",DialogMessageAgendaNoFav:"There are no sessions in your favorites-list.",DialogCaptionAgendaNoFav:"Favorites",SAgendaShareSession:"I'm in the session: {sessionTitle}",HtmlTextPhotosImagesCount:"{number} photos",HtmlTextPhotosNoImages:"Empty album",HtmlTextPhotosImagesCountTitle:"photos",DialogMessagePollAreYouSureVote:'Are you sure that you want to vote to: "{text}"',DialogMessagePollVoteFail:"Failed to vote, please try again later.",DialogMessagePollVoteSuccess:"Thank you for your vote!",HtmlTextPollVoteButton:"Vote",HtmlTextReviewsReviewsCount:"{number} Reviews on {provider}",HtmlTextReviewsByAuthor:"by {name}",HtmlTextReviewsLoadingProvider:"Loading...",HtmlTextReviewsReadMoreLink:"Read more",SRssShareEmailSubject:"Check out this article from {title}",SRssShareTwitterFrom:" from {title}",DialogMessageSubscribeSubscribeSuccess:"Thank you for subscribing",DialogMessageSubscribeFailed:"Subscription not available right now. Please try again later",HtmlTextSubscribeUnknownButton:"Unknown",HtmlTextSubscribeFacebookButton:"Facebook",HtmlTextSubscribeTwitterButton:"Twitter",HtmlTextSubscribeLinkedInButton:"LinkedIn",HtmlTextSubscribeSubscribeButton:"Subscribe",HtmlTextSubscribeFollowBlogTitle:"Follow {blogTitle}",HtmlTextSubscribeDiscoverString:"Discover us on these sites",HtmlTextSubscribeSubscribeString:"Subscribe to {blogTitle}",HtmlTextSubscribeInsetYourEmail:"your@email.com",HtmlTextSubscribeLoading:"Subscribing...",ToastMessageSubscribeInsetEmail:"Email is required",ToastMessageSubscribeInvalidEmail:"Please enter a valid email address",DialogCaptionSubscribeSuccess:"Success",DialogCaptionSubscribeFail:"Error",HtmlTextTwitterFollowers:"Followers",HtmlTextTwitterTweets:"Tweets",HtmlTextTwitterFollowButton:"Follow",HtmlTextTwitterUnfollowButton:"Unfollow",HtmlTextTwitterRetweet:"by {retweeterName}",HtmlTextTwitterRetweetDetails:"retweeted by",STwitterShareEmailSubject:"Check out this tweet from @{name}",HtmlTextTwitterShowMoreTweets:"Show more tweets",HtmlTextTwitterLoadingTweets:"Loading tweets...",HtmlTextYoutubeViewsCount:"{number} views",HtmlTextYoutubeByAuthor:"by {author}",HtmlTextYoutubeViews:"{views} Views",SYoutubeShareTitle:"Check out this video - {title}",HtmlTextLinkStaticTextIfCantOpenSafari:"Tap the buttons to use this cool app!",HtmlTextEventsPastEvents:"Past Events",HtmlTextEventsFutureEvents:"Upcoming Events",HtmlTextEventsVenueStr:"Venue",HtmlTextEventsLocationStr:"Location",HtmlTextEventsPhoneNumberStr:"Phone Number",HtmlTextEventsTicketStr:"Ticket",HtmlTextEventsRsvpButton:"Join",HtmlTextEventsRsvpAttending:"Attending",HtmlTextEventsRsvpMaybe:"Maybe",HtmlTextEventsRsvpDecline:"Decline",HtmlTextEventsNoEventsStr:"There are currently no events to display",HtmlTextShowOnMapButtonStr:"Map",HtmlTextEventsAdd2CalStr:"Calendar",HtmlTextContactUsWebSiteStr:"Web Site",HtmlTextContactUsAddressStr:"Address",HtmlTextContactUsPhoneNumberStr:"Phone Number",HtmlTextContactUsFaxNumberStr:"Fax Number",HtmlTextContactUsCallNowStr:"Call Now",HtmlTextContactUsCallStr:"Call",HtmlTextContactUsFaxStr:"Fax",HtmlTextContactUsEmailStr:"Email",HtmlTextContactUsLinkStr:"Link",HtmlTextContactUsMapStr:"Map",HtmlTextContactUsContactUsStr:"Contact Us",HtmlTextSpeakersBioTitle:"Speaker's Bio",HtmlTextFavoritesShareButton:"Share",HtmlTextFavoritesEditButton:"Edit",HtmlTextFavoritesDoneButton:"Done",HtmlTextFavoritesCancelButton:"Cancel",HtmlTextFavoritesBuyButton:"Buy",HtmlTextFavoritesNoFavsStr1:"No tracks added",HtmlTextFavoritesNoFavsStr2:"Add tracks to your favorites list",DialogCaptionPhotosManagerDeviceNotSupported:"Your device does not support the photo gallery view",PhotoGalleryPreparingToShare:"Preparing to share...",HtmlTextLinksDescriptionTitle:"Description",HtmlTextAboutUsItemTitleGenre:"Genre",HtmlTextAboutUsItemTitleFounded:"Founded",HtmlTextAboutUsItemTitleMembers:"Members",HtmlTextAboutUsItemTitleHometown:"Hometown",HtmlTextAboutUsItemTitleBiography:"Biography",HtmlTextAboutUsItemTitleRecordLabel:"Record Label",HtmlTextAboutUsItemTitleHours:"Hours",HtmlTextAboutUsItemTitleServices:"Services",HtmlTextAboutUsItemTitleAwards:"Awards",HtmlTextAboutUsItemTitleParking:"Parking",HtmlTextAboutUsItemTitleProducts:"Products",HtmlTextAboutUsItemTitleMission:"Mission",HtmlTextAboutUsItemTitleManager:"Manager",HtmlTextAboutUsItemTitleBookingAgent:"Booking Agent",HtmlTextAboutUsItemTitleSpecialties:"Specialties",HtmlTextAboutUsItemTitleCulinaryTeam:"Culinary Team",HtmlTextAboutUsItemTitleGeneralInfo:"General Info",HtmlTextAboutUsItemTitleCompanyOverview:"Company Overview",HtmlTextAboutUsItemHoursAlwaysOpen:"Always Open",HtmlTextAboutUsItemHoursNoHours:"No available hours",HtmlTextAboutUsInfoVersion:"Version {versionName}",HtmlTextAboutUsReadMore:"read more",HtmlTextAboutUsListItemReadMore:"read more",HtmlTextAboutUsDescriptionTitle:"Description",SShareApp:"Check out the {appName} mobile app that i just used!",HtmlTextShareAppButtonText:"Share App with my friends",HtmlTextAboutUsInfoPrivacyPolicy:'By downloading, accessing and/or using the App in any manner, you agree to be bound by these <a hred="http://mobile.conduit.com/eula.aspx">Terms and Conditions</a> and <a href="http://mobile.conduit.com/privacypolicy.aspx">Privacy Policy</a>',HtmlTextCouponsTitleOffer:"Special Offer",HtmlTextCouponsPriceOff:"OFF",HtmlTextCouponsTitleSpecialDiscount:"Special Discount",HtmlTextCouponsTitleOriginalPrice:"Original Price",HtmlTextCouponsTitleNewPrice:"New Price",HtmlTextCouponsTitleDiscount:"Discount",HtmlTextCouponsTitleSaving:"Savings",HtmlTextCouponsTitleDealDetails:"Deal Details",HtmlTextCouponsValidFrom:"Start",HtmlTextCouponsValidUntil:"End",HtmlTextCouponsTermsTitle:"terms & conditions",HtmlTextCouponsTitleValidity:"Validity",ToastMessageCouponsClaimSuccess:"Now you can use this coupon",HtmlTextCouponsClaimButton:"Click to claim coupon",HtmlTextCouponsCouponClaimed:"Coupon claimed",HtmlTextCouponsExpired:"EXPIRED",CouponsNoResultsFound:"No coupons available",CouponsNoResultsFoundSubtitle:"Check out again at another time",HtmlTextCouponsShareDefaultOfferTitle:"Great coupon",HtmlTextCouponsShareTitle:"Look at this awesome offer!",HtmlTextCouponsShareDescription:'Check out the awesome deal I got through {appName} mobile app: "{offerTitle}"',HtmlTextLoyaltyCardsDefaultFreebieName:"freebie",HtmlTextLoyaltyCardsTitleOffer:"Special Offer",HtmlTextLoyaltyCardsValidFrom:"Start",HtmlTextLoyaltyCardsValidUntil:"End",HtmlTextLoyaltyCardsShowMoreButton:"info",HtmlTextLoyaltyCardsExpired:"EXPIRED",HtmlTextLoyaltyCardsComingSoon:"Coming soon",HtmlTextLoyaltyCardsShareWinTitle:"I just filled up my {cardName} loyalty card and got a FREE {freebieName}! Get the {appName} mobile app and start collecting your freebies!",HtmlTextLoyaltyCardsShareWinTwitterTitle:"I just filled up my loyalty card on the {appName} mobile app and got a freebie! Check it out",HtmlTextLoyaltyCardsShareWinEmailTitle:"Wanna get free stuff?",HtmlTextLoyaltyCardsShareWinEmailText:"Hey,\nI just filled up my {cardName} loyalty card and got a FREE {freebieName}! Get the {appName} app and start collecting stamps on your loyalty card to get rewards, too. It pays to be a loyal customer! ?",HtmlTextLoyaltyCardsShareTitle:"Im on my way to getting some free stuff thanks to my {cardName} loyalty card. Get the {appName} mobile app and you can start collecting rewards too!",HtmlTextLoyaltyCardsShareTwitterTitle:"Im about to get free stuff using my {appName} mobile app! Download it and start earning rewards too!",HtmlTextLoyaltyCardsShareEmailTitle:"Wanna get free stuff, too?",HtmlTextLoyaltyCardsShareEmailText:"Hey,\nIm using this really cool loyalty card and Im on my way to getting a FREE {freebieName}!",HtmlTextLoyaltyCardsValidityTitle:"Validity",HtmlTextLoyaltyCardsInfoTitle:"Card Info",HtmlTextLoyaltyCardsInfoButtonCancel:"Close",HtmlTextLoyaltyCardsOnlyNativeTitle:"Get your freebie!",HtmlTextLoyaltyCardsOnlyNativeText:"Download our app to start collecting stamps and earn rewards",HtmlTextLoyaltyCardsOnlyNativeDownloadButton:"Download Now!",HtmlTextLoyaltyCardsNoItemsTitle:"No loyalty cards available",HtmlTextLoyaltyCardsNoItemsText:"Check back again soon!",HtmlTextLoyaltyCardsDialogButtonOk:"Stamp Card",HtmlTextLoyaltyCardsDialogButtonCancel:"Cancel",HtmlTextLoyaltyCardsDialogPlaceholder:"Enter Code",HtmlTextLoyaltyCardsDialogPlaceholderLocked:"Locked",HtmlTextLoyaltyCardsDialogStampCaption:"Stamp Card",HtmlTextLoyaltyCardsDialogCongratsCaption:"Congrats!",HtmlTextLoyaltyCardsDialogCongratsSuccessCaption:"Congrats!",HtmlTextLoyaltyCardsDialogNormalText:"Please hand your device to the cashier to stamp your device",HtmlTextLoyaltyCardsDialogMidFreebieText:"Please hand your device to the cashier to stamp your device and get a free {freebie}",HtmlTextLoyaltyCardsDialogFreebieText:"You've earned your freebie {freebie}",HtmlTextLoyaltyCardsDialogFreebieSuccessText:"You've redeemed your freebie {freebie}",HtmlTextLoyaltyCardsDialogServiceCoolDownText:"Uh oh! That was one too many attempts. For security purposes, this card will be blocked for {hours} hours",HtmlTextLoyaltyCardsDialogLoading:"Verifying code...",HtmlTextLoyaltyCardsDialogServiceFailText:"Service is unavailable. try again later.",HtmlTextLoyaltyCardsDialogWrongCodeText:"Wrong code",HtmlTextLoyaltyCardsDialogLimitPerDayText:"Sorry, the daily stamp limit for this card is {punchesPerDay}. Please come back tomorrow!",HtmlTextMyProfileLogoutFromLinkedin:"Logout from LinkedIn",HtmlTextMyProfileLogoutButton:"Sign Out",ErrorHandleTitle:"Failed to retrieve data",ErrorHandleSubTitle:"There might be a problem with the connection to the server",ErrorHandleReloadButtonTitle:"Reload",HtmlTextInboxNoMessagesStr:"No messages",ReportsInvalidFormPopupTitle:"Can't send the form",ReportsMandatoryMessage:"Some fields are mandatory",ReportsInvalidInputMessage:"{name} is a mandatory field",ReportsInvalidValueMessage:"{name} is not in correct format",ReportsTemplateDefaultSubmitCaption:"Submit",ReportsInvalidEmail:"Invalid email",ReportsSavedSuccessfullyMessage:"Sent Successfully",ReportsSavedSuccessfullySubtitleMessage:"Thank You! Your report has been sent successfully.",ReportsSaveFailedMessage:"Send Failed",ReportsSaveFailedSubtitleMessage:"We are sorry. We failed to save your report, please try again.",ReportsSavingMessage:"Sending...",ReportsShowMyLocationMessage:"Show my location in the report",ReportsFailedToDetermineLocation:"Failed to determine your location. Please make sure your GPS device is on.",StateNotSpecified:"State",StateNonUS:"Non US",StateAlabama:"Alabama",StateAlaska:"Alaska",StateArizona:"Arizona",StateArkansas:"Arkansas",StateCalifornia:"California",StateColorado:"Colorado",StateConnecticut:"Connecticut",StateDelaware:"Delaware",StateFlorida:"Florida",StateGeorgia:"Georgia",StateHawaii:"Hawaii",StateIdaho:"Idaho",StateIllinois:"Illinois",StateIndiana:"Indiana",StateIowa:"Iowa",StateKansas:"Kansas",StateKentucky:"Kentucky",StateLouisiana:"Louisiana",StateMaine:"Maine",StateMaryland:"Maryland",StateMassachusetts:"Massachusetts",StateMichigan:"Michigan",StateMinnesota:"Minnesota",StateMississippi:"Mississippi",StateMissouri:"Missouri",StateMontana:"Montana",StateNebraska:"Nebraska",StateNevada:"Nevada",StateNewHampshire:"New Hampshire",StateNewJersey:"New Jersey",StateNewMexico:"New Mexico",StateNewYork:"New York",StateNorthCarolina:"North Carolina",StateNorthDakota:"North Dakota",StateOhio:"Ohio",StateOklahoma:"Oklahoma",StateOregon:"Oregon",StatePennsylvania:"Pennsylvania",StateRhodeIsland:"Rhode Island",StateSouthCarolina:"South Carolina",StateSouthDakota:"South Dakota",StateTennessee:"Tennessee",StateTexas:"Texas",StateUtah:"Utah",StateVermont:"Vermont",StateVirginia:"Virginia",StateWashington:"Washington",StateWestVirginia:"West Virginia",StateWisconsin:"Wisconsin",StateWyoming:"Wyoming",CountryNotSpecified:"Country",CountryAfghanistan:"Afghanistan",CountryAlbania:"Albania",CountryAlgeria:"Algeria",CountryAndorra:"Andorra",CountryAngola:"Angola",CountryAntiguaandBarbuda:"Antigua and Barbuda",CountryArgentina:"Argentina",CountryArmenia:"Armenia",CountryAustralia:"Australia",CountryAustria:"Austria",CountryAzerbaijan:"Azerbaijan",CountryBahamas:"Bahamas",CountryBahrain:"Bahrain",CountryBangladesh:"Bangladesh",CountryBarbados:"Barbados",CountryBelarus:"Belarus",CountryBelgium:"Belgium",CountryBelize:"Belize",CountryBenin:"Benin",CountryBhutan:"Bhutan",CountryBolivia:"Bolivia",CountryBosniaHerzegovina:"Bosnia Herzegovina",CountryBotswana:"Botswana",CountryBrazil:"Brazil",CountryBrunei:"Brunei",CountryBulgaria:"Bulgaria",CountryBurkina:"Burkina",CountryBurundi:"Burundi",CountryCambodia:"Cambodia",CountryCameroon:"Cameroon",CountryCanada:"Canada",CountryCapeVerde:"Cape Verde",CountryCentralAfricanRep:"Central African Rep",CountryChad:"Chad",CountryChile:"Chile",CountryChina:"China",CountryColombia:"Colombia",CountryComoros:"Comoros",CountryCongo:"Congo",CountryCostaRica:"Costa Rica",CountryCroatia:"Croatia",CountryCuba:"Cuba",CountryCyprus:"Cyprus",CountryCzechRepublic:"Czech Republic",CountryDenmark:"Denmark",CountryDjibouti:"Djibouti",CountryDominica:"Dominica",CountryDominicanRepublic:"Dominican Republic",CountryEastTimor:"East Timor",CountryEcuador:"Ecuador",CountryEgypt:"Egypt",CountryElSalvador:"El Salvador",CountryEquatorialGuinea:"Equatorial Guinea",CountryEritrea:"Eritrea",CountryEstonia:"Estonia",CountryEthiopia:"Ethiopia",CountryFiji:"Fiji",CountryFinland:"Finland",CountryFrance:"France",CountryGabon:"Gabon",CountryGambia:"Gambia",CountryGeorgia:"Georgia",CountryGermany:"Germany",CountryGhana:"Ghana",CountryGreece:"Greece",CountryGrenada:"Grenada",CountryGuatemala:"Guatemala",CountryGuinea:"Guinea",CountryGuyana:"Guyana",CountryHaiti:"Haiti",CountryHonduras:"Honduras",CountryHungary:"Hungary",CountryIceland:"Iceland",CountryIndia:"India",CountryIndonesia:"Indonesia",CountryIran:"Iran",CountryIraq:"Iraq",CountryIreland:"Ireland",CountryIsrael:"Israel",CountryItaly:"Italy",CountryIvoryCoast:"Ivory Coast",CountryJamaica:"Jamaica",CountryJapan:"Japan",CountryJordan:"Jordan",CountryKazakhstan:"Kazakhstan",CountryKenya:"Kenya",CountryKiribati:"Kiribati",CountryKoreaNorth:"Korea North",CountryKoreaSouth:"Korea South",CountryKosovo:"Kosovo",CountryKuwait:"Kuwait",CountryKyrgyzstan:"Kyrgyzstan",CountryLaos:"Laos",CountryLatvia:"Latvia",CountryLebanon:"Lebanon",CountryLesotho:"Lesotho",CountryLiberia:"Liberia",CountryLibya:"Libya",CountryLiechtenstein:"Liechtenstein",CountryLithuania:"Lithuania",CountryLuxembourg:"Luxembourg",CountryMacedonia:"Macedonia",CountryMadagascar:"Madagascar",CountryMalawi:"Malawi",CountryMalaysia:"Malaysia",CountryMaldives:"Maldives",CountryMali:"Mali",CountryMalta:"Malta",CountryMarshallIslands:"Marshall Islands",CountryMauritania:"Mauritania",CountryMauritius:"Mauritius",CountryMexico:"Mexico",CountryMicronesia:"Micronesia",CountryMoldova:"Moldova",CountryMonaco:"Monaco",CountryMongolia:"Mongolia",CountryMontenegro:"Montenegro",CountryMorocco:"Morocco",CountryMozambique:"Mozambique",CountryMyanmar:"Myanmar",CountryNamibia:"Namibia",CountryNauru:"Nauru",CountryNepal:"Nepal",CountryNetherlands:"Netherlands",CountryNewZealand:"New Zealand",CountryNicaragua:"Nicaragua",CountryNiger:"Niger",CountryNigeria:"Nigeria",CountryNorway:"Norway",CountryOman:"Oman",CountryPakistan:"Pakistan",CountryPalau:"Palau",CountryPanama:"Panama",CountryPapuaNewGuinea:"Papua New Guinea",CountryParaguay:"Paraguay",CountryPeru:"Peru",CountryPhilippines:"Philippines",CountryPoland:"Poland",CountryPortugal:"Portugal",CountryQatar:"Qatar",CountryRomania:"Romania",CountryRussianFederation:"Russian Federation",CountryRwanda:"Rwanda",CountryStKittsNevis:"St Kitts & Nevis",CountryStLucia:"St Lucia",CountrySaintVincent:"Saint Vincent",CountrySamoa:"Samoa",CountrySanMarino:"San Marino",CountrySaoTome:"Sao Tome",CountrySaudiArabia:"Saudi Arabia",CountrySenegal:"Senegal",CountrySerbia:"Serbia",CountrySeychelles:"Seychelles",CountrySierraLeone:"Sierra Leone",CountrySingapore:"Singapore",CountrySlovakia:"Slovakia",CountrySlovenia:"Slovenia",CountrySolomonIslands:"Solomon Islands",CountrySomalia:"Somalia",CountrySouthAfrica:"South Africa",CountrySouthSudan:"South Sudan",CountrySpain:"Spain",CountrySriLanka:"Sri Lanka",CountrySudan:"Sudan",CountrySuriname:"Suriname",CountrySwaziland:"Swaziland",CountrySweden:"Sweden",CountrySwitzerland:"Switzerland",CountrySyria:"Syria",CountryTaiwan:"Taiwan",CountryTajikistan:"Tajikistan",CountryTanzania:"Tanzania",CountryThailand:"Thailand",CountryTogo:"Togo",CountryTonga:"Tonga",CountryTrinidadTobago:"Trinidad & Tobago",CountryTunisia:"Tunisia",CountryTurkey:"Turkey",CountryTurkmenistan:"Turkmenistan",CountryTuvalu:"Tuvalu",CountryUganda:"Uganda",CountryUkraine:"Ukraine",CountryUnitedArabEmirates:"United Arab Emirates",CountryUnitedKingdom:"United Kingdom",CountryUnitedStates:"United States",CountryUruguay:"Uruguay",CountryUzbekistan:"Uzbekistan",CountryVanuatu:"Vanuatu",CountryVaticanCity:"Vatican City",CountryVenezuela:"Venezuela",CountryVietnam:"Vietnam",CountryYemen:"Yemen",CountryZambia:"Zambia",CountryZimbabwe:"Zimbabwe",GenderNotSpecified:"Gender",GenderMale:"Male",GenderFemale:"Female",CollectionsSearchPlaceholder:"Search {category}",CollectionsSearchNoResultsFound:"No Results Found",CollectionsSearchNoResultsFoundSubtitle:"We did not find results for: <b>{query_string}</b> On <b>{node_name}</b>",CollectionsSearchNoItemsFound:"No Items Found",CollectionsSearchNoItemsFoundSubtitle:"{node_name} has no items",CollectionsBuyNow:"Buy Now",CollectionsCurrentPrice:"Current Price",CollectionsItemDetails:"Item Details",CollectionsContactUs:"Contact Us",CollectionsVisitUs:"Visit Us","CollectionsContactItem-Email":"Email","CollectionsContactItem-Facebook":"Facebook page","CollectionsContactItem-Linkedin":"LinkedIn","CollectionsContactItem-Twitter":"Twitter","CollectionsContactItem-Website":"Website",CollectionsCategoryItemsCount:"{count} items",CollectionsCategoryUnknownItemsCount:"Category",CollectionsSearchPlaceholder2:"enter your search here",SUnknownUserName:"[unknown]",SUserJobTitleFull:"{job_title} at {company}",UserSearchNoResultsFound:"No Results Found",UserSearchNoResultsFoundSubtitle:"We did not find users matching your query",UserSayHelloTo:"Say hello to {user_caption}",UserGoogle:"Google {user_caption}",AppsfireNotifications:"Notifications",SmartBannerInAppStore:"This App is available on the App Store",SmartBannerInGooglePlay:"This App is available on Google Play",SmartBannerButtonText:"Get It"}}; var AdsManager=(function(){var A={};A.AdSlotsEnum={BottomBanner:1,FullScreenPortrait:2,FullScreenLandscape:4,TopBanner:8};var q={};var c="ADS_POST";var v={};var z=[];var a={NONE:0,LOADING:1,DONE:2};var j=a.NONE;var k=null;var h=null;var u=[];var n=-1;var p=0;var f=0;var m=null;var s=false;var y=[];var o="FULL_SCREEN_AD";var l=null;A.getAdBarModel=function(){return k};A.getFullScreenAdModel=function(){return l};A.init=function(C){var B={keywords:null,settings:{}};C=_.extend({},B,C);q=C;if(q.settings.fullScreenAdEnabled){l=new FullScreenAdModel({timeout:q.settings.fullScreenAdTO})}if(q.settings.bottomBarAdEnabled){k=new AdBarModel()}var D=function(){if(q.settings.bottomBarAdEnabled){r()}};t(D)};A.stop=function(){clearInterval(h)};var x=function(){if(conduitApi.platform.storage.isSupported()){var B=conduitApi.platform.storage.getItem(null,null,o,true);if(B){y=JSON.parse(B)}}};var i=function(){if(conduitApi.platform.storage.isSupported()){var B=JSON.stringify(y);conduitApi.platform.storage.setItem(null,null,o,B,true)}};var t=function(D){if(j===a.DONE){Utils.Helpers.funcWrapper(D)();return}z.push(D);if(j===a.LOADING){return}j=a.LOADING;v={cId:null,slot:null,width:320,height:480,age:null,gender:null,mobileNumber:null,keywords:q.keywords,category:null,location:{latitude:0,longitude:0},locale:"en"};var B=function(E){if(typeof(E)!=="undefined"&&typeof(E.coords)!=="undefined"){v.location=E.coords}j=a.DONE;for(var F=0;F<z.length;F++){Utils.Helpers.funcWrapper(z.pop())()}};var C=function(E){if(typeof(E)!=="undefined"&&typeof(E.locale!=="undefined")){v.locale=E.language}if(true){B();return}if(PLATFORM===platformEnum.simulator||!conduitApi.platform.geo.isSupported()){B()}else{conduitApi.platform.geo.getLocation(B,B)}};if(conduitApi.platform.deviceInfo.isSupported()){conduitApi.platform.deviceInfo.getDeviceInfo(C,C)}else{C()}};var d=function(B){s=false;clearInterval(m);u=B;n=-1;p=0;w();var C=q.settings.bottomBarSwitchInterval;if(C){m=setInterval(w,C)}};var w=function(){var D=n;n++;if(n>=u.length){p++;if(p>=q.settings.adBarCycles){r()}n=0}var C=u[n];var B=(D!=n);if(C&&B){k.set(C)}};A.getFullScreenAd=function(D,C){x();if(y&&y.length){var B=y[0];if(B.expiredDate>new Date().getTime()){B.duration=q.settings.fullScreenAdDisplayDuration;D(B);return}}if(C){D(null)}else{g(D)}};var e=function(B){s=false};var b=function(E,D,C){E=_.extend({},v,E);var B={postParams:E,executeType:executeTypeEnum.FORCE_NETWORK};Services.executeService(c,null,D,C,B)};var r=function(B){if(s){return}s=true;var D=new Date().getTime();var C=D-f;if(q.settings.adBarMinInterval&&q.settings.adBarMinInterval>C){setTimeout(function(){s=false;r()},q.settings.adBarMinInterval-C);return}f=D;var E={cId:null,slot:A.AdSlotsEnum.BottomBanner,deviceId:UserManager.getUserId()};b(E,d,e)};var g=function(C){function D(E){if(E%180){var I=A.AdSlotsEnum.FullScreenLandscape}else{var I=A.AdSlotsEnum.FullScreenPortrait}var H={slot:I};var G=function(J){y=J;if(y&&y.length){if(!y[0].expiredDate){y[0].expiredDate=new Date().getTime()+1000*60*60*24}i();A.getFullScreenAd(C,true)}else{C(null)}};var F=function(J){C(null)};b(H,G,F)}function B(){C(null)}conduitApi.platform.orientation.getOrientation(D,B)};return A})(); var AdBarModel=Backbone.Model.extend({defaults:{link:"",text:""},adClicked:function(){if(this.get("link")){conduitApi.app.openLink(function(){},function(){},{useExternalBrowser:true,url:this.get("link"),title:this.get("text")||"Ad"});var a={url:this.get("link")};conduitApi.analytics.addEvent(null,null,conduitApi.analytics.usageEventTypeEnum.BannerClicked,a)}}}); var FullScreenAdModel=Backbone.Model.extend({stateEnum:{NONE:0,LOADING:1,ERROR:2,TIMEOUT:3,OK:4},readyCbs:[],defaults:{link:"",imageUrl:"",timeout:0},initialize:function(){this.set({state:this.stateEnum.LOADING});this.on("change:state",this._changeState,this);setTimeout(this._timeout.hitch(this),this.get("timeout"));this.getAdData()},getAdData:function(){AdsManager.getFullScreenAd(this.getAdDataDone.hitch(this))},getAdDataDone:function(a){if(a){this.set(a);this.getImageData()}else{this.set({state:this.stateEnum.ERROR})}},getImageData:function(){if((DEVICE===deviceTypeEnum.android||DEVICE===deviceTypeEnum.iphone)&&PLATFORM==platformEnum.nativeApp){navigator.ads.loadFullScreenAd(this._imageLoaded.hitch(this),this._imageError.hitch(this),this.get("imageUrl"))}else{var a=new Image();a.onload=this._imageLoaded.hitch(this);a.onerror=this._imageError.hitch(this);a.src=this.get("imageUrl")}},_timeout:function(){if(this.get("state")===this.stateEnum.LOADING){this.set({state:this.stateEnum.TIMEOUT})}},_imageLoaded:function(){this.set({state:this.stateEnum.OK})},_imageError:function(){this.set({state:this.stateEnum.ERROR})},ready:function(a){var b=this.get("state");if(b===this.stateEnum.ERROR||b===this.stateEnum.TIMEOUT){a(false)}else{if(b===this.stateEnum.OK){a(true)}else{this.readyCbs.push(a)}}},_changeState:function(){var b=this.get("state");for(var a=0;a<this.readyCbs.length;a++){if(b===this.stateEnum.ERROR||b===this.stateEnum.TIMEOUT||b===this.stateEnum.OK){this.ready(this.readyCbs.pop())}}},adClicked:function(){if(this.get("link")){conduitApi.app.openLink(function(){},function(){},{useExternalBrowser:true,url:this.get("link"),title:this.get("text")||"Ad"});var a={url:this.get("link")};conduitApi.analytics.addEvent(null,null,conduitApi.analytics.usageEventTypeEnum.BannerClicked,a)}}}); var InappPurchaseManager=(function(){var b={};var d={TransactionStart:0,TransactionComplete:1,TransactionVerificationFailed:2};var e="INAPP_USER_TRANSACTION_POST";var c={};var a={};b.init=function(o,m,k){var h=null;if(o&&o.buckets){h=o.buckets}if(!h||h.length===0){Utils.Helpers.funcWrapper(m)();return}var g="";var l=",";for(var j=0;j<h.length;j++){var n=h[j].id;$.each(h[j].items,function(p,q){q.bucketId=n});c=$.extend(c,h[j].items);a=$.extend(a,h[j].stores);g=g+n;if(j<h.length-1){g=g+l}}var f=function(){console.log("cbInitTokensSuccess");if(conduitApi.platform.inAppPurchase.isSupported()){for(var i in a){var p=a[i];if(p.name==="Logia"){conduitApi.platform.inAppPurchase.init(m,k,p.params);return}}}Utils.Helpers.funcWrapper(m)()};InappPurchaseTokens.init(g,f,k)};b.buyResource=function(h,o,k){if(!conduitApi.platform.inAppPurchase.isSupported()){Utils.Helpers.funcWrapper(k)("inAppPurchase driver not supported");return}var q=c[h];if(!q){Utils.Helpers.funcWrapper(k)("unknown resourcesId");return}var j=q.maps[0];var m=UserManager.getUserId();var p={};var r={userId:m,key:h,bucketId:q.bucketId,storeId:j.storeId,status:d.TransactionStart,payload:{}};var g={postParams:r};var l=function(s){};var n=function(s){};Services.executeService(e,p,l,n,g);var i=function(s){l=function(t){if(!(t&&t.token)){Utils.Helpers.funcWrapper(k)("no token from service",t);return}InappPurchaseTokens.setToken(h,t.token);Utils.Helpers.funcWrapper(o)(t)};n=function(t){Utils.Helpers.funcWrapper(k)("service fail",t)};r.status=d.TransactionComplete;r.payload.data=s;Services.executeService(e,p,l,n,g)};var f=function(s){r.status=d.TransactionVerificationFailed;r.payload.data=s;Services.executeService(e,p,l,n,g);Utils.Helpers.funcWrapper(k)("buy fail",s)};conduitApi.platform.inAppPurchase.purchase(i,f,j.itemId,m)};return b}()); var InappPurchaseTokens=(function(){var c={};var f="InappPurchaseTokens";var e={};c.init=function(i,g,h){d();a(i,g,h)};c.getAllTokens=function(g){return e};c.getToken=function(h){var g="";if(e[h]){g=e[h]}return g};c.setToken=function(h,g){e[h]=g;b()};var d=function(){if(conduitApi.platform.storage.isSupported()){var g=conduitApi.platform.storage.getItem(null,null,f,true);if(g){e=JSON.parse(g)}}};var b=function(){if(conduitApi.platform.storage.isSupported()){var g=JSON.stringify(e);conduitApi.platform.storage.setItem(null,null,f,g,true)}};var a=function(k,h,j){var g={bucketId:k,userId:UserManager.getUserId()};var l=function(r,n){var t={};var m=",";for(var p in r){var s=r[p];var q="";for(var o=0;o<s.length;o++){q+=s[o];if(o<s.length-1){q+=m}}t[p]=q}e=t;b();Utils.Helpers.funcWrapper(h)()};var i={};i.executeType=executeTypeEnum.FORCE_NETWORK;Services.executeService("INAPP_USER_TOKENS_GET",g,l,j,i)};return c}()); var ItemsTransformer=(function(){var a={};a.transformItem=function(f,b){b=b||{};var e=f;if(e&&e.originalItem){e=e.originalItem}if(!(e&&e.purchase&&e.purchase.resourceIds&&e.purchase.resourceIds.length>0)){return e}if(!conduitApi.platform.inAppPurchase.isSupported()){return null}for(var d=0;d<e.purchase.resourceIds.length;d++){var c=InappPurchaseTokens.getToken(e.purchase.resourceIds[d]);if(c){return e}}e.purchase.alt.originalItem=e;return e.purchase.alt};return a}()); /*
 * iScroll Lite base on iScroll v4.1.6 ~ Copyright (c) 2011 Matteo Spinelli, http://cubiq.org
 * Released under MIT license, http://cubiq.org/license
 */
(function(){var o=Math,s=(/webkit/i).test(navigator.appVersion)?"webkit":(/firefox/i).test(navigator.userAgent)?"Moz":"opera" in window?"O":"",j="WebKitCSSMatrix" in window&&"m11" in new WebKitCSSMatrix(),r="ontouchstart" in window,e=s+"Transform" in document.documentElement.style,h=(/iphone|ipad/gi).test(navigator.appVersion),c=(/playbook/gi).test(navigator.appVersion),f=h||c,l=(function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(m){return setTimeout(m,17)}})(),k=(function(){return window.cancelRequestAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||clearTimeout})(),g="onorientationchange" in window?"orientationchange":"resize",a=r?"touchstart":"mousedown",n=r?"touchmove":"mousemove",d=r?"touchend":"mouseup",q=r?"touchcancel":"mouseup",b="translate"+(j?"3d(":"("),i=j?",0)":")",p=function(u,m){var v=this,w=document,t;v.wrapper=typeof u=="object"?u:w.getElementById(u);v.wrapper.style.overflow="hidden";v.scroller=v.wrapper.children[0];v.options={hScroll:true,vScroll:true,x:0,y:0,bounce:true,bounceLock:false,momentum:true,lockDirection:true,useTransform:true,useTransition:false,onRefresh:null,onBeforeScrollStart:function(x){x.preventDefault()},onScrollStart:null,onBeforeScrollMove:null,onScrollMove:null,onBeforeScrollEnd:null,onScrollEnd:null,onTouchEnd:null,onDestroy:null};for(t in m){v.options[t]=m[t]}v.x=v.options.x;v.y=v.options.y;v.options.useTransform=e?v.options.useTransform:false;v.options.hScrollbar=v.options.hScroll&&v.options.hScrollbar;v.options.vScrollbar=v.options.vScroll&&v.options.vScrollbar;v.options.useTransition=f&&v.options.useTransition;v.scroller.style[s+"TransitionProperty"]=v.options.useTransform?"-"+s.toLowerCase()+"-transform":"top left";v.scroller.style[s+"TransitionDuration"]="0";v.scroller.style[s+"TransformOrigin"]="0 0";if(v.options.useTransition){v.scroller.style[s+"TransitionTimingFunction"]="cubic-bezier(0.33,0.66,0.66,1)"}if(v.options.useTransform){v.scroller.style[s+"Transform"]=b+v.x+"px,"+v.y+"px"+i}else{v.scroller.style.cssText+=";position:absolute;top:"+v.y+"px;left:"+v.x+"px"}v.refresh();v._bind(g,window);v._bind(a);if(!r){v._bind("mouseout",v.wrapper)}};p.prototype={enabled:true,x:0,y:0,steps:[],scale:1,handleEvent:function(t){var m=this;switch(t.type){case a:if(!r&&t.button!==0){return}m._start(t);break;case n:m._move(t);break;case d:case q:m._end(t);break;case g:m._resize();break;case"mouseout":m._mouseout(t);break;case"webkitTransitionEnd":m._transitionEnd(t);break}},_resize:function(){this.refresh()},_pos:function(m,t){m=this.hScroll?m:0;t=this.vScroll?t:0;if(this.options.useTransform){this.scroller.style[s+"Transform"]=b+m+"px,"+t+"px"+i+" scale("+this.scale+")"}else{m=o.round(m);t=o.round(t);this.scroller.style.left=m+"px";this.scroller.style.top=t+"px"}this.x=m;this.y=t},_start:function(w){var v=this,t=r?w.touches[0]:w,u,m,z;if(!v.enabled){return}if(v.options.onBeforeScrollStart){v.options.onBeforeScrollStart.call(v,w)}if(v.options.useTransition){v._transitionTime(0)}v.moved=false;v.animating=false;v.zoomed=false;v.distX=0;v.distY=0;v.absDistX=0;v.absDistY=0;v.dirX=0;v.dirY=0;if(v.options.momentum){if(v.options.useTransform){u=getComputedStyle(v.scroller,null)[s+"Transform"].replace(/[^0-9-.,]/g,"").split(",");m=u[4]*1;z=u[5]*1}else{m=getComputedStyle(v.scroller,null).left.replace(/[^0-9-]/g,"")*1;z=getComputedStyle(v.scroller,null).top.replace(/[^0-9-]/g,"")*1}if(m!=v.x||z!=v.y){if(v.options.useTransition){v._unbind("webkitTransitionEnd")}else{k(v.aniTime)}v.steps=[];v._pos(m,z)}}v.absStartX=v.x;v.absStartY=v.y;v.startX=v.x;v.startY=v.y;v.pointX=t.pageX;v.pointY=t.pageY;v.startTime=w.timeStamp||Date.now();if(v.options.onScrollStart){v.options.onScrollStart.call(v,w)}v._bind(n);v._bind(d);v._bind(q)},_move:function(y){var v=this,t=r?y.touches[0]:y,u=t.pageX-v.pointX,m=t.pageY-v.pointY,z=v.x+u,x=v.y+m,w=y.timeStamp||Date.now();if(v.options.onBeforeScrollMove){v.options.onBeforeScrollMove.call(v,y)}v.pointX=t.pageX;v.pointY=t.pageY;if(z>0||z<v.maxScrollX){z=v.options.bounce?v.x+(u/2):z>=0||v.maxScrollX>=0?0:v.maxScrollX}if(x>0||x<v.maxScrollY){x=v.options.bounce?v.y+(m/2):x>=0||v.maxScrollY>=0?0:v.maxScrollY}if(v.absDistX<6&&v.absDistY<6){v.distX+=u;v.distY+=m;v.absDistX=o.abs(v.distX);v.absDistY=o.abs(v.distY);return}if(v.options.lockDirection){if(v.absDistX>v.absDistY+5){x=v.y;m=0}else{if(v.absDistY>v.absDistX+5){z=v.x;u=0}}}v.moved=true;v._pos(z,x);v.dirX=u>0?-1:u<0?1:0;v.dirY=m>0?-1:m<0?1:0;if(w-v.startTime>300){v.startTime=w;v.startX=v.x;v.startY=v.y}if(v.options.onScrollMove){v.options.onScrollMove.call(v,y)}},_end:function(y){if(r&&y.touches.length!=0){return}var w=this,C=r?y.changedTouches[0]:y,z,B,u={dist:0,time:0},m={dist:0,time:0},v=(y.timeStamp||Date.now())-w.startTime,A=w.x,x=w.y,t;w._unbind(n);w._unbind(d);w._unbind(q);if(w.options.onBeforeScrollEnd){w.options.onBeforeScrollEnd.call(w,y)}if(!w.moved){z=C.target;while(z.nodeType!=1){z=z.parentNode}if(z.tagName!="SELECT"&&z.tagName!="INPUT"&&z.tagName!="TEXTAREA"){if(r){B=document.createEvent("MouseEvents");B.initMouseEvent("click",true,true,y.view,1,C.screenX,C.screenY,C.clientX,C.clientY,y.ctrlKey,y.altKey,y.shiftKey,y.metaKey,0,null);B._fake=true;z.dispatchEvent(B)}}else{z.focus()}w._resetPos(200);if(w.options.onTouchEnd){w.options.onTouchEnd.call(w,y)}return}if(v<300&&w.options.momentum){u=A?w._momentum(A-w.startX,v,-w.x,w.scrollerW-w.wrapperW+w.x,w.options.bounce?w.wrapperW:0):u;m=x?w._momentum(x-w.startY,v,-w.y,(w.maxScrollY<0?w.scrollerH-w.wrapperH+w.y:0),w.options.bounce?w.wrapperH:0):m;A=w.x+u.dist;x=w.y+m.dist;if((w.x>0&&A>0)||(w.x<w.maxScrollX&&A<w.maxScrollX)){u={dist:0,time:0}}if((w.y>0&&x>0)||(w.y<w.maxScrollY&&x<w.maxScrollY)){m={dist:0,time:0}}}if(u.dist||m.dist){t=o.max(o.max(u.time,m.time),10);w.scrollTo(o.round(A),o.round(x),t);if(w.options.onTouchEnd){w.options.onTouchEnd.call(w,y)}return}w._resetPos(200);if(w.options.onTouchEnd){w.options.onTouchEnd.call(w,y)}},_resetPos:function(u){var m=this,v=m.x>=0?0:m.x<m.maxScrollX?m.maxScrollX:m.x,t=m.y>=0||m.maxScrollY>0?0:m.y<m.maxScrollY?m.maxScrollY:m.y;if(v==m.x&&t==m.y){if(m.moved){if(m.options.onScrollEnd){m.options.onScrollEnd.call(m)}m.moved=false}return}m.scrollTo(v,t,u||0)},_mouseout:function(u){var m=u.relatedTarget;if(!m){this._end(u);return}while(m=m.parentNode){if(m==this.wrapper){return}}this._end(u)},_transitionEnd:function(t){var m=this;if(t.target!=m.scroller){return}m._unbind("webkitTransitionEnd");m._startAni()},_startAni:function(){var y=this,t=y.x,m=y.y,w=Date.now(),x,v,u;if(y.animating){return}if(!y.steps.length){y._resetPos(400);return}x=y.steps.shift();if(x.x==t&&x.y==m){x.time=0}y.animating=true;y.moved=true;if(y.options.useTransition){y._transitionTime(x.time);y._pos(x.x,x.y);y.animating=false;if(x.time){y._bind("webkitTransitionEnd")}else{y._resetPos(0)}return}u=function(){var z=Date.now(),B,A;if(z>=w+x.time){y._pos(x.x,x.y);y.animating=false;if(y.options.onAnimationEnd){y.options.onAnimationEnd.call(y)}y._startAni();return}z=(z-w)/x.time-1;v=o.sqrt(1-z*z);B=(x.x-t)*v+t;A=(x.y-m)*v+m;y._pos(B,A);if(y.animating){y.aniTime=l(u)}};u()},_transitionTime:function(m){this.scroller.style[s+"TransitionDuration"]=m+"ms"},_momentum:function(z,t,x,m,B){var y=0.0006,u=o.abs(z)/t,v=(u*u)/(2*y),A=0,w=0;if(z>0&&v>x){w=B/(6/(v/u*y));x=x+w;u=u*x/v;v=x}else{if(z<0&&v>m){w=B/(6/(v/u*y));m=m+w;u=u*m/v;v=m}}v=v*(z<0?-1:1);A=u/y;return{dist:v,time:o.round(A)}},_offset:function(m){var u=-m.offsetLeft,t=-m.offsetTop;while(m=m.offsetParent){u-=m.offsetLeft;t-=m.offsetTop}return{left:u,top:t}},_bind:function(u,t,m){(t||this.scroller).addEventListener(u,this,!!m)},_unbind:function(u,t,m){(t||this.scroller).removeEventListener(u,this,!!m)},destroy:function(){var m=this;m.scroller.style[s+"Transform"]="";m._unbind(g,window);m._unbind(a);m._unbind(n);m._unbind(d);m._unbind(q);m._unbind("mouseout",m.wrapper);if(m.options.useTransition){m._unbind("webkitTransitionEnd")}if(m.options.onDestroy){m.options.onDestroy.call(m)}},refresh:function(){var m=this,t;m.wrapperW=m.wrapper.clientWidth;m.wrapperH=m.wrapper.clientHeight;m.scrollerW=m.scroller.offsetWidth;m.scrollerH=m.scroller.offsetHeight;m.maxScrollX=m.wrapperW-m.scrollerW;m.maxScrollY=m.wrapperH-m.scrollerH;m.dirX=0;m.dirY=0;m.hScroll=m.options.hScroll&&m.maxScrollX<0;m.vScroll=m.options.vScroll&&(!m.options.bounceLock&&!m.hScroll||m.scrollerH>m.wrapperH);t=m._offset(m.wrapper);m.wrapperOffsetLeft=-t.left;m.wrapperOffsetTop=-t.top;m.scroller.style[s+"TransitionDuration"]="0";m._resetPos(200)},scrollTo:function(m,B,A,z){var w=this,v=m,u,t;w.stop();if(!v.length){v=[{x:m,y:B,time:A,relative:z}]}for(u=0,t=v.length;u<t;u++){if(v[u].relative){v[u].x=w.x-v[u].x;v[u].y=w.y-v[u].y}w.steps.push({x:v[u].x,y:v[u].y,time:v[u].time||0})}w._startAni()},scrollToElement:function(m,u){var t=this,v;m=m.nodeType?m:t.scroller.querySelector(m);if(!m){return}v=t._offset(m);v.left+=t.wrapperOffsetLeft;v.top+=t.wrapperOffsetTop;v.left=v.left>0?0:v.left<t.maxScrollX?t.maxScrollX:v.left;v.top=v.top>0?0:v.top<t.maxScrollY?t.maxScrollY:v.top;u=u===undefined?o.max(o.abs(v.left)*2,o.abs(v.top)*2):u;t.scrollTo(v.left,v.top,u)},disable:function(){this.stop();this._resetPos(0);this.enabled=false;this._unbind(n);this._unbind(d);this._unbind(q)},enable:function(){this.enabled=true},stop:function(){k(this.aniTime);this.steps=[];this.moved=false;this.animating=false}};if(typeof exports!=="undefined"){exports.iScroll=p}else{window.iScroll=p}})(); var BaseScroller=function(){};BaseScroller.constructor=BaseScroller;BaseScroller.prototype={SCROLL_WRAPPER_SELECTOR:".scroll_wrapper",ACTIVE_PAGE_SELECTOR:".ui-page-active",$body:null,getMyScrollerWrapper:function(a){if(a.hasClass("scroll_wrapper")){return a}var b=a.parents(this.SCROLL_WRAPPER_SELECTOR);if(b.length>0){return b}return null},getScrollerWrapper:function(b){if(!b||!b.length){var a=$(this.ACTIVE_PAGE_SELECTOR);if(a.length){b=$(this.SCROLL_WRAPPER_SELECTOR,a)}}return b},triggerWrapperResize:function(c){var a=this;var b=c?c:a.getScrollerWrapper();a.onWrapperResize(b);window.setTimeout(function(){a.onWrapperResize(b)},100)},onResizeEventHandler:function(a){this.triggerWrapperResize()},construct:function(){var a=this;a.triggerWrapperResize=_.debounce(a.triggerWrapperResize.hitch(a),200);a.onResizeEventHandler=a.onResizeEventHandler.hitch(a);$(window).bind("orientationchange throttledresize",a.onResizeEventHandler);this.$body=$("body")},init:function(a){},refreshScroll:function(b,a){},onWrapperResize:function(a){},onContentChanged:function(a){},resetScroll:function(a){},scrollTo:function(c,a,b){},restoreScroll:function(){},handlePageShow:function(a){this.triggerWrapperResize(a)}}; var ScrollingFactory={ISCROLL_NAME:"IScrollScroller",FIXED_SCROLL_NAME:"FixedScroller",ABSOLUTE_SCROLL_NAME:"AbsoluteScroller",OVERFLOW_SCROLL_NAME:"OverflowScroller",getScrollerName:function(){if(LAYOUT===layoutFormat.wide){return this.ISCROLL_NAME}var a=navigator.userAgent.match(/(iPad|iPhone);.*CPU.*OS 7_\d/i)&&!navigator.userAgent.match(/CriOS/i);if(a&&LAYOUT===layoutFormat.narrow){return this.FIXED_SCROLL_NAME}if(PLATFORM===platformEnum.simulator||PLATFORM===platformEnum.gadget||DEVICE===deviceTypeEnum.iphone){if($.mobile.browser.ie&&$.mobile.browser.ie<9){return this.FIXED_SCROLL_NAME}else{return this.ISCROLL_NAME}}else{if(DEVICE===deviceTypeEnum.android){if(PLATFORM===platformEnum.nativeApp){return this.FIXED_SCROLL_NAME}else{if(PLATFORM===platformEnum.webApp&&DeviceSupport.isPositionFixed){return this.FIXED_SCROLL_NAME}else{return this.ABSOLUTE_SCROLL_NAME}}}}return this.ABSOLUTE_SCROLL_NAME},createScroller:function(){var a=this.getScrollerName();return new window[a]()}}; var BaseLongScroller=function(){};BaseLongScroller.constructor=BaseLongScroller;BaseLongScroller.prototype=BaseScroller.extend({_scrollStack:[],PERSISTANT_SELECTOR:'*[data-position="fixed"]',TOOLBARS_SELECTOR:'*[data-role="header"], *[data-role="footer"]',HEADER_SELECTOR:'*[data-role="header"]',FOOTER_SELECTOR:'*[data-role="footer"]',construct:function(){this.Super();$("body").addClass("long_scroller")},init:function(a){this.Super(a)},onWrapperResize:function(c){this.Super(c);var a=Utils.Html.getInnerHeight();$("#app_pages_container").css("min-height",a);var b=$(".ui-page-active");b.css("min-height",a);this.onContentChanged(c)},onContentChanged:function(a){this.Super(a);setTimeout(function(){var b=$(".ui-page-active");b.parent().css("min-height",b.height())},100)},resetScroll:function(b){this.Super(b);var a=$(document.body);this._scrollStack.push(a.scrollTop());a.scrollTop(0)},scrollTo:function(c,a,b){this.Super(c,a,b);$(document.body).scrollTop(a)},restoreScroll:function(){this.Super();var a=this._scrollStack.pop();$(document.body).scrollTop(a)},handlePageShow:function(a){this.Super(a);this.resetScroll(a)}}); var AbsoluteScroller=function(){this.construct()};AbsoluteScroller.constructor=AbsoluteScroller;AbsoluteScroller.prototype=BaseLongScroller.extend({SHOW_DELAY:100,_visable:true,construct:function(){this.Super();var c=$(document),b=$(window);$("body").addClass("absolute_scroller");((c.scrollTop()===0)?b:c).bind("scrollstart",this.handleScrollStart.hitch(this)).bind("scrollstop",this.handleScrollStop.hitch(this));$("#app_pages_container").bind("vclick",this._toggleBars.hitch(this));var a={'*[data-role="header"], *[data-role="footer"]':"{z-index: 1000;position: relative;-webkit-transform: translateZ(0);-webkit-animation-duration: 500ms;}",html:"{ overflow-y:auto !important; }"};a[this.SCROLL_WRAPPER_SELECTOR]="{height: 100%}";Utils.Html.addCssStyle(a,document,"scrollStyle")},_toggleBars:function(){if(!this._scrollTriggered){if(this._visable){this._hideBars()}else{this._showBars()}}},init:function(a){this.Super(a);$(this.TOOLBARS_SELECTOR).addClass("fade")},_hideBars:function(){$(this.TOOLBARS_SELECTOR+":not("+this.PERSISTANT_SELECTOR+")").css("top",0);this._visable=false},handleScrollStart:function(){this._scrollTriggered=true;clearTimeout(this._timerHandle);this._hideBars()},_timerHandle:null,_showBars:function(a,g){clearTimeout(this._timerHandle);var e=400;var d=$(window).scrollTop();var h=$("body").height();var c=$(this.HEADER_SELECTOR+":not("+this.PERSISTANT_SELECTOR+")");var b=$(this.FOOTER_SELECTOR+":not("+this.PERSISTANT_SELECTOR+")");var f=window.innerHeight-h+d;if(d!==0){c.one("webkitAnimationEnd",function(){c.removeClass("in")}).addClass("in")}if(f!==0){b.one("webkitAnimationEnd",function(){b.removeClass("in")}).addClass("in")}c.css("top",d);b.css("top",f);this._visable=true},_startTimer:function(){clearTimeout(this._timerHandle);this._timerHandle=setTimeout(this._showBars.hitch(this),this.SHOW_DELAY)},handleScrollStop:function(a){this._scrollTriggered=false;this._startTimer()},onWrapperResize:function(a){this.Super(a);this._startTimer()},onContentChanged:function(a){this.Super(a);this._startTimer()},resetScroll:function(a){this.Super(a)},scrollTo:function(c,a,b){this.Super(c,a,b)},restoreScroll:function(){this.Super()}}); var FixedScroller=function(){this.construct()};FixedScroller.constructor=FixedScroller;FixedScroller.prototype=BaseLongScroller.extend({construct:function(){this.Super();$("html").addClass("fixed_scroller")},init:function(a){this.Super(a)},_getHeaderHeight:function(){return $(this.HEADER_SELECTOR).height()},_getFooterHeight:function(){return $(this.FOOTER_SELECTOR).height()},onWrapperResize:function(b){this.Super(b);var a=$(".app_header").height();$(".ui-page-active").find(this.HEADER_SELECTOR).css({top:a});$(this.SCROLL_WRAPPER_SELECTOR).css({marginBottom:Utils.Html.getFooterHeight()+"px"})},onContentChanged:function(a){this.Super(a)},resetScroll:function(a){this.Super(a)},scrollTo:function(c,a,b){this.Super(c,a,b)},restoreScroll:function(){this.Super()}}); var BaseShortScroller=function(){};BaseShortScroller.constructor=BaseShortScroller;BaseShortScroller.prototype=BaseScroller.extend({$appPagesContainer:null,construct:function(){this.Super();$(document).bind("scroll",function(a){if(window.pageYOffset==0){this.triggerWrapperResize()}}.hitch(this));this.$body.addClass("short_scroller")},_updateWrapperSize:function(c){var b=$(this.ACTIVE_PAGE_SELECTOR);if(c.length){var a=Utils.Html.getInnerHeight();if(a>0){b.height(a);b.parent().height(a);c.height(a);this.$appPagesContainer=this.$appPagesContainer||$("#app_pages_container");if(this.$appPagesContainer&&this.$appPagesContainer.length){this.$appPagesContainer.css("min-height",a)}else{this.$appPagesContainer=null}}}},getScrollerWrapper:function(b){if(!b||!b.length){var a=$(this.ACTIVE_PAGE_SELECTOR);if(a.length){b=$(this.SCROLL_WRAPPER_SELECTOR,a)}}return b},refreshScroll:function(b,a){b.height(a)},onWrapperResize:function(a){a=this.getScrollerWrapper(a);if(a&&a.length){this._updateWrapperSize(a)}}}); var IScrollScroller=function(){this.construct()};IScrollScroller.constructor=IScrollScroller;IScrollScroller.prototype=BaseShortScroller.extend({ISCROLL_OBJECT_KEY:"iscroll_object",construct:function(){this.Super();var a={".scroll_wrapper":"{ position:relative; z-index:1; width:100%; overflow:auto; }",".scroller":"{ min-height:100%; width:100%; z-index:1; padding:0; position:relative; }"};Utils.Html.addCssStyle(a,document,"scrollStyle")},init:function(b){this._updateWrapperSize(b);var a=this._getIScrollObject(b);if(!a){a=new iScroll(b[0],{hScroll:false,vScroll:true,vScrollbar:true,useTransition:true,onScrollMove:function(){$.mobile.setPageScrolling(true)},onScrollEnd:function(){$.mobile.setPageScrolling(false)}});b.data(this.ISCROLL_OBJECT_KEY,a)}b.delegate(":input","blur",function(d){var c=b[0];var f=c.scrollTop+(-a.y);c.scrollTop=0;Scrolling.scrollTo(b,f)});this._throttleRefresh(a);this.Super(b)},onWrapperResize:function(a){if($(document.activeElement).is(":input")){return}this.Super(a);this._refreshIScroll(a)},refreshScroll:function(b,a){this.Super(b,a);this._refreshIScroll(b)},_refreshIScroll:function(d){if(d){for(var b=0;b<d.length;b++){var c=d.eq(b);var a=this._getIScrollObject(c);if(a){this._throttleRefresh(a)}}}},_throttleRefresh:function(a){clearTimeout(a.timeout);var b=a.lastCall||0;curr=(new Date()).getTime();diff=curr-b;if(diff>=500){timeout=0}else{timeout=500}a.timeout=setTimeout(function(){a.lastCall=curr;a.refresh()},timeout)},onContentChanged:function(a){this._refreshIScroll(a)},resetScroll:function(a){this.scrollTo(a,0)},scrollTo:function(d,b,c){var a=this._getIScrollObject(d);if(a){c=c||0;a.scrollTo(0,-b,c)}},_getIScrollObject:function(a){if(a&&a.length){return a.data(this.ISCROLL_OBJECT_KEY)}return null}}); var OverflowScroller=function(){this.construct()};OverflowScroller.constructor=OverflowScroller;OverflowScroller.prototype=BaseShortScroller.extend({construct:function(){this.Super();var a={".scroll_wrapper":"{ overflow-y:scroll; overflow-x:hidden; -webkit-overflow-scrolling: touch;}",".scroll_wrapper>*":"{ -webkit-transform: translate3d(0,0,0); }"};Utils.Html.addCssStyle(a,document,"scrollStyle")}}); var conduitApi={init:function(a,b){if(typeof conduitApi.__BCAPI!=="undefined"&&typeof conduitApi.__BCAPI.init==="function"){return conduitApi.__BCAPI.init(a,b,this.slaveId)}},getContext:function(a){if(typeof conduitApi.__BCAPI!=="undefined"&&typeof conduitApi.__BCAPI.getContext==="function"){return conduitApi.__BCAPI.getContext(a)}},moduleSupported:function(a){if(typeof conduitApi.__BCAPI!=="undefined"&&typeof conduitApi.__BCAPI[a]!=="undefined"&&typeof conduitApi.__BCAPI[a].isSupported==="function"){var b=conduitApi.__BCAPI[a].isSupported();return b}return false},platform:{isSupported:function(){return conduitApi.moduleSupported("platform")},moduleSupported:function(a){var b="platform";if(conduitApi.moduleSupported(b)&&typeof conduitApi.__BCAPI[b][a]!=="undefined"&&typeof conduitApi.__BCAPI[b][a].isSupported==="function"){return conduitApi.__BCAPI[b][a].isSupported()}return false},media:{isSupported:function(){return conduitApi.platform.moduleSupported("media")},init:function(b,c,a){if(conduitApi.platform.media.isSupported()){conduitApi.__BCAPI.platform.media.init(b,c,a)}},setTracks:function(a,c,b){if(conduitApi.platform.media.isSupported()){conduitApi.__BCAPI.platform.media.setTracks(a,b)}else{Utils.Helpers.funcWrapper(c)()}},play:function(a,c,b){if(conduitApi.platform.media.isSupported()){conduitApi.__BCAPI.platform.media.play(b)}else{Utils.Helpers.funcWrapper(c)()}}},video:{isSupported:function(){return conduitApi.platform.moduleSupported("video")},play:function(a,d,b,c){if(conduitApi.platform.video.isSupported()){conduitApi.__BCAPI.platform.video.play(b,c)}else{Utils.Helpers.funcWrapper(d)()}}},accelerometer:{isSupported:function(){return conduitApi.platform.moduleSupported("accelerometer")},getLastAcceleration:function(a,b){if(conduitApi.platform.accelerometer.isSupported()){conduitApi.__BCAPI.platform.accelerometer.getLastAcceleration(a,b)}else{b()}},startAcceleration:function(a,c,b){if(conduitApi.platform.accelerometer.isSupported()){conduitApi.__BCAPI.platform.accelerometer.startAcceleration(a,c,b)}else{c()}},stopAcceleration:function(a,b,c){if(conduitApi.platform.accelerometer.isSupported()){conduitApi.__BCAPI.platform.accelerometer.stopAcceleration(a,b,c)}else{b()}}},camera:{isSupported:function(){return conduitApi.platform.moduleSupported("camera")},DestinationType:{DATA_URL:0,FILE_URI:1},PictureSourceType:{PHOTOLIBRARY:0,CAMERA:1,SAVEDPHOTOALBUM:2},captureImage:function(b,c,a){if(conduitApi.platform.camera.isSupported()){conduitApi.__BCAPI.platform.camera.captureImage(b,c,a)}}},deviceInfo:{isSupported:function(){return conduitApi.platform.moduleSupported("deviceInfo")},deviceTypeEnum:{unknown:0,iphone:1<<0,android:1<<1,rim:1<<2,winPhone:1<<3,symbian:1<<4,bada:1<<5,ipad:1<<6},platformEnum:{simulator:0,nativeApp:1,webApp:2},layoutEnum:{narrow:0,wide:1},getDeviceInfo:function(a,b){if(conduitApi.platform.deviceInfo.isSupported()){conduitApi.__BCAPI.platform.deviceInfo.getDeviceInfo(a,b)}}},geo:{isSupported:function(){return conduitApi.platform.moduleSupported("geo")},ErrorCodes:{UNKNOWN_ERROR:0,PERMISSION_DENIED:1,POSITION_UNAVAILABLE:2,TIMEOUT:3},getLocation:function(a,c,b){if(conduitApi.platform.geo.isSupported()){conduitApi.__BCAPI.platform.geo.getLocation(a,c,b)}},startGeoLocation:function(a,c,b){if(conduitApi.platform.geo.isSupported()){conduitApi.__BCAPI.platform.geo.startGeoLocation(a,c,b)}},stopGeoLocation:function(a,c,b){if(conduitApi.platform.geo.isSupported()){conduitApi.__BCAPI.platform.geo.stopGeoLocation(b,a,c)}}},orientation:{isSupported:function(){return conduitApi.platform.moduleSupported("orientation")},getOrientation:function(a,b){if(conduitApi.platform.orientation.isSupported()){conduitApi.__BCAPI.platform.orientation.getOrientation(a,b)}},lockOrientation:function(a,b,c){if(conduitApi.platform.orientation.isSupported()){conduitApi.__BCAPI.platform.orientation.lockOrientation(a,b,c,conduitApi.getContext(this.slaveId))}},unlockOrientation:function(a,b){if(conduitApi.platform.orientation.isSupported()){conduitApi.__BCAPI.platform.orientation.unlockOrientation(a,b,conduitApi.getContext(this.slaveId))}},startOrientation:function(a,b){if(conduitApi.platform.orientation.isSupported()){conduitApi.__BCAPI.platform.orientation.startOrientation(a,b,conduitApi.getContext(this.slaveId))}},stopOrientation:function(a,b){if(conduitApi.platform.orientation.isSupported()){conduitApi.__BCAPI.platform.orientation.stopOrientation(a,b,conduitApi.getContext(this.slaveId))}}},pushNotification:{isSupported:function(){return conduitApi.platform.moduleSupported("pushNotification")},registerPushNotification:function(a,c,b){if(conduitApi.platform.pushNotification.isSupported()){conduitApi.__BCAPI.platform.pushNotification.registerPushNotification(a,c,b,conduitApi.getContext(this.slaveId))}},unregisterPushNotification:function(a,b){if(conduitApi.platform.pushNotification.isSupported()){conduitApi.__BCAPI.platform.pushNotification.unregisterPushNotification(a,b,conduitApi.getContext(this.slaveId))}}},storage:{isSupported:function(){return conduitApi.platform.moduleSupported("storage")},setItem:function(a,c,b,d,e){if(conduitApi.platform.storage.isSupported()){return conduitApi.__BCAPI.platform.storage.setItem(a,c,b,d,e,conduitApi.getContext(this.slaveId))}},getItem:function(a,c,b,d){if(conduitApi.platform.storage.isSupported()){return conduitApi.__BCAPI.platform.storage.getItem(a,c,b,d,conduitApi.getContext(this.slaveId))}},removeItem:function(a,c,b,d){if(conduitApi.platform.storage.isSupported()){return conduitApi.__BCAPI.platform.storage.removeItem(a,c,b,conduitApi.getContext(this.slaveId),d)}},clearStorage:function(a,b){if(conduitApi.platform.storage.isSupported()){return conduitApi.__BCAPI.platform.storage.clearStorage(a,b,conduitApi.getContext(this.slaveId))}}},vibrate:{isSupported:function(){return conduitApi.platform.moduleSupported("vibrate")},vibrateForTime:function(a,c,b){if(conduitApi.platform.vibrate.isSupported()){conduitApi.__BCAPI.platform.vibrate.vibrateForTime(a,c,b)}}},inAppPurchase:{isSupported:function(){return conduitApi.platform.moduleSupported("inAppPurchase")},init:function(a,c,b){if(conduitApi.platform.inAppPurchase.isSupported()){conduitApi.__BCAPI.platform.inAppPurchase.init(a,c,b)}},purchase:function(a,b,c){if(conduitApi.platform.inAppPurchase.isSupported()){conduitApi.__BCAPI.platform.inAppPurchase.purchase(a,b,c)}}},gestures:{isSupported:function(){return conduitApi.platform.moduleSupported("gestures")},registerShake:function(a,c,b){if(conduitApi.platform.gestures.isSupported()){conduitApi.__BCAPI.platform.gestures.registerShake(a,c,b,conduitApi.getContext(this.slaveId))}},unregisterShake:function(a,b){if(conduitApi.platform.gestures.isSupported()){conduitApi.__BCAPI.platform.gestures.unregisterShake(a,b,conduitApi.getContext(this.slaveId))}}}},UI:{isSupported:function(){return conduitApi.moduleSupported("UI")},startActivityIndicator:function(b,c,d,a){if(conduitApi.UI.isSupported()){conduitApi.__BCAPI.UI.startActivityIndicator(b,c,d,a)}},dismissActivityIndicator:function(c,d,b,a){if(conduitApi.UI.isSupported()){conduitApi.__BCAPI.UI.dismissActivityIndicator(c,d,b,a)}},showDialogBox:function(a,c,b,d){if(conduitApi.UI.isSupported()){conduitApi.__BCAPI.UI.showDialogBox(a,c,b,d)}},showToastMessage:function(b,c,d,a,e){if(conduitApi.UI.isSupported()){conduitApi.__BCAPI.UI.showToastMessage(b,c,d,a,e)}}},app:{isSupported:function(){return conduitApi.moduleSupported("app")},hideInfoBar:function(a,b){if(conduitApi.app.isSupported()){conduitApi.__BCAPI.app.hideInfoBar(a,b,conduitApi.getContext(this.slaveId))}},showInfoBar:function(a,b){if(conduitApi.app.isSupported()){return conduitApi.__BCAPI.app.showInfoBar(a,b,conduitApi.getContext(this.slaveId))}},toggleInfoBar:function(a,b){if(conduitApi.app.isSupported()){return conduitApi.__BCAPI.app.toggleInfoBar(a,b,conduitApi.getContext(this.slaveId))}},isInfoBarVisible:function(a,b){if(conduitApi.app.isSupported()){return conduitApi.__BCAPI.app.isInfoBarVisible(a,b,conduitApi.getContext(this.slaveId))}},hideNavigationBar:function(a,b){if(conduitApi.app.isSupported()){return conduitApi.__BCAPI.app.hideNavigationBar(a,b,conduitApi.getContext(this.slaveId))}},showNavigationBar:function(a,b){if(conduitApi.app.isSupported()){return conduitApi.__BCAPI.app.showNavigationBar(a,b,conduitApi.getContext(this.slaveId))}},toggleNavigationBar:function(a,b){if(conduitApi.app.isSupported()){return conduitApi.__BCAPI.app.toggleNavigationBar(a,b,conduitApi.getContext(this.slaveId))}},isNavigationBarVisible:function(a,b){if(conduitApi.app.isSupported()){return conduitApi.__BCAPI.app.isNavigationBarVisible(a,b,conduitApi.getContext(this.slaveId))}},addInfoBarButton:function(a,d,c,b,e){if(conduitApi.app.isSupported()){return conduitApi.__BCAPI.app.addInfoBarButton(a,d,c,b,e,conduitApi.getContext(this.slaveId))}},removeInfoBarButton:function(a,c,b){if(conduitApi.app.isSupported()){return conduitApi.__BCAPI.app.removeInfoBarButton(a,c,b,conduitApi.getContext(this.slaveId))}},addBackButton:function(a,d,c,b,e){if(conduitApi.app.isSupported()){return conduitApi.__BCAPI.app.addBackButton(a,d,c,b,e,conduitApi.getContext(this.slaveId))}},removeBackButton:function(a,b){if(conduitApi.app.isSupported()){return conduitApi.__BCAPI.app.removeBackButton(a,b,conduitApi.getContext(this.slaveId))}},addRefreshButton:function(a,d,c,b,e){if(conduitApi.app.isSupported()){return conduitApi.__BCAPI.app.addRefreshButton(a,d,c,b,e,conduitApi.getContext(this.slaveId))}},removeRefreshButton:function(a,b){if(conduitApi.app.isSupported()){return conduitApi.__BCAPI.app.removeRefreshButton(a,b,conduitApi.getContext(this.slaveId))}},addNavigationButton:function(a,d,c,b,e){if(conduitApi.app.isSupported()){return conduitApi.__BCAPI.app.addNavigationButton(a,d,c,b,e,conduitApi.getContext(this.slaveId))}},removeNavigationButton:function(a,b){if(conduitApi.app.isSupported()){return conduitApi.__BCAPI.app.removeNavigationButton(a,b,conduitApi.getContext(this.slaveId))}},removeAllInfoBarButtons:function(a,b){if(conduitApi.app.isSupported()){return conduitApi.__BCAPI.app.removeAllInfoBarButtons(a,b,conduitApi.getContext(this.slaveId))}},openLink:function(a,d,b,c,e){if(typeof(b.title)==="undefined"){b.title=""}conduitApi.platform.deviceInfo.getDeviceInfo(function(f){if(f.platform===platformEnum.simulator){window.open(b.url)}else{if(conduitApi.app.isSupported()){conduitApi.__BCAPI.app.openLink(a,d,b,c,e,conduitApi.getContext(this.slaveId))}}})},closeLink:function(a,b,c){if(conduitApi.app.isSupported()){conduitApi.__BCAPI.app.closeLink(a,b,c)}},setLinkRect:function(a,b,d,c){if(conduitApi.app.isSupported()){conduitApi.__BCAPI.app.setLinkRect(a,b,d,c)}},closeApp:function(a,b){if(conduitApi.app.isSupported()){conduitApi.__BCAPI.app.closeApp(a,b)}}},social:{isSupported:function(){return conduitApi.moduleSupported("social")},socialServicesEnum:{Facebook:0,Twitter:1,Email:2},getSupportedServices:function(c,a,b){if(conduitApi.social.isSupported()){return conduitApi.__BCAPI.social.getSupportedServices(c,a,b)}},share:function(b,d,a,c){if(conduitApi.social.isSupported()){c=c||{};return conduitApi.__BCAPI.social.share(b,d,a,c,conduitApi.getContext(this.slaveId))}},getAccessTokens:function(b,d,a,c){if(conduitApi.social.isSupported()){c=c||{};conduitApi.__BCAPI.social.getAccessTokens(b,d,a,c,conduitApi.getContext(this.slaveId))}},logout:function(b,c,a){if(conduitApi.social.isSupported()){conduitApi.__BCAPI.social.logout(b,c,a)}}},analytics:{isSupported:function(){return true},usageEventTypeEnum:{Unknown:0,TabClick:1,OpenLink:2,ReceivedPush:3,SocialLogin:4,SocialShare:5,ViewChanged:6,BannerClicked:7,UserLoggedIn:8,ExternalContentShown:9,CouponClaimed:10,CardPunched:11},socialProviderType:{Unknown:0,Facebook:"5408ce72-ff55-4c1b-9f75-5b93d5ff9108",Email:"6012574f-feaa-4b95-a816-ce71085aec5d",Twitter:"c80e87a8-9e77-4d6a-9be7-b1e35d173e32"},socialShareTypes:{Unknown:0,Facebook:1,Email:2,Twitter:3},addEvent:function(b,d,c,e,a){if(conduitApi.analytics.isSupported()){conduitApi.__BCAPI.analytics.addEvent(b,d,c,e,a,conduitApi.getContext(this.slaveId))}}},log:{isSupported:function(){return true},info:function(a,b,c){if(conduitApi.log.isSupported()){conduitApi.__BCAPI.log.info(a,b,c)}},warning:function(a,b,c){if(conduitApi.log.isSupported()){conduitApi.__BCAPI.log.warning(a,b,c)}},error:function(a,b,c){if(conduitApi.log.isSupported()){conduitApi.__BCAPI.log.error(a,b,c)}}}}; function BaseAppDriver(){}BaseAppDriver.prototype={_infoBarButtonID:0,_infoBarBtnCbMap:{},_refreshButtonsIds:[],_navigationButtonsIds:[],_getRootDir:function(a){if(a.pageType){return"pages/"+pageTypes[a.pageType].folder+"/"}else{return""}},hideInfoBar:function(a,c,b){var d=$(".app_header");if(d.length===0){Utils.Helpers.funcWrapper(c)();return false}d.hide();$(window).trigger("resize");Utils.Helpers.funcWrapper(a)();return true},showInfoBar:function(a,c,b){var d=$(".app_header");if(d.length===0){Utils.Helpers.funcWrapper(c)();return false}d.show();$(window).trigger("resize");Utils.Helpers.funcWrapper(a)();return true},toggleInfoBar:function(a,c,b){Utils.Helpers.funcWrapper(c)();return false},isInfoBarVisible:function(a,c,b){Utils.Helpers.funcWrapper(c)();return false},hideNavigationBar:function(a,c,b){var d=$("#app_navigation_bar");if(d.length===0){Utils.Helpers.funcWrapper(c)();return false}d.hide();$(window).trigger("resize");Utils.Helpers.funcWrapper(a)();return true},showNavigationBar:function(a,c,b){var d=$("#app_navigation_bar");if(d.length===0){Utils.Helpers.funcWrapper(c)();return false}d.show();$(window).trigger("resize");Utils.Helpers.funcWrapper(a)();return true},toggleNavigationBar:function(a,c,b){Utils.Helpers.funcWrapper(c)();return false},isNavigationBarVisible:function(a,c,b){Utils.Helpers.funcWrapper(c)();return false},_getIdStr:function(a){return("infobar_button_"+a)},addInfoBarButton:function(a,e,c,b,f,d){AppManager.app().addInfoBarButton(a,e,c,b,f,d)},removeInfoBarButton:function(a,d,c,b){AppManager.app().removeInfoBarButton(a,d,c,b)},removeAllInfoBarButtons:function(a,c,b){AppManager.app().removeAllInfoBarButtons(a,c,b)},openLink:function(b,e,c,f,g,d){var a={url:c.url};conduitApi.__BCAPI.analytics.addEvent(null,null,conduitApi.analytics.usageEventTypeEnum.OpenLink,a,false,d);return !(this.handleInternalLink(c.url))},handleInternalLink:function(b){if(typeof(b)==="string"){var a=b.split(":");if(a[0]==="GoToPage"){var c=AppViewFactory.getAppView();if(a[1]==="navigation"){c.goToNavPage()}else{if(a[1]==="id"){c.goToPageId(a[2])}else{c.goToPageIndex(a[2])}}return true}}return false},addRefreshButton:function(a,e,c,b,g,d){if((DEVICE==deviceTypeEnum.android||DEVICE===deviceTypeEnum.iphone)&&PLATFORM==platformEnum.nativeApp){navigator.appManager.addRefreshButton(g);Utils.Helpers.funcWrapper(a)()}else{function f(h){this._refreshButtonsIds.push(h);Utils.Helpers.funcWrapper(a)()}this.addInfoBarButton(f.hitch(this),e,"refresh.png",b,g,d)}},removeRefreshButton:function(a,c,b){if((DEVICE===deviceTypeEnum.iphone||DEVICE==deviceTypeEnum.android)&&PLATFORM==platformEnum.nativeApp){navigator.appManager.removeRefreshButton();Utils.Helpers.funcWrapper(a)()}else{var d=this._refreshButtonsIds.pop();this.removeInfoBarButton(a,c,d,b)}},addNavigationButton:function(a,e,c,b,g,d){if(PLATFORM===platformEnum.nativeApp){if(DEVICE===deviceTypeEnum.iphone){navigator.appManager.addNavigationButton(g);Utils.Helpers.funcWrapper(a)()}else{Utils.Helpers.funcWrapper(a)()}}else{function f(h){this._navigationButtonsIds.push(h);Utils.Helpers.funcWrapper(a)()}this.addInfoBarButton(f.hitch(this),e,c,b,g,d)}},removeNavigationButton:function(a,c,b){if(PLATFORM===platformEnum.nativeApp){if(DEVICE===deviceTypeEnum.iphone){navigator.appManager.removeNavigationButton();Utils.Helpers.funcWrapper(a)()}else{Utils.Helpers.funcWrapper(a)()}}else{var d=this._navigationButtonsIds.pop();this.removeInfoBarButton(a,c,d,b)}}};BaseAppDriver.constructor=BaseAppDriver; var analyticsDriver=(function(){var a={};a.isSupported=function(){return true};a.addEvent=function(c,f,e,g,b,d){usage.addEvent(d.pageId,d.pageType,e,g,b);Utils.Helpers.funcWrapper(c)()};return a}()); function BaseGeoDriver(){}BaseGeoDriver.prototype={isSupported:function(){return(typeof navigator.geolocation!=="undefined")},startGeoLocation:function(a,c,b){var d;var e=function(f){Utils.Helpers.funcWrapper(a)(d,f)};d=navigator.geolocation.watchPosition(e,this._createCbFail(c),this.getDefLocationOpt(b))},getDefLocationOpt:function(a){var b={enableHighAccuracy:true,timeout:5000,maximumAge:60000};$.extend(b,a);return b},stopGeoLocation:function(a,c,b){navigator.geolocation.clearWatch(b);Utils.Helpers.funcWrapper(a)()},getLocation:function(c,e,d){var f=this;function b(g){$.each(f._cbSucesses||[],function(h,j){j(g)});f._cbSucesses=null;f._cbFails=null;f.doCall=true}function a(g){$.each(f._cbFails||[],function(j,h){h(g)});f._cbSucesses=null;f._cbFails=null;f.doCall=true}if(!f._cbSucesses){f._cbSucesses=[];f._cbFails=[];f.doCall=true}if(typeof(c)==="function"){f._cbSucesses.push(c)}if(typeof(e)==="function"){f._cbFails.push(e)}if(f.doCall){f.doCall=false;f._getLocation(b,a,d)}}}; var SocialDriver=function(){this._socialServices={};this._socialServices[conduitApi.social.socialServicesEnum.Facebook]=new Facebook();this._socialServices[conduitApi.social.socialServicesEnum.Email]=new Email();this._socialServices[conduitApi.social.socialServicesEnum.Twitter]=new Twitter()};SocialDriver.prototype={isSupported:function(){if(typeof socialNotSupported!=="undefined"&&socialNotSupported){return false}return true},_isServiceSupported:function(a){return this._socialServices.hasOwnProperty(a)},getSupportedServices:function(f,d,e){var c=[];for(var b in this._socialServices){var a=true;if(PLATFORM===conduitApi.platform.deviceInfo.platformEnum.webApp){if(!f.url){if(b==conduitApi.social.socialServicesEnum.Facebook){a=false}}}if(a){c.push(b)}}c.sort();Utils.Helpers.funcWrapper(d)(c)},share:function(b,e,a,c,d){if(!c){Utils.Helpers.funcWrapper(e)("Share options not supplied");return}a=parseInt(a);if(!this._isServiceSupported(a)){Utils.Helpers.funcWrapper(e)("Service not supported");return}if(PLATFORM===platformEnum.simulator){cqm.showToastMessage("Share is not supported in simulator mode.");return}c.pageId=d.pageId;this._socialServices[a].share(b,e,c)},getAccessTokens:function(b,e,a,c,d){a=parseInt(a);if(!this._isServiceSupported(a)){Utils.Helpers.funcWrapper(e)("Service not supported");return}c.pageId=d.pageId;this._socialServices[a].getAccessTokens(b,e,c)},logout:function(b,c,a){a=parseInt(a);if(!this._isServiceSupported(a)){Utils.Helpers.funcWrapper(c)("Service not supported");return}this._socialServices[a].logout(b,c)},saveShareInfo:function(a,b){this._shareInfo=a;this._tokens=b},handleTwitterShareLoginReturn:function(a){this._socialServices[conduitApi.social.socialServicesEnum.Twitter].share(null,null,a)},_createSshKey:function(f){var e=f.sskey;var c=f.tId;var g=new Date();var b=JSON.stringify(g);b=b.substring(1,b.length-1);var h=HMAC_SHA256_MAC(e,"hts="+b+"&tuid="+c);var a={hts:b,sshKey:h};return a},tweet:function(a,d,e){var b=this._createSshKey(this._tokens);var f={tId:this._tokens.tId,sshKey:b.sshKey,hts:b.hts};var c={postParams:{status:e,wrap_links:true},contentType:"application/x-www-form-urlencoded"};Services.executeService("TWITTER_API_PROXY_POST",f,a,d,c)},openSharePage:function(b){var a=new SharePage(b);AppManager.app().trigger("openSharePage",a)}}; var storageDriver=(function(){var a={};var c=localStorage;function b(f,e,d){if(d){f=APP_ID+"_"+f}else{if(e.UUID){f=e.UUID.toUpperCase()+"_"+f}}return f}a.isSupported=function(){if(typeof conduit_storage!=="undefined"){c=conduit_storage}return(typeof c!=="undefined")};a.setItem=function(d,g,h,k,j,f){if((typeof(h)!=="string")||(typeof(k)!=="string")){Utils.Helpers.funcWrapper(g)();return false}h=b(h,f,j);try{c.setItem(h,k)}catch(i){try{c.clear();c.setItem(h,k)}catch(i){Utils.Helpers.funcWrapper(g)();return false}}Utils.Helpers.funcWrapper(d)();return true};a.getItem=function(d,f,g,i,e){if(typeof(g)!=="string"){Utils.Helpers.funcWrapper(f)();return null}else{g=b(g,e,i);var h=c.getItem(g);if(typeof h==="undefined"||h==null){Utils.Helpers.funcWrapper(f)();h=null}else{Utils.Helpers.funcWrapper(d)(h)}return h}};a.removeItem=function(d,g,h,f,j){if(typeof(h)!=="string"){Utils.Helpers.funcWrapper(g)();return null}else{h=b(h,f,j);try{c.removeItem(h)}catch(i){}Utils.Helpers.funcWrapper(d)()}};a.clearStorage=function(d,j,g){var f;var k="";storageLength=c.length;var h=g.UUID.toUpperCase();var e=h.length;for(f=0;f<storageLength;){k=c.key(f);if(k.substring(0,e)==h){c.removeItem(k);storageLength--}else{f++}}Utils.Helpers.funcWrapper(d)();return true};return a}()); var BaseInputPanelDriver=function(){};BaseInputPanelDriver.prototype={_getDefaultOptions:function(){return{initialTxt:"",sendBtnTxt:_T("HtmlTextInputPanelButtonSendMessage"),placeHolderTxt:_T("HtmlTextInputPanelPlaceholder")}},openPanel:function(a,c,b){},closePanel:function(a,b){}}; var BaseGoogleMap={showDirections:function(h,b,c,a){var e=this;var f=null;var j=null;if(c){if(c.lat&&c.lng){f=c.lat+","+c.lng}else{if(c.address){f=c.address}}}if(a){if(a.lat&&a.lng){j=a.lat+","+a.lng}else{if(a.address){j=a.address}}}function d(){e._doShowDirections(h,b,f,j)}function g(k){if(!f){f=k.coords.latitude+","+k.coords.longitude}else{j=k.coords.latitude+","+k.coords.longitude}d()}function i(){Utils.Helpers.funcWrapper(b)()}if(f==null||j==null){conduitApi.platform.geo.getLocation(g,i)}else{d()}},_doShowDirections:function(d,a,c,b){}}; var accelerometerDriver=(function(){var a={};a.isSupported=function(){return false};a.getLastAcceleration=function(b,c){Utils.Helpers.funcWrapper(c)("not supported")};a.startAcceleration=function(b,d,c){Utils.Helpers.funcWrapper(d)("not supported")};a.stopAcceleration=function(b,c,d){Utils.Helpers.funcWrapper(c)("not supported")};return a}()); var cameraDriver=(function(){var a={};a.isSupported=function(){return false};a.captureImage=function(b,d,c){Utils.Helpers.funcWrapper(d)("not supported")};return a}()); var deviceInfoDriver=(function(){var a={};var b=null;a.isSupported=function(c){return true};a.getDeviceInfo=function(c,d){var e="en";if(navigator.userLanguage){e=navigator.userLanguage}else{if(window.navigator.language){e=window.navigator.language}}b={device:DEVICE,platform:PLATFORM,layout:LAYOUT,version:"1.0",uuid:null,language:e};Utils.Helpers.funcWrapper(c)(b)};return a}()); function GeoDriver(){this.Super()}GeoDriver.prototype=BaseGeoDriver.extend({_createCbFail:function(a){return function(b){PositionError={PERMISSION_DENIED:1,POSITION_UNAVAILABLE:2,TIMEOUT:3};switch(b.code){case PositionError.PERMISSION_DENIED:b.code=conduitApi.platform.geo.ErrorCodes.PERMISSION_DENIED;break;case PositionError.POSITION_UNAVAILABLE:b.code=conduitApi.platform.geo.POSITION_UNAVAILABLE;break;case PositionError.TIMEOUT:b.code=conduitApi.platform.geo.TIMEOUT;break;case PositionError.UNKNOWN_ERROR:b.code=conduitApi.platform.geo.UNKNOWN_ERROR;break}Utils.Helpers.funcWrapper(a)(b)}},_getLocation:function(a,c,b){var d=this.getDefLocationOpt(b);navigator.geolocation.getCurrentPosition(a,c,d);if(navigator.userAgent.indexOf("Firefox/")>0){var e=5000;if(d.timeout){e=d.timeout}setTimeout(c,e)}}}); var audioDriver=(function(){var m={};var o=1;var e=0;var a={};var c={};var b={};var f={};var l={};var h={};var d={};var j={};var n={};var k={};var i={};var g=!!document.createElement("audio").canPlayType;function p(q,r){return"audio-player"+q+"_"+r}m.isSupported=function(){return g};m.getVolume=function(q,r){if(typeof(q)==="function"){q(o)}};m.setVolume=function(q,r,s){o=s;var t=$("audio");$.each(t,function(u,v){v.volume=s});$.each(a,function(u,v){v(s)});eventsManager.dispatchEvent("volumeChangedEvent",{volume:s});if(typeof(q)==="function"){q()}};m.registerVolumeChanged=function(q,t,r,s){if(typeof(r)==="function"){if(s.pageId){a[s.pageId]=r}}if(typeof(q)==="function"){q()}};m.unregisterVolumeChanged=function(q,s,r){if(r.pageId){if(a[r.pageId]){delete a[r.pageId]}if(typeof(q)==="function"){q();return}}if(typeof(s)==="function"){s()}};m.registerMediaEnded=function(q,t,u,r,s){if(typeof(r)==="function"){if(s.pageId){c[p(s.pageId,u)]=r}}if(typeof(q)==="function"){q()}};m.unregisterMediaEnded=function(q,s,t,r){if(r.pageId){if(c[p(r.pageId,t)]){delete c[p(r.pageId,t)]}}if(typeof(q)==="function"){q()}};m.registerMediaPlaying=function(q,t,u,r,s){if(typeof(r)==="function"){if(s.pageId){b[p(s.pageId,u)]=r}}if(typeof(q)==="function"){q()}};m.unregisterMediaPlaying=function(q,s,t,r){if(r.pageId){if(b[p(r.pageId,t)]){delete b[p(r.pageId,t)]}}if(typeof(q)==="function"){q()}};m.registerMediaPause=function(q,t,u,r,s){if(typeof(r)==="function"){if(s.pageId){f[p(s.pageId,u)]=r}}if(typeof(q)==="function"){q()}};m.unregisterMediaPause=function(q,s,t,r){if(r.pageId){if(f[p(r.pageId,t)]){delete f[p(r.pageId,t)]}}if(typeof(q)==="function"){q()}};m.registerMediaTimeUpdate=function(q,t,u,r,s){if(typeof(r)==="function"){if(s.pageId){l[p(s.pageId,u)]=r}}if(typeof(q)==="function"){q()}};m.unregisterMediaTimeUpdate=function(q,s,t,r){if(r.pageId){if(l[p(r.pageId,t)]){delete l[p(r.pageId,t)]}}if(typeof(q)==="function"){q()}};m.registerMediaCanPlay=function(q,t,u,r,s){if(typeof(r)==="function"){if(s.pageId){h[p(s.pageId,u)]=r}}if(typeof(q)==="function"){q()}};m.unregisterMediaCanPlay=function(q,s,t,r){if(r.pageId){if(h[p(r.pageId,t)]){delete h[p(r.pageId,t)]}}if(typeof(q)==="function"){q()}};m.registerMediaSeeked=function(q,t,u,r,s){if(typeof(r)==="function"){if(s.pageId){d[p(s.pageId,u)]=r}}if(typeof(q)==="function"){q()}};m.unregisterMediaSeeked=function(q,s,t,r){if(r.pageId){if(d[p(r.pageId,t)]){delete d[p(r.pageId,t)]}}if(typeof(q)==="function"){q()}};m.registerMediaSeeking=function(q,t,u,r,s){if(typeof(r)==="function"){if(s.pageId){j[p(s.pageId,u)]=r}}if(typeof(q)==="function"){q()}};m.unregisterMediaSeeking=function(q,s,t,r){if(r.pageId){if(j[p(r.pageId,t)]){delete j[p(r.pageId,t)]}}if(typeof(q)==="function"){q()}};m.registerLoadedMetaData=function(q,t,u,r,s){if(typeof(r)==="function"){if(s.pageId){n[p(s.pageId,u)]=r}}if(typeof(q)==="function"){q()}};m.unregisterLoadedMetaData=function(q,s,t,r){if(r.pageId){if(n[p(r.pageId,t)]){delete n[p(r.pageId,t)]}}if(typeof(q)==="function"){q()}};m.registerLoadStart=function(q,t,u,r,s){if(typeof(r)==="function"){if(s.pageId){k[p(s.pageId,u)]=r}}if(typeof(q)==="function"){q()}};m.unregisterLoadStart=function(q,s,t,r){if(r.pageId){if(k[p(r.pageId,t)]){delete k[p(r.pageId,t)]}}if(typeof(q)==="function"){q()}};m.registerError=function(q,t,u,r,s){if(typeof(r)==="function"){if(s.pageId){i[p(s.pageId,u)]=r}}if(typeof(q)==="function"){q()}};m.unregisterError=function(q,s,t,r){if(r.pageId){if(i[p(r.pageId,t)]){delete i[p(r.pageId,t)]}}if(typeof(q)==="function"){q()}};m.createPlayer=function(r,v,u){if(typeof(r)!=="function"){return}e++;var w=e;var q=p(u.pageId,e);var x=$(document.body);var t='<audio id="'+q+'"></audio>';x.append(t);var s=$("#"+q);if(s.length>0){s.bind("ended",function(){if(c[q]){c[q]()}eventsManager.dispatchEvent("mediaEndedEvent",{playerHandle:w});s[0].pause()});s.bind("playing",function(){if(b[q]){b[q]()}eventsManager.dispatchEvent("mediaPlayingEvent",{playerHandle:w})});s.bind("pause",function(){if(f[q]){f[q]()}eventsManager.dispatchEvent("mediaPauseEvent",{playerHandle:w})});s.bind("timeupdate",function(){if(l[q]){l[q](s[0].currentTime)}eventsManager.dispatchEvent("mediaTimeUpdateEvent",{playerHandle:w,currentTime:s[0].currentTime})});s.bind("canplay",function(){if(h[q]){h[q]()}eventsManager.dispatchEvent("mediaCanPlayEvent",{playerHandle:w})});s.bind("seeked",function(){if(d[q]){d[q]()}eventsManager.dispatchEvent("mediaSeekedEvent",{playerHandle:w})});s.bind("seeking",function(){if(j[q]){j[q]()}eventsManager.dispatchEvent("mediaSeekingEvent",{playerHandle:w})});s.bind("loadedmetadata",function(){if(n[q]){n[q]()}eventsManager.dispatchEvent("loadedMetaDataEvent",{playerHandle:w})});s.bind("loadstart",function(){if(k[q]){k[q]()}eventsManager.dispatchEvent("loadStartEvent",{playerHandle:w})});s.bind("error",function(){if(i[q]){i[q]()}eventsManager.dispatchEvent("errorEvent",{playerHandle:w})});s[0].volume=o;r(w);return}if(typeof(v)==="function"){v()}};m.destroyPlayer=function(s){var q=p(context.pageId,s);var r=$("#"+q);r.unbind("ended").unbind("playing").unbind("pause").unbind("timeupdate").unbind("canplay").unbind("seeked").unbind("seeking").unbind("loadedmetadata").unbind("loadstart").unbind("error").remove()};m.setUrl=function(q,u,v,s,t){var r=$("#"+p(t.pageId,v));if(r.length>0){setTimeout(function(){r.attr("src",s);r[0].load();if(typeof(q)==="function"){q();return}},1)}if(typeof(u)==="function"){u()}};m.setCurrentTime=function(q,t,v,u,s){var r=$("#"+p(s.pageId,v));if(r.length>0){r[0].currentTime=u;if(typeof(q)==="function"){q();return}}if(typeof(t)==="function"){t()}};m.getCurrentTime=function(q,t,u,s){var r=$("#"+p(s.pageId,u));if(r.length>0){if(typeof(q)==="function"){q(r[0].currentTime);return}}if(typeof(t)==="function"){t()}};m.getDuration=function(q,t,u,s){var r=$("#"+p(s.pageId,u));if(r.length>0){if(typeof(q)==="function"){q(r[0].duration);return}}if(typeof(t)==="function"){t()}};m.pause=function(q,t,u,s){var r=$("#"+p(s.pageId,u));if(r.length>0){r[0].pause();if(typeof(q)==="function"){q();return}}if(typeof(t)==="function"){t()}};m.play=function(q,t,u,s){var r=$("#"+p(s.pageId,u));if(r.length>0){r[0].play();if(typeof(q)==="function"){q();return}}if(typeof(t)==="function"){t()}};return m}()); var orientationDriver=(function(){var a={};a.isSupported=function(){return(typeof window.orientation!=="undefined")};a.getOrientation=function(b,c){b(window.orientation)};a.setOrientation=function(b,c,d){Utils.Helpers.funcWrapper(c)("not supported")};a.lockOrientation=function(b,d,e,c){Utils.Helpers.funcWrapper(d)("not supported")};a.unlockOrientation=function(b,d,c){Utils.Helpers.funcWrapper(d)("not supported")};a.startOrientation=function(b,d,c){Utils.Helpers.funcWrapper(d)("not supported")};a.stopOrientation=function(b,d,c){Utils.Helpers.funcWrapper(d)("not supported")};return a}()); var pushNotificationDriver=(function(){var a={};a.isSupported=function(){return false};a.registerPushNotification=function(b,e,c,d){Utils.Helpers.funcWrapper(e)("not supported")};a.unregisterPushNotification=function(b,d,c){Utils.Helpers.funcWrapper(d)("not supported")};return a}()); var uiDriver=(function(){var a={};a.isSupported=function(){return true};a.startActivityIndicator=function(c,d,e,b){cqm.showLoading(e,b);Utils.Helpers.funcWrapper(c)()};a.dismissActivityIndicator=function(c,d,b){cqm.hideLoading(b);Utils.Helpers.funcWrapper(c)()};a.showDialogBox=function(c,e,d,b){cqm.showDialogBox(d.title,d.message,d.buttons);Utils.Helpers.funcWrapper(c)()};a.showToastMessage=function(c,d,e,b,f){cqm.showToastMessage(e,b,f);Utils.Helpers.funcWrapper(c)()};return a}()); var vibrateDriver=(function(){var a={};a.isSupported=function(){return false};a.vibrateForTime=function(b,d,c){Utils.Helpers.funcWrapper(d)("not supported")};return a}()); var inAppPurchaseDriver=(function(){var a={};a.isSupported=function(){return false};a.init=function(b,d,c){Utils.Helpers.funcWrapper(d)("not supported")};a.purchase=function(b,c,d){Utils.Helpers.funcWrapper(c)("not supported")};return a}()); var gesturesDriver=(function(){var a={};a.isSupported=function(){return false};a.registerShake=function(b,d,c){Utils.Helpers.funcWrapper(d)("not supported")};a.unregisterShake=function(b,d,c){Utils.Helpers.funcWrapper(d)("not supported")};return a}()); function AppDriver(){this.Super()}AppDriver.prototype=BaseAppDriver.extend({HTTP_PREFIX:"http://",HTTPS_PREFIX:"https://",isSupported:function(){return true},openLink:function(a,e,c,f,g,d){if(!c||!c.url){Utils.Helpers.funcWrapper(e)("No URL!");return}var b=this.Super(a,e,c,f,g,d);if(!b){return}if(c.openInCurrentWindow){document.location=c.url}else{if(c.url.indexOf("://")==-1){c.url=this.HTTP_PREFIX+c.url}window.open(c.url)}Utils.Helpers.funcWrapper(a)()},closeLink:function(a,b,c){Utils.Helpers.funcWrapper(b)("unsupported")},setLinkRect:function(a,b,d,c){Utils.Helpers.funcWrapper(b)("unsupported")},closeApp:function(a,b){window.close();Utils.Helpers.funcWrapper(a)()},addBackButton:function(a,e,c,b,g,d){if(DEVICE!==deviceTypeEnum.android||PLATFORM==platformEnum.simulator){function f(h){this._backBtnHandle=h;Utils.Helpers.funcWrapper(a)()}this.addInfoBarButton(f.hitch(this),e,"back.png",b,g,d)}},removeBackButton:function(a,c,b){if(DEVICE!==deviceTypeEnum.android||PLATFORM==platformEnum.simulator){function d(e){this._backBtnHandle=null;Utils.Helpers.funcWrapper(a)()}this.removeInfoBarButton(d.hitch(this),c,this._backBtnHandle,b)}}}); var logDriver=(function(){var a={};a.error=function(b,c,d){console.error(d);Utils.Helpers.funcWrapper(b)()};a.warning=function(b,c,d){console.warn(d);Utils.Helpers.funcWrapper(b)()};a.info=function(b,c,d){console.log(d);Utils.Helpers.funcWrapper(b)()};return a}()); var mediaDriver=(function(){var h={};var d=null;var e=null;var c=null;var i=null;var f=!!document.createElement("audio").canPlayType;function g(){var j=false;if(c){j=c.get("statusPlaying")}if(!j){i=setTimeout(function(){a()},5000)}}function b(j){a();if(!c){c=new MediaPlayerModel({statusArrowUp:true})}c.set({tracks:[]});e=new MediaPlayerView({model:c});var k=$(j);var l=e.render().el;k.append(l);k.bind("hide",g);AppManager.app().bind("destroy",a)}function a(){if(i){clearTimeout(i);i=null}if(e){e.destroyPlayer();e.remove();delete e;e=null;$("audio").remove()}}h.isSupported=function(){return f};h.init=function(k,l,j){b(j);d=j;Utils.Helpers.funcWrapper(k)()};h.setTracks=function(j,k){c.set({tracks:k});Utils.Helpers.funcWrapper(j)()};h.play=function(j){e.play(j)};return h}()); var inputPanelDriver=BaseInputPanelDriver.extend((function(){var d={};var b=null;var c=null;function a(f,g){e();c=new InputPanelModel({cbSend:f});b=new InputPanelView({model:c,options:g});var h=$("#app_footer");h.prepend(b.render().el)}function e(){if(b){b.remove();delete b;b=null;delete c;c=null}}d.openPanel=function(f,h,g){g=_.extend({},this._getDefaultOptions(),g);a(f,g)};d.closePanel=function(f,g){e();Scrolling.onWrapperResize();Utils.Helpers.funcWrapper(f)()};return d})()); var videoDriver=(function(){var a={};a.isSupported=function(){return(typeof navigator.video!=="undefined")};a.play=function(b,c){navigator.video.play(b,c)};return a}()); function GoogleMap(){}GoogleMap.prototype=BaseGoogleMap;GoogleMap.prototype._doShowDirections=function(g,a,f,d){var c="http://maps.google.com/maps?saddr="+f+"&daddr="+d;var e=true;if(PLATFORM===platformEnum.simulator){e=false}var b={url:c,openInCurrentWindow:e};conduitApi.app.openLink(g,a,b)};if(typeof navigator.google_map=="undefined"){navigator.google_map=new GoogleMap()}; var BaseSocialService=function(){};BaseSocialService.prototype={SOCIAL_USER_CANCELED:"user_canceled",share:function(a,c,b){this._shareOptions=Utils.Helpers.deepClone(true,{},b);this._shareCbFail=Utils.Helpers.funcWrapper(c);this._shareCbSuccess=Utils.Helpers.funcWrapper(a);var d=this._createGetAtOptions();this.getAccessTokens(this._cbGetAccessSuccess.hitch(this),this._cbGetAccessFailed.hitch(this),d)}}; var SocialService=function(){};SocialService.prototype=BaseSocialService.extend({_openLoginForm:function(d){var e={pageId:this._options.pageId,pageState:this._options.pageState||{tabIndex:0}};conduitApi.platform.storage.setItem(null,null,RETURN_STATE_INFO,JSON.stringify(e),true);var h="return_app_id";var c=document.location.href;var b=c.length;if(!c.endsWith("#")){c=c+"#"}c=c+h+"="+APP_ID;var a={returnUrl:c};var g=Services.generateUrl(d,a);var f={url:g,hideDialog:true,openInCurrentWindow:true};conduitApi.app.openLink(null,this._getAtCbFail,f)},_createGetAtOptions:function(){var a={useLoginForm:true,pageState:this._shareOptions,pageId:this._shareOptions.pageId};return a},_getStoredTokens:function(d,c){var b=function(){c()};var a=function(f){try{f=JSON.parse(f)}catch(g){f=null}c(f)};conduitApi.platform.storage.getItem(a,b,d,true)}}); var Facebook=function(){};Facebook.prototype={FACEBOOK_API_TIMEOUT:8000,_fixTokens:function(a){a.fbId=a.fbId||(a.userId||a.userID);return a},getAccessTokens:function(b,d,c){var e=this;var h=function(n){var n=e._fixTokens(n);var m="FACEBOOK_USER_DATA_"+n.fbId;var l=null;if(conduitApi.platform.storage.isSupported()){var j=conduitApi.platform.storage.getItem(null,null,m,true);if(j){l=JSON.parse(j)}}if(l){Utils.Helpers.funcWrapper(b)(n,l)}else{var k=false;var o=setTimeout(function(){k=true;Utils.Helpers.funcWrapper(d)("timeout")},e.FACEBOOK_API_TIMEOUT);function i(p){if(!k){clearTimeout(o);Utils.Helpers.funcWrapper(b)(n,p)}if(p&&conduitApi.platform.storage.isSupported()){var q=JSON.stringify(p);conduitApi.platform.storage.setItem(null,null,m,q,true)}}FB.api("/"+n.fbId,i)}};var f=false;var a=(c&&c.useLoginForm)?e.FACEBOOK_API_TIMEOUT:1000;var g=setTimeout(function(){f=true;Utils.Helpers.funcWrapper(d)("timeout")},a);FB.getLoginStatus(function(i){if(!f){clearTimeout(g);if(i&&i.status==="connected"){h(i.authResponse)}else{if(c&&c.useLoginForm){FB.login(function(j){if(j.authResponse){var k={socialProviderType:conduitApi.analytics.socialProviderType.Facebook,socialId:"Facebook userId:"+j.authResponse.userId};conduitApi.analytics.addEvent(null,null,conduitApi.analytics.usageEventTypeEnum.SocialLogin,k);h(j.authResponse)}else{Utils.Helpers.funcWrapper(d)("User cancelled login or did not fully authorize.")}},{scope:"publish_stream"})}else{Utils.Helpers.funcWrapper(d)("User not connected.")}}}})},logout:function(a,b){if(window.CDV&&window.CDV.FB){FB.logout(a)}else{Utils.Helpers.funcWrapper(a)()}},share:function(a,d,c){var e=this;if(!c||!c.shareInfo){Utils.Helpers.funcWrapper(d)("missing params")}var b=Utils.ShareInfo.getFaceBookShareOptions(c.shareInfo);function f(){var g=false;var h=setTimeout(function(){g=true;Utils.Helpers.funcWrapper(d)("timeout")},e.FACEBOOK_API_TIMEOUT);FB.ui(b,function(i){if(!g){clearTimeout(h);if(i&&i.post_id){var j={shareType:conduitApi.analytics.socialShareTypes.Facebook,socialId:c.shareInfo.socialId};conduitApi.analytics.addEvent(null,null,conduitApi.analytics.usageEventTypeEnum.SocialShare,j);Utils.Helpers.funcWrapper(a)(i.post_id)}else{Utils.Helpers.funcWrapper(d)("not published")}}})}FB.getLoginStatus(function(g){if(g.status=="connected"){f()}else{FB.login(function(h){if(h.status=="connected"){f()}else{}},{scope:"publish_stream"})}})}}; var BaseTwitter=function(){};BaseTwitter.prototype=SocialService.extend({TWITTER_LOGIN_SERVICE_NAME:"MOBILE_TWITTER_LOGIN",_getStoredTokensCb:function(a){var b="&tId=";if(a&&a.sskey){this._getAtCbSuccess(a)}else{if(this._options.useLoginForm){this._openLoginForm(this.TWITTER_LOGIN_SERVICE_NAME,_T("DialogCaptionTwitterLogin"),TWITTER_TOKENS,b)}else{this._getAtCbFail()}}},_fixTokens:function(a){if(!a.cid&&a.cuid){a.cid=a.cuid}if(!a.tId&&a.user_id){a.tId=a.user_id}if(!a.name&&a.screen_name){a.name=a.screen_name}},_cbGetAccessFailed:function(a){if(!a||a!==this.SOCIAL_USER_CANCELED){var b=[{text:_T("ButtonClose"),cb:function(){}}];conduitApi.UI.showDialogBox(null,null,{title:_T("DialogCaptionTwitter"),message:_T("DialogMessageShareFailConectTwitter"),buttons:b})}this._shareCbFail()},_createCommentForTwitterShare:function(g,f,h){var i=140;var e=i-1;var c=Utils.String.stripTags(g).substring(0,e);var a="";if(f){a=" "+f}var d=c.length+a.length;if(d>i){c=Utils.String.trailString(c,e-a.length)}c+=a;if(h){h=" "+h;if(c.length+h.length<i){c+=h}}var j=AppManager.app().get("appLink");if(j){var b=".\n "+_T("SShareTweetedFromLink",{appLink:j});if(c.length+b.length<i){c+=b}}return c},_formatShareInfoDoneCb:function(a){if(this._shareOptions.allowEdit){this._shareOptions.shareInfo.service=conduitApi.social.socialServicesEnum.Twitter;this._shareOptions.shareInfo.name=a.name;conduitApi.__BCAPI.social.openSharePage(this._shareOptions.shareInfo);this._shareCbSuccess()}else{conduitApi.__BCAPI.social.tweet(cbSuccess,cbFail,this._shareOptions.shareInfo.comment)}},_cbGetAccessSuccess:function(a){conduitApi.__BCAPI.social.saveShareInfo(this._shareOptions.shareInfo,a);this._shareOptions.shareInfo.comment=this._createCommentForTwitterShare(this._shareOptions.shareInfo.twitterTitle||this._shareOptions.shareInfo.title,this._shareOptions.shareInfo.url,this._shareOptions.shareInfo.twitterFrom);this._formatShareInfoDoneCb(a)},getAccessTokens:function(a,c,b){this._getAtCbSuccess=Utils.Helpers.funcWrapper(a);this._getAtCbFail=Utils.Helpers.funcWrapper(c);this._options=b;this._getStoredTokens(TWITTER_TOKENS,this._getStoredTokensCb.hitch(this))}}); var Email=function(){};Email.prototype={share:function(b,e,c){var g=c.shareInfo.emailTitle||c.shareInfo.title||"";var d=encodeURIComponent(g);var a=Utils.ShareInfo.getEMailBody(c.shareInfo)||"";a=Utils.String.removeHTMLTags(a);a=Utils.String.desanitize(a);var f={shareType:conduitApi.analytics.socialShareTypes.Email,socialId:c.shareInfo.socialId};conduitApi.analytics.addEvent(null,null,conduitApi.analytics.usageEventTypeEnum.SocialShare,f);this.sendMail(d,a);Utils.Helpers.funcWrapper(b)()},sendMail:function(b,a){document.location="mailto:?subject="+b+"&body="+a}}; var Twitter=function(){};Twitter.prototype=BaseTwitter.extend({logout:function(a,b){conduitApi.platform.storage.removeItem(null,null,TWITTER_TOKENS);this._openLoginForm(this.TWITTER_LOGIN_SERVICE_NAME)}}); /*
 * NOTE: every "conduit" change will be with "CONDUIT CHANGE" comment!
 *
 * Add to Homescreen v2.0 ~ Copyright (c) 2012 Matteo Spinelli, http://cubiq.org
 * Released under MIT license, http://cubiq.org/license
 */
var addToHome=(function(n){if(DEVICE!==deviceTypeEnum.iphone||PLATFORM!==platformEnum.webApp){return}var i=n.navigator,j="platform" in i&&(/iphone|ipod|ipad/gi).test(i.platform),v,o,y,B,e,x=0,u=0,f,b,C,a,l,k,m,d={autostart:true,returningVisitor:false,animationIn:"drop",animationOut:"fade",startDelay:2000,lifespan:15000,bottomOffset:14,expire:0,message:"",touchIcon:false,arrow:true,hookOnLoad:true,iterations:100},q={ca_es:"Per installar aquesta aplicaci al vostre %device premeu %icon i llavors <strong>Afegir a pantalla d'inici</strong>.",da_dk:"Tilf?j denne side til din %device: tryk p %icon og derefter <strong>Tilf?j til hjemmeskrm</strong>.",de_de:"Installieren Sie diese App auf Ihrem %device: %icon antippen und dann <strong>Zum Home-Bildschirm</strong>.",el_gr:"       %device: %icon   <strong>?  </strong>.",en_us:"Install this web app on your %device: tap %icon and then <strong>Add to Home Screen</strong>.",es_es:"Para instalar esta app en su %device, pulse %icon y seleccione <strong>Aadir a pantalla de inicio</strong>.",fi_fi:"Asenna tm web-sovellus laitteeseesi %device: paina %icon ja sen jlkeen valitse <strong>Lis Koti-valikkoon</strong>.",fr_fr:"Ajoutez cette application sur votre %device en cliquant sur %icon, puis <strong>Ajouter  l'cran d'accueil</strong>.",he_il:'<span dir="rtl">    -%device :  %icon  <strong>  </strong>.</span>',hu_hu:"Teleptse ezt a web-alkalmazst az n %device-jra: nyomjon a %icon-ra majd a <strong>Fkpernyhz ads</strong> gombra.",it_it:"Installa questa applicazione sul tuo %device: premi su %icon e poi <strong>Aggiungi a Home</strong>.",ja_jp:"%device%icon<strong>?</strong>?",ko_kr:'%device? ??? ?? %icon? ?  "? ??" ????',nb_no:"Installer denne appen p din %device: trykk p %icon og deretter <strong>Legg til p Hjem-skjerm</strong>",nl_nl:"Installeer deze webapp op uw %device: tik %icon en dan <strong>Zet in beginscherm</strong>.",pt_br:"Instale este web app em seu %device: aperte %icon e selecione <strong>Adicionar  Tela Inicio</strong>.",pt_pt:"Para instalar esta aplicao no seu %device, prima o %icon e depois o <strong>Adicionar ao ecr principal</strong>.",ru_ru:"?  -??   %device: ? %icon,  <strong>?  </strong>.",sv_se:"Lgg till denna webbapplikation p din %device: tryck p %icon och drefter <strong>Lgg till p hemskrmen</strong>.",th_th:"??????????? ???? %device ???????: ?? %icon ?? <strong>????????????</strong>",tr_tr:"%device iin bu uygulamay kurduktan sonra %icon simgesine dokunarak <strong>Ev Ekranna Ekle</strong>yin.",zh_cn:"??? %device ? %icon ??<strong>?</strong>",zh_tw:"??? %device ? %icon ??<strong>??</strong>"};function t(){if(!j){return}var w=Date.now(),D;if(n.addToHomeConfig){for(D in n.addToHomeConfig){d[D]=n.addToHomeConfig[D]}}if(!d.autostart){d.hookOnLoad=false}v=(/ipad/gi).test(i.platform);o=n.devicePixelRatio&&n.devicePixelRatio>1;y=i.appVersion.match(/Safari/gi);B=i.standalone;e=i.appVersion.match(/OS (\d+_\d+)/i);e=e[1]?+e[1].replace("_","."):0;f=+n.localStorage.getItem("addToHome")||w;b=n.sessionStorage.getItem("addToHomeSession");C=!d.returningVisitor||(f&&f+28*24*60*60*1000>w);f=(!d.expire||f<=w);if(d.hookOnLoad){n.addEventListener("load",s,false)}else{if(!d.hookOnLoad&&d.autostart){s()}}}function s(){n.removeEventListener("load",s,false);if(!l&&(!y||!f||b||B||!C)){return}if(d.expire||d.returningVisitor){n.localStorage.setItem("addToHome",Date.now()+d.expire*60000)}var H=d.touchIcon?document.querySelectorAll("head link[rel=apple-touch-icon],head link[rel=apple-touch-icon-precomposed]"):[],I,F="",E,w=i.platform.split(" ")[0],J="en_us",G,D;a=document.createElement("div");a.id="addToHomeScreen";a.style.cssText+="left:-9999px;-webkit-transition-property:-webkit-transform,opacity;-webkit-transition-duration:0;-webkit-transform:translate3d(0,0,0);position:"+(e<5?"absolute":"fixed");if(d.message in q){J=d.message;d.message=""}if(d.message===""){d.message=J in q?q[J]:q.en_us}if(H.length){for(G=0,D=H.length;G<D;G++){I=H[G].getAttribute("sizes");if(I){if(o&&I=="114x114"){F=H[G].href;break}}else{F=H[G].href}}F='<span style="background-image:url('+F+')" class="addToHomeTouchIcon"></span>'}a.className=(v?"addToHomeIpad":"addToHomeIphone")+(F?" addToHomeWide":"");a.innerHTML=F+d.message.replace("%device",w).replace("%icon",e>=4.2?'<span class="addToHomeShare"></span>':'<span class="addToHomePlus">+</span>')+(d.arrow?'<span class="addToHomeArrow"></span>':"")+'<span class="addToHomeClose">\u00D7</span>';document.body.appendChild(a);E=a;if(E){E.addEventListener("click",g,true);E.addEventListener("touchend",g,true);E.addEventListener("touchstart",g,true)}setTimeout(A,d.startDelay)}function A(){if(window.add2HomeIsDisabled===true){return}var D,w=160;if(v){if(e<5){u=n.scrollY;x=n.scrollX;w=208}a.style.top=u+d.bottomOffset+"px";a.style.left=x+w-Math.round(a.offsetWidth/2)+"px";switch(d.animationIn){case"drop":D="0.6s";a.style.webkitTransform="translate3d(0,"+-(n.scrollY+d.bottomOffset+a.offsetHeight)+"px,0)";break;case"bubble":D="0.6s";a.style.opacity="0";a.style.webkitTransform="translate3d(0,"+(u+50)+"px,0)";break;default:D="1s";a.style.opacity="0"}}else{u=n.innerHeight+n.scrollY;if(e<5){x=Math.round((n.innerWidth-a.offsetWidth)/2)+n.scrollX;a.style.left=x+"px";a.style.top=u-a.offsetHeight-d.bottomOffset+"px"}else{a.style.left="50%";a.style.marginLeft=-Math.round(a.offsetWidth/2)+"px";a.style.bottom=d.bottomOffset+"px"}switch(d.animationIn){case"drop":D="1s";a.style.webkitTransform="translate3d(0,"+-(u+d.bottomOffset)+"px,0)";break;case"bubble":D="0.6s";a.style.webkitTransform="translate3d(0,"+(a.offsetHeight+d.bottomOffset+50)+"px,0)";break;default:D="1s";a.style.opacity="0"}}a.offsetHeight;a.style.webkitTransitionDuration=D;a.style.opacity="1";a.style.webkitTransform="translate3d(0,0,0)";a.addEventListener("webkitTransitionEnd",h,false);m=setTimeout(p,d.lifespan)}function r(w){if(!j||a){return}l=w;s()}function p(){clearInterval(k);clearTimeout(m);m=null;var F=0,G=0,D="1",E="0",w=a;if(w){w.removeEventListener("click",p,false)}if(e<5){F=v?n.scrollY-u:n.scrollY+n.innerHeight-u;G=v?n.scrollX-x:n.scrollX+Math.round((n.innerWidth-a.offsetWidth)/2)-x}a.style.webkitTransitionProperty="-webkit-transform,opacity";switch(d.animationOut){case"drop":if(v){E="0.4s";D="0";F=F+50}else{E="0.6s";F=F+a.offsetHeight+d.bottomOffset+50}break;case"bubble":if(v){E="0.8s";F=F-a.offsetHeight-d.bottomOffset-50}else{E="0.4s";D="0";F=F-50}break;default:E="0.8s";D="0"}a.addEventListener("webkitTransitionEnd",h,false);a.style.opacity=D;a.style.webkitTransitionDuration=E;a.style.webkitTransform="translate3d("+G+"px,"+F+"px,0)"}function g(){try{n.sessionStorage.setItem("addToHomeSession","1");b=true}catch(w){console.log("add to home failed to save session flag : "+w.message)}p()}function h(){a.removeEventListener("webkitTransitionEnd",h,false);a.style.webkitTransitionProperty="-webkit-transform";a.style.webkitTransitionDuration="0.2s";if(!m){a.parentNode.removeChild(a);a=null;return}if(e<5&&m){k=setInterval(c,d.iterations)}}function c(){var w=new WebKitCSSMatrix(n.getComputedStyle(a,null).webkitTransform),D=v?n.scrollY-u:n.scrollY+n.innerHeight-u,E=v?n.scrollX-x:n.scrollX+Math.round((n.innerWidth-a.offsetWidth)/2)-x;if(D==w.m42&&E==w.m41){return}a.style.webkitTransform="translate3d("+E+"px,"+D+"px,0)"}function z(){n.localStorage.removeItem("addToHome");n.sessionStorage.removeItem("addToHomeSession")}t();return{show:r,close:p,reset:z}})(this); /*
 * jQuery Smart Banner
 * Copyright (c) 2012 Arnold Daniels <arnold@jasny.net>
 * Based on 'jQuery Smart Web App Banner' by Kurt Zenisek @ kzeni.com
 */
!function(b){var a=function(d){this.origHtmlMargin=parseFloat(b("html").css("margin-top"));this.options=b.extend({},b.smartbanner.defaults,d);var c=navigator.standalone;if(this.options.force){this.type=this.options.force}else{if(navigator.userAgent.match(/iPad|iPhone|iPod/i)!=null){if(navigator.userAgent.match(/Safari/i)!=null&&(navigator.userAgent.match(/CriOS/i)!=null||window.Number(navigator.userAgent.substr(navigator.userAgent.indexOf("OS ")+3,3).replace("_","."))<6)){this.type="ios"}}else{if(navigator.userAgent.match(/Android/i)!=null){this.type="android"}}}if(!this.type||c||this.getCookie("sb-closed"+this.options.cookiePostfix)||this.getCookie("sb-installed"+this.options.cookiePostfix)){return}if(this.scale<1){this.scale=1}var g=b(this.type=="android"?'meta[name="google-play-app"]':'meta[name="apple-itunes-app"]');if(g.length==0&&!this.options.url){return}var f=g.length>0?/app-id=([^\s,]+)/.exec(g.attr("content")):null;var e=g.length>0?/store-url=([^\s,]+)/.exec(g.attr("content")):null;this.options.url=this.options.url?this.options.url:((e&&e.length>1)?e[1]:null);this.appId=(f&&f.length>1)?(f[1]):null;this.title=this.options.title?this.options.title:b("title").text().replace(/\s*[|\-].*$/,"");this.author=this.options.author?this.options.author:(b('meta[name="author"]').length?b('meta[name="author"]').attr("content"):window.location.hostname);this.create();this.show();this.listen()};a.prototype={constructor:a,create:function(){var e,d=(this.options.url?this.options.url:(this.type=="android"?"market://details?id=":("https://itunes.apple.com/"+this.options.appStoreLanguage+"/app/id"))+this.appId),h=(this.type=="android"?this.options.inGooglePlay:this.options.inAppStore),g=this.options.price?this.options.price+" - "+h:h,f=this.options.iconGloss===null?(this.type=="ios"):this.options.iconGloss;var c=this.options.targetElement||b("body");c.prepend('<div id="smartbanner" class="'+this.type+'"><div class="sb-container"><a href="#" class="sb-close"></a><span class="sb-icon"></span><div class="sb-info"><strong>'+this.title+"</strong><span>"+this.author+"</span><span>"+g+'</span></div><a href="'+d+'" class="sb-button"><span>'+this.options.button+"</span></a></div></div>");if(this.options.icon){e=this.options.icon}else{if(b('link[rel="apple-touch-icon-precomposed"]').length>0){e=b('link[rel="apple-touch-icon-precomposed"]').attr("href");if(this.options.iconGloss===null){f=false}}else{if(b('link[rel="apple-touch-icon"]').length>0){e=b('link[rel="apple-touch-icon"]').attr("href")}}}if(e){b("#smartbanner .sb-icon").css("background-image","url("+e+")");if(f){b("#smartbanner .sb-icon").addClass("gloss")}}else{b("#smartbanner").addClass("no-icon")}this.bannerHeight=b("#smartbanner").outerHeight()+2;if(this.scale>1){b("#smartbanner").css("top",parseFloat(b("#smartbanner").css("top"))*this.scale).css("height",parseFloat(b("#smartbanner").css("height"))*this.scale);b("#smartbanner .sb-container").css("-webkit-transform","scale("+this.scale+")").css("-msie-transform","scale("+this.scale+")").css("-moz-transform","scale("+this.scale+")").css("width",b(window).width()/this.scale)}},listen:function(){b("#smartbanner .sb-close").bind("click",b.proxy(this.close,this));b("#smartbanner .sb-button").bind("click",b.proxy(this.install,this))},show:function(c){b("#smartbanner .sb-container").stop().animate({top:0},this.options.speedIn);b("#smartbanner").stop().animate({height:this.bannerHeight*this.scale},this.options.speedIn).addClass("shown")},hide:function(c){b("#smartbanner .sb-container").stop().animate({top:-1*this.bannerHeight*this.scale},this.options.speedOut);b("#smartbanner").stop().animate({height:0},this.options.speedOut,function(){b(this).css("border-style","none")}).removeClass("shown")},close:function(c){c.preventDefault();this.hide();this.setCookie("sb-closed"+this.options.cookiePostfix,"true",this.options.daysHidden);if(this.options.onClose&&typeof this.options.onClose==="function"){this.options.onClose()}},install:function(c){this.hide();this.setCookie("sb-installed"+this.options.cookiePostfix,"true",this.options.daysReminder)},setCookie:function(c,e,d){var f=new Date();f.setDate(f.getDate()+d);e=escape(e)+((d==null)?"":"; expires="+f.toUTCString());document.cookie=c+"="+e+"; path=/;"},getCookie:function(d){var e,c,g,f=document.cookie.split(";");for(e=0;e<f.length;e++){c=f[e].substr(0,f[e].indexOf("="));g=f[e].substr(f[e].indexOf("=")+1);c=c.replace(/^\s+|\s+$/g,"");if(c==d){return unescape(g)}}return null},switchType:function(){var c=this;this.hide(function(){c.type=c.type=="android"?"ios":"android";var d=b(c.type=="android"?'meta[name="google-play-app"]':'meta[name="apple-itunes-app"]').attr("content");c.appId=/app-id=([^\s,]+)/.exec(d)[1];b("#smartbanner").detach();c.create();c.show()})}};b.smartbanner=function(d){var f=b(window),e=f.data("typeahead"),c=typeof d=="object"&&d;if(!e){f.data("typeahead",(e=new a(c)))}if(typeof d=="string"){e[d]()}};b.smartbanner.defaults={title:null,author:null,price:"FREE",appStoreLanguage:"us",inAppStore:"On the App Store",inGooglePlay:"In Google Play",icon:null,iconGloss:null,button:"VIEW",url:null,scale:"auto",speedIn:300,speedOut:400,daysHidden:15,daysReminder:90,force:null,targetElement:null,cookiePostfix:""};b.smartbanner.Constructor=a}(window.jQuery); window.SmartBanner=(function(){var f={daysHidden:1,daysReminder:7,price:null};var a=null;var c=function(){window.setTimeout(Scrolling.triggerWrapperResize,50)};var d=function(j){var i,h=null;if(AppSettingsManager&&(i=AppSettingsManager.getSettings())){h=i.get("smartbanner")}var g={title:j.get("appLabel"),icon:j.get("appIcon"),author:" ",inAppStore:_T("SmartBannerInAppStore"),inGooglePlay:_T("SmartBannerInGooglePlay"),button:_T("SmartBannerButtonText"),cookiePostfix:"_"+APP_ID,price:"",onClose:c};a=$.extend({},f,g,h)};var b=function(){var g=$.extend({},a,{targetElement:$(".app_header")});$.smartbanner(g)};var e={show:b,initOptionsWithAppData:d};return e}()); var PostMsgSender=function(a){var b={};var d;function c(e){d=e}b.sendMessage=function(f){var e=comUtils.stringifyMessage(f);if(d.postMessage){d.postMessage(e,"*")}};c(a);return b}; var PostMsgReceiver=function(a){var d={};var c;function b(i){try{var k=i.data;var h=comTypeEnum.postMessage;var f=i.source;var j=comUtils.parseMessage(k,h,f);c(j)}catch(g){console.log(g)}}function e(f){c=f;if(window.addEventListener){window.addEventListener("message",b,false)}else{if(window.attachEvent){window.attachEvent("onmessage",b)}}}d.stop=function(){if(window.removeEventListener){window.removeEventListener("message",b,false)}else{if(window.detachEvent){window.detachEvent("onmessage",b)}}};e(a);return d}; var IframeSender=function(a){var b={};var d;function c(f){d=f}b.sendMessage=function(i){var f=comUtils.stringifyMessage(i);var g={msgStr:f,metaData:_pageId};try{d.__handleMessage(g)}catch(h){}};c(a);return b};var _pageId;function setPageId(a){_pageId=a}try{if(window.frameElement&&typeof(window.frameElement.setPageId)==="function"){window.frameElement.setPageId(setPageId)}}catch(e){}; var IframeReceiver=function(a){var b={};function c(d){__cbReceive=d;__iframeReceiveActive=true}b.stop=function(){__iframeReceiveActive=false};c(a);return b};var __cbReceive;var __iframeReceiveActive=false;function __handleMessage(b){if(!__iframeReceiveActive){return}var a=comTypeEnum.iframeMessage;var c=comUtils.parseMessage(b.msgStr,a,b.metaData);__cbReceive(c)}; var NativeMsgSender=function(d){var a={};var c;function b(e){c=e}a.sendMessage=function(h){var g={receiverId:c,message:h};var f=comUtils.stringifyMessage(h);if(window.ComNative&&window.ComNative.sendMessage){f=encodeURIComponent(f);var e="sendMessage;"+c+":"+f;ComNative.sendMessage(e)}};b(d);return a}; var NativeMsgReceiver=function(a){var b={};function c(d){__nativeCbReceiver=d;__nativeReceiverActive=true}b.stop=function(){__nativeReceiverActive=false};c(a);return b};var __nativeReceiverActive=false;var __nativeCbReceiver;function msgReceiverEventListener(d,a){try{if(!__nativeReceiverActive){return}var c=comTypeEnum.nativeMessage;d=decodeURIComponent(d);var e=comUtils.parseMessage(d,c,a);__nativeCbReceiver(e)}catch(b){console.error("msgReceiverEventListener: ex="+b);console.error("msgReceiverEventListener: message="+d)}}; var comUtils=(function(){var a={};a.parseMessage=function(e,f,c){var d=e.replace(/\n/g," ");var g=JSON.parse(d);var b={msg:g,type:f,metaData:c};return b};a.stringifyMessage=function(c){var b=JSON.stringify(c);return b};a.addCssStyle=function(b){if(b){for(colorIndex in b){b[colorIndex]="{ "+b[colorIndex]+" }"}Utils.Html.addCssStyle(b,document,"themeColors")}};return a})();if(!Array.prototype.indexOf){Array.prototype.indexOf=function(c,d){for(var b=(d||0),a=this.length;b<a;b++){if(this[b]===c){return b}}return -1}}; var comMaster=(function(){var p={};var r="HANDSHAKE";var q="ACK";var g=5000;var f;var c;var o;var b={};function n(t){for(var s in b){if(b[s].metaData===t){return s}}}function i(s){b[s].sender.sendMessage({messageTxt:q,slaveId:s})}function j(t){var s=n(t);if(s&&b[s]){i(s);b[s].slaveReadyCb(s)}}function d(t){var s=t.msg;if(s.messageTxt===r){j(t.metaData)}else{if(c){c(s.slaveId,s.msg)}}}function m(s){return new PostMsgSender(s)}function h(s){return new NativeMsgSender(s)}function a(){f=new NativeMsgReceiver(d);o=h}function l(){f=new PostMsgReceiver(d);o=m}function e(s){return new IframeSender(s)}function k(){f=new IframeReceiver(d);o=e}p.registerOnReceive=function(s){c=s};p.init=function(s){switch(s){case comTypeEnum.postMessage:l();break;case comTypeEnum.iframeMessage:k();break;case comTypeEnum.nativeMessage:a();break}};p.addSlave=function(v,t,u,s){b[v]={metaData:t,sender:o(u),slaveReadyCb:s}};p.sendMessage=function(s,t){if(b[s]){b[s].sender.sendMessage(t)}};p.reset=function(){b={};eventsManager.reset()};return p})(); var masterDemux=(function(){var a={};a.dispatchEvent=function(b,c,d){comMaster.sendMessage(b,{protocol:protocolTypeEnum.event,eventName:c,eventData:d})};a.sendRpcResponse=function(b,c){comMaster.sendMessage(b,{protocol:protocolTypeEnum.rpc,rpcResponse:c})};return a})(); var masterMux=(function(){var b={};function a(d,e){switch(e.protocol){case protocolTypeEnum.rpc:rpcReceiver.requestReceived(d,e.rpcRequest);break;case protocolTypeEnum.event:eventsManager[e.eventCb](d,e.eventName);break}}function c(){comMaster.registerOnReceive(a)}c();return b})(); var eventsManager=(function(){var b={};var a={};b.registerSlave=function(c,d){var e=a[d];if(!e){a[d]={slavesArr:[c]}}else{if(!e.slavesArr){e.slavesArr=[c];if(e.dispatcher){e.dispatcher.slaveRegistered(d)}}else{e.slavesArr.push(c)}}};b.unregisterSlave=function(c,d){var f=a[d];if(!f){return}var g=f.slavesArr;if(!g){return}var e=g.indexOf(c);if(e!=-1){g.splice(e,1);if(g.length===0&&f.dispatcher){delete f.slavesArr;f.dispatcher.noSlavesRegistered(d)}}};b.registerEventDispatcher=function(c,d){var e=a[c];if(!e){a[c]={dispatcher:d}}else{if(e.slavesArr){d.slaveRegistered(c)}}a[c].dispatcher=d};b.unRegisterEventDispatcher=function(c){if(a[c]){delete a[c].dispatcher}};b.dispatchEvent=function(c,f){var g=a[c];if(g){var h=g.slavesArr;if(h){var e=h.length;for(var d=0;d<e;d++){masterDemux.dispatchEvent(h[d],c,f)}}}};b.reset=function(){a={}};return b})(); var rpcReceiver=(function(){var d={};var b=1;function c(n,g,o,j){var f=n.split(".");var l=o[b];if(f[0]!=="conduitApi"){l("Access denied!");return}var h=f.pop();for(var k=0;k<f.length;k++){if(typeof g!=="object"){l("Invalid function name!");return}g=g[f[k]]}if(typeof(g[h])!=="function"){l("Invalid function name!");return}try{g[h].apply(j,o)}catch(m){console.error(m);l(m)}}function a(h,i,g,e){var f={id:i,cbName:g,args:[].slice.call(e)};masterDemux.sendRpcResponse(h,f)}d.requestReceived=function(i,g){var f=g.args;function e(){a(i,g.id,"cbSuccess",arguments)}function h(){a(i,g.id,"cbFail",arguments)}f.unshift(h);f.unshift(e);c(g.funcName,window,f,{slaveId:i})};return d})(); var DataDumper=(function(){var a={};function b(d,e){if(typeof e==="undefined"){e=false}if(d&&d.services){var f=d.services;for(serviceUrl in f){var g=f[serviceUrl];if(g&&g.serviceUrl&&g.data){var c=0;if(PLATFORM===platformEnum.webApp){c=g.maxAge}var h=Services.generateUrl(null,null,false,g.serviceUrl);if(e||!NetworkCache.getItem(h)){NetworkCache.saveItem(h,g.data,c)}}}}}a.dumpInitialData=function(){if(window.__dataDump){if(PLATFORM===platformEnum.nativeApp){var c=AppConfiguration.get(AppConfiguration.keys.IS_DATA_DUMPED);if(!c){b(window.__dataDump);AppConfiguration.set(AppConfiguration.keys.IS_DATA_DUMPED,true)}}else{if(PLATFORM===platformEnum.webApp){b(window.__dataDump,true)}}}};return a}()); var AjaxRequest=(function(){var g={};var d={cache:true,async:true,headers:{}};var h=/^(?:about|app|app\-storage|.+\-extension|file|res|widget|x\-wmapp1|x\-wmapp2):/ig;var e=h.test(document.URL);var a=function(){var k=null;if(e){k=new XMLHttpRequest()}else{if(window.XDomainRequest){k=new XDomainRequest();k.isXDomainRequest=true}else{if(window.XMLHttpRequest){k=new XMLHttpRequest()}}}return k};var c=function(m,q,o,p){_timeoutManager=new f(function(){o("timeout")},p);var l,n=document.head||document.getElementsByTagName("head")[0]||document.documentElement;var k="json"+(Math.random()*100).toString().replace(/\./g,"");window[k]=function(r){_timeoutManager.clear();n.removeChild(l);q&&q(r)};l=document.createElement("script");l.setAttribute("async","async");l.type="text/javascript";if(l.onError){l.onError=o}l.src=m.replace("callback=?","callback="+k);n.appendChild(l)};function b(m,o){var n=null;if(m){if(o==="application/json"){n=JSON.stringify(m)}else{if(o==="application/x-www-form-urlencoded"){var k=[];for(key in m){var l=m[key];k.push(encodeURIComponent(key)+"="+encodeURIComponent(l))}n=k.join("&")}}}return n}var f=function(l,m){var k={};var n;k.clear=function(){clearTimeout(n)};n=setTimeout(l,m);return k};var j=function(x,q,o){var k=x.url;var r=x.type;var s=x.timeout;var u=x.contentType;var n=x.data;var l;var w=a();if(w){if(s){if(w.timeout){w.timeout=x.timeout}else{l=new f(function(){o("timeout")},s)}}if(w.isXDomainRequest&&r!=="GET"){r="POST"}w.open(r,k,true);var v=_.keys(x.headers||{}),p=v.length;for(var m=0;m<p;m++){var t=v[m];w.setRequestHeader(t,x.headers[t])}if(w.isXDomainRequest){w.onload=function(){l&&l.clear();try{q(JSON.parse(w.responseText))}catch(y){o("error")}};w.onerror=function(){o("error")}}else{w.setRequestHeader("Content-type",u);w.onreadystatechange=function(){if(this.readyState!==4){return}var y=this.status,z=this.responseText;if((y==200||y==202)&&z){l&&l.clear();try{q(JSON.parse(z))}catch(A){console.log(A);o("error",A)}}else{if(o){l&&l.clear();o("error","Request has returend with status "+y)}}}}n=b(n,u);w.send(n);return w}else{if(o){o("error","Error creating XHR object")}}};var i=function(s,o,n){var k=s.url;var q=s.timeout;var m=s.data;var l=k.split("?")&&k.split("?").length>1;if(!l&&m){k=k+"?";for(var r in m){k=k+encodeURIComponent(r)+"="+encodeURIComponent(m[r])+"&"}k=k+"callback=?"}else{var p="?";if(l){p="&"}k=k+p+"callback=?"}c(k,o,n,q)};g.makeRequest=function(l){var q={};if(l){l=_.extend({},d,l);var k=l.success;var m=l.error;var o=l.complete;var p=function(r){k&&k(r);o&&o()};var n=function(s,r){m&&m(q,s,r);o&&o()};if(l.dataType=="jsonp"){i(l,p,n)}else{q=j(l,p,n);return q}}};return g})(); var NetworkCache={saveItem:function(b,d,a,f){var e=-1;if(a!==-1){a*=1000;e=new Date().getTime()+a}var c={data:d,expirationTime:e};if(typeof f!=="undefined"){c.meta=f}c=JSON.stringify(c);b=b.toLowerCase();conduitApi.platform.storage.setItem(null,null,b,c,true)},getItem:function(b){b=b.toLowerCase();var d=conduitApi.platform.storage.getItem(null,null,b,true);if(d){d=JSON.parse(d);if(d!==null){var a={data:d.data,isExpired:false};if(typeof d.meta!=="undefined"){a.meta=d.meta}var e=d.expirationTime;var c=new Date().getTime();if(e!==-1&&e<c){a.isExpired=true}return a}}return null},removeItem:function(a){conduitApi.platform.storage.removeItem(null,null,a,true)}}; var NetworkRequest=(function(){var d={};var e=b();var a={retries:0,timeout:15000,retryCount:1,contentType:"application/json",dataType:e};var c=function(i,l,k,g,j,h){if(h.retryCount<h.retries){h.retryCount=h.retryCount+1;d.makeRequest(i,l,k,g,j,h)}else{if(typeof(j)==="function"){j()}}};d.makeRequest=function(j,m,l,h,k,i){i=_.extend({},a,i);m=m.toUpperCase();if(m!=="GET"&&e==="jsonp"){Utils.Helpers.cbWrapper(k);return}var g=null;if(e==="jsonp"){g=f()}AjaxRequest.makeRequest({url:j,type:m,data:l,cache:true,dataType:i.dataType,jsonpCallback:g,timeout:i.timeout,contentType:i.contentType,async:true,success:function(n,p,o){if(n==null){c(j,m,l,h,k,i)}else{if(typeof(h)==="function"){h(n)}}},error:function(n,p,o){c(j,m,l,h,k,i)}})};var f=function(){var h=1;var g="";do{g="jsonp_"+h;h++}while(typeof window[g]=="function");return g};function b(){var g="jsonp";if(PLATFORM===platformEnum.nativeApp){g="json"}else{if(XMLHttpRequest&&("withCredentials" in new XMLHttpRequest())){g="json"}}return g}return d})(); var UrlGenerator=(function(){var c={};var b={};function f(){var g=DeviceToken.getDeviceToken();var h={appId:APP_ID,deviceType:g,appVersion:APP_VERSION,appMode:APP_MODE};_.extend(h,b);return h}function a(){var g={};var h=InappPurchaseTokens.getAllTokens();_.each(h,function(i,j){g["token:"+j]=i});return g}function e(g,i){for(var h in i){if(typeof(i[h])==="string"){i[h]=d(i[h],false,i)}}return d(g,true,i)}function d(k,i,j){for(var h in j){var l="{"+h+"}";var g=j[h];if(typeof(g)==="object"){g=JSON.stringify(g)}if(i&&h!=="hts"){g=encodeURIComponent(g)}k=k.replace(l,g)}return k}c.addDefaultParams=function(i){i=i||{};var h=f();for(var g in h){if(!i.hasOwnProperty(g)){i[g]=h[g]}}return i};c.sortParams=function(m){var k=[];for(h in m){k.push(h)}k.sort();var g={};for(var j=0;j<k.length;++j){var h=k[j];var l=m[h];if(typeof(l)==="string"||typeof(l)==="number"||typeof(l)==="boolean"||_.isArray(l)||!l){g[h]=l}else{g[h]=c.sortParams(l)}}return g};c.generateUrl=function(i,j,g){if(!i){return null}j=j||{};j=c.addDefaultParams(j);j=c.sortParams(j);var h=a();_.extend(j,h);i=e(i,j);if(g||FORCE_NO_CACHE){if(i&&(i.indexOf("nocache=true")<0)){i=Utils.Url.addQueryParamToUrl(i,"nocache","true")}}return i};c.extendAppParams=function(g){_.extend(b,g)};c.emptyAppParams=function(){b={}};return c}()); var ServiceMap=(function(){var b={};var a={};var c=false;b.isReady=function(){return c};b.getService=function(d){return a[d]};b.getServiceReloadInterval=function(e){var d=a[e];if(d){if(typeof d.reloadInterval!=="undefined"){return d.reloadInterval}}return null};b.forceServiceNoCache=function(e){var d=a[e];if(d){if(d.url.indexOf("nocache=true")<0){a[e].url=Utils.Url.addQueryParamToUrl(d.url,"nocache","true")}}};b.parseServiceMap=function(e){a={};for(d in e.services){var g=e.services[d];var d={url:g.url,method:g.method,reloadInterval:g.reload_interval_sec,timeout:g.timeout,retries:g.retries};var f=g.name;a[f]=d}c=true};return b})(); var Services=(function(){var e={};var a={};var b={executeType:executeTypeEnum.HIT_AND_RUN_SILENT,postParams:null,reloadInterval:3600,forceServerNoCache:false};e.overrideService=function(g,h){a[g]=h};function f(j,h,i){if(typeof h.result!=="undefined"&&h.result!=null&&typeof h.result.reload_interval_sec!=="undefined"){i=h.result.reload_interval_sec}else{if(typeof h.maxAge!=="undefined"){i=h.maxAge}}var g=h.result;NetworkCache.saveItem(j,g,i)}function c(i,g){if(i){if(typeof(g)==="function"){var h=responseTypeEnum.VALID_CACHE;if(i.isExpired){h=responseTypeEnum.EXPIRED_CACHE}g(i.data,h)}}}e.generateUrl=function(h,j,i,g){var k=g||d(h);if(k){k=UrlGenerator.generateUrl(k,j,i);return k}return null};e.isCacheValid=function(i,j){var h=e.generateUrl(i,j);if(h!==null){var g=NetworkCache.getItem(h);if(!g||g.isExpired){return false}}return true};e.makeServiceRequest=function(k,g,m,n,h,p){p=_.extend({},b,p);var o=NetworkCache.getItem(k);if(p.executeType!==executeTypeEnum.FORCE_NETWORK&&p.executeType!==executeTypeEnum.HIT_ON_NETWORK_FAIL){c(o,n)}function j(q){if(q.success===true){if(g==="GET"){f(k,q,p.reloadInterval)}if(typeof(n)==="function"){if(p.executeType!==executeTypeEnum.HIT_AND_RUN_SILENT||!o){n(q.result,responseTypeEnum.NETWORK)}}}else{i(q.error)}}function i(q){if(p.executeType===executeTypeEnum.HIT_ON_NETWORK_FAIL&&o){c(o,n);return}if(typeof(h)==="function"){if(p.executeType!==executeTypeEnum.HIT_AND_RUN_SILENT||!o){h(q)}}}var l=true;if((p.executeType===executeTypeEnum.HIT_AND_RUN||p.executeType===executeTypeEnum.HIT_AND_RUN_SILENT)&&o&&!o.isExpired){l=false}if(l){NetworkRequest.makeRequest(k,g,m,j,i,p)}};e.executeService=function(m,t,q,h,u,s){var k=true;u=u||{};t=UrlGenerator.addDefaultParams(t);var i=a[m];if(i){var j=i(m,t,q,h,u.postParams);if(j==true){k=false}}if(k){var o=e.generateUrl(m,t,u.forceServerNoCache,s);if(o!==null){var l=ServiceMap.getService(m);if(l){var g=l.method;var r=l.reloadInterval;if(r){u.reloadInterval=r}var p=l.timeout;if(p){u.timeout=p}var n=l.retries;if(typeof(n)!=="undefined"){u.retries=n}u.serviceName=m;u.getParams=t;e.makeServiceRequest(o,g,u.postParams,q,h,u);return}}Utils.Helpers.cbWrapper(h)}};function d(h){var i=null;var g=ServiceMap.getService(h);if(g){i=g.url}return i}e.clearUrlFromCache=function(g,i){var h=e.generateUrl(g,i);if(h){NetworkCache.removeItem(h);return true}return false};return e})(); var FacebookLib=(function(){var h={};var d=20;var k=50;var j=8000;var m=8000;var g,l,a;var e=[];var c="";if(SERVICEMAP_URL===DEV_SERVICEMAP_URL){if(PLATFORM===platformEnum.simulator){c="473416846023010"}else{c="1077791999027176"}}else{if(SERVICEMAP_URL===QA_SERVICEMAP_URL){if(PLATFORM===platformEnum.simulator){c="238792926248713"}else{c="127980924017588"}}else{c="209845035304"}}if(PLATFORM===platformEnum.nativeApp&&DEVICE===deviceTypeEnum.iphone){c="209845035304"}h.setAppId=function(n){c=n};h.facebookToUnixTime=function(t){t=t.replace("+0000","");var r=t.split("T");var n=r[0].split("-");var o=r[1].split(":");var s=new Date(+n[0],+n[1]-1,+n[2],+o[0],+o[1],+o[2]);var q=s.getTime();var p=Utils.TimeDate.toLocalTime(q);return p};h.getPictureFromId=function(o){var n=l;if(!n){n=g}if(n){return"https://graph.facebook.com/"+o+"/picture?access_token="+n}else{return"http://graph.facebook.com/"+o+"/picture"}};var i=function(o,s,q){if(typeof(FB)==="undefined"){e.push(o);e.push(s);e.push(q)}else{q=q||{};var r=false;function t(){if(conduitApi.social.isSupported()){var v={useLoginForm:true};var u=function(w){l=w.accessToken;a=w.fbId;if(!r){r=true;Utils.Helpers.funcWrapper(o)(l)}};conduitApi.social.getAccessTokens(u,s,conduitApi.social.socialServicesEnum.Facebook,v)}else{if(!r){r=true;Utils.Helpers.funcWrapper(s)("Social not supported")}}}function p(){if(!r){r=true;Utils.Helpers.funcWrapper(o)(g)}}function n(){if(conduitApi.social.isSupported()){var v={useLoginForm:false};var u=function(w){l=w.accessToken;a=w.fbId;if(!r){r=true;Utils.Helpers.funcWrapper(o)(l)}};conduitApi.social.getAccessTokens(u,p,conduitApi.social.socialServicesEnum.Facebook,v)}else{p()}}if(l){if(!r){r=true;Utils.Helpers.funcWrapper(o)(l)}}else{if(q.fallbackToDefault){if(g){if(q.dontUseApi){p()}else{n()}}else{t()}}else{if(q.useLoginForm){t()}else{if(!r){r=true;Utils.Helpers.funcWrapper(o)(l)}}}}}};var f=function(n,o){if(typeof FB!=="undefined"){n()}else{var p=false;window.fbAsyncInit=function(){if(!p){clearTimeout(r);Utils.Helpers.funcWrapper(n)()}};var q=document.createElement("script");q.type="text/javascript";q.src="http://connect.facebook.net/en_US/all.js";q.async=true;document.getElementById("fb-root").appendChild(q);var r=setTimeout(function(){p=true;o()},j)}};h.init=function(q){if(q){c=q.appId||c;g=q.appAccessToken||g}if(PLATFORM===platformEnum.nativeApp){var p={status:true,cookie:true,xfbml:true,oauth:true};if(c){p.appId=c}if(window.CDV&&window.CDV.FB){p.nativeInterface=CDV.FB;p.useCachedDialogs=false}FB.init(p)}else{var o=function(){var s={status:true,cookie:true,xfbml:true,oauth:true};if(c){s.appId=c}FB.init(s);if(e.length!=0){var r=0;while(r<e.length/3){i(e.shift(),e.shift(),e.shift())}}};var n=function(){};f(o,n)}};function b(o,p,s){var q=this;var r=Array.prototype.slice.call(arguments,3);var n=function(){l="";function t(){Utils.Helpers.funcWrapper(s).apply(q,r)}conduitApi.social.logout(t,p,conduitApi.social.socialServicesEnum.Facebook)};if(o&&o.error&&o.error.code&&o.error.code===190&&o.error.error_subcode&&o.error.error_subcode===458){n()}else{if(o&&o.error&&o.error.code&&o.error.code===200){conduitApi.UI.showDialogBox(null,null,{title:_T("DialogCaptionFacebookRequiresPermissions"),message:_T("DialogMessageFacebookRequiresPermissions"),buttons:[{text:_T("ButtonOk"),cb:n},{text:_T("ButtonCancel"),cb:function(){Utils.Helpers.funcWrapper(p)(o)}}]})}else{Utils.Helpers.funcWrapper(p)(o)}}}h.addLikeButton=function(p,r,o){o=o||{};var n=LocalizationManager.getCulture();n=n.replace(/-/g,"_");var q={link:p,width:200,locale:n,colorscheme:"light"};r.html(faceBookTemplates.likeButton(q));h.init();if(o.cbClick){FB.Event.subscribe("edge.create",function(s){o.cbClick(s)})}};h.isLike=function(o,n,q,p){var r=function(s){var t=false;var u=setTimeout(function(){t=true;Utils.Helpers.funcWrapper(q)("timeout")},m);FB.api({method:"pages.isFan",page_id:o,uid:a,access_token:s},function(v){if(!t){clearTimeout(u);if(typeof(v)==="boolean"){b(v,q,h.isLike,o,n,q,p)}else{Utils.Helpers.funcWrapper(q)(v)}}})};i(r,q,{useLoginForm:true})};h.getPageData=function(o,n,q,p,s){var r=function(t){var u=false;var v=setTimeout(function(){u=true;Utils.Helpers.funcWrapper(q)("timeout",s)},m);p=p||{};FB.api("/"+o,{limit:p.limit,access_token:t},function(w){if(!u){clearTimeout(v);if(!w||w.error){b(w,q,h.getPageData,o,n,q,p,s)}else{Utils.Helpers.funcWrapper(n)(w,s)}}})};i(r,q,{fallbackToDefault:true,dontUseApi:true})};h.getPosts=function(p,o,r,q,n){var s=function(t){var u=false;var v=setTimeout(function(){u=true;Utils.Helpers.funcWrapper(r)("timeout")},m);q=q||{};q.limit=q.limit||d;q.access_token=t;n=n||"feed";FB.api("/"+p+"/"+n,q,function(w){if(!u){clearTimeout(v);if(!w||w.error){b(w,r,h.getPosts,p,o,r,q,n)}else{if(a){w.authenticatedUserId=a;for(var x=0;x<w.data.length;x++){var y=w.data[x];y.wasLike=(y.likes&&y.likes.data&&y.likes.data.length&&(y.likes.data[0].id===a))}}Utils.Helpers.funcWrapper(o)(w)}}})};i(s,r,{fallbackToDefault:true})};h.getComments=function(n,o,q,p){var r=function(s){var t=false;var u=setTimeout(function(){t=true;Utils.Helpers.funcWrapper(q)("timeout")},m);p=p||{};p.limit=p.limit||k;p.access_token=s;p.summary=true;FB.api("/"+n+"/comments",p,function(v){if(!t){clearTimeout(u);if(!v||v.error){b(v,q,h.getComments,n,o,q,p)}else{Utils.Helpers.funcWrapper(o)(v)}}})};i(r,q,{fallbackToDefault:true})};h.getItem=function(n,o,q,p){var r=function(s){var t=false;var u=setTimeout(function(){t=true;Utils.Helpers.funcWrapper(q)("timeout")},m);p=p||{};p.access_token=s;FB.api("/"+n,p,function(v){if(!t){clearTimeout(u);if(!v||v.error){b(v,q,h.getItem,n,o,q,p)}else{Utils.Helpers.funcWrapper(o)(v)}}})};i(r,q,{fallbackToDefault:true})};h.rsvpEvent=function(n,p,o,r,q){var s=function(t){var u=false;var v=setTimeout(function(){u=true;Utils.Helpers.funcWrapper(r)("timeout")},m);q=q||{};FB.api("/"+n+"/"+p,"post",{access_token:t},function(w){if(!u){clearTimeout(v);if(!w||w.error){b(w,r,h.rsvpEvent,n,w,o,r,q)}else{Utils.Helpers.funcWrapper(o)(w)}}})};i(s,r,{useLoginForm:true})};h.likeItem=function(n,o,q,p){var r=function(s){var t=false;var u=setTimeout(function(){t=true;Utils.Helpers.funcWrapper(q)("timeout")},m);p=p||{};FB.api("/"+n+"/likes","post",{access_token:s},function(v){if(!t){clearTimeout(u);if(!v||v.error){b(v,q,h.likeItem,n,o,q,p)}else{Utils.Helpers.funcWrapper(o)(v)}}})};i(r,q,{useLoginForm:true})};h.unlikeItem=function(n,o,q,p){var r=function(s){var t=false;var u=setTimeout(function(){t=true;Utils.Helpers.funcWrapper(q)("timeout")},m);p=p||{};FB.api("/"+n+"/likes","delete",{access_token:s},function(v){if(!t){clearTimeout(u);if(!v||v.error){b(v,q,h.unlikeItem,n,o,q,p)}else{Utils.Helpers.funcWrapper(o)(v)}}})};i(r,q,{useLoginForm:true})};h.commentItem=function(n,r,o,q,p){var s=function(t){var u=false;var v=setTimeout(function(){u=true;Utils.Helpers.funcWrapper(q)("timeout")},m);p=p||{};FB.api("/"+n+"/comments","post",{message:r,access_token:t},function(w){if(!u){clearTimeout(v);if(!w||w.error){b(w,q,h.commentItem,n,r,o,q,p)}else{Utils.Helpers.funcWrapper(o)(w)}}})};i(s,q,{useLoginForm:true})};h.postMessage=function(o,r,n,q,p){var s=function(t){var u=false;var v=setTimeout(function(){u=true;Utils.Helpers.funcWrapper(q)("timeout")},m);p=p||{};FB.api("/"+o+"/feed","post",{message:r,access_token:t},function(w){if(!u){clearTimeout(v);if(!w||w.error){b(w,q,h.postMessage,o,r,n,q,p);Utils.Helpers.funcWrapper(q)(w)}else{Utils.Helpers.funcWrapper(n)(w)}}})};i(s,q,{useLoginForm:true})};h.getUserData=function(n,p){h.init();function q(){var s=false;var t=setTimeout(function(){s=true;Utils.Helpers.funcWrapper(p)("timeout")},m);function r(u){if(!s){clearTimeout(t);Utils.Helpers.funcWrapper(n)(u)}}FB.api("/"+a,r)}function o(){Utils.Helpers.funcWrapper(n)(p)}i(q,o,{useLoginForm:true})};h.setAppAccessToken=function(n){g=n};return h}()); var TwitterManager=(function(){var g=this;var j=8000,b=60,k=null;g.getUserFeed=function(q,t,p,r){t.take=t.take||20;t.skip=t.skip||0;var u=f(t.skip);var o=["http://api.twitter.com/1/statuses/user_timeline.json?include_rts=true&screen_name=",t.userName,"&count=",t.take+1,u,"&include_entities=",(t.extraInfo||{}).includeEntities||0].join("");d(o,function(v,s){AjaxRequest.makeRequest({url:o,dataType:"jsonp",timeout:j,error:function(w,y){s({success:false,error:y})},success:function(z){if(!z||!z.length){s({success:false,error:"No Items"});return}var y=_.map(z,function(A){return h(A)});var x=z[0].user;var w=c(x);l(w,y,t.take);w.statuses=y;v({success:true,result:w,maxAge:b})}})},p,r)};g.getResultFeed=function(q,s,r,p){var o=s.take||20;var t=f(s.skip);switch(s.type){case"1":i(s.query,s.extraInfo.listName,s.extraInfo.includeEntities,t,o,r,p);break;case"2":n(s.query,t,o,(s.extraInfo||{}).includeEntities,r,p);break;default:break}};g.followUser=function(o){conduitApi.app.openLink(null,null,{url:"https://twitter.com/intent/follow?screen_name="+o})};g.isFollowingUser=function(r,p,s){function q(u){var t="http://api.twitter.com/1/friendships/exists.json?screen_name_a="+u.name+"&screen_name_b="+r;AjaxRequest.makeRequest({url:t,dataType:"jsonp",timeout:j,error:function(v,w){Utils.Helpers.funcWrapper(s)(false)},success:function(v){Utils.Helpers.funcWrapper(p)(v)}})}function o(){Utils.Helpers.funcWrapper(p)(false)}conduitApi.social.getAccessTokens(q,o,conduitApi.social.socialServicesEnum.Twitter,{useLoginForm:false})};var m=function(o){if(!o||!o.media){return null}return _.map(o.media,function(p){return{id:p.id,displayUrl:p.display_url,type:p.type,mediaUrl:p.media_url}})};var e=function(q,p,o){if(!q){return q}if(p){q=q.replace(/(https?:\/\/|www\.)[\S]+/ig,"[url]$&[/url]")}if(o){q=q.replace(/(@)([a-z0-9_]{1,})/ig,"[twit=$2]$1$2[/twit]");q=q.replace(/(#)([a-z0-9_]{1,})/ig,"[trend=$2]$1$2[/trend]")}return q};var a=function(o){var p=new Date(o.replace(/^\w+ (\w+) (\d+) ([\d:]+) \+0000 (\d+)$/,"$1 $2 $4 $3 UTC"));return(p.getTime()-p.getMilliseconds())/1000};var h=function(r){var u,p,s,q,v,o;if(r.retweeted_status){u=r.user?r.user.screen_name:r.from_screen_name;p=r.retweeted_status.user?r.retweeted_status.user.name:r.retweeted_status.from_user_name;s=r.retweeted_status.user?r.retweeted_status.user.profile_image_url:r.retweeted_status.profile_image_url;q=r.retweeted_status.user.screen_name;v=r.retweeted_status.user.statuses_count;o=r.retweeted_status.user.followers_count}else{p=r.user?r.user.name:r.from_user_name;s=r.user?r.user.profile_image_url:r.profile_image_url;q=r.user?r.user.screen_name:r.from_user;v=r.user?r.user.statuses_count:null;o=r.user?r.user.followers_count:null}return{description:e(r.text,true,true),id:r.id,id_str:r.id_str,time:a(r.created_at),inReplyToScreenName:r.in_reply_to_screen_name,inReplyToUserId:r.in_reply_to_user_id,inReplyToStatusId:r.in_reply_to_status_id,retweetedCount:r.retweet_count,source:r.source,icon:s,user:p,entities:m(r.entities),socialInfo:{socialId:"twitter::"+r.id,title:r.text,shortDesc:r.text,imageUrl:s,url:"https://twitter.com/#!/"+q+"/status/"+r.id_str},retweeter:{name:u},screenName:q,totalStatuses:v,totalFollowers:o}};var c=function(o){return{user:o.name,totalStatuses:o.statuses_count,totalFollowers:o.followers_count,icon:o.profile_image_url}};var d=function(p,r,q,o){r(function(s){if(s.success){q(s.result,responseTypeEnum.NETWORK)}else{o(s)}},o)};var i=function(u,r,q,w,p,t,v){var o=["http://api.twitter.com/1/",u,"/lists/",r,"/statuses.json?","per_page=",p+1,w,"&include_entities=",q||0].join("");d(o,function(x,s){AjaxRequest.makeRequest({url:o,dataType:"jsonp",timeout:j,error:function(y,z){s({success:false,error:z})},success:function(A){if(!A||!A.length){s({success:false,error:"No Items"});return}var z=_.map(A,function(B){return h(B)});var y={};l(y,z,p);y.results=z;x({success:true,result:y,maxAge:b})}})},t,v)};var n=function(t,v,q,p,r,u){var o=["http://search.twitter.com/search.json?q=",t,"&count=",q+1,v,"&include_entities=",p||0].join("");d(o,function(w,s){AjaxRequest.makeRequest({url:o,dataType:"jsonp",timeout:j,error:function(y,z){s({success:false,error:"No Items"})},success:function(z){if(!z||!z.results||!z.results.length){w([]);return}var y=_.map(z.results,function(A){return h(A)});var x={};l(x,y,q);x.results=y;w({success:true,result:x,maxAge:b})}})},r,u)};var f=function(p){var o="";if(p>0){o="&max_id="+k.id_str}else{if(p===0){k=null}}return o};var l=function(p,q,o){p.hasMoreItems=false;if(q.length===o+1){p.hasMoreItems=true;k=q.pop()}};return g}()); var ServiceOverrideManager=(function(){var e={};var a={};var b={};e.overrideServices=function(i){_.each(i,function(k){var m=k.key.toUpperCase();var l=k.version;var j=k.params;d(m,l,j)});for(serviceName in b){h(serviceName,b[serviceName].serviceVersion,b[serviceName].serviceParams)}};function c(j,i){return a[j]&&a[j][i]}function d(k,j,i){if(c(k,j)){if(b[k]){if(b[k].serviceVersion<j){b[k]={serviceVersion:j,serviceParams:i}}}else{b[k]={serviceVersion:j,serviceParams:i}}}}e.registerOverride=function(j,i,k){if(!a[j]){a[j]={}}a[j][i]={func:k}};function h(j,k,i){Services.overrideService(j,function(m,o,l,n,p){o=_.extend({},o,i);return a[m][k].func(m,o,l,n,p)})}function f(){e.registerOverride("CMS_TWITTER_USER_GET","1",function(j,l,i,k,m){TwitterManager.getUserFeed(j,l,i,k);return true});e.registerOverride("CMS_TWITTER_QUERY_GET","1",function(j,l,i,k,m){TwitterManager.getResultFeed(j,l,i,k);return true});e.registerOverride("CMS_TWITTER_USER_GET","2",function(j,l,i,k,m){TwitterManager.getUserFeed(j,l,i,k);return true});e.registerOverride("CMS_TWITTER_QUERY_GET","2",function(j,l,i,k,m){TwitterManager.getResultFeed(j,l,i,k);return true})}function g(){f()}g();return e}()); var FavoritesModel=Backbone.Model.extend({getShareInfo:function(){var c={};var a=_T("SShareFavoritesPlaylistTitle");var d="";var b=this.get("items");b.each(function(e){d+=e.get("title")+"\n"});c.title=a;c.shortDesc=d;return c}}); var FavoritesManager=(function(){var d={};var c="FavoritesList";_enabled=false;var b=null;var a=null;function e(){var j=conduitApi.platform.storage.getItem(null,null,c,true);if(j){var k=JSON.parse(j);var g=k.length;for(var h=0;h<g;h++){b.add(new Backbone.Model(k[h]))}}}function f(g){if(!_.isArray(g)&&!d.contains(g)){g.set({index:this.length});Backbone.Collection.prototype.add.call(this,g)}}d.contains=function(g){return b.any(function(h){return h.get("stream").url===g.get("stream").url})};d.getModel=function(){return a};d.save=function(){conduitApi.platform.storage.setItem(null,null,c,JSON.stringify(b.toJSON()),true)};d.addTrack=function(g){b.add(g)};d.removeTrack=function(j){var g=b.length;for(var h=0;h<g;h++){var k=b.at(h);if(k.get("stream").url===j.get("stream").url){b.remove(k);return}}};d.sortList=function(g){b.models=b.sortBy(function(i,h){return g[h]})};d.moveItem=function(g,h){b.models=b.sortBy(function(j,i){if(i===g){return i+h}return i})};d.isEnabled=function(){return _enabled};d.reset=function(){b.reset();e()};d.init=function(){_enabled=true;b=new Backbone.Collection();b.add=f;e();a=new FavoritesModel({items:b})};return d})(); var ConduitApiImpl=(function(){var c={};var a=function(){};var b=function(){};c.closeApp=function(d,e){navigator.conduitApp.closeApp()};c.init=function(e,g,f){function h(i){var j={};if(typeof(i)==="object"&&i!==null){for(key in i){j[key]=h(i[key])}if(typeof(i.isSupported)==="function"){j.isSupported=i.isSupported()}}return j}var d=null;Utils.Helpers.funcWrapper(e)(h(conduitApi),LayoutApplier.generateColorTheme(AppManager.app()),PLATFORM)};c.initApiImpl=function(){c.platform.init();c.app=new AppDriver;c.UI=uiDriver;c.social=new SocialDriver;c.analytics=analyticsDriver;c.media=mediaDriver;c.log=logDriver};c.getContext=function(d){var e={appId:APP_ID};if(typeof(d)==="undefined"){e.UUID=APP_ID;e.pageId=APP_ID}else{e.pageId=d;e.pageType=AppManager.app().getPageType(d);e.UUID=APP_ID+"_"+d}return e};return c}());ConduitApiImpl.platform=(function(){var a={};a.isSupported=function(){return true};a.init=function(){a.accelerometer=accelerometerDriver;a.camera=cameraDriver;a.deviceInfo=deviceInfoDriver;a.geo=new GeoDriver;a.orientation=orientationDriver;a.pushNotification=pushNotificationDriver;a.storage=storageDriver;a.vibrate=vibrateDriver;a.inAppPurchase=inAppPurchaseDriver;a.gestures=gesturesDriver;a.audio=audioDriver;a.media=mediaDriver;a.video=videoDriver};return a}());ConduitApiImpl.UI=(function(){var a={};return a}()); var PushNotificationManager=(function(){var c={};var e=null;var d=null;function b(k,m,j){if(!k||k===""||k==="empty message"){return}if(j&&j=="true"){var l={messageId:m};function g(n){}function h(n){}Services.executeService("PUSH_NOTIFICATION_GET",l,g,h)}var f={messageId:m};conduitApi.analytics.addEvent(null,null,conduitApi.analytics.usageEventTypeEnum.ReceivedPush,f);var i=[{text:_T("ButtonClose")}];conduitApi.UI.showDialogBox(null,null,{title:_T("PushNotificationTitle"),message:k,buttons:i,link:"all"})}function a(h){if(conduitApi.platform.pushNotification.isSupported()){function g(j,i){e=j.split(" ").join("");d=i;Utils.Helpers.funcWrapper(h)()}function f(i){Utils.Helpers.funcWrapper(h)()}conduitApi.platform.pushNotification.registerPushNotification(g,f,b)}else{Utils.Helpers.funcWrapper(h)()}}c.init=function(f){a(f)};c.getToken=function(){return e};c.getProviderId=function(){return d};return c}()); var UserManager=(function(){var d={};var e=null;var a=null;function c(g){if(conduitApi.platform.deviceInfo.isSupported()){var f=function(h){e=h;if(h){a=h.uuid}if(a){Utils.Helpers.funcWrapper(g)()}else{b(g)}};conduitApi.platform.deviceInfo.getDeviceInfo(f,f)}else{b(g)}}function b(f){a=conduitApi.platform.storage.getItem(null,null,"uuid");if(!a){a=Utils.Helpers.generateGUID();conduitApi.platform.storage.setItem(null,null,"uuid",a)}Utils.Helpers.funcWrapper(f)()}d.sendUMS=function(){if(PLATFORM===platformEnum.simulator){return}var h="";var g="";if(e){h=e.version;g=e.language}var f={postParams:{deviceId:a,pushId:null,osVersion:h,deviceLocale:g,deviceTypeId:DeviceToken.getDeviceToken(),appId:APP_ID,appVersion:APP_VERSION}};if(PLATFORM===platformEnum.nativeApp){PushNotificationManager.init(function(){f.postParams.pushId=PushNotificationManager.getToken();f.postParams.pushProviderId=PushNotificationManager.getProviderId();setTimeout(function(){Services.executeService("UMS_USER_POST",null,null,null,f)},10)})}else{setTimeout(function(){Services.executeService("UMS_USER_POST",null,null,null,f)},1000)}};d.init=function(f){c(f)};d.getUserId=function(){return a};return d}()); var ProfileManager=(function(){var e={};e.socialProviderEnum={LINKEDIN:"linkedin",FACEBOOK:"facebook",CUSTOM:"custom"};var c="ProfileManagerData";var a={name:"",img:""};var b={id:null,profile:a,mainProvider:""};user=b;function g(){var h=conduitApi.platform.storage.getItem(null,null,c,true);if(h){user=JSON.parse(h)}}function d(h){conduitApi.platform.storage.setItem(null,null,c,JSON.stringify(h),true)}function f(h){user=h;d(user)}e.init=function(){g()};e.getUserProfile=function(){return user.profile};e.getUserId=function(){return user.userId};e.isLoggedIn=function(){return user.userId!=null};e.setGlobalAppId=function(h){e.globalAppId=h};e.login=function(h,i,l){var j=function k(m){var o=function n(p){var u=function t(v){if(!v.mainProvider){v.mainProvider=l}f(v);Utils.Helpers.funcWrapper(h)()};var s=p.profile.id;var r=e.getUserId();var q={postParams:{userId:r,socialId:s,type:l,udid:UserManager.getUserId(),globalAppId:e.globalAppId,data:p.profile}};Services.executeService("COMMUNITY_SOCIAL_LOGIN_POST",null,u,i,q)};navigator.social.getUserInfo(o,i,l)};navigator.social.login(j,i,l)};e.logout=function(i,j,k){var h=function(l){var p=function(q){if(user.mainProvider===k){f(b)}Utils.Helpers.funcWrapper(i)()};var n=e.getUserId();var m={postParams:{userId:n,type:k,udid:UserManager.getUserId(),globalAppId:e.globalAppId}};var o={userId:n};Services.executeService("COMMUNITY_SOCIAL_LOGOUT_POST",o,p,j,m)};navigator.social.logout(h,j,k)};e.mainLogout=function(h,i){if(!mainProvider){Utils.Helpers.funcWrapper(h)()}else{e.logout(h,i,mainProvider)}};e.getLoginStatus=function(h,i,j){navigator.social.getLoginStatus(h,i,j)};return e}()); var usage=(function(){var b=function(){};var o={bulkCount:10,maxCapacity:100,maxRetries:3,timeBetweenRetries:30000,isRetriesExponential:true};var m=5*60*1000;var a=null;var g="UMS_USAGE_PUT";var l="CONDUIT_APP_STAT_DATA";var e=0;var d=0;var k=[];var c=false;var j={};var n=function(){if(conduitApi.platform.storage.isSupported()){var p=conduitApi.platform.storage.getItem(null,null,l,true);if(p){k=JSON.parse(p)}}};var i=function(){if(conduitApi.platform.storage.isSupported()){var p=JSON.stringify(k);conduitApi.platform.storage.setItem(null,null,l,p,true)}};function h(t){if(c){return}var v=k.length;if(v<=0){return}c=true;if(typeof(t)==="undefined"){t=500}var w=function(){for(var A=0;A<v;A++){k.shift()}i();v=0;d=0;f();c=false};var p=function(){d++;if(d>=o.maxRetries){w()}else{c=false;var A=o.timeBetweenRetries;if(o.isRetriesExponential){A=A*Math.pow(2,d-1)}h(A)}};var z=function(){w()};var u=function(A){var B=true;if(B){p()}else{w()}};var y=null;if(!y){y={coords:{latitude:null,longitude:null}}}var s=DeviceToken.getDeviceToken();var r=new Date();var x={appId:APP_ID,appVersion:APP_VERSION,deviceType:s,deviceVariant:DEVICE_VARIANT,latitude:y.coords.latitude,longitude:y.coords.longitude,timeStamp:parseInt(r.getTime()/1000),osVersion:0,platform:navigator.userAgent,uuId:UserManager.getUserId()};var q={postParams:{usageHeader:x,usageItems:k}};setTimeout(function(){Services.executeService(g,null,z,u,q)},t)}j.addEvent=function(r,q,s,v,p){if(k.length>=o.maxCapacity){h();return}var t=new Date();b(r,q,s,v,p);var u={timestamp:parseInt(t.getTime()/1000),eventType:s,meta:v||{}};if(r){u.pageId=r}if(q){u.pageType=q}k.push(u);i();if(p||k.length>=o.bulkCount){h()}};function f(){if(a!==null){clearInterval(a)}a=setInterval(function(){h()},m)}j.setGaAddEventCb=function(p){b=p};j.init=function(p){o=_.extend({},o,p);n();var q=ServiceMap.getServiceReloadInterval(g);if(q!==null){m=q*1000}f()};return j}()); var googleAnalytics={setCode:function(a){window._gaq=window._gaq||[];window._gaq.push(["_setAccount",a]);window._gaq.push(["_trackPageview"]);(function(){var c=document.createElement("script");c.type="text/javascript";c.async=true;c.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";var b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(c,b)})();usage.setGaAddEventCb(this.addEventGAImpl)},addEventGAImpl:function(c,b,d,e,a){if(d==conduitApi.analytics.usageEventTypeEnum.TabClick&&e.label){window._gaq.push(["_trackPageview",e.label])}}}; var AppConfiguration=(function(){var c={};var b={};var a="app_settings";c.keys={IS_DATA_DUMPED:"is_data_dumped"};c.init=function(){var d=conduitApi.platform.storage.getItem(null,null,a,true);if(d){b=JSON.parse(d)}};c.get=function(d){return b[d]};c.set=function(d,e){b[d]=e;var f=JSON.stringify(b);conduitApi.platform.storage.setItem(null,null,a,f,true)};return c})(); var layoutEngine={colorHelper:{ensureARGB:function(a){if(a.length<9){return"#FF"+a.substring(1)}return a},hexToRgba:function(b){if(b.charAt(0)=="#"){b=b.substring(1)}var a={a:255,r:0,g:0,b:0};var c=0;if(b.length>6){a.a=parseInt(b.substring(c,2),16);c+=2}a.r=parseInt(b.substring(c,c+2),16);a.g=parseInt(b.substring(c+2,c+4),16);a.b=parseInt(b.substring(c+4,c+6),16);return a},rgbaToHex:function(b){var a=function(d){d=parseInt(d,10);if(isNaN(d)){return"00"}d=Math.max(0,Math.min(d,255));return"0123456789ABCDEF".charAt((d-d%16)/16)+"0123456789ABCDEF".charAt(d%16)};var c="#";c+=a(b.a||255);c+=a(b.r)+a(b.g)+a(b.b);return c},rgbToHsl:function(k){var a=k.r/255,i=k.g/255,m=k.b/255;var n=Math.max(a,i,m),e=Math.min(a,i,m);var f,o,c=(n+e)/2;if(n==e){f=o=0}else{var j=n-e;o=c>0.5?j/(2-n-e):j/(n+e);switch(n){case a:f=(i-m)/j+(i<m?6:0);break;case i:f=(m-a)/j+2;break;case m:f=(a-i)/j+4;break}f/=6}return{h:f,s:o,l:c}},hslToRgb:function(m){var a,j,k;var i=m.h,n=m.s,f=m.l;if(n==0){a=j=k=f}else{function e(h,g,b){if(b<0){b+=1}if(b>1){b-=1}if(b<1/6){return h+(g-h)*6*b}if(b<1/2){return g}if(b<2/3){return h+(g-h)*(2/3-b)*6}return h}var c=f<0.5?f*(1+n):f+n-f*n;var d=2*f-c;a=e(d,c,i+1/3);j=e(d,c,i);k=e(d,c,i-1/3)}return{r:a*255,g:j*255,b:k*255}}},methods:{replace:function(a,b){var c=layoutEngine.replace(b,a.colors,a.methods);return c},useOther:function(a,d,b){if(!b){return d}return a.colors[d]},hsla:function(b,f,k,c,i){var e=b.color;var d=layoutEngine.colorHelper.hexToRgba(e);var j=layoutEngine.colorHelper.rgbToHsl(d);if(f||f==0){j.h=Math.min(1,j.h*f)}if(k||k==0){j.s=Math.min(1,j.s*k)}if(c||c==0){j.l=Math.min(1,j.l*c)}var g=layoutEngine.colorHelper.hslToRgb(j);g.a=d.a;if(i||i==0){g.a=Math.min(255,g.a*i)}return layoutEngine.colorHelper.rgbaToHex(g)},t_hsla:function(e,a,b,g){var d=e.color;var f=layoutEngine.colorHelper.hexToRgba(d);var c=layoutEngine.colorHelper.rgbToHsl(f);if(c.l>=a){return layoutEngine.methods.hsla.apply(this,[e].concat(g))}else{return layoutEngine.methods.hsla.apply(this,[e].concat(b))}}},processColor:function(a,f,b){if(!f){return f}if(!_.isArray(f)){f=[f]}for(var e=0;e<f.length;e++){var h=f[e];if(!h){continue}var j=h["const"]||a[h.param];if(!j){continue}if(h.fn){var d=[{color:j,colors:a,methods:b}].concat(h.params||[]);var g=b[h.fn];if(typeof g=="function"){j=g.apply(this,d)}}return j}},replace:function(e,a,c){for(var b in e){if(!e[b]){continue}if(e.hasOwnProperty(b)&&typeof e[b]!=="function"){if(e[b]["_replace"]){e[b]=layoutEngine.processColor(a,e[b]["_replace"],c)}else{if(Utils.Helpers.isPlainObject(e[b])){layoutEngine.replace(e[b],a,c)}else{if(_.isArray(e[b])){for(var d=0;d<e[b].length;d++){layoutEngine.replace(e[b][d],a,c)}}}}}}return e},exec:function(tpl,colors){var p=Utils.Helpers.deepClone(true,{},tpl);var methods=Utils.Helpers.deepClone(true,{},layoutEngine.methods);if(p.methods){for(var m in p.methods){if(!p.methods.hasOwnProperty(m)){continue}methods[m]=eval("("+p.methods[m]+")")}}layoutEngine.replace(p,colors,methods);return p}}; var IconsLayout={ANDROID_ICON_SIZES:{tab:[1,4,7],grid:[2,5,8],list:[3,6,9]},IPHONE_ICON_SIZES:{tab:[12,16,20],grid:[11,15,19],list:[10,14,18]},_getDensity:function(){if(LAYOUT==layoutFormat.wide){return 2}if(window.devicePixelRatio!=="undefined"){if(window.devicePixelRatio<=1){return 0}else{return 1}}return 0},getIconSize:function(a){var b=this._getDensity();if(DEVICE==deviceTypeEnum.android&&(PLATFORM==platformEnum.nativeApp||PLATFORM==platformEnum.webApp)){if(a==navigationLayoutTypes.bottomBar||a==navigationLayoutTypes.topBar){return this.ANDROID_ICON_SIZES.tab[b]}else{if(a==navigationLayoutTypes.grid){return this.ANDROID_ICON_SIZES.grid[b]}else{if(a==navigationLayoutTypes.list){return this.ANDROID_ICON_SIZES.list[b]}}}}else{if(a==navigationLayoutTypes.bottomBar||a==navigationLayoutTypes.topBar){return this.IPHONE_ICON_SIZES.tab[b]}else{if(a==navigationLayoutTypes.grid){return this.IPHONE_ICON_SIZES.grid[b]}else{if(a==navigationLayoutTypes.list){return this.IPHONE_ICON_SIZES.list[b]}}}}return}}; var App=Backbone.Model.extend({defaults:{id:null,defaultPageId:null,defaultTabIndex:0,pages:[],navigationType:navigationLayoutTypes.none},initialize:function(){this.bind("addMorePage",this.addNavPage,this);this.bind("addNavPage",this.addNavPage,this)},setAppData:function(k,g,h,c){if(!this._isTabIndexValid(k,g,h)){h=0}var d=AppSettingsManager.getSettings();var b=d.get("brand");var e="";if(b.showAppLinks&&k.details&&k.details.appHomeUrl){e=k.details.appHomeUrl}var a=null;var f=null;if(d.get("ads").enabled&&typeof(AdsManager)!=="undefined"){a=AdsManager.getAdBarModel();f=AdsManager.getFullScreenAdModel()}var j=null;if(d.get("appsFireEnabled")){j=new Backbone.Model(d.get("appsFire"))}var i=new AppSocial(k.social);this.appHeader=new AppHeader(k.meta.header);this.set({defaultPageId:g,defaultTabIndex:h,appLayout:c,id:APP_ID,navigationType:k.layout.layoutType,appLabel:k.label,appIcon:k.icon,appLink:e,adBar:a,social:i,fullScreenAd:f,appsFireModel:j,header:this.appHeader,eulaUrl:k.eulaUrl,externalContent:window.__externalContent,globalAppId:k.globalAppId});this._setAppPages(k.pages)},_isTabIndexValid:function(d,b,a){if(d&&d.pages&&b&&a){var f=d.pages.length;for(var c=0;c<f;c++){var e=d.pages[c];if(e.id===b){var g=[];if(e.meta){g=e.meta[pageTypes[e.type].itemsName]||[]}return a<g.length&&a>0}}}return false},_setAppPages:function(e){var a=[];var c=IconsLayout.getIconSize(navigationLayoutTypes.topBar);var g=IconsLayout.getIconSize(navigationLayoutTypes.grid);var f=IconsLayout.getIconSize(navigationLayoutTypes.list);for(pageIndex in e){var b=e[pageIndex];b=ItemsTransformer.transformItem(b,{isPage:true});var h=b&&this._isSupportedPageType(b.type,b.minVersion,b.version);if(h){var d=new Template();d.tabIconSize=c;d.gridIconSize=g;d.listIconSize=f;d.buildFromJSON(b);d.bind("pageSelected",this.pageSelected,this);a.push(d)}}this.set({pages:a})},pageSelected:function(a){if(this.selected){this.selected.set({selected:false});this.selected.get("pageButtons").reset()}this.selected=a;this.appHeader.setButtons(this.selected.get("pageButtons"))},_isValidPageVersion:function(b,c){if(PLATFORM===platformEnum.simulator){return true}if(!b&&!c){return true}var a=Utils.Helpers.compareVersions(b,APP_VERSION);if(a>=0){if(c){var a=Utils.Helpers.compareVersions(c,APP_VERSION);if(a<=0){return true}}else{return true}}return false},_isSupportedPageType:function(a,b,e){if(pageTypes[a]){var d=true;var c=pageTypes[a].support;if(c){d=ResourceLoader.isValidResource(c)}if(d){if(this._isValidPageVersion(b,e)){return true}}}return false},addNavPage:function(a){a.bind("pageSelected",this.pageSelected,this);this.get("pages").push(a)},selectPage:function(a){this.getPageById(a).selectPage()},destroy:function(){comMaster.reset();AdsManager.stop();Services.clearUrlFromCache("AMS_APP_GET");this.trigger("destroy")},addInfoBarButton:function(a,e,c,b,f,d){this.getPageById(d.pageId).addInfoBarButton(a,e,c,b,f)},removeInfoBarButton:function(a,d,c,b){this.getPageById(b.pageId).removeInfoBarButton(a,d,c)},removeAllInfoBarButtons:function(a,c,b){this.getPageById(b.pageId).removeAllInfoBarButtons(a,c)},getPageById:function(b){var a=this.get("pages");var e=a.length;for(var c=0;c<e;c++){var d=a[c];if(d.get("id")===b){return d}}},getPageType:function(a){var b=this.getPageById(a);if(b){return b.get("type")}return null},removeSharePage:function(){var a=this.get("pages");var d=a.length;for(var b=0;b<d;b++){var c=a[b]}}}); var AppSettings=Backbone.Model.extend({defaults:{overrideTranslation:null,refreshEnabled:true,ads:{},brand:{},showAdsBarOnHeader:false,overrideServices:{},showAdd2Home:true,loginWithGeoLocation:false,isHeaderScrollable:false},initialize:function(){this.set({showAdd2Home:!this.get("disableAddToHome")});this.initAds();var b=this.get("isHeaderScrollable");if(typeof(b)!="undefined"){if(LAYOUT===layoutFormat.wide){b=false}if(DEVICE!==deviceTypeEnum.iphone){b=false}this.set({isHeaderScrollable:b})}var a=this.get("appsFire");if(a&&a.enabled&&a.appKey){this.set({appsFireEnabled:true})}if(this.get("brand")===null){this.set("brand",this.defaults.brand)}},initAds:function(){var a=this.get("ads");var b={enabled:false,fullScreenAdEnabled:false,bottomBarAdEnabled:true,bottomBarSwitchInterval:30000,adBarCycles:2,adBarMinInterval:600000,fullScreenAdDisplayDuration:3000,fullScreenAdTO:5000};a=_.extend({},b,a);if(PLATFORM!==platformEnum.nativeApp){a.fullScreenAdEnabled=false}this.set({ads:a})}}); var AppSocial=Backbone.Model.extend({defaults:{facebook:null},initialize:function(){}}); var Layout=Backbone.Model.extend({defaults:{backgroundImage:null,colors:{}},initialize:function(){var a=this.get("meta").bgImage||"";this.set({backgroundImage:a});this.bind("change:layout",this._onLayoutChanged);this._onLayoutChanged()},_onLayoutChanged:function(){var d=null;var f=this.get("template");var e=this.get("layout").colorTheme;if(window.__overrideLayout){f=window.__overrideLayout}if(window.__overrideColors){e=window.__overrideColors}var c={};var b=Utils.Helpers.deepClone(true,{},c,f);b=layoutEngine.exec(b,e);var a=b;if(e.layout){a=Utils.Helpers.deepClone(true,{},b,e.layout)}var d=layoutEngine.exec(a,e);this.set({colors:d})}}); var Template=Backbone.Model.extend({defaults:{selected:false,first:false,defaultTabIndex:0,changePage:true},initialize:function(){this.set({pageButtons:new PageButtonsCollection()})},buildFromJSON:function(b){var a=(b.icon.indexOf("?")!=-1)?"&":"?";b.tabIconUrl=b.icon+a+"sizeId="+this.tabIconSize;b.gridIconUrl=b.icon+a+"sizeId="+this.gridIconSize;b.listIconUrl=b.icon+a+"sizeId="+this.listIconSize;if(b.type==="9eea8149-956c-46f9-8597-167401c63cd7"){if(b.meta&&b.meta.items&&b.meta.items.length&&b.meta.items[0]&&b.meta.items[0].link){b.meta.items[0].link=UrlGenerator.generateUrl(b.meta.items[0].link,{uuId:UserManager.getUserId()})}}this.set(b)},selectPage:function(b){b=b||{};var a=this.get("selected");this.set({selected:false});if(typeof(b.tabIndex)!="undefined"){this.set({defaultTabIndex:b.tabIndex})}if(b.requestId){this.set({requestId:b.requestId})}if(!a){conduitApi.analytics.addEvent.hitch({slaveId:this.get("id")})(null,null,conduitApi.analytics.usageEventTypeEnum.TabClick,{label:this.get("label")});this.trigger("pageSelected",this)}this.set({selected:true})},selectFirstPage:function(){this.set({first:true});this.selectPage()},addInfoBarButton:function(a,f,c,b,h){var e=this.get("pageButtons");var d=Utils.Helpers.generateGUID();var g=new InfoBarButtonModel({id:d,icon:c,addToRight:b});g.bind("buttonClicked",h);e.add(g);Utils.Helpers.funcWrapper(a)(d)},removeInfoBarButton:function(a,d,c){var b=this.get("pageButtons");b.remove(c);Utils.Helpers.funcWrapper(a)()},removeAllInfoBarButtons:function(a,c){var b=this.get("pageButtons");b.reset();Utils.Helpers.funcWrapper(a)()}}); var InfoBarButtonModel=Backbone.Model.extend({defaults:{id:0,icon:"",addToRight:true},buttonClicked:function(){this.trigger("buttonClicked",this.get("id"))}}); var PageButtonsCollection=Backbone.Collection.extend({model:InfoBarButtonModel}); var AppHeader=Backbone.Model.extend({defaults:{type:null,content:null},setButtons:function(a){var b=this.get("buttons");this.set({buttons:a});this.trigger("buttonsChanged",b)}}); var SimplePluginListener=function(b,e){var d={},a=null,c=false;d.verifyInitialized=function(g,i){var j=navigator[b];if(!j){throw"PluginWrapper : "+b+" plugin not found"}if(a){g(a)}else{if(!c){var f=navigator[b][e];if(!f){throw"PluginWrapper : "+e+" plugin function not found"}function k(l){a=l;g(a)}function h(){console.log("PluginWrapper : "+b+" could not retrieve register for changes");Utils.Helpers.funcWrapper(i)()}f(k,h);c=true}}};d.onChange=function(f,g){d.verifyInitialized(f,g)};return d}; var AppManager=(function(){var b={};var a=false;var c=new App();b.app=function(){return c};b.refreshAndGoToPage=function(f,d,g){if(a){return}a=true;var e=function(){a=false;c.unbind("appLaunched",e);if(g){g()}};c.bind("appLaunched",e);c.destroy();AppInit.initLocalization();AppInit.launchApp({pageId:f,pageState:{tabIndex:d}})};b.gotoPage=function(d){c.selectPage(d)};b.changeLayout=function(e){var d=c.get("appLayout");d.set({layout:e});if(window.LayoutApplier){LayoutApplier.apply(c)}};b.changeCulture=function(d,e){LocalizationManager.updateLocalizationData(d,e)};return b})(); var CodeRunner={runCode:function(code){if(code&&typeof(code)==="string"){try{eval(code)}catch(e){console.error("CodeRunner Error: "+e)}}}}; var Experience=(function(){var g={};var i=null;var h="";var f="";var k=false;var b=false;var l=false;function a(){if(k){return}k=true;conduitApi.platform.gestures.unregisterShake(null,null);g.reset();conduitApi.platform.vibrate.vibrateForTime(null,null,100)}function j(){conduitApi.platform.gestures.registerShake(null,null,a);k=false}function d(m){if(b){return}b=true;navigator.appManager.hideExperience();conduitApi.UI.dismissActivityIndicator();j();Utils.Helpers.funcWrapper(i)(m)}function e(){if(l){return}l=true;conduitApi.UI.dismissActivityIndicator();var m=_T("DialogMessageFailGetAppId");navigator.notification.alert(m,null,"Conduit Revu","Close")}function c(m){if(m.message){m=m.message}if(!m||!m.email||!m.appCode){e();return}h=m.email;f=m.appCode;conduitApi.UI.startActivityIndicator(function(){var o={code:m.appCode,email:m.email};var n={executeType:executeTypeEnum.HIT_AND_RUN_SILENT};b=false;l=false;Services.executeService("AMS_APPID_GET",o,d,e,n)},null,_T("IndicatorLoading"))}g.reset=function(){APP_ID=null;AppManager.refreshAndGoToPage()};g.getAppId=function(o,n){if(!navigator.appManager||!navigator.appManager.showExperience){Utils.Helpers.funcWrapper(n)();return}function m(){Utils.Helpers.funcWrapper(n)()}i=o;navigator.appManager.showExperience(c,m,h,f)};return g})(); var AmsLoader=(function(){var c={},a=_.extend({},Backbone.Events);var b=5000;c.addAppChangeListener=function(d){a.on("change",d)};c.loadApp=function(d,i){APP_ID=i;d=Utils.Helpers.funcWrapper(d);UserManager.sendUMS(true);var j=function(l){if(l=="APP_DISABLED"){var k=[{text:_T("ButtonClose"),cb:function(){conduitApi.app.closeApp()}}];conduitApi.UI.showDialogBox(null,null,{title:_T("DialogCaptionError"),message:_T("DialogMessageFailGetAppDisabled"),buttons:k})}else{var k=[{text:_T("ButtonRetry"),cb:function(){c.loadApp(d,i)}},{text:_T("ButtonClose"),cb:function(){conduitApi.app.closeApp()}}];conduitApi.UI.showDialogBox(null,null,{title:_T("DialogCaptionError"),message:_T("DialogMessageFailGetAppNormal"),buttons:k})}};var h=function(k){a.trigger("change",k);d.apply(this,arguments)};var e=_.once(function(){var k={executeType:executeTypeEnum.HIT_AND_RUN_SILENT};if(PLATFORM===platformEnum.nativeApp){k.executeType=executeTypeEnum.HIT_ON_NETWORK_FAIL;k.timeout=b}Services.executeService("AMS_APP_GET",null,h,j,k)});if(PLATFORM===platformEnum.webApp&&USE_DATADUMP_SERVICE){var g=function(k){if(typeof k!=="undefined"&&typeof k.datadump!=="undefined"){__dataDump=k.datadump;DataDumper.dumpInitialData()}e()};var f={executeType:executeTypeEnum.FORCE_NETWORK};Services.executeService("DATADUMP_GET",{},g,e,f)}else{e()}};return c})(); var AppSettingsManager=(function(){var a={};var b=null;a.createSettings=function(c){b=new AppSettings(c)};a.getSettings=function(){return b};return a})(); var Config=new SimplePluginListener("configurationPlugin","onConfigurationChange"); var LayoutTemplate=new SimplePluginListener("layoutTemplatePlugin","addChangeListener"); var Social=function(){this.getLoginStatus=function(a,b,c){Utils.Helpers.funcWrapper(b)("not supported yet...")};this.logout=function(a,b,c){Utils.Helpers.funcWrapper(a)()};this.login=function(a,b,c){Utils.Helpers.funcWrapper(a)()};this.getUserInfo=function(c,f,g){var a={profile:{headline:"Mobile Client Team Leader at Conduit",lastName:"Gluschnaider",id:"f6Ekl00iyR",currentStatus:"http://lnkd.in/J69UWv",firstName:"Yoel",distance:0,positions:{values:[{title:"Mobile Client Team Leader",id:253923367,startDate:{year:2012,month:1},company:{name:"Conduit",id:11232,type:"Privately Held",size:"201-500 employees",industry:"Internet"},summary:"Manages a team of 3 mobile developers that is in charge of the Client side of the Conduit Mobile platform. The team consists of iPhone, Android, WP7 and Front End developers.",isCurrent:true}],_total:1},location:{country:{code:"il"},name:"Israel"},industry:"Computer Software",pictureUrl:"http://m3.licdn.com/mpr/mprx/0_mLnj-0VaxNzeUvbK2kba-yW70KtLRPBK2GCC-gZlhvQzXc8rGiQAyj2xAO-VZNny76NijVo7HzKE"}};var e={profile:{headline:"barvaz",lastName:"Bar vas",id:"123456",firstName:"Bery",distance:0,positions:{values:[{title:"Duck Leader",id:987654321012,startDate:{year:2012,month:1},company:{name:"Conduckit",id:112329876543541,type:"Privately Held",size:"201-500 employees",industry:"Internet"},summary:"Manages a team of 3 ducks that is in charge of the duck-side of the moon.",isCurrent:true}],_total:1},location:{country:{code:"il"},name:"Israel"},industry:"Power ducks",pictureUrl:"http://cloud2.lbox.me/images/384x384/201111/disruptive-pattern-mini-rubber-duck_sdjcov1320123118668.jpg"}};var d={profile:{headline:"barak",lastName:"Obamba",id:"123456490",firstName:"Barak",distance:0,positions:{values:[{title:"Ping-pong player and president of USA",id:8524698321012,startDate:{year:2012,month:1},company:{name:"usa",id:112329876543541,type:"Privately Held",size:"201000000-500000000 employees",industry:"State"},summary:"president and bla bla bla",isCurrent:true}],_total:1},location:{country:{code:"us"},name:"USA"},industry:"White houses",pictureUrl:"http://www.pc.co.il/wp-content/uploads/2009/09/obama.jpg"}};var b={profile:{headline:"Yoni Shalom",lastName:"Shalom",id:"7171143",firstName:"Yoni",distance:0,positions:{values:[{title:"Duck Leader",id:1231231321,startDate:{year:2012,month:1},company:{name:"AwesomeCompany LTD.",id:112329876543541,type:"Privately Held",size:"201-500 employees",industry:"Internet"},summary:"Manages a team of 3 ducks that is in charge of the duck-side of the moon.",isCurrent:true}],_total:1},location:{country:{code:"il"},name:"Israel"},industry:"Quacking Industry",pictureUrl:"https://twimg0-a.akamaihd.net/profile_images/1114419516/images_bigger.jpg"}};Utils.Helpers.funcWrapper(c)(b)}};if(typeof navigator.social=="undefined"){navigator.social=new Social()}; var ServiceMapGetterPlugin=function(){var a=function(c,e,i){var h=i.SERVICEMAP_URL;if(i.FORCE_NO_CACHE){h+="?nocache=true"}var g=function(k){if(k.success){var j=k.result;var l=k.maxAge;NetworkCache.saveItem(h,j,l);Utils.Helpers.funcWrapper(c)(j)}else{Utils.Helpers.cbWrapper(e)}};var f=function(k){if(k.success){var j=k.result;var l=k.maxAge;NetworkCache.saveItem(h,j,l)}};var d=NetworkCache.getItem(h);if(d){if(d.isExpired){NetworkRequest.makeRequest(h,"GET",null,f)}Utils.Helpers.funcWrapper(c)(d.data)}else{NetworkRequest.makeRequest(h,"GET",null,g,e)}};var b=function(d,f){var e=function(g){if(APP_MODE===appMode.experience){ServiceMap.forceServiceNoCache("AMS_APP_GET")}Utils.Helpers.funcWrapper(d)(g)};var c=function(){var h=_T("DialogMessageFailGetServiceMap");var g=[{text:_T("ButtonRetry"),cb:function(){b(d)}},{text:_T("ButtonClose"),cb:function(){conduitApi.app.closeApp()}}];conduitApi.UI.showDialogBox(null,null,{title:_T("DialogCaptionError"),message:h,buttons:g})};a(e,c,f)};this.registerServiceMapReady=function(c,d){b(c,d)}};if(typeof navigator.serviceMap=="undefined"){navigator.serviceMap=new ServiceMapGetterPlugin()}; var WebConfigurationPlugin=(function(){var a={};a.onConfigurationChange=function(b){b({})};return a}());navigator.configurationPlugin=WebConfigurationPlugin; var LayoutTemplatePlugin=(function(){var a={},b=_.extend({},Backbone.Events);_template=null;a.onAppChanged=function(c){var d=Utils.Helpers.getPath(c,"layout.template");if(!d.styleTemplateId){_template=d;b.trigger("change",_template);return}a.loadTemplate(d)};a.addChangeListener=function(d,c){b.on("change",Utils.Helpers.funcWrapper(d));b.on("fail",Utils.Helpers.funcWrapper(c));if(_template){b.trigger("change",_template)}};a.loadTemplate=function(c){var d={executeType:executeTypeEnum.HIT_AND_RUN_SILENT};if(PLATFORM===platformEnum.nativeApp){d.executeType=executeTypeEnum.HIT_ON_NETWORK_FAIL}Services.executeService("AMS_APP_STYLE_GET",c,function e(g){_template=g;b.trigger("change",_template)},function f(){b.trigger("fail")},d)};AmsLoader.addAppChangeListener(a.onAppChanged);return a}());navigator.layoutTemplatePlugin=LayoutTemplatePlugin; var TouchHandler=(function(){var b={};var a=("ontouchstart" in window);b.START_EVENT=a?"touchstart":"mousedown";b.MOVE_EVENT=a?"touchmove":"mousemove";b.END_EVENT=a?"touchend":"mouseup";b.getXFromEvent=null;b.getYFromEvent=null;if(a){b.getXFromEvent=function(c){return c.changedTouches[0].pageX};b.getYFromEvent=function(c){return c.changedTouches[0].pageY}}else{if($.browser.msie){b.getXFromEvent=function(c){return c.clientX};b.getYFromEvent=function(c){return c.clientY}}else{b.getXFromEvent=function(c){return c.pageX};b.getYFromEvent=function(c){return c.pageY}}}return b}()); var AppViewFactory=(function(){var b={};var a=null;b.getAppView=function(c){if(a){a.remove();a=null}if(c){a=new AppView({model:c})}return a};return b}()); var templates={};templates.app=_.template('<div class="theme_background_image app_background_image"><div class="clr_appGeneral_bg"></div></div> <div class="app_content_container"></div>');templates.appHeaderText=_.template('<div class="app_info_bar"><span class="info_bar_left"></span><h1 class="app_header_text_only app_header_text"><%= content %></h1><span class="info_bar_right"></span></div>');templates.appHeaderEmpty=_.template('<div class="app_info_bar"><span class="info_bar_left"></span><span class="info_bar_right"></span></div>');templates.appHeaderImage=_.template('<div class="app_info_bar"><span class="info_bar_left"></span><div class="app_header_image"></div><span class="info_bar_right"></span></div>');templates.appHeaderImageAndText=_.template('<div class="app_info_bar"><span class="info_bar_left"></span><div class="app_header_image_text_container"><img id="favicon_header_img" alt="" src="<%= imageUrl %>" /><h1 class="app_header_text_with_img app_header_text"><%= content %></h1></div><span class="info_bar_right"></span></div>');templates.bottomBarItem=_.template('<a href="<%= href %>" <% if (openInNewTab) { %>target="_newtab" <% } %>data-role="button" class="navigation_bar_item clr_navBar_item_bg clr_navBar_item_brdr clr_navBar_item_hdlTxt" ><div class="navigation_bar_item_bubble clr_navBar_item_bubbleBg"><img class="item_image" src="<%= tabIconUrl %>" alt=""><div class="navigation_bar_item_text item_text"><%= label %></div></div></a>');templates.bottomBarMoreItem=_.template('<a href="javascript:void(0)" data-role="button" class="navigation_bar_item clr_navBar_item_bg clr_navBar_item_brdr clr_navBar_item_hdlTxt" ><div class="navigation_bar_item_bubble clr_navBar_item_bubbleBg"><div class="item_image mask_sprite sprite-more_btn clr_navBar_item_icn"></div><div class="navigation_bar_item_text item_text"><%= label %></div></div></a>');templates.listNavItem=_.template('<a class="clr_navList_item_bg clr_navList_item_brdr clr_navList_item_txt" data-role="button" href="<%= href %>" <% if (openInNewTab) { %>target="_newtab" <% } %>class="navigation_list_item"><img class="navigation_bar_item_img" src="<%= listIconUrl %>" alt="" /><div class="navigation_bar_item_text item_text"><%= label %></div></a>');templates.gridNavItem=_.template('<a data-role="button" href="<%= href %>" <% if (openInNewTab) { %>target="_newtab" <% } %>class="navigation_grid_item clr_navGrid_btn_bg clr_navGrid_btn_brdr clr_navGrid_btn_txt" ><img class="navigation_bar_item_img" src="<%= gridIconUrl %>" alt="" /><div class="navigation_bar_item_text item_text"><%= label %></div></a>');templates.sideMenuNav=_.template('<div class="side_area clr_navSide_bg"><div class="scroll_wrapper"><div class="scroller"><ul></ul></div></div></div><div class="app_container"><div class="page_transparent_overlay"></div></div>');templates.sideMenuNavItem=_.template('<a class="clr_navSide_item_bg clr_navSide_item_brdr clr_navSide_item_txt" data-role="button" href="<%= href %>" <% if (openInNewTab) { %>target="_newtab" <% } %>class="navigation_list_item"><img class="navigation_bar_item_img" src="<%= listIconUrl %>" alt="" /><div class="navigation_bar_item_text item_text"><%= label %></div></a>');templates.imageAd=_.template('<% if(typeof(imageUrl) != "undefined" && imageUrl !== null && imageUrl !== ""){ %><div class="ad_content ad_img_container"><img alt="" src="<%= imageUrl %>" /></div><% } %>');templates.textAd=_.template('<% if(typeof(text) != "undefined" && text !== null && text !== ""){ %><div class="ad_content ad_text"><%= text %></div><div class="ad_text_img mask_sprite sprite-arrow clr_contTypeB_icn"/></div><% } %>');templates.fullScreenAd=_.template('<div class="fullScreenImage sliced_image" style="background-image:url(\'<%= imageUrl %>\')"></div>');templates.infoBarButton=_.template('<% if (icon == "back.png") { %><div class="mask_sprite sprite-back clr_appHeader_btn_icn" ></div><% } else if (icon == "list.png") { %><div class="mask_sprite sprite-list clr_appHeader_btn_icn" ></div><% } else if (icon == "grid.png") { %><div class="mask_sprite sprite-grid clr_appHeader_btn_icn" ></div><% } else if (icon == "refresh.png") { %><div class="mask_sprite sprite-refresh clr_appHeader_btn_icn" ></div><% } else if (icon == "in_fav.png") { %><div class="mask_sprite sprite-starHeaderFull clr_appHeader_btn_icn" ></div><% } else if (icon == "not_in_fav.png") { %><div class="mask_sprite sprite-starHeaderEmpty clr_appHeader_btn_icn" ></div><% } else { %><img src="<%= icon %>"/><% } %>');templates.viewOriginalTemplate=_.template('<div class="view-orig-container"><a class="view_original_button clr_contTypeA_actBtn_bg clr_contTypeA_actBtn_brdr clr_contTypeA_actBtn_hdlTxt" data-role="button"><span class="view-orig-text"><%= text %></span></a></div>'); var AppView=Backbone.View.extend({id:"app",initialize:function(){this.model.bind("openSharePage",this.openSharePage,this);this.model.bind("destroy",this.destroy,this);$('*[data-role="page"]').live("pagebeforehide pageshow",this._handlePageStateChanged.hitch(this));this.render()},goToNavPage:function(){var a=this.model.get("navigationType");if(a===navigationLayoutTypes.list||a===navigationLayoutTypes.grid){if(DEVICE==deviceTypeEnum.android&&PLATFORM==platformEnum.nativeApp){navigator.appManager.onApplicationDone()}else{this.navTemplateView.model.selectPage()}}else{if(a===navigationLayoutTypes.sideMenu){this.side_menu_view.toggleSideMenu()}else{this.goToPageIndex(0)}}},goToPageId:function(b){var a=this.model.get("pages");var e=a.length;for(var c=0;c<e;c++){var d=a[c];if(d.get("id")===b){d.selectFirstPage();return true}}return false},goToPageIndex:function(b){var a=this.model.get("pages");var c=a[b];if(c){c.selectFirstPage();return true}return false},_handlePageStateChanged:function(f){var c=$(f.target);var b=c.data("id");if(!b){b=c.parents(".template_view").data("id");c.data("id",b)}var g=c.attr("data-bars");if(g&&g.indexOf("hideHeader")!==-1){switch(f.type){case"pageshow":conduitApi.app.hideInfoBar();break;case"pagebeforehide":conduitApi.app.showInfoBar();break}}var e=c.attr("data-buttons");if(e&&e.indexOf("back")!==-1){switch(f.type){case"pageshow":this._addBackButton(b);break;case"pagebeforehide":this._removeBackButton(b);break}}if(!(DEVICE==deviceTypeEnum.android&&PLATFORM==platformEnum.nativeApp)){if(e&&e.indexOf("home")!==-1){switch(f.type){case"pageshow":this._addNavigationButton(b,true);break;case"pagebeforehide":this._removeNavigationButton(b);break}}}if(!(DEVICE==deviceTypeEnum.android&&PLATFORM==platformEnum.nativeApp)){if(e&&e.indexOf("navigation")!==-1){switch(f.type){case"pageshow":this._addNavigationButton(b,false);break;case"pagebeforehide":this._removeNavigationButton(b);break}}}if(e&&e.indexOf("refresh")!==-1){var d=AppSettingsManager.getSettings();switch(f.type){case"pageshow":if(d.get("refreshEnabled")){this._addRefreshButton(b,c)}c.trigger("silentRefresh");break;case"pagebeforehide":if(d.get("refreshEnabled")){this._removeRefreshButton(b)}break}}if(f.type==="pageshow"){var a=AppManager.app().getPageById(b);if(a&&!a.get("selected")){a.set({changePage:false});a.selectPage()}}},_addBackButton:function(b){var a=function(){if(window.Scrolling){Scrolling.restoreScroll()}if(PLATFORM!==platformEnum.simulator&&window.top==window.self){history.back()}else{if($.mobile.urlstack.length>1){var c=$.mobile.urlstack[$.mobile.urlstack.length-2];location.hash="cqm_"+c.pageId}}};conduitApi.app.addBackButton.hitch({slaveId:b})(null,null,null,false,a)},_removeBackButton:function(a){conduitApi.app.removeBackButton.hitch({slaveId:a})()},_addRefreshButton:function(b,c){var a=function(){c.trigger("refresh")};conduitApi.app.addRefreshButton.hitch({slaveId:b})(null,null,"refresh.png",true,a.hitch(this))},_removeRefreshButton:function(a){conduitApi.app.removeRefreshButton.hitch({slaveId:a})()},_addNavigationButton:function(d,c){var b;var a=this.model.get("navigationType");if(a===navigationLayoutTypes.list||a===navigationLayoutTypes.sideMenu){b="list.png"}else{if(a===navigationLayoutTypes.grid){b="grid.png"}else{if(a===navigationLayoutTypes.none){b="grid.png"}else{return}}}conduitApi.app.addNavigationButton.hitch({slaveId:d})(null,null,b,c,this.goToNavPage.hitch(this))},_removeNavigationButton:function(a){conduitApi.app.removeNavigationButton.hitch({slaveId:a})(null,null)},openSharePage:function(a){this.sharePageView=new SharePageView({model:a});this.$el.append(this.sharePageView.render().el)},render:function(){var b=$("body");b.append(this.el);var c;var a=this.model.get("navigationType");if(a!==navigationLayoutTypes.sideMenu){c=this.$el}else{this.side_menu_view=new SideMenuNavView({model:this.model});this.$el.html(this.side_menu_view.render().el);c=this.side_menu_view.$appContainer}c.append(templates.app({}));c=c.find(".app_content_container");this.templatesView=new TemplatesView({model:this.model});this.footerView=new FooterView({model:this.model});if(!AppSettingsManager.getSettings().get("isHeaderScrollable")){this.headerView=new HeaderView({model:this.model.get("header")});c.append(this.headerView.render().el)}c.append(this.templatesView.render().el).append(this.footerView.render().el);var d=this.model.get("adBar");if(d){var e=new AdBarView({model:d});if(AppSettingsManager.getSettings().get("showAdsBarOnHeader")){$(this.headerView.el).prepend(e.el)}else{$(this.footerView.el).prepend(e.el)}}this.renderNavigation();$(this.templatesView.el).css("min-height",Utils.Html.getInnerHeight());this.handleExternalContent();this.selectTheDefaultPage();return this},handleExternalContent:function(){var c=this.model.get("externalContent");if(c){var a=new Backbone.Model(c);var b=new ExternalContentView({model:a});$(this.templatesView.el).append(b.render().el);$("#"+b.innerViewId).bind("pagebeforehide",function(){$(b.el).hide()});$.mobile.changePage("#"+b.innerViewId,{transition:"none",reverse:false,changeHash:false,parentContainer:$(this.templatesView.el)})}},selectTheDefaultPage:function(){var h=this.model.get("defaultPageId");if(h){var b=this.model.get("pages");var g=b.length;for(var d=0;d<g;d++){var f=b[d];if(f.get("id")===h){var c=f.get("type");var e=(c==="308af5fa-e91b-d7e7-1926-acfea8f266dc"||c==="ec79d314-f6aa-f396-a651-3f9b3344dd99"||c==="c54d24ef-faf5-45dd-8859-85e3ebe7cecf"||(c==="9eea8149-956c-46f9-8597-167401c63cd7"&&PLATFORM===platformEnum.webApp));if(!e){var a=this.model.get("defaultTabIndex");if(a){f.set({defaultTabIndex:a})}f.selectFirstPage();return}}}var f=b[0];if(f){f.selectFirstPage()}}},selectFirstPage:function(){if(!this.model.get("defaultPageId")&&!this.model.get("externalContent")){var a=this.model.get("pages")[0];if(a){this.model.set({defaultPageId:a.get("id")})}}},renderNavigation:function(){var a=this.model.get("navigationType");switch(a){case navigationLayoutTypes.none:this.selectFirstPage();break;case navigationLayoutTypes.bottomBar:var c=new TabBarView({model:this.model});$(this.footerView.el).append(c.render().el);this.selectFirstPage();break;case navigationLayoutTypes.sideMenu:this.selectFirstPage();break;case navigationLayoutTypes.topBar:var c=new TabBarView({model:this.model});$(this.headerView.el).append(c.render().el);this.selectFirstPage();break;case navigationLayoutTypes.list:case navigationLayoutTypes.grid:var b=new Template({id:NAVIGATION_PAGE_GUID,appModel:this.model,navType:a});this.navTemplateView=new NavTemplateView({model:b});this.model.trigger("addNavPage",b);$(this.templatesView.el).prepend(this.navTemplateView.el);if(!this.model.get("defaultPageId")){b.selectPage()}var d=$(this.templatesView.el).find(".scroll_wrapper");Scrolling.onContentChanged(d);break}},destroy:function(){conduitApi.UI.dismissActivityIndicator();this.model.unbind("openSharePage",this.openSharePage);this.model.unbind("destroy",this.destroy);$('*[data-role="page"]').die("pageshow").die("pagebeforehide");this.remove();if(window.$&&$.mobile&&$.mobile.resetNavigation){$.mobile.resetNavigation()}this.model.trigger("destroyed")}}); var InfoBarButtonView=Backbone.View.extend({className:"t3d info_bar_btn clr_appHeader_btn_bg clr_appHeader_btn_brdr",events:{tap:"buttonClicked"},initialize:function(){this.model.bind("removed",this.remove,this)},render:function(){var a=templates.infoBarButton;this.$el.attr("data-role","button");this.$el.html(a(this.model.toJSON()));return this},buttonClicked:function(a){a.preventDefault();this.model.buttonClicked()}}); var HeaderView=Backbone.View.extend({className:"app_header clr_appHeader_bg clr_appHeader_brdr clr_appHeader_hdlTxt",attributes:{"data-role":"header"},initialize:function(){this.model.bind("buttonsChanged",this.buttonsChanged,this);this.buttonsChanged()},buttonsChanged:function(a){this.$el.find(".info_bar_btn").remove();this.$el.attr("data-position","fixed");if(a){a.unbind("add",this.buttonAdded);a.unbind("remove",this.buttonRemoved)}var b=this.model.get("buttons");if(b){b.each(this.buttonAdded,this);b.bind("add",this.buttonAdded,this);b.bind("remove",this.buttonRemoved,this)}},buttonAdded:function(a){var b=new InfoBarButtonView({model:a});if(a.get("addToRight")){this.$el.find(".info_bar_right").prepend(b.render().el)}else{this.$el.find(".info_bar_left").append(b.render().el)}},buttonRemoved:function(a){a.trigger("removed")},_loadImage:function(){var b=this.model.get("content");var a=new Image();var c=function(j){var f=j.target||j.srcElement;var l="url("+f.src+")";var k=44;var d=f.height;var h=f.width;var i=0;if(d>k){h=Math.floor(h*(k/d));d=k}else{i=Math.floor((k-d)/2)}var g=this.$(".app_header_image");g.css({"background-image":l,"background-size":h+"px "+d+"px",top:i,bottom:i})};a.onload=c.hitch(this);a.src=b},render:function(){var b;var a=this.model.get("type");switch(a){case headerTypes.textHeader:b=templates.appHeaderText;break;case headerTypes.imageHeader:b=templates.appHeaderImage;break;case headerTypes.imageAndTextHeader:b=templates.appHeaderImageAndText;break;default:b=templates.appHeaderEmpty;break}this.$el.html(b(this.model.toJSON()));if(a===headerTypes.imageHeader){this._loadImage()}return this}}); var TemplatesView=Backbone.View.extend({id:"app_pages_container",initialize:function(){this.model.bind("addMorePage",this.addMorePage,this)},render:function(){var b=this;this.$el.attr("data-role","pages_container");var a=this.model.get("pages");$.each(a,function(f){var g=this;var h=b._createTemplateView(g);if(h){var e=function(){var i=b._createTemplateView(g);h.$el.after(i.$el);h.$el.remove();h._unbind();setTimeout(function(){g.set({selected:false});g.set({selected:true})},0)};g.bind("change:isPurchase",e);b.$el.append(h.el);var d="";var c=g.get("meta");if(c&&c.layout&&c.layout.meta&&c.layout.meta.bgImage){d=c.layout.meta.bgImage}if(Utils&&Utils.ImageLoader){Utils.ImageLoader.load(d)}}});return this},addMorePage:function(a){var b=new MorePageView({model:a});this.$el.append(b.el)},_fixTemplateViewName:function(c,b,a){if(LAYOUT===layoutFormat.wide&&(b==="a7bf6078-3f92-4b90-acf2-b122903bc846"||b==="4680c3f3-e767-4ebf-b112-9ba769c3ff2a")&&a===2){return pageTypes[b].templateViewName}else{return c}},_createTemplateView:function(d){var e=null;var c=d.get("type");var b=pageTypes[c].templateViewName;if(LAYOUT===layoutFormat.wide&&pageTypes[c].wideTemplateViewName){b=pageTypes[c].wideTemplateViewName}var a=d.get("meta")["pageLayout"];b=this._fixTemplateViewName(b,c,a);if(b&&window[b]){e=new window[b]({model:d,tabsName:pageTypes[c].itemsName});$(e.el).addClass(pageTypes[c].cssClass)}return e}}); var FooterView=Backbone.View.extend({id:"app_footer",render:function(){var a=this.$el,b=$(document.body);a.attr("data-role","footer");a.addClass("clr_appGeneral_footer_bg");b.bind("focusin",function(){a.addClass("on_input_focus")});b.bind("focusout",function(){a.removeClass("on_input_focus")});return this}}); var TemplateView=Backbone.View.extend({initialize:function(){this.rendered=[];this._homePagesViews=[];this._changePageParams={changeHash:true};this.model.bind("change:selected",this.handleSelectedStateChange,this);this.$el.addClass("template_view");this.$el.data("id",this.model.get("id"));$('*[data-role="page"]',this.$el).live("pageshow",this._handlePageShow.hitch(this));if(AppSettingsManager.getSettings().get("isHeaderScrollable")){$('*[data-role="page"]',this.$el).live("pagebeforeshow",this._handlePageBeforeShow)}},_unbind:function(){this.model.unbind("change:selected",this.handleSelectedStateChange,this)},_handlePageShow:function(){var a=this.$el.find(".ui-page-active .scroll_wrapper");Scrolling.handlePageShow(a)},_handlePageBeforeShow:function(){$this=$(this);if(!$this.data("header")){var a=AppManager.app().get("header");var b=new HeaderView({model:a});$this.find(".scroller").prepend(b.render().el);$this.data("header",true)}},render:function(b){var f=this.model.get("meta");if(f&&f.hideHeader){this._homePagesViews[b].$el.attr({"data-bars":"hideHeader"})}var d=pageTypes[this.model.get("type")].itemsName;if(d){var a=this.getTemplateItems(d);if(a.length>1){var e=new PageTabsModel({items:a});var c=new PageTabsView({model:e,selectedIndex:b});this._homePagesViews[b].addTabsView(c.render().el);c.bind("tabClicked",this._onSelectedTabChanged,this)}}},handleSelectedStateChange:function(){if(this.model.get("selected")){this.$el.show();this._onSelectedTabChanged(this.model.get("defaultTabIndex"))}else{this.$el.hide()}},_onSelectedTabChanged:function(f){if(!this.rendered[f]){this.render(f);this.rendered[f]=true}var g={transition:"none",reverse:false};var c=this._homePagesViews[f];g.changeHash=c.changeHash;if(this.model.get("first")){this.model.set({first:false});g.changeHash=false}if(this.model.get("changePage")){var e="#"+c.id;if(DEVICE!=deviceTypeEnum.android||PLATFORM!=platformEnum.nativeApp){var h=$(e).parent();if(!h.hasClass("with_page_background_image")){var d="";var b=this.model.get("meta");if(b&&b.layout&&b.layout.meta&&b.layout.meta.bgImage){d=b.layout.meta.bgImage}if(d!==""){d="url("+d+")";h.addClass("with_page_background_image");var a=h;if(ScrollingFactory.getScrollerName()===ScrollingFactory.FIXED_SCROLL_NAME){a=$("<div></div>");h.prepend(a)}a.css("background-image",d).addClass("page_background_image")}}}$.mobile.changePage(e,g)}else{this.model.set({changePage:true})}},getTemplateItems:function(a){return this.model.get("meta")[a]}}); var MorePageView=TemplateView.extend({render:function(a){var b=new NavView({model:this.model,navType:navigationLayoutTypes.list});this.$el.html(b.render().el);this._homePagesViews[a]=b}}); var FullScreenAdView=Backbone.View.extend({id:"full_screen_ad_container",events:{tap:"adClicked"},render:function(){this.$el.html(templates.fullScreenAd(this.model.toJSON()));setTimeout(function(){this.$el.css({"-webkit-transition-property":"opacity","-webkit-transition-duration":"0.5s","-webkit-transition-timing-function":"ease-out",opacity:"0.0"});setTimeout(function(){this.$el.hide();if(navigator.appManager&&navigator.appManager.unlockScreen){navigator.appManager.unlockScreen()}}.hitch(this),500)}.hitch(this),this.model.get("duration"));return this},adClicked:function(a){a.preventDefault();this.model.adClicked()}}); var AdBarView=Backbone.View.extend({id:"ad_container",className:"clr_appGeneral_adBar_bg clr_appGeneral_adBar_brdr clr_appGeneral_adBar_hdlTxt",initialize:function(){this.model.bind("change",this.render,this)},events:{tap:"adClicked"},render:function(){if(this.model.get("displayType")==adDisplayTypes.image){var a=templates.imageAd}else{var a=templates.textAd}this.$el.html(a(this.model.toJSON()));var b=$(".ui-page-active .scroll_wrapper");Scrolling.onWrapperResize(b);return this},adClicked:function(a){a.preventDefault();this.model.adClicked()}}); var ExternalContentView=Backbone.View.extend({render:function(){var c=null;this.innerViewId="home_"+Utils.Helpers.generateGUID();switch(this.model.get("contentType")){case ExternalContentTypes.BLOG_POST:this.$el.addClass("blog");var d=this.model.get("content").items[0];this.url=d.link;d.formattedDatetime=Utils.TimeDate.timeAsText(d.datetime);d.formattedShortDesc=$.trim(d.description);d.formattedTitle=$.trim(d.socialInfo.title);var e=new Backbone.Model(d);c=new BlogPostView({model:e,id:this.innerViewId});$(c.el).attr("data-buttons","");break;case ExternalContentTypes.STATIC_HTML:this.$el.addClass("staticHtml");this.url=this.model.get("url");var b=new Backbone.Model({html:this.model.get("content")});c=new StaticHtmlView({model:b,id:this.innerViewId});break}var a={url:this.url,locationHref:document.location.href};conduitApi.analytics.addEvent(null,null,conduitApi.analytics.usageEventTypeEnum.ExternalContentShown,a,true);this.$el.html(c.render().el);if(this.model.get("contentType")==ExternalContentTypes.STATIC_HTML){c.appendToView(templates.viewOriginalTemplate({text:_T("HtmlTextViewOriginalPageBtnText")}));$(c.el).find(".view-orig-container").tap(this._onViewOrigTap.hitch(this))}return this},_onViewOrigTap:function(a){a.preventDefault();conduitApi.app.openLink(null,null,{url:this.url})}}); var BaseNavItemView=Backbone.View.extend({_isButton:false,initialize:function(){this.model.bind("change:isPurchase",this.render,this);var b=this.model.get("type");var e=this.model.get("meta");var d={};if(e&&e.items&&e.items[0]){d=e.items[0]}var a="javascript:void(0)";var c=false;switch(b){case"308af5fa-e91b-d7e7-1926-acfea8f266dc":if(PLATFORM!=platformEnum.simulator){this._isButton=true;if(d.phone){a="tel:"+d.phone}}break;case"ec79d314-f6aa-f396-a651-3f9b3344dd99":if(PLATFORM!=platformEnum.simulator){this._isButton=true;if(d.email){a="mailto:"+d.email}}break;case"c54d24ef-faf5-45dd-8859-85e3ebe7cecf":if(PLATFORM!=platformEnum.simulator){this._makeOpenLinkButton(d)}break;case"9eea8149-956c-46f9-8597-167401c63cd7":if(PLATFORM===platformEnum.webApp){this._makeOpenLinkButton(d)}break;case"8901e95e-4dc9-411f-835a-0f18a7872122":if(PLATFORM!=platformEnum.simulator&&d.type=="menulink"){this._makeOpenLinkButton(d)}break}this.model.set({href:a});this.model.set({openInNewTab:c});if(!this._isButton){this.$el.tap(this.itemClicked.hitch(this))}},_makeOpenLinkButton:function(b){this._isButton=true;var a=PLATFORM===platformEnum.webApp;if(typeof(b.openInExternalBrowser)!=="undefined"){a=b.openInExternalBrowser}if(conduitApi.app.isSupported()){this.$el.tap(function(){conduitApi.app.openLink(null,null,{useExternalBrowser:a,url:b.link,title:b.title})})}},itemClicked:function(a){a.preventDefault();this.model.selectPage()}}); var TabBarView=Backbone.View.extend({tagName:"table",MAX_PAGES:5,id:"app_navigation_bar",render:function(){this.$el.attr({cellpadding:"0",cellspacing:"0",border:"0"});var b=this.model.get("pages");var a=b.length;var f=Math.min(this.MAX_PAGES,a);var c=100/f;var e=f-1;for(var d=0;d<e;d++){var g=b[d];var h=new TabItemView({model:g});this.$el.append($(h.render().el).attr("style","width: "+c+"%"))}if(a>this.MAX_PAGES){var g=new Template({label:_T("HtmlTextMorePages"),pages:b,id:NAVIGATION_PAGE_GUID});var h=new TabItemView({model:g});this.model.trigger("addMorePage",g);h.template=templates.bottomBarMoreItem;this.$el.append($(h.render().el).attr("style","width: "+c+"%"))}else{if(e!==-1){var g=b[e];var h=new TabItemView({model:g});this.$el.append($(h.render().el).attr("style","width: "+c+"%"))}}return this}}); var TabItemView=BaseNavItemView.extend({template:templates.bottomBarItem,tagName:"td",className:"ui-btn-up",initialize:function(){BaseNavItemView.prototype.initialize.apply(this);this.model.bind("change:selected",this.renderSelected,this)},render:function(){this.$el.html(this.template(this.model.toJSON()));this.renderSelected();return this},renderSelected:function(){if(!this._isButton){if(this.model.get("selected")){this.$el.find("*").addClass("selected")}else{this.$el.find("*").removeClass("selected")}}}}); var NavView=Backbone.View.extend({id:"nav_view",render:function(){this.$el.attr("data-role","page");var b;switch(this.options.navType){case navigationLayoutTypes.grid:b=new GridNavView({model:this.model});this.$el.bind("pageshow",function(){b.onPageShow()});this.$el.bind("pagehide",function(){b.onPageHide()});this.$el.addClass("clr_navGrid_bg");b.onPageHide();break;case navigationLayoutTypes.list:b=new ListNavView({model:this.model});this.$el.addClass("clr_navList_bg");break}var c=document.createElement("div");c.className="scroll_wrapper";var a=document.createElement("div");a.className="scroller";c.appendChild(a);this.el.appendChild(c);a.appendChild(b.render().el);var d=$(c);Scrolling.init(d);this.$el.append(this.scrollerElement);return this}}); var NavTemplateView=TemplateView.extend({render:function(){var a=new NavView({model:this.model.get("appModel"),navType:this.model.get("navType")});this.$el.html(a.render().el);this._homePagesViews[0]=a;return this}}); var ListNavView=Backbone.View.extend({tagName:"ul",id:"app_navigation_list",render:function(){var a=this.model.get("pages");var b=this;_.each(a,function(d){if(d.get("id")!=NAVIGATION_PAGE_GUID){var c=new ListNavItemView({model:d});$(b.el).append(c.render().el)}});this.trigger("contentChanged");return this}}); var ListNavItemView=BaseNavItemView.extend({template:templates.listNavItem,tagName:"li",className:"navigation_list_item_wrapper",render:function(){this.$el.html(this.template(this.model.toJSON()));return this}}); var GridNavView=Backbone.View.extend({tagName:"ul",id:"app_navigation_grid",initialize:function(){$(window).bind("throttledresize",this.onResize.hitch(this))},render:function(){var a=this.model.get("pages");var b=this;_.each(a,function(d){if(d.get("id")!=NAVIGATION_PAGE_GUID){var c=new GridNavItemView({model:d});$(b.el).append(c.render().el)}});this.trigger("contentChanged");return this},onResize:function(){if(this.isPageShow){this.updateThumbnailsMargin()}},onPageShow:function(){this.isPageShow=true;this.updateThumbnailsMargin();this.$el.css({visibility:"visible"})},onPageHide:function(){this.isPageShow=false;this.$el.css({visibility:"hidden"})},updateThumbnailsMargin:function(){this.$el.find(".navigation_bar_item_img").css({"margin-left":"3px"});Utils.Html.setGridMargin(this.$el,{minMargin:8-5,centerFewItems:true,alsoTop:false})}}); var GridNavItemView=BaseNavItemView.extend({template:templates.gridNavItem,tagName:"li",className:"navigation_list_item_wrapper",render:function(){this.$el.html(this.template(this.model.toJSON()));return this}}); var SideMenuNavView=Backbone.View.extend({template:templates.sideMenuNav,id:"app_navigation_sideMenu",animationDuration:300,initialize:function(){},_addAnimationClasses:function(){this.$appContainer.css({"-webkit-transition-property":"all","-webkit-transition-duration":this.animationDuration+"ms","-webkit-transition-timing-function":"linear"})},_removeAnimationClasses:function(){this.$appContainer.css({"-webkit-transition-duration":"0ms"})},toggleSideMenu:function(){if(this.sideMenuOpen){this.closeSideMenu()}else{this.openSideMenu()}},closeSideMenu:function(a){if(!this.sideMenuOpen){return}$.mobile.closeDialog(function(){Utils.Helpers.funcWrapper(a)()});this._closeSideMenu()},_backClicked:function(){if(!this.sideMenuOpen){return}this._closeSideMenu()},_closeSideMenu:function(){this._removeAnimationClasses();setTimeout(function(){this._addAnimationClasses();this.$appContainer.removeClass("sideMenuOpen")}.hitch(this),0);if(ScrollingFactory.getScrollerName()!==ScrollingFactory.ISCROLL_NAME){this.$appContainer.css({"max-height":"",overflow:""});setTimeout(function(){this.$sideArea.hide()}.hitch(this),this.animationDuration)}this.sideMenuOpen=false},openSideMenu:function(){$.mobile.openDialog(function(){this._backClicked()}.hitch(this));this._removeAnimationClasses();if(ScrollingFactory.getScrollerName()!==ScrollingFactory.ISCROLL_NAME){this.$sideArea.show();var a=this.$sideArea.height();this.$appContainer.css({"max-height":a,overflow:"hidden"})}setTimeout(function(){this._addAnimationClasses();this.$appContainer.addClass("sideMenuOpen")}.hitch(this),0);this.sideMenuOpen=true},_refreshScroll:function(){var a=Utils.Html.getInnerSize(window).height;Scrolling.refreshScroll(this.$scrollWrapper,a)},render:function(){this.$el.html(this.template(this.model.toJSON()));this.$appContainer=this.$(".app_container");this.$sideArea=this.$(".side_area");var a=this.model.get("pages");var b=this.$("ul");_.each(a,function(e){if(e.get("id")!=NAVIGATION_PAGE_GUID){var d=new SideMenuNavItemView({model:e,sideMenu:this});b.append(d.render().el)}}.hitch(this));this.$scrollWrapper=this.$(".scroll_wrapper");Scrolling.init(this.$scrollWrapper);$(window).bind("orientationchange throttledresize scroll",this._refreshScroll.hitch(this));this._refreshScroll();var c=this;this.$(".page_transparent_overlay").bind("vmousedown",function(){c.toggleSideMenu();return false});if(IS_RTL){this.$sideArea.bind("swiperight",function(){c.closeSideMenu()})}else{this.$sideArea.bind("swipeleft",function(){c.closeSideMenu()})}this._closeSideMenu();if(IS_RTL){this.$appContainer.bind("swipeleft",function(){c.openSideMenu()})}else{this.$appContainer.bind("swiperight",function(){c.openSideMenu()})}this.trigger("contentChanged");return this}}); var SideMenuNavItemView=BaseNavItemView.extend({template:templates.sideMenuNavItem,tagName:"li",className:"navigation_list_item_wrapper",render:function(){this.$el.html(this.template(this.model.toJSON()));return this},itemClicked:function(a){a.preventDefault();this.options.sideMenu.closeSideMenu(this.closeMenuDone.hitch(this))},closeMenuDone:function(){this.model.selectPage()}}); var commonTemplates={};commonTemplates.emptyPage=_.template('<div id="<%= id %>" data-role="page"></div>');commonTemplates.feedsHomePage=_.template('<div id="home_<%= pageID %>" data-role="page" class="controller"><div data-role="header"><table class="top_tabs_table theme_topbar_background" cellpadding="0" cellspacing="0"border="0"><tr class="top_tabs"></tr></table></div><div class="scroll_wrapper"><div class="scroller"><ul class="feeds_list"></ul></div></div></div>');commonTemplates.feedsDetailsPage=_.template('<div id="details_screen_<%= pageID %>" data-role="page" class="controller with_back_button"><div data-role="header"><div class="feed_details_share theme_infobar_background"></div></div><div class="scroll_wrapper"><div class="scroller"><div class="theme_item title_frame"></div></div></div></div>');commonTemplates.shareView=_.template('<div style="width:<%= btnWidth %>%;" class="share_bar_button" share-service="<%= service %>"><div class="share_button_image <%= serviceImageClass %> mask_sprite clr_appGeneral_shareViewIcn" /></div>');commonTemplates.showMoreButton=_.template('<div class="more_container"><a class="button clr_contTypeA_btn_bg clr_contTypeA_btn_brdr clr_contTypeA_btn_hdlTxt" data-role="button"><div class="button_text"><%= showMoreStr %></div><div class="loading_text"><div class="loading_icon mask_sprite sprite-ajax-loader_small spin clr_contTypeA_btn_icn"></div><div class="loading_string"><%= loadingStr %></div></div></a></div>');commonTemplates.showMoreButtonWithoutLoading=_.template('<div class="more_container"><a class="button clr_contTypeA_btn_bg clr_contTypeA_btn_brdr clr_contTypeA_btn_hdlTxt" data-role="button"><div class="button_text"><%= showMoreStr %></div></a></div>');commonTemplates.pageTabViewTemplate=_.template('<span class="page-tab-title clr_tabBar_item_bubble_bg clr_tabBar_item_bubble_brdr clr_tabBar_item_bubble_txt" ><%= title %></span>'); PhotoGalleryManager=function(a){this._container=a};PhotoGalleryManager.constructor=PhotoGalleryManager;PhotoGalleryManager.prototype={AUTO_HIDE_DELAY:60000,pressedImage:function(d,a){if(PLATFORM==conduitApi.platform.deviceInfo.platformEnum.nativeApp){var c=function(){this.innerPressedImage(d,a)};for(var b=0;b<d.length;b++){if(d[b].photoModel){d[b].shareInfo=d[b].photoModel.get("shareInfo")}}navigator.photoGallery.startGallery(c.hitch(this),a,d)}else{this.innerPressedImage(d,a)}},innerPressedImage:function(d,b){if(this._isGallerySupported()){var a={jQueryMobile:false,backButtonHideEnabled:true,minUserZoom:1,getImageSource:this._getImageSource,getImageCaption:this._getImageCaption,captionAndToolbarAutoHideDelay:this.AUTO_HIDE_DELAY,enableUIWebViewRepositionTimeout:true};var c=this;this._galleryInstance=window.Code.PhotoSwipe.attach(d,a);this._galleryInstance.addEventHandler(window.Code.PhotoSwipe.EventTypes.onShow,function(){$("html").addClass("photoswipe")});this._galleryInstance.addEventHandler(window.Code.PhotoSwipe.EventTypes.onBeforeHide,function(){$("html").removeClass("photoswipe")});if(DEVICE===conduitApi.platform.deviceInfo.deviceTypeEnum.android&&PLATFORM==conduitApi.platform.deviceInfo.platformEnum.nativeApp){conduitApi.app.addBackButton(null,null,null,true,this._onBackButtonPressed);conduitApi.app.hideNavigationBar()}this._galleryInstance.show(b);this._galleryInstance.documentOverlay.el.dir="ltr";this._galleryInstance.toolbar.captionEl.dir="ltr";this._galleryInstance.toolbar.toolbarEl.dir="ltr";this._galleryInstance.uiLayer.el.dir="ltr";this._galleryInstance.carousel.el.dir="ltr";this._galleryInstance.addEventHandler(Code.PhotoSwipe.EventTypes.onHide,function(){$(window).trigger("resize")})}else{if(PLATFORM==platformEnum.simulator){cqm.showToastMessage("Photo gallery view is not supported in simulator mode")}else{cqm.showToastMessage(_T("DialogCaptionPhotosManagerDeviceNotSupported"))}}},_isGallerySupported:function(){return window.getComputedStyle},_getImageSource:function(a){return a.largeImage},_getImageCaption:function(g){var c="";if(g.photoTime){c=dateFormat(g.photoTime*1000,"dateTime")}var e=Utils.String.trailString(g.title,80);var f=photoGalleryTemplates.imageCaptionMarkup({title:e,time:c});var b=$(f);if(g.photoModel){var d=b.find(".ps-share-button-container");var a=$(photoGalleryTemplates.shareButtonMarkup({}));ShareControlHelper.addShareControlButton(d,g.photoModel,a)}return b[0]},_onBackButtonPressed:function(){history.back()}}; var photoGalleryTemplates={imageCaptionMarkup:_.template('<div class="photo_swipe_caption"><%= title %><BR /><div class="ps-caption-date"><%= time %></div><div class="ps-share-button-container"></div></div>'),shareButtonMarkup:_.template('<div class="icon sprite sprite-sharePhotos"></div>')}; var DividedScreenView=Backbone.View.extend({tagName:"div",className:"divided_screen",initialize:function(){this.$page1container=$('<div class="page1_container clr_appGeneral_scrnDiv_bg clr_appGeneral_scrnDiv_brdr"></div>');this.$page2container=$('<div class="page2_container"></div>');this.$el.append(this.$page1container).append(this.$page2container);this._view1=null;this._view2=null;var b=this.options.leftWidth||"33%";var a=this.options.minWidth||"300px";this.$page1container.css({width:b,"min-width":a});this.$el.attr({"data-role":"page","data-buttons":"navigation"});if(this.options.bubblePageEvents){this.$el.bind("pageshow",function(){if(this._view1){this._view1.trigger("pageshow")}if(this._view2){this._view2.trigger("pageshow")}}.hitch(this));this.$el.bind("pagehide",function(){if(this._view1){this._view1.trigger("pagehide")}if(this._view2){this._view2.trigger("pagehide")}}.hitch(this))}},addRefreshButton:function(b,a){var c=this.$el.attr("data-buttons")+" refresh";this.$el.attr({"data-buttons":c});this.$el.bind("refresh",function(){if(b&&this._view1){this._view1.handleRefreshClick()}if(a&&this._view2){this._view2.handleRefreshClick()}}.hitch(this));this.$el.bind("silentRefresh",function(){if(b&&this._view1){this._view1.handleSilentRefresh()}if(a&&this._view2){this._view2.handleSilentRefresh()}}.hitch(this));return this},render:function(){return this},_setViewInContainer:function(b,a){if(b.$el.parent().length>0){return false}b.$el.attr("data-role","minipage");a.empty().append(b.$el);return true},setView1:function(a){if(this._setViewInContainer(a,this.$page1container)){this._view1=a}},setView2:function(a){if(this._setViewInContainer(a,this.$page2container)){this._view2=a}},addTabsView:function(a){if(this._view1){this._view1.addTabsView(a)}}}); var VideoPlayerUtils={removeRelatedVideos:function(a){if(a.indexOf("?")>-1){return a+"&rel=0"}else{return a+"?rel=0"}}}; var VideoPlayerModel=Backbone.Model.extend({defaults:{isYoutube:false,picture:"",videoUrl:"",rtspUrl:""}}); var VideoPlayerView=Backbone.View.extend({tagName:"div",events:{tap:"itemClicked"},render:function(){var b=this.model.get("picture");if(!b){b=""}if(this.options.useBigIcon){var d="play_circle"}else{var d="playVideo"}var a='<span class="video_player_play_icon sprite sprite-'+d+'"></span>';if(this.options.isSliced){this.$el.addClass("video_player_sliced_poster sliced_image clr_appGeneral_bg").html(a).css("background-image","url('"+b+"')")}else{var c='<img class="video_player_image" src="'+b+'" />'+a;this.$el.addClass("video_player_poster clr_appGeneral_bg").html(c);this.$el.find("IMG").error(function(){$(this).remove()})}return this},itemClicked:function(d){d.preventDefault();var c=this.model.get("isYoutube");if(PLATFORM===platformEnum.nativeApp){var b=this.model.get("videoUrl");if(c){b=VideoPlayerUtils.removeRelatedVideos(b)}conduitApi.platform.video.play(null,null,b,c?VideoTypes.YOUTUBE:VideoTypes.GENERAL);return}if(c&&DEVICE===deviceTypeEnum.android&&PLATFORM!==platformEnum.simulator){var b=this.model.get("videoUrl");if(c){b=VideoPlayerUtils.removeRelatedVideos(b)}window.location=b;return}var a=new FullScreenVideoPlayerView({model:this.model});$("body").append(a.render().el);$.mobile.changePage("#"+a.id,{transition:"fade"});$(a.el).bind("pagehide",function(){$(a.el).remove()})}}); var FullScreenVideoPlayerView=Backbone.View.extend({tagName:"div",id:"video_player_"+Utils.Helpers.generateGUID(),initialize:function(){this.$el.attr({"data-role":"page"})},render:function(){var e=this.model.get("videoUrl");var d=this.model.get("isYoutube");if(d){e=VideoPlayerUtils.removeRelatedVideos(e);e=e.indexOf("?")?e+"&html5=0":e+"?html5=0";var b='<object style="overflow:hidden;height:100%;width:100%;background:black" height="100%" width="100%"><embed id="movie_embed" src="'+e+'" type="application/x-shockwave-flash" allowfullscreen="true" wmode="opaque" allowScriptAccess="always" autoplay="1" width="100%" height="100%"></object>'}else{var c=this.model.get("imageUrl");var h="";if(c){var h=' poster="'+c+'"'}var b='<video controls class="video_player"><source src="'+e+'"></video>'}var g='<div class="full_video_player_header"><div class="video_close_button sprite sprite-ps-close"></div></div>';var a=g+'<div class="full_video_player_body">'+b+"</div>";this.$el.addClass("video_full_player").html(a);var f=this.$el.find(".video_close_button");f.tap(function(j){j.preventDefault();if(PLATFORM!==platformEnum.simulator){history.back()}else{if($.mobile.urlstack.length>1){var i=$.mobile.urlstack[$.mobile.urlstack.length-2];location.hash="cqm_"+i.pageId}}},false);$(window).bind("throttledresize",this._resizePlayer.hitch(this));this._resizePlayer();return this},_resizePlayer:function(){var a=window.innerHeight+"px";var b=window.innerWidth+"px";this.$el.css({height:a,width:b})}}); var LogoHeaderView=Backbone.View.extend({className:"logo_img_header",render:function(){var a=this.model.get("logoImgUrl");if(a){this.$el.html(logoHeaderTemplates.tpl({logoImgUrl:a}));this.$el.find("IMG").load(function(){var b=Scrolling.getMyScrollerWrapper(this.$el);Scrolling.onContentChanged(b)}.hitch(this)).error(function(){$(this).remove()})}return this}}); var logoHeaderTemplates={tpl:_.template('<img class="logo_header_image" src="<%= logoImgUrl %>" />')}; var PurchaseItemModel=Backbone.Model.extend({defaults:{methods:[],itemModel:null},methodTypeEnum:{inapp:1,externalLink:2},_checkiTunes:function(b){if(DEVICE===deviceTypeEnum.iphone&&PLATFORM===platformEnum.nativeApp){function a(){function g(h){if(h&&h.length>0){var i=h[0];if(i.status==="exist"&&i.url){b.get("stream").url=i.url;b.set({isPurchase:true})}}}var d=encodeURIComponent(b.get("author"))||"";var e=encodeURIComponent(b.get("collectionTitle"))||"";var f=encodeURIComponent(b.get("title"))||"";var c=[{artistName:d,albumName:e,songName:f}];Cordova.exec(g,null,"iPodLib","queryMediaItems",[{items:c}]);document.removeEventListener("itunesLibraryChanged")}document.addEventListener("itunesLibraryChanged",a,false)}},buy:function(e,d,c){if(!e){return}if(e.type===this.methodTypeEnum.externalLink&&e.url){if(conduitApi.app.isSupported()){var b=UrlGenerator.generateUrl(e.url,{});conduitApi.app.openLink(null,null,{url:b,title:b});this._checkiTunes(this.get("itemModel"))}}else{if(e.type===this.methodTypeEnum.inapp&&e.resourceId){var a=function(i){var g=this.get("itemModel");if(g&&g.buildFromJSON){var h=g.toJSON();var f=ItemsTransformer.transformItem(h);g.buildFromJSON(f);g.set({isPurchase:true});Utils.Helpers.funcWrapper(d)(i)}else{Utils.Helpers.funcWrapper(c)('no "rebuild from locked data" function')}};InappPurchaseManager.buyResource(e.resourceId,a.hitch(this),c)}else{}}}}); var PurchaseItemView=Backbone.View.extend({tagName:"div",events:{tap:"itemClicked"},initialize:function(){this.buyString=_T("HtmlTextPurchaseItemBuy");this.colorClass="clr_contTypeB_actBtn_bg clr_contTypeB_actBtn_brdr clr_contTypeB_actBtn_hdlTxt"},render:function(){var a=purchaseItemTemplates.defaultBuyButton({buyString:this.buyString,colorClass:this.colorClass});this.$el.html(a);return this},chooseMethod:function(c){var a=this.model.get("methods");if(a&&a.length>0){if(a.length===1){Utils.Helpers.funcWrapper(c)(a[0])}else{var d=[];_.each(a,function(k,f){var j=k.title||"";var g=k.price||"";var h=purchaseItemTemplates.chooseMethodButton({title:j,price:g});d[f]={title:h,returnValue:k}});var e=purchaseItemTemplates.cancelMethodButton({cancelString:_T("ButtonCancel")});var b={dialogTitle:_T("DialogCaptionPurchaseChooseMethod"),cancelTitle:e,dialogWidth:260};ChooseDialog.execute(d,c,c,b)}}else{Utils.Helpers.funcWrapper(c)(null)}},itemClicked:function(b){b.preventDefault();var a=function(e){var d=function(f){};var c=function(g){var h=_T("DialogMessagePurchaseFail");var f=[{text:_T("ButtonClose")}];conduitApi.UI.showDialogBox(null,null,{title:_T("DialogCaptionError"),message:h,buttons:f})};this.model.buy(e,d,c)};this.chooseMethod(a.hitch(this))}}); var purchaseItemTemplates={};purchaseItemTemplates.defaultBuyButton=_.template('<div class="purchase_item_button <%= colorClass %>" data-role="button"><%= buyString %></div>');purchaseItemTemplates.chooseMethodButton=_.template('<div class="puechase_method_item"><span class="puechase_method_text title"><%= title %></span><span class="puechase_method_text price"><%= price %></span></div');purchaseItemTemplates.cancelMethodButton=_.template('<div class="puechase_cancel_item"><%= cancelString %></div'); var MapPageView=Backbone.View.extend({className:"map-page-view",events:{pageshow:"onPageShow"},_googleMapsView:null,initialize:function(){this.id="showOnMap_"+Utils.Helpers.generateGUID();this.$el.attr({"data-role":"page","data-buttons":"back",id:this.id});var a=this.model.toJSON();a.callback=this.onGoogleReady.hitch(this);this._googleMapsView=new GoogleMapsView(a)},render:function(){return this},onPageShow:function(){if(!this._needToRender){this._needToRender=true;cqm.showLoading(_T("HtmlTextMapLoading"),this.$el,false);if(this._googleReady){this.renderMap()}}},onGoogleReady:function(){if(!window.GoogleMarkerLabel.draw){GoogleMarkerLabelClassCreator.createClass()}this._googleReady=true;if(this._needToRender){this.renderMap()}Utils.Helpers.funcWrapper(this.model.get("callback"))()},renderMap:function(){this.$el.html(this._googleMapsView.render().el);cqm.hideLoading(this.$el)}}); var BaseItemsView=Backbone.View.extend({events:{"tap .more_container":"_onShowMoreTap"},_initOptions:function(){var a={showMoreStr:_T("HtmlTextPaginationShowMoreItems"),loadingStr:_T("HtmlTextPaginationLoadingItems"),failStr:_T("ToastMessagePaginationFailedGetItems")};this.options=$.extend({},a,this.options)},initialize:function(){this._initOptions();var a=this.model.get("items");if(a){a.bind("getItemsSuccess",this._onGetItemsSuccess,this);a.bind("getItemsFail",this.onGetDataFail,this);a.bind("add",this._renderOneItem,this);a.bind("singleAdd",this._refreshScroll,this);a.bind("reset",this._reset,this)}this.model.bind("change:isLoading",this._onLoadingStateChanged,this);this._onLoadingStateChanged()},_onLoadingStateChanged:function(){var b=this.model.get("loadingType");if(b!==loadingTypeEnum.NORMAL&&b!==loadingTypeEnum.REFRESH){return}if(this.model.get("isLoading")){var a=true;cqm.showLoading(_T("HtmlTextPaginationRefreshItems"),this.$el,a)}else{cqm.hideLoading(this.$el)}},handleRefreshClick:function(){this.model.set("loadingType",loadingTypeEnum.REFRESH);this.model.getItems(executeTypeEnum.FORCE_NETWORK)},handleSilentRefresh:function(){if(this.model.isExpiredCache()){this.model.set("loadingType",loadingTypeEnum.SILENT_REFRESH);this.model.getItems(executeTypeEnum.FORCE_NETWORK)}},render:function(){this._reset();this._renderItems();this._renderShowMoreButton();return this},_onGetItemsSuccess:function(a,d,c){this._renderShowMoreButton();this._refreshScroll();var b=this.model.get("items");if(b&&_.isEmpty(b.models)){this.onNoResults()}},_refreshScroll:function(){var a=this.getRootView();if(a){this.$myScrollWrapper=this.$myScrollWrapper||Scrolling.getMyScrollerWrapper(a);Scrolling.onContentChanged(this.$myScrollWrapper)}},_reset:function(){},_renderItems:function(){var a=this.model.get("items");if(a){a.each(this._renderOneItem.hitch(this))}},_renderOneItem:function(a){},_renderShowMoreButton:function(){var b=this.model.get("items");if(!b||b.EOF||b.length===0){this._removeShowMoreButton();return}var a=this.getRootView();if(!a){return}if(!this.$showMoreButton){this.$showMoreButton=$(commonTemplates.showMoreButton(this.options));this.$getMoreButton=this.$showMoreButton.find(".button_text");this.$getMoreLoading=this.$showMoreButton.find(".loading_text");a.append(this.$showMoreButton)}this.$getMoreLoading.hide();this.$getMoreButton.show();this.$showMoreButton.addClass("read_more_button")},_removeShowMoreButton:function(){if(this.$showMoreButton){this.$showMoreButton.remove();this.$showMoreButton=null}},_cbRetry:function(){this.model.getItems(executeTypeEnum.HIT_AND_RUN)},_cbCancel:function(){this.model.set({eof:true})},onGetDataFail:function(c,b){this._removeShowMoreButton();if(PLATFORM!=platformEnum.simulator){if(c===executeTypeEnum.HIT_AND_RUN){var a={title:_T("DialogCaptionError"),message:this.options.failStr,buttons:[{text:_T("ButtonRetry"),cb:this._cbRetry.hitch(this)},{text:_T("ButtonCancel"),cb:this._cbCancel.hitch(this)}]};conduitApi.UI.showDialogBox(null,null,a)}else{conduitApi.UI.showToastMessage(null,null,this.options.failStr,this.$el);this._cbCancel()}}else{if(!b){conduitApi.UI.showToastMessage(null,null,this.options.failStr,this.$el);this._cbCancel()}}},_onShowMoreTap:function(a){a.preventDefault();this.$getMoreButton.hide();this.$getMoreLoading.show();this.$showMoreButton.removeClass("read_more_button");this.model.set("loadingType",loadingTypeEnum.SHOW_MORE);this.model.getItems(executeTypeEnum.HIT_AND_RUN_SILENT)},onNoResults:function(){},getRootView:function(){return null}}); var ItemsView=BaseItemsView.extend({initialize:function(){this.$itemsList=$('<ul class="feeds_items_list"></ul>');this.getRootView().append(this.$itemsList);BaseItemsView.prototype.initialize.apply(this)},_reset:function(){this.$itemsList.html("")},_renderOneItem:function(c,d,a){var b=this.createItemView(c);if(b){if(a&&a.index===0){this.$itemsList.prepend(b.render().el)}else{this.$itemsList.append(b.render().el)}}},createItemView:function(a){return null},getRootView:function(){return null},onNoResults:function(){}}); var PageTabModel=Backbone.Model.extend({defaults:{title:""}}); var PageTabsModel=Backbone.Model.extend({defaults:{items:[]}}); var PageTabView=Backbone.View.extend({tagName:"td",className:"page-tab-view clr_tabBar_item_bg clr_tabBar_item_brdr",events:{tap:"tabClicked"},initialize:function(){var a=this.options.width+"%";this.$el.attr("data-role","button").css({width:a})},render:function(){this.$el.html(commonTemplates.pageTabViewTemplate(this.model.toJSON()));if(this.options.selected){this.$el.addClass("selected");this.$el.find("SPAN").addClass("selected")}return this},tabClicked:function(a){a.preventDefault();this.trigger("tabClicked",this)}}); var PageTabsView=Backbone.View.extend({tagName:"table",className:"page-tabs-view clr_tabBar_bg clr_tabBar_brdr",_pageTabViews:[],render:function(){var h=$("<tr></tr>");this.$el.append(h);var a=this.model.get("items");var b=a.length;var f=Math.floor(100/b);for(var d=0;d<b;++d){var g=a[d];var e=new PageTabModel(g);var c=new PageTabView({model:e,index:d,width:f,selected:d==this.options.selectedIndex});c.bind("tabClicked",this._onTabClicked,this);h.append(c.render().el)}return this},_onTabClicked:function(a){if(a.options.index!=this.options.selectedIndex){conduitApi.analytics.addEvent(null,null,conduitApi.analytics.usageEventTypeEnum.ViewChanged,{viewId:a.model.get("id")});this.trigger("tabClicked",a.options.index)}}}); HtmlContainerControl=function(){};HtmlContainerControl.constructor=HtmlContainerControl;HtmlContainerControl.prototype={renderHtml:function(d,e,c){if(!e){return}var a={changeColors:false,purchaseItemModel:null};c=_.extend({},a,c);this.$myScrollWrapper=this.$myScrollWrapper||Scrolling.getMyScrollerWrapper(d);var b=$('<div class="html_container_control">'+e+"</div>");this._stylizeHtml(b,c);d.html(b);this._bindEvents(d)},_stylizeHtml:function(f,c){f.find("iframe").each(function(){$(this).replaceWith($(this).text())});f.find("object,style,link,script").remove();if(c.changeColors){f.find("a").addClass("clr_contTypeA_lnkTxt");f.find(":header").addClass("clr_contTypeA_hdlTxt");f.addClass("clr_contTypeA_txt");f.find("*").css({color:"","background-color":""})}f.find("IMG").css({"max-width":"100%",width:"auto",height:"auto"});f.find("P").css({margin:"0px 0px 7px 0px"});var b=[];if(c.purchaseItemModel){var a=c.purchaseItemModel.get("purchase");if(a){b=a.methods}}if(b&&b.length>0){var e=new PurchaseItemModel({itemModel:c.purchaseItemModel,methods:b});$button=f.find(".buy_button_element");if($button.length>0){var d=new PurchaseItemView({model:e,el:$button[0]});if($button.hasClass("default_buy_button")){d.render()}}else{var d=new PurchaseItemView({model:e});f.append(d.render().el)}}Scrolling.onContentChanged(this.$myScrollWrapper)},_bindEvents:function(a){if(PLATFORM==platformEnum.simulator){var c=a.find('a[href^="tel"],a[href^="mailto"]');c.each(function(d){$(this).attr({href:"javascript:void(0)",rel:"avoid-link"}).tap(function(f){f.preventDefault();cqm.showToastMessage("This link is not supported in simulator mode.")})})}else{a.find('a[href^="tel"]').attr("rel","avoid-link");a.find('a[href^="mailto"]').attr("rel","avoid-link")}var b=a.find("a").not('[rel="avoid-link"]');a.find("a").not('[rel="avoid-link"]').tap(function(g){var f=$(this);var d=f.attr("href");if(conduitApi.app.isSupported()){conduitApi.app.openLink(null,null,{url:d,title:f.text()})}return false});a.find("IMG").load(function(){Scrolling.onContentChanged(this.$myScrollWrapper)}.hitch(this)).error(function(){$(this).remove()})}}; LinksTextControl=function(){};LinksTextControl.constructor=LinksTextControl;LinksTextControl.prototype={_rgxLink:/((([A-Za-z]{3,9}:(?:\/\/)?)(?:[-;:&=\+\$,\w]+@)?[A-Za-z0-9.-]+|(?:www.|[-;:&=\+\$,\w]+@)[A-Za-z0-9.-]+)((?:\/[\+~%\/.\w-_]*)?\??(?:[-\+=&;%@.\w_]*)#?(?:[.\!\/\\w]*))?)/g,renderText:function(d,c,b){if(!c){return}var a={changeColors:true,sanitize:true};b=_.extend({},a,b);if(b.sanitize){c=Utils.String.sanitizeText(c,true)}replacment='<span class="link" data-link="$1">$1</span>';c=c.replace(this._rgxLink,replacment);d.html(c);this._stylizeHtml(d,b);this._bindEvents(d)},_stylizeHtml:function(b,a){if(a.changeColors){b.find(".link").addClass("clr_contTypeA_lnkTxt")}},_bindEvents:function(a){a.find(".link").tap(function(d){var c=$(this);var b=c.attr("data-link");if(b.substr(0,3)==="www"){b="http://"+b}if(conduitApi.app.isSupported()){conduitApi.app.openLink(null,null,{url:b,title:c.text()})}})}}; var AudioPlayer=function(){var y={};y.modeEnum={stop:0,play:1,loading:2};y.errorEnum={ok:0,noPlayer:-1,errorOccured:-2};var o=null;var e=y.modeEnum.stop;var q=false;var d=1;var i=0;var h=0;var k=false;var t=false;var f=false;var s=false;var l=-1;var p=null;var m=null;var b=null;var n=null;var u=null;var g=null;var c=conduitApi.getContext();function x(z){if(typeof(p)==="function"){p(z)}}function j(z){if(d===z){return}d=z;if(typeof(b)==="function"){b(z)}}function a(A,z){if((e===A)&&(q===z)){return}if(o!==null){clearTimeout(o);o=null}e=A;q=z;if(typeof(n)==="function"){n(A,z)}}function v(z){if(i===z){return}i=z;if(typeof(u)==="function"){u(z)}}var w=function(D){l=D;var H=function(){a(y.modeEnum.stop,false)};audioDriver.registerMediaPause(null,null,l,H,c);var B=function(){a(y.modeEnum.play,false)};audioDriver.registerMediaPlaying(null,null,l,B,c);var E=function(){if(typeof(m)==="function"){m()}};audioDriver.registerMediaEnded(null,null,l,E,c);var F=function(K){v(K)};audioDriver.registerMediaTimeUpdate(null,null,l,F,c);var I=function(K){a(e,false)};audioDriver.registerMediaSeeked(null,null,l,I,c);var z=function(K){a(e,true)};audioDriver.registerMediaSeeking(null,null,l,z,c);var J=function(){cbGetDurationSuccess=function(K){h=K;if(typeof(g)==="function"){g()}};audioDriver.getDuration(cbGetDurationSuccess,null,l,c)};audioDriver.registerLoadedMetaData(null,null,l,J,c);var G=function(){k=true;if(f){f=false;audioDriver.play(null,null,l,c)}};audioDriver.registerMediaCanPlay(null,null,l,G,c);var C=function(){if(DEVICE===deviceTypeEnum.iphone){k=true;if(f){f=false;audioDriver.play(null,null,l,c)}}};audioDriver.registerLoadStart(null,null,l,C,c);var A=function(){t=true};audioDriver.registerError(null,null,l,A,c)};audioDriver.createPlayer(w,null,c);var r=function(z){j(z)};audioDriver.registerVolumeChanged(null,null,r,c);y.getVolume=function(){return d};y.getCurrentTime=function(){return i};y.getDuration=function(){return h};y.getIsMute=function(){return s};y.getMode=function(){return e};y.getSeekingMode=function(){return q};y.isLoading=function(){return(q||(e===y.modeEnum.loading))};y.play=function(){if(l<0){x(y.errorEnum.noPlayer);return y.errorEnum.noPlayer}if(t){x(y.errorEnum.errorOccured);return y.errorEnum.errorOccured}a(y.modeEnum.loading,q);if(o!==null){clearTimeout(o);o=null}o=setTimeout(function(){x(y.errorEnum.errorOccured);y.pause()},30000);if(k){audioDriver.play(null,null,l,c)}else{f=true}return y.errorEnum.ok};y.pause=function(){if(l<0){return y.errorEnum.noPlayer}audioDriver.pause(null,null,l,c);a(y.modeEnum.stop,false);return y.errorEnum.ok};y.setUrl=function(A){if(l<0){return y.errorEnum.noPlayer}if(o!==null){clearTimeout(o);o=null}var B=e;k=false;t=false;h=0;a(y.modeEnum.loading,false);audioDriver.pause(null,null,l,c);var z=function(){if(B===y.modeEnum.stop){a(y.modeEnum.stop,q)}else{y.play()}};audioDriver.setUrl(z,null,l,A,c);return y.errorEnum.ok};y.setCurrentTime=function(z){if(l<0){return y.errorEnum.noPlayer}audioDriver.setCurrentTime(null,null,l,z,c);return y.errorEnum.ok};y.setVolume=function(z){s=false;audioDriver.setVolume(null,null,z,c)};y.doMute=function(){s=true;audioDriver.setVolume(null,null,0,c)};y.doUnMute=function(){s=false;audioDriver.setVolume(null,null,d,c)};y.switchMuteMode=function(){if(s){y.doUnMute()}else{y.doMute()}};y.registerErrorPlaying=function(z){p=z};y.registerMediaEnded=function(z){m=z};y.registerVolumeChanged=function(z){b=z};y.registerModeChanged=function(z){n=z};y.registerCurrentTimeChanged=function(z){u=z};y.registerLoadedMetaData=function(z){g=z};return y}; !function(v,u){function m(B,A){function z(){}z[r]=this[r];var y=this,x=new z,w=q(B),i=w?B:this,f=w?{}:B,e=function(){this.initialize?this.initialize.apply(this,arguments):(A||w&&y.apply(this,arguments),i.apply(this,arguments))};e.methods=function(b){n(x,b,y),e[r]=x;return this},e.methods.call(e,f).prototype.constructor=e,e.extend=arguments.callee,e[r].implement=e.statics=function(d,c){d=typeof d=="string"?function(){var a={};a[d]=c;return a}():d,n(this,d,y);return this};return e}function n(e,c,h){for(var f in c){c.hasOwnProperty(f)&&(e[f]=q(c[f])&&q(h[r][f])&&t.test(c[f])?o(f,c[f],h):c[f])}}function o(e,d,f){return function(){var b=this.supr;this.supr=f[r][e];var a=d.apply(this,arguments);this.supr=b;return a}}function p(b){return m.call(q(b)?b:s,b,1)}var t=/xyz/.test(function(){xyz})?/\bsupr\b/:/.*/,s=function(){},r="prototype",q=function(b){return typeof b===u};if(typeof module!="undefined"&&module.exports){module.exports=p}else{var l=v.klass;p.noConflict=function(){v.klass=l;return this},v.klass=p}}(this,"function"); (function(a){if(!Function.prototype.bind){Function.prototype.bind=function(e){var f=[].slice,c=f.call(arguments,1),b=this,g=function(){},d=function(){return b.apply(this instanceof g?this:(e||{}),c.concat(f.call(arguments)))};g.prototype=b.prototype;d.prototype=new g();return d}}if(typeof a.Code==="undefined"){a.Code={}}a.Code.Util={registerNamespace:function(){var g=arguments,e=null,f,d,h,c,k,b,l;for(f=0,b=g.length;f<b;f++){h=g[f];c=h.split(".");k=c[0];if(typeof a[k]==="undefined"){a[k]={}}e=a[k];for(d=1,l=c.length;d<l;++d){e[c[d]]=e[c[d]]||{};e=e[c[d]]}}},coalesce:function(){var c,b;for(c=0,b=arguments.length;c<b;c++){if(!this.isNothing(arguments[c])){return arguments[c]}}return null},extend:function(b,c,d){var e;if(this.isNothing(d)){d=true}if(b&&c&&this.isObject(c)){for(e in c){if(this.objectHasProperty(c,e)){if(d){b[e]=c[e]}else{if(typeof b[e]==="undefined"){b[e]=c[e]}}}}}},clone:function(c){var b={};this.extend(b,c);return b},isObject:function(b){return b instanceof Object},isFunction:function(b){return({}).toString.call(b)==="[object Function]"},isArray:function(b){return b instanceof Array},isLikeArray:function(b){return typeof b.length==="number"},isNumber:function(b){return typeof b==="number"},isString:function(b){return typeof b==="string"},isNothing:function(b){if(typeof b==="undefined"||b===null){return true}return false},swapArrayElements:function(b,e,d){var c=b[e];b[e]=b[d];b[d]=c},trim:function(b){return b.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},toCamelCase:function(b){return b.replace(/(\-[a-z])/g,function(c){return c.toUpperCase().replace("-","")})},toDashedCase:function(b){return b.replace(/([A-Z])/g,function(c){return"-"+c.toLowerCase()})},arrayIndexOf:function(f,h,g){var e,d,c,b;c=-1;for(e=0,d=h.length;e<d;e++){b=h[e];if(!this.isNothing(g)){if(this.objectHasProperty(b,g)){if(b[g]===f){c=e;break}}}else{if(b===f){c=e;break}}}return c},objectHasProperty:function(c,b){if(c.hasOwnProperty){return c.hasOwnProperty(b)}else{return("undefined"!==typeof c[b])}}}}(window));(function(a,b){b.Browser={ua:null,version:null,safari:null,webkit:null,opera:null,msie:null,chrome:null,mozilla:null,android:null,blackberry:null,iPad:null,iPhone:null,iPod:null,iOS:null,is3dSupported:null,isCSSTransformSupported:null,isTouchSupported:null,isGestureSupported:null,_detect:function(){this.ua=a.navigator.userAgent;this.version=(this.ua.match(/.+(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[]);this.safari=(/Safari/gi).test(a.navigator.appVersion);this.webkit=/webkit/i.test(this.ua);this.opera=/opera/i.test(this.ua);this.msie=/msie/i.test(this.ua)&&!this.opera;this.chrome=/Chrome/i.test(this.ua);this.firefox=/Firefox/i.test(this.ua);this.fennec=/Fennec/i.test(this.ua);this.mozilla=/mozilla/i.test(this.ua)&&!/(compatible|webkit)/.test(this.ua);this.android=/android/i.test(this.ua);this.blackberry=/blackberry/i.test(this.ua);this.iOS=(/iphone|ipod|ipad/gi).test(a.navigator.platform);this.iPad=(/ipad/gi).test(a.navigator.platform);this.iPhone=(/iphone/gi).test(a.navigator.platform);this.iPod=(/ipod/gi).test(a.navigator.platform);var c=document.createElement("div");this.is3dSupported=!b.isNothing(c.style.WebkitPerspective);this.isCSSTransformSupported=(!b.isNothing(c.style.WebkitTransform)||!b.isNothing(c.style.MozTransform)||!b.isNothing(c.style.transformProperty));this.isTouchSupported=this.isEventSupported("touchstart");this.isGestureSupported=this.isEventSupported("gesturestart")},_eventTagNames:{select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"},isEventSupported:function(c){var e=document.createElement(this._eventTagNames[c]||"div"),d;c="on"+c;d=b.objectHasProperty(e,c);if(!d){e.setAttribute(c,"return;");d=typeof e[c]==="function"}e=null;return d},isLandscape:function(){return(b.DOM.windowWidth()>b.DOM.windowHeight())}};b.Browser._detect()}(window,window.Code.Util));(function(a,b){b.extend(b,{Events:{add:function(e,d,c){this._checkHandlersProperty(e);if(d==="mousewheel"){d=this._normaliseMouseWheelType()}if(typeof e.__eventHandlers[d]==="undefined"){e.__eventHandlers[d]=[]}e.__eventHandlers[d].push(c);if(this._isBrowserObject(e)){e.addEventListener(d,c,false)}},remove:function(h,g,f){this._checkHandlersProperty(h);if(g==="mousewheel"){g=this._normaliseMouseWheelType()}if(h.__eventHandlers[g] instanceof Array){var e,d,c=h.__eventHandlers[g];if(b.isNothing(f)){if(this._isBrowserObject(h)){for(e=0,d=c.length;e<d;e++){h.removeEventListener(g,c[e],false)}}h.__eventHandlers[g]=[];return}for(e=0,d=c.length;e<d;e++){if(c[e]===f){c.splice(e,1);break}}if(this._isBrowserObject(h)){h.removeEventListener(g,f,false);return}}},fire:function(g,l){var h,f,d,m,e,k=Array.prototype.slice.call(arguments).splice(2),c;if(l==="mousewheel"){l=this._normaliseMouseWheelType()}if(this._isBrowserObject(g)){if(typeof l!=="string"){throw"type must be a string for DOM elements"}c=this._NATIVE_EVENTS[l];d=document.createEvent(c?"HTMLEvents":"UIEvents");d[c?"initEvent":"initUIEvent"](l,true,true,a,1);if(k.length<1){g.dispatchEvent(d);return}}this._checkHandlersProperty(g);if(typeof l==="string"){d={type:l}}else{d=l}if(!d.target){d.target=g}if(!d.type){throw new Error("Event object missing 'type' property.")}if(g.__eventHandlers[d.type] instanceof Array){m=g.__eventHandlers[d.type];k.unshift(d);for(h=0,f=m.length;h<f;h++){e=m[h];if(!b.isNothing(e)){e.apply(g,k)}}}},getMousePosition:function(d){var c={x:0,y:0};if(d.pageX){c.x=d.pageX}else{if(d.clientX){c.x=d.clientX+(document.documentElement.scrollLeft||document.body.scrollLeft)}}if(d.pageY){c.y=d.pageY}else{if(d.clientY){c.y=d.clientY+(document.documentElement.scrollTop||document.body.scrollTop)}}return c},getTouchEvent:function(c){return c},getWheelDelta:function(c){var d=0;if(!b.isNothing(c.wheelDelta)){d=c.wheelDelta/120}else{if(!b.isNothing(c.detail)){d=-c.detail/3}}return d},domReady:function(c){document.addEventListener("DOMContentLoaded",c,false)},_checkHandlersProperty:function(c){if(b.isNothing(c.__eventHandlers)){b.extend(c,{__eventHandlers:{}})}},_isBrowserObject:function(c){if(c===a||c===a.document){return true}return this._isElement(c)||this._isNode(c)},_isElement:function(c){return(typeof a.HTMLElement==="object"?c instanceof a.HTMLElement:typeof c==="object"&&c.nodeType===1&&typeof c.nodeName==="string")},_isNode:function(c){return(typeof a.Node==="object"?c instanceof a.Node:typeof c==="object"&&typeof c.nodeType==="number"&&typeof c.nodeName==="string")},_normaliseMouseWheelType:function(){if(b.Browser.isEventSupported("mousewheel")){return"mousewheel"}return"DOMMouseScroll"},_NATIVE_EVENTS:{click:1,dblclick:1,mouseup:1,mousedown:1,contextmenu:1,mousewheel:1,DOMMouseScroll:1,mouseover:1,mouseout:1,mousemove:1,selectstart:1,selectend:1,keydown:1,keypress:1,keyup:1,orientationchange:1,touchstart:1,touchmove:1,touchend:1,touchcancel:1,gesturestart:1,gesturechange:1,gestureend:1,focus:1,blur:1,change:1,reset:1,select:1,submit:1,load:1,unload:1,beforeunload:1,resize:1,move:1,DOMContentLoaded:1,readystatechange:1,error:1,abort:1,scroll:1}}})}(window,window.Code.Util));(function(a,b){b.extend(b,{DOM:{setData:function(f,e,g){if(b.isLikeArray(f)){var d,c;for(d=0,c=f.length;d<c;d++){b.DOM._setData(f[d],e,g)}}else{b.DOM._setData(f,e,g)}},_setData:function(d,c,e){b.DOM.setAttribute(d,"data-"+c,e)},getData:function(e,d,c){return b.DOM.getAttribute(e,"data-"+d,c)},removeData:function(f,e){if(b.isLikeArray(f)){var d,c;for(d=0,c=f.length;d<c;d++){b.DOM._removeData(f[d],e)}}else{b.DOM._removeData(f,e)}},_removeData:function(d,c){b.DOM.removeAttribute(d,"data-"+c)},isChildOf:function(c,d){if(d===c){return false}while(c&&c!==d){c=c.parentNode}return c===d},find:function(g,h){if(b.isNothing(h)){h=a.document}var f=h.querySelectorAll(g),c=[],e,d;for(e=0,d=f.length;e<d;e++){c.push(f[e])}return c},createElement:function(e,d,g){var f,c=document.createElement(e);for(f in d){if(b.objectHasProperty(d,f)){c.setAttribute(f,d[f])}}c.innerHTML=g||"";return c},appendChild:function(c,d){d.appendChild(c)},insertBefore:function(e,c,d){d.insertBefore(e,c)},appendText:function(d,c){b.DOM.appendChild(document.createTextNode(d),c)},appendToBody:function(c){this.appendChild(c,document.body)},removeChild:function(c,d){d.removeChild(c)},removeChildren:function(c){if(c.hasChildNodes()){while(c.childNodes.length>=1){c.removeChild(c.childNodes[c.childNodes.length-1])}}},hasAttribute:function(d,c){return !b.isNothing(d.getAttribute(c))},getAttribute:function(f,e,d){var c=f.getAttribute(e);if(b.isNothing(c)&&!b.isNothing(d)){c=d}return c},setAttribute:function(f,d,g){if(b.isLikeArray(f)){var e,c;for(e=0,c=f.length;e<c;e++){b.DOM._setAttribute(f[e],d,g)}}else{b.DOM._setAttribute(f,d,g)}},_setAttribute:function(d,c,e){d.setAttribute(c,e)},removeAttribute:function(f,d){if(b.isLikeArray(f)){var e,c;for(e=0,c=f.length;e<c;e++){b.DOM._removeAttribute(f[e],d)}}else{b.DOM._removeAttribute(f,d)}},_removeAttribute:function(d,c){if(this.hasAttribute(d,c)){d.removeAttribute(c)}},addClass:function(f,e){if(b.isLikeArray(f)){var d,c;for(d=0,c=f.length;d<c;d++){b.DOM._addClass(f[d],e)}}else{b.DOM._addClass(f,e)}},_addClass:function(f,e){var c=b.DOM.getAttribute(f,"class",""),d=new RegExp("(?:^|\\s+)"+e+"(?:\\s+|$)");if(!d.test(c)){if(c!==""){c=c+" "}c=c+e;b.DOM.setAttribute(f,"class",c)}},removeClass:function(f,e){if(b.isLikeArray(f)){var d,c;for(d=0,c=f.length;d<c;d++){b.DOM._removeClass(f[d],e)}}else{b.DOM._removeClass(f,e)}},_removeClass:function(h,g){var c=b.DOM.getAttribute(h,"class",""),f=b.trim(c).split(" "),k="",e,d;for(e=0,d=f.length;e<d;e++){if(f[e]!==g){if(k!==""){k+=" "}k+=f[e]}}if(k===""){b.DOM.removeAttribute(h,"class")}else{b.DOM.setAttribute(h,"class",k)}},hasClass:function(e,d){var c=new RegExp("(?:^|\\s+)"+d+"(?:\\s+|$)");return c.test(b.DOM.getAttribute(e,"class",""))},setStyle:function(f,e,g){if(b.isLikeArray(f)){var d,c;for(d=0,c=f.length;d<c;d++){b.DOM._setStyle(f[d],e,g)}}else{b.DOM._setStyle(f,e,g)}},_setStyle:function(d,c,e){var g,f;if(b.isObject(c)){for(g in c){if(b.objectHasProperty(c,g)){if(g==="width"){b.DOM.width(d,c[g])}else{if(g==="height"){b.DOM.height(d,c[g])}else{d.style[g]=c[g]}}}}}else{d.style[c]=e}},getStyle:function(e,d){var c=a.getComputedStyle(e,"").getPropertyValue(d);if(c===""){c=e.style[d]}return c},hide:function(e){if(b.isLikeArray(e)){var d,c;for(d=0,c=e.length;d<c;d++){b.DOM._hide(e[d])}}else{b.DOM._hide(e)}},_hide:function(c){b.DOM.setData(c,"ccl-disp",b.DOM.getStyle(c,"display"));b.DOM.setStyle(c,"display","none")},show:function(e){if(b.isLikeArray(e)){var d,c;for(d=0,c=e.length;d<c;d++){b.DOM._show(e[d])}}else{b.DOM._show(e)}},_show:function(c){if(b.DOM.getStyle(c,"display")==="none"){var d=b.DOM.getData(c,"ccl-disp","block");if(d==="none"||d===""){d="block"}b.DOM.setStyle(c,"display",d)}},width:function(c,d){if(!b.isNothing(d)){if(b.isNumber(d)){d=d+"px"}c.style.width=d}return this._getDimension(c,"width")},outerWidth:function(d){var c=b.DOM.width(d);c+=parseInt(b.DOM.getStyle(d,"padding-left"),10)+parseInt(b.DOM.getStyle(d,"padding-right"),10);c+=parseInt(b.DOM.getStyle(d,"margin-left"),10)+parseInt(b.DOM.getStyle(d,"margin-right"),10);c+=parseInt(b.DOM.getStyle(d,"border-left-width"),10)+parseInt(b.DOM.getStyle(d,"border-right-width"),10);return c},height:function(c,d){if(!b.isNothing(d)){if(b.isNumber(d)){d=d+"px"}c.style.height=d}return this._getDimension(c,"height")},_getDimension:function(e,f){var c=a.parseInt(a.getComputedStyle(e,"").getPropertyValue(f)),d;if(isNaN(c)){d={display:e.style.display,left:e.style.left};e.style.display="block";e.style.left="-1000000px";c=a.parseInt(a.getComputedStyle(e,"").getPropertyValue(f));e.style.display=d.display;e.style.left=d.left}return c},outerHeight:function(d){var c=b.DOM.height(d);c+=parseInt(b.DOM.getStyle(d,"padding-top"),10)+parseInt(b.DOM.getStyle(d,"padding-bottom"),10);c+=parseInt(b.DOM.getStyle(d,"margin-top"),10)+parseInt(b.DOM.getStyle(d,"margin-bottom"),10);c+=parseInt(b.DOM.getStyle(d,"border-top-width"),10)+parseInt(b.DOM.getStyle(d,"border-bottom-width"),10);return c},documentWidth:function(){return b.DOM.width(document.documentElement)},documentHeight:function(){return b.DOM.height(document.documentElement)},documentOuterWidth:function(){return b.DOM.width(document.documentElement)},documentOuterHeight:function(){return b.DOM.outerHeight(document.documentElement)},bodyWidth:function(){return b.DOM.width(document.body)},bodyHeight:function(){return b.DOM.height(document.body)},bodyOuterWidth:function(){return b.DOM.outerWidth(document.body)},bodyOuterHeight:function(){return b.DOM.outerHeight(document.body)},windowWidth:function(){return a.innerWidth},windowHeight:function(){return a.innerHeight},windowScrollLeft:function(){return a.pageXOffset},windowScrollTop:function(){return a.pageYOffset}}})}(window,window.Code.Util));(function(a,b){b.extend(b,{Animation:{_applyTransitionDelay:50,_transitionEndLabel:(a.document.documentElement.style.webkitTransition!==undefined)?"webkitTransitionEnd":"transitionend",_transitionEndHandler:null,_transitionPrefix:(a.document.documentElement.style.webkitTransition!==undefined)?"webkitTransition":(a.document.documentElement.style.MozTransition!==undefined)?"MozTransition":"transition",_transformLabel:(a.document.documentElement.style.webkitTransform!==undefined)?"webkitTransform":(a.document.documentElement.style.MozTransition!==undefined)?"MozTransform":"transform",_getTransitionEndHandler:function(){if(b.isNothing(this._transitionEndHandler)){this._transitionEndHandler=this._onTransitionEnd.bind(this)}return this._transitionEndHandler},stop:function(d){if(b.Browser.isCSSTransformSupported){var e=d.style[this._transitionPrefix+"Property"],f=(e!=="")?"ccl"+e+"callback":"cclallcallback",c={};b.Events.remove(d,this._transitionEndLabel,this._getTransitionEndHandler());if(b.isNothing(d.callbackLabel)){delete d.callbackLabel}c[this._transitionPrefix+"Property"]="";c[this._transitionPrefix+"Duration"]="";c[this._transitionPrefix+"TimingFunction"]="";c[this._transitionPrefix+"Delay"]="";c[this._transformLabel]="";b.DOM.setStyle(d,c)}else{if(!b.isNothing(a.jQuery)){a.jQuery(d).stop(true,true)}}},fadeIn:function(e,g,h,f,d){d=b.coalesce(d,1);if(d<=0){d=1}if(g<=0){b.DOM.setStyle(e,"opacity",d);if(!b.isNothing(h)){h(e);return}}var c=b.DOM.getStyle(e,"opacity");if(c>=1){b.DOM.setStyle(e,"opacity",0)}if(b.Browser.isCSSTransformSupported){this._applyTransition(e,"opacity",d,g,h,f)}else{if(!b.isNothing(a.jQuery)){a.jQuery(e).fadeTo(g,d,h)}}},fadeTo:function(d,c,f,g,e){this.fadeIn(d,f,g,e,c)},fadeOut:function(c,e,f,d){if(e<=0){b.DOM.setStyle(c,"opacity",0);if(!b.isNothing(f)){f(c);return}}if(b.Browser.isCSSTransformSupported){this._applyTransition(c,"opacity",0,e,f,d)}else{a.jQuery(c).fadeTo(e,0,f)}},slideBy:function(e,c,i,g,h,f){var d={};c=b.coalesce(c,0);i=b.coalesce(i,0);f=b.coalesce(f,"ease-out");d[this._transitionPrefix+"Property"]="all";d[this._transitionPrefix+"Delay"]="0";if(g===0){d[this._transitionPrefix+"Duration"]="";d[this._transitionPrefix+"TimingFunction"]=""}else{d[this._transitionPrefix+"Duration"]=g+"ms";d[this._transitionPrefix+"TimingFunction"]=b.coalesce(f,"ease-out");b.Events.add(e,this._transitionEndLabel,this._getTransitionEndHandler())}d[this._transformLabel]=(b.Browser.is3dSupported)?"translate3d("+c+"px, "+i+"px, 0px)":"translate("+c+"px, "+i+"px)";if(!b.isNothing(h)){e.cclallcallback=h}b.DOM.setStyle(e,d);if(g===0){a.setTimeout(function(){this._leaveTransforms(e)}.bind(this),this._applyTransitionDelay)}},resetTranslate:function(d){var c={};c[this._transformLabel]=c[this._transformLabel]=(b.Browser.is3dSupported)?"translate3d(0px, 0px, 0px)":"translate(0px, 0px)";b.DOM.setStyle(d,c)},_applyTransition:function(d,g,h,f,i,e){var c={};e=b.coalesce(e,"ease-in");c[this._transitionPrefix+"Property"]=g;c[this._transitionPrefix+"Duration"]=f+"ms";c[this._transitionPrefix+"TimingFunction"]=e;c[this._transitionPrefix+"Delay"]="0";b.Events.add(d,this._transitionEndLabel,this._getTransitionEndHandler());b.DOM.setStyle(d,c);if(!b.isNothing(i)){d["ccl"+g+"callback"]=i}a.setTimeout(function(){b.DOM.setStyle(d,g,h)},this._applyTransitionDelay)},_onTransitionEnd:function(c){b.Events.remove(c.currentTarget,this._transitionEndLabel,this._getTransitionEndHandler());this._leaveTransforms(c.currentTarget)},_leaveTransforms:function(f){var l=f.style[this._transitionPrefix+"Property"],k=(l!=="")?"ccl"+l+"callback":"cclallcallback",n,g=b.coalesce(f.style.webkitTransform,f.style.MozTransform,f.style.transform),i,m,j=a.parseInt(b.DOM.getStyle(f,"left"),0),h=a.parseInt(b.DOM.getStyle(f,"top"),0),e,d,c={};if(g!==""){if(b.Browser.is3dSupported){i=g.match(/translate3d\((.*?)\)/)}else{i=g.match(/translate\((.*?)\)/)}if(!b.isNothing(i)){m=i[1].split(", ");e=a.parseInt(m[0],0);d=a.parseInt(m[1],0)}}c[this._transitionPrefix+"Property"]="";c[this._transitionPrefix+"Duration"]="";c[this._transitionPrefix+"TimingFunction"]="";c[this._transitionPrefix+"Delay"]="";b.DOM.setStyle(f,c);a.setTimeout(function(){if(!b.isNothing(m)){c={};c[this._transformLabel]="";c.left=(j+e)+"px";c.top=(h+d)+"px";b.DOM.setStyle(f,c)}if(!b.isNothing(f[k])){n=f[k];delete f[k];n(f)}}.bind(this),this._applyTransitionDelay)}}})}(window,window.Code.Util));(function(b,a,c){c.registerNamespace("Code.Util.TouchElement");c.TouchElement.EventTypes={onTouch:"CodeUtilTouchElementOnTouch"};c.TouchElement.ActionTypes={touchStart:"touchStart",touchMove:"touchMove",touchEnd:"touchEnd",touchMoveEnd:"touchMoveEnd",tap:"tap",doubleTap:"doubleTap",swipeLeft:"swipeLeft",swipeRight:"swipeRight",swipeUp:"swipeUp",swipeDown:"swipeDown",gestureStart:"gestureStart",gestureChange:"gestureChange",gestureEnd:"gestureEnd"}}(window,window.klass,window.Code.Util));(function(b,a,c){c.registerNamespace("Code.Util.TouchElement");c.TouchElement.TouchElementClass=a({el:null,captureSettings:null,touchStartPoint:null,touchEndPoint:null,touchStartTime:null,doubleTapTimeout:null,touchStartHandler:null,touchMoveHandler:null,touchEndHandler:null,mouseDownHandler:null,mouseMoveHandler:null,mouseUpHandler:null,mouseOutHandler:null,gestureStartHandler:null,gestureChangeHandler:null,gestureEndHandler:null,swipeThreshold:null,swipeTimeThreshold:null,doubleTapSpeed:null,dispose:function(){var d;this.removeEventHandlers();for(d in this){if(c.objectHasProperty(this,d)){this[d]=null}}},initialize:function(d,e){this.el=d;this.captureSettings={swipe:false,move:false,gesture:false,doubleTap:false,preventDefaultTouchEvents:true};c.extend(this.captureSettings,e);this.swipeThreshold=50;this.swipeTimeThreshold=250;this.doubleTapSpeed=250;this.touchStartPoint={x:0,y:0};this.touchEndPoint={x:0,y:0}},addEventHandlers:function(){if(c.isNothing(this.touchStartHandler)){this.touchStartHandler=this.onTouchStart.bind(this);this.touchMoveHandler=this.onTouchMove.bind(this);this.touchEndHandler=this.onTouchEnd.bind(this);this.mouseDownHandler=this.onMouseDown.bind(this);this.mouseMoveHandler=this.onMouseMove.bind(this);this.mouseUpHandler=this.onMouseUp.bind(this);this.mouseOutHandler=this.onMouseOut.bind(this);this.gestureStartHandler=this.onGestureStart.bind(this);this.gestureChangeHandler=this.onGestureChange.bind(this);this.gestureEndHandler=this.onGestureEnd.bind(this)}c.Events.add(this.el,"touchstart",this.touchStartHandler);if(this.captureSettings.move){c.Events.add(this.el,"touchmove",this.touchMoveHandler)}c.Events.add(this.el,"touchend",this.touchEndHandler);c.Events.add(this.el,"mousedown",this.mouseDownHandler);if(c.Browser.isGestureSupported&&this.captureSettings.gesture){c.Events.add(this.el,"gesturestart",this.gestureStartHandler);c.Events.add(this.el,"gesturechange",this.gestureChangeHandler);c.Events.add(this.el,"gestureend",this.gestureEndHandler)}},removeEventHandlers:function(){c.Events.remove(this.el,"touchstart",this.touchStartHandler);if(this.captureSettings.move){c.Events.remove(this.el,"touchmove",this.touchMoveHandler)}c.Events.remove(this.el,"touchend",this.touchEndHandler);c.Events.remove(this.el,"mousedown",this.mouseDownHandler);if(c.Browser.isGestureSupported&&this.captureSettings.gesture){c.Events.remove(this.el,"gesturestart",this.gestureStartHandler);c.Events.remove(this.el,"gesturechange",this.gestureChangeHandler);c.Events.remove(this.el,"gestureend",this.gestureEndHandler)}},getTouchPoint:function(d){return{x:d[0].pageX,y:d[0].pageY}},fireTouchEvent:function(k){var j,f=0,d=0,l=0,h,g,i;f=this.touchEndPoint.x-this.touchStartPoint.x;d=this.touchEndPoint.y-this.touchStartPoint.y;l=Math.sqrt((f*f)+(d*d));if(this.captureSettings.swipe){g=new Date();i=g-this.touchStartTime;if(i<=this.swipeTimeThreshold){if(b.Math.abs(f)>=this.swipeThreshold){c.Events.fire(this,{type:c.TouchElement.EventTypes.onTouch,target:this,point:this.touchEndPoint,action:(f<0)?c.TouchElement.ActionTypes.swipeLeft:c.TouchElement.ActionTypes.swipeRight,targetEl:k.target,currentTargetEl:k.currentTarget});return}if(b.Math.abs(d)>=this.swipeThreshold){c.Events.fire(this,{type:c.TouchElement.EventTypes.onTouch,target:this,point:this.touchEndPoint,action:(d<0)?c.TouchElement.ActionTypes.swipeUp:c.TouchElement.ActionTypes.swipeDown,targetEl:k.target,currentTargetEl:k.currentTarget});return}}}if(l>1){c.Events.fire(this,{type:c.TouchElement.EventTypes.onTouch,target:this,action:c.TouchElement.ActionTypes.touchMoveEnd,point:this.touchEndPoint,targetEl:k.target,currentTargetEl:k.currentTarget});return}if(!this.captureSettings.doubleTap){c.Events.fire(this,{type:c.TouchElement.EventTypes.onTouch,target:this,point:this.touchEndPoint,action:c.TouchElement.ActionTypes.tap,targetEl:k.target,currentTargetEl:k.currentTarget});return}if(c.isNothing(this.doubleTapTimeout)){this.doubleTapTimeout=b.setTimeout(function(){this.doubleTapTimeout=null;c.Events.fire(this,{type:c.TouchElement.EventTypes.onTouch,target:this,point:this.touchEndPoint,action:c.TouchElement.ActionTypes.tap,targetEl:k.target,currentTargetEl:k.currentTarget})}.bind(this),this.doubleTapSpeed);return}else{b.clearTimeout(this.doubleTapTimeout);this.doubleTapTimeout=null;c.Events.fire(this,{type:c.TouchElement.EventTypes.onTouch,target:this,point:this.touchEndPoint,action:c.TouchElement.ActionTypes.doubleTap,targetEl:k.target,currentTargetEl:k.currentTarget})}},onTouchStart:function(g){if(this.captureSettings.preventDefaultTouchEvents){g.preventDefault()}c.Events.remove(this.el,"mousedown",this.mouseDownHandler);var d=c.Events.getTouchEvent(g),f=d.touches;if(f.length>1&&this.captureSettings.gesture){this.isGesture=true;return}this.touchStartTime=new Date();this.isGesture=false;this.touchStartPoint=this.getTouchPoint(f);c.Events.fire(this,{type:c.TouchElement.EventTypes.onTouch,target:this,action:c.TouchElement.ActionTypes.touchStart,point:this.touchStartPoint,targetEl:g.target,currentTargetEl:g.currentTarget})},onTouchMove:function(g){if(this.captureSettings.preventDefaultTouchEvents){g.preventDefault()}if(this.isGesture&&this.captureSettings.gesture){return}var d=c.Events.getTouchEvent(g),f=d.touches;c.Events.fire(this,{type:c.TouchElement.EventTypes.onTouch,target:this,action:c.TouchElement.ActionTypes.touchMove,point:this.getTouchPoint(f),targetEl:g.target,currentTargetEl:g.currentTarget})},onTouchEnd:function(g){if(this.isGesture&&this.captureSettings.gesture){return}if(this.captureSettings.preventDefaultTouchEvents){g.preventDefault()}var d=c.Events.getTouchEvent(g),f=(!c.isNothing(d.changedTouches))?d.changedTouches:d.touches;this.touchEndPoint=this.getTouchPoint(f);c.Events.fire(this,{type:c.TouchElement.EventTypes.onTouch,target:this,action:c.TouchElement.ActionTypes.touchEnd,point:this.touchEndPoint,targetEl:g.target,currentTargetEl:g.currentTarget});this.fireTouchEvent(g)},onMouseDown:function(d){d.preventDefault();c.Events.remove(this.el,"touchstart",this.mouseDownHandler);c.Events.remove(this.el,"touchmove",this.touchMoveHandler);c.Events.remove(this.el,"touchend",this.touchEndHandler);if(this.captureSettings.move){c.Events.add(this.el,"mousemove",this.mouseMoveHandler)}c.Events.add(this.el,"mouseup",this.mouseUpHandler);c.Events.add(this.el,"mouseout",this.mouseOutHandler);this.touchStartTime=new Date();this.isGesture=false;this.touchStartPoint=c.Events.getMousePosition(d);c.Events.fire(this,{type:c.TouchElement.EventTypes.onTouch,target:this,action:c.TouchElement.ActionTypes.touchStart,point:this.touchStartPoint,targetEl:d.target,currentTargetEl:d.currentTarget})},onMouseMove:function(d){d.preventDefault();c.Events.fire(this,{type:c.TouchElement.EventTypes.onTouch,target:this,action:c.TouchElement.ActionTypes.touchMove,point:c.Events.getMousePosition(d),targetEl:d.target,currentTargetEl:d.currentTarget})},onMouseUp:function(d){d.preventDefault();if(this.captureSettings.move){c.Events.remove(this.el,"mousemove",this.mouseMoveHandler)}c.Events.remove(this.el,"mouseup",this.mouseUpHandler);c.Events.remove(this.el,"mouseout",this.mouseOutHandler);this.touchEndPoint=c.Events.getMousePosition(d);c.Events.fire(this,{type:c.TouchElement.EventTypes.onTouch,target:this,action:c.TouchElement.ActionTypes.touchEnd,point:this.touchEndPoint,targetEl:d.target,currentTargetEl:d.currentTarget});this.fireTouchEvent(d)},onMouseOut:function(f){var d=f.relatedTarget;if(this.el===d||c.DOM.isChildOf(d,this.el)){return}f.preventDefault();if(this.captureSettings.move){c.Events.remove(this.el,"mousemove",this.mouseMoveHandler)}c.Events.remove(this.el,"mouseup",this.mouseUpHandler);c.Events.remove(this.el,"mouseout",this.mouseOutHandler);this.touchEndPoint=c.Events.getMousePosition(f);c.Events.fire(this,{type:c.TouchElement.EventTypes.onTouch,target:this,action:c.TouchElement.ActionTypes.touchEnd,point:this.touchEndPoint,targetEl:f.target,currentTargetEl:f.currentTarget});this.fireTouchEvent(f)},onGestureStart:function(f){f.preventDefault();var d=c.Events.getTouchEvent(f);c.Events.fire(this,{type:c.TouchElement.EventTypes.onTouch,target:this,action:c.TouchElement.ActionTypes.gestureStart,scale:d.scale,rotation:d.rotation,targetEl:f.target,currentTargetEl:f.currentTarget})},onGestureChange:function(f){f.preventDefault();var d=c.Events.getTouchEvent(f);c.Events.fire(this,{type:c.TouchElement.EventTypes.onTouch,target:this,action:c.TouchElement.ActionTypes.gestureChange,scale:d.scale,rotation:d.rotation,targetEl:f.target,currentTargetEl:f.currentTarget})},onGestureEnd:function(f){f.preventDefault();var d=c.Events.getTouchEvent(f);c.Events.fire(this,{type:c.TouchElement.EventTypes.onTouch,target:this,action:c.TouchElement.ActionTypes.gestureEnd,scale:d.scale,rotation:d.rotation,targetEl:f.target,currentTargetEl:f.currentTarget})}})}(window,window.klass,window.Code.Util));(function(c,a,d){d.registerNamespace("Code.PhotoSwipe.Image");var b=c.Code.PhotoSwipe;b.Image.EventTypes={onLoad:"onLoad",onError:"onError"}}(window,window.klass,window.Code.Util));(function(c,a,d){d.registerNamespace("Code.PhotoSwipe.Image");var b=c.Code.PhotoSwipe;b.Image.ImageClass=a({refObj:null,imageEl:null,src:null,caption:null,metaData:null,imageLoadHandler:null,imageErrorHandler:null,dispose:function(){var f,e;this.shrinkImage();for(f in this){if(d.objectHasProperty(this,f)){this[f]=null}}},initialize:function(g,h,f,e){this.refObj=g;this.originalSrc=h;this.src=h;this.caption=f;this.metaData=e;this.imageEl=new c.Image();this.imageLoadHandler=this.onImageLoad.bind(this);this.imageErrorHandler=this.onImageError.bind(this)},load:function(){this.imageEl.originalSrc=d.coalesce(this.imageEl.originalSrc,"");if(this.imageEl.originalSrc===this.src){if(this.imageEl.isError){d.Events.fire(this,{type:b.Image.EventTypes.onError,target:this})}else{d.Events.fire(this,{type:b.Image.EventTypes.onLoad,target:this})}return}this.imageEl.isError=false;this.imageEl.isLoading=true;this.imageEl.naturalWidth=null;this.imageEl.naturalHeight=null;this.imageEl.isLandscape=false;this.imageEl.onload=this.imageLoadHandler;this.imageEl.onerror=this.imageErrorHandler;this.imageEl.onabort=this.imageErrorHandler;this.imageEl.originalSrc=this.src;this.imageEl.src=this.src},shrinkImage:function(){if(d.isNothing(this.imageEl)){return}if(this.imageEl.src.indexOf(this.src)>-1){this.imageEl.src="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";if(!d.isNothing(this.imageEl.parentNode)){d.DOM.removeChild(this.imageEl,this.imageEl.parentNode)}}},onImageLoad:function(f){this.imageEl.onload=null;this.imageEl.naturalWidth=d.coalesce(this.imageEl.naturalWidth,this.imageEl.width);this.imageEl.naturalHeight=d.coalesce(this.imageEl.naturalHeight,this.imageEl.height);this.imageEl.isLandscape=(this.imageEl.naturalWidth>this.imageEl.naturalHeight);this.imageEl.isLoading=false;d.Events.fire(this,{type:b.Image.EventTypes.onLoad,target:this})},onImageError:function(f){this.imageEl.onload=null;this.imageEl.onerror=null;this.imageEl.onabort=null;this.imageEl.isLoading=false;this.imageEl.isError=true;d.Events.fire(this,{type:b.Image.EventTypes.onError,target:this})}})}(window,window.klass,window.Code.Util));(function(c,a,d){d.registerNamespace("Code.PhotoSwipe.Cache");var b=c.Code.PhotoSwipe;b.Cache.Mode={normal:"normal",aggressive:"aggressive"};b.Cache.Functions={getImageSource:function(e){return e.href},getImageCaption:function(h){if(h.nodeName==="IMG"){return d.DOM.getAttribute(h,"alt")}var g,f,e;for(g=0,f=h.childNodes.length;g<f;g++){e=h.childNodes[g];if(h.childNodes[g].nodeName==="IMG"){return d.DOM.getAttribute(e,"alt")}}},getImageMetaData:function(e){return{}}}}(window,window.klass,window.Code.Util));(function(c,a,d){d.registerNamespace("Code.PhotoSwipe.Cache");var b=c.Code.PhotoSwipe;b.Cache.CacheClass=a({images:null,settings:null,dispose:function(){var g,f,e;if(!d.isNothing(this.images)){for(f=0,e=this.images.length;f<e;f++){this.images[f].dispose()}this.images.length=0}for(g in this){if(d.objectHasProperty(this,g)){this[g]=null}}},initialize:function(m,o){var k,h,l,g,e,n,f;this.settings=o;this.images=[];for(k=0,h=m.length;k<h;k++){g=m[k];e=this.settings.getImageSource(g);n=this.settings.getImageCaption(g);f=this.settings.getImageMetaData(g);this.images.push(new b.Image.ImageClass(g,e,n,f))}},getImages:function(h){var k,g,f=[],e;for(k=0,g=h.length;k<g;k++){e=this.images[h[k]];if(this.settings.cacheMode===b.Cache.Mode.aggressive){e.cacheDoNotShrink=true}f.push(e)}if(this.settings.cacheMode===b.Cache.Mode.aggressive){for(k=0,g=this.images.length;k<g;k++){e=this.images[k];if(!d.objectHasProperty(e,"cacheDoNotShrink")){e.shrinkImage()}else{delete e.cacheDoNotShrink}}}return f}})}(window,window.klass,window.Code.Util,window.Code.PhotoSwipe.Image));(function(c,a,d){d.registerNamespace("Code.PhotoSwipe.DocumentOverlay");var b=c.Code.PhotoSwipe;b.DocumentOverlay.CssClasses={documentOverlay:"ps-document-overlay"}}(window,window.klass,window.Code.Util));(function(c,a,d){d.registerNamespace("Code.PhotoSwipe.DocumentOverlay");var b=c.Code.PhotoSwipe;b.DocumentOverlay.DocumentOverlayClass=a({el:null,settings:null,initialBodyHeight:null,dispose:function(){var e;d.Animation.stop(this.el);d.DOM.removeChild(this.el,this.el.parentNode);for(e in this){if(d.objectHasProperty(this,e)){this[e]=null}}},initialize:function(e){this.settings=e;this.el=d.DOM.createElement("div",{"class":b.DocumentOverlay.CssClasses.documentOverlay},"");d.DOM.setStyle(this.el,{display:"block",position:"absolute",left:0,top:0,zIndex:this.settings.zIndex});d.DOM.hide(this.el);if(this.settings.target===c){d.DOM.appendToBody(this.el)}else{d.DOM.appendChild(this.el,this.settings.target)}d.Animation.resetTranslate(this.el);this.initialBodyHeight=d.DOM.bodyOuterHeight()},resetPosition:function(){var f,e,g;if(this.settings.target===c){f=d.DOM.windowWidth();e=d.DOM.bodyOuterHeight()*2;g=(this.settings.jQueryMobile)?d.DOM.windowScrollTop()+"px":"0px";if(e<1){e=this.initialBodyHeight}if(d.DOM.windowHeight()>e){e=d.DOM.windowHeight()}}else{f=d.DOM.width(this.settings.target);e=d.DOM.height(this.settings.target);g="0px"}d.DOM.setStyle(this.el,{width:f,height:e,top:g})},fadeIn:function(e,f){this.resetPosition();d.DOM.setStyle(this.el,"opacity",0);d.DOM.show(this.el);d.Animation.fadeIn(this.el,e,f)}})}(window,window.klass,window.Code.Util));(function(c,a,d){d.registerNamespace("Code.PhotoSwipe.Carousel");var b=c.Code.PhotoSwipe;b.Carousel.EventTypes={onSlideByEnd:"PhotoSwipeCarouselOnSlideByEnd",onSlideshowStart:"PhotoSwipeCarouselOnSlideshowStart",onSlideshowStop:"PhotoSwipeCarouselOnSlideshowStop"};b.Carousel.CssClasses={carousel:"ps-carousel",content:"ps-carousel-content",item:"ps-carousel-item",itemLoading:"ps-carousel-item-loading",itemError:"ps-carousel-item-error"};b.Carousel.SlideByAction={previous:"previous",current:"current",next:"next"}}(window,window.klass,window.Code.Util));(function(c,a,d){d.registerNamespace("Code.PhotoSwipe.Carousel");var b=c.Code.PhotoSwipe;b.Carousel.CarouselClass=a({el:null,contentEl:null,settings:null,cache:null,slideByEndHandler:null,currentCacheIndex:null,isSliding:null,isSlideshowActive:null,lastSlideByAction:null,touchStartPoint:null,touchStartPosition:null,imageLoadHandler:null,imageErrorHandler:null,slideshowTimeout:null,dispose:function(){var g,f,e;for(f=0,e=this.cache.images.length;f<e;f++){d.Events.remove(this.cache.images[f],b.Image.EventTypes.onLoad,this.imageLoadHandler);d.Events.remove(this.cache.images[f],b.Image.EventTypes.onError,this.imageErrorHandler)}this.stopSlideshow();d.Animation.stop(this.el);d.DOM.removeChild(this.el,this.el.parentNode);for(g in this){if(d.objectHasProperty(this,g)){this[g]=null}}},initialize:function(e,f){var h,j,g;this.cache=e;this.settings=f;this.slideByEndHandler=this.onSlideByEnd.bind(this);this.imageLoadHandler=this.onImageLoad.bind(this);this.imageErrorHandler=this.onImageError.bind(this);this.currentCacheIndex=0;this.isSliding=false;this.isSlideshowActive=false;if(this.cache.images.length<3){this.settings.loop=false}this.el=d.DOM.createElement("div",{"class":b.Carousel.CssClasses.carousel},"");d.DOM.setStyle(this.el,{display:"block",position:"absolute",left:0,top:0,overflow:"hidden",zIndex:this.settings.zIndex});d.DOM.hide(this.el);this.contentEl=d.DOM.createElement("div",{"class":b.Carousel.CssClasses.content},"");d.DOM.setStyle(this.contentEl,{display:"block",position:"absolute",left:0,top:0});d.DOM.appendChild(this.contentEl,this.el);j=(e.images.length<3)?e.images.length:3;for(h=0;h<j;h++){g=d.DOM.createElement("div",{"class":b.Carousel.CssClasses.item+" "+b.Carousel.CssClasses.item+"-"+h},"");d.DOM.setAttribute(g,"style","float: left;");d.DOM.setStyle(g,{display:"block",position:"relative",left:0,top:0,overflow:"hidden"});if(this.settings.margin>0){d.DOM.setStyle(g,{marginRight:this.settings.margin+"px"})}d.DOM.appendChild(g,this.contentEl)}if(this.settings.target===c){d.DOM.appendToBody(this.el)}else{d.DOM.appendChild(this.el,this.settings.target)}},resetPosition:function(){var f,p,n,l,m,e,k,h,o,g;if(this.settings.target===c){f=d.DOM.windowWidth();p=d.DOM.windowHeight();n=d.DOM.windowScrollTop()+"px"}else{f=d.DOM.width(this.settings.target);p=d.DOM.height(this.settings.target);n="0px"}l=(this.settings.margin>0)?f+this.settings.margin:f;m=d.DOM.find("."+b.Carousel.CssClasses.item,this.contentEl);e=l*m.length;d.DOM.setStyle(this.el,{top:n,width:f,height:p});d.DOM.setStyle(this.contentEl,{width:e,height:p});for(k=0,h=m.length;k<h;k++){o=m[k];d.DOM.setStyle(o,{width:f,height:p});g=d.DOM.find("img",o)[0];if(!d.isNothing(g)){this.resetImagePosition(g)}}this.setContentLeftPosition()},resetImagePosition:function(g){if(d.isNothing(g)){return}var e=d.DOM.getAttribute(g,"src"),h,i,f,j,k,m=d.DOM.width(this.el),l=d.DOM.height(this.el);if(this.settings.imageScaleMethod==="fitNoUpscale"){i=g.naturalWidth;f=g.naturalHeight;if(i>m){h=m/i;i=Math.round(i*h);f=Math.round(f*h)}if(f>l){h=l/f;f=Math.round(f*h);i=Math.round(i*h)}}else{if(g.isLandscape){h=m/g.naturalWidth}else{h=l/g.naturalHeight}i=Math.round(g.naturalWidth*h);f=Math.round(g.naturalHeight*h);if(this.settings.imageScaleMethod==="zoom"){h=1;if(f<l){h=l/f}else{if(i<m){h=m/i}}if(h!==1){i=Math.round(i*h);f=Math.round(f*h)}}else{if(this.settings.imageScaleMethod==="fit"){h=1;if(i>m){h=m/i}else{if(f>l){h=l/f}}if(h!==1){i=Math.round(i*h);f=Math.round(f*h)}}}}j=Math.round(((l-f)/2))+"px";k=Math.round(((m-i)/2))+"px";d.DOM.setStyle(g,{position:"absolute",width:i,height:f,top:j,left:k,display:"block"})},setContentLeftPosition:function(){var e,g,f;if(this.settings.target===c){e=d.DOM.windowWidth()}else{e=d.DOM.width(this.settings.target)}g=this.getItemEls();f=0;if(this.settings.loop){f=(e+this.settings.margin)*-1}else{if(this.currentCacheIndex===this.cache.images.length-1){f=((g.length-1)*(e+this.settings.margin))*-1}else{if(this.currentCacheIndex>0){f=(e+this.settings.margin)*-1}}}d.DOM.setStyle(this.contentEl,{left:f+"px"})},show:function(f){this.currentCacheIndex=f;this.resetPosition();this.setImages(false);d.DOM.show(this.el);d.Animation.resetTranslate(this.contentEl);var h=this.getItemEls(),g,e;for(g=0,e=h.length;g<e;g++){d.Animation.resetTranslate(h[g])}d.Events.fire(this,{type:b.Carousel.EventTypes.onSlideByEnd,target:this,action:b.Carousel.SlideByAction.current,cacheIndex:this.currentCacheIndex})},setImages:function(f){var g,i=this.getItemEls(),e=this.currentCacheIndex+1,h=this.currentCacheIndex-1;if(this.settings.loop){if(e>this.cache.images.length-1){e=0}if(h<0){h=this.cache.images.length-1}g=this.cache.getImages([h,this.currentCacheIndex,e]);if(!f){this.addCacheImageToItemEl(g[1],i[1])}this.addCacheImageToItemEl(g[2],i[2]);this.addCacheImageToItemEl(g[0],i[0])}else{if(i.length===1){if(!f){g=this.cache.getImages([this.currentCacheIndex]);this.addCacheImageToItemEl(g[0],i[0])}}else{if(i.length===2){if(this.currentCacheIndex===0){g=this.cache.getImages([this.currentCacheIndex,this.currentCacheIndex+1]);if(!f){this.addCacheImageToItemEl(g[0],i[0])}this.addCacheImageToItemEl(g[1],i[1])}else{g=this.cache.getImages([this.currentCacheIndex-1,this.currentCacheIndex]);if(!f){this.addCacheImageToItemEl(g[1],i[1])}this.addCacheImageToItemEl(g[0],i[0])}}else{if(this.currentCacheIndex===0){g=this.cache.getImages([this.currentCacheIndex,this.currentCacheIndex+1,this.currentCacheIndex+2]);if(!f){this.addCacheImageToItemEl(g[0],i[0])}this.addCacheImageToItemEl(g[1],i[1]);this.addCacheImageToItemEl(g[2],i[2])}else{if(this.currentCacheIndex===this.cache.images.length-1){g=this.cache.getImages([this.currentCacheIndex-2,this.currentCacheIndex-1,this.currentCacheIndex]);if(!f){this.addCacheImageToItemEl(g[2],i[2])}this.addCacheImageToItemEl(g[1],i[1]);this.addCacheImageToItemEl(g[0],i[0])}else{g=this.cache.getImages([this.currentCacheIndex-1,this.currentCacheIndex,this.currentCacheIndex+1]);if(!f){this.addCacheImageToItemEl(g[1],i[1])}this.addCacheImageToItemEl(g[2],i[2]);this.addCacheImageToItemEl(g[0],i[0])}}}}}},addCacheImageToItemEl:function(e,f){d.DOM.removeClass(f,b.Carousel.CssClasses.itemError);d.DOM.addClass(f,b.Carousel.CssClasses.itemLoading);d.DOM.removeChildren(f);d.DOM.setStyle(e.imageEl,{display:"none"});d.DOM.appendChild(e.imageEl,f);d.Animation.resetTranslate(e.imageEl);d.Events.add(e,b.Image.EventTypes.onLoad,this.imageLoadHandler);d.Events.add(e,b.Image.EventTypes.onError,this.imageErrorHandler);e.load()},slideCarousel:function(e,j,i){if(this.isSliding){return}var h,g,f;if(this.settings.target===c){h=d.DOM.windowWidth()+this.settings.margin}else{h=d.DOM.width(this.settings.target)+this.settings.margin}i=d.coalesce(i,this.settings.slideSpeed);if(c.Math.abs(g)<1){return}switch(j){case d.TouchElement.ActionTypes.swipeLeft:f=h*-1;break;case d.TouchElement.ActionTypes.swipeRight:f=h;break;default:g=e.x-this.touchStartPoint.x;if(c.Math.abs(g)>h/2){f=(g>0)?h:h*-1}else{f=0}break}if(f<0){this.lastSlideByAction=b.Carousel.SlideByAction.next}else{if(f>0){this.lastSlideByAction=b.Carousel.SlideByAction.previous}else{this.lastSlideByAction=b.Carousel.SlideByAction.current}}if(!this.settings.loop){if((this.lastSlideByAction===b.Carousel.SlideByAction.previous&&this.currentCacheIndex===0)||(this.lastSlideByAction===b.Carousel.SlideByAction.next&&this.currentCacheIndex===this.cache.images.length-1)){f=0;this.lastSlideByAction=b.Carousel.SlideByAction.current}}this.isSliding=true;this.doSlideCarousel(f,i)},moveCarousel:function(e){if(this.isSliding){return}if(!this.settings.enableDrag){return}this.doMoveCarousel(e.x-this.touchStartPoint.x)},getItemEls:function(){return d.DOM.find("."+b.Carousel.CssClasses.item,this.contentEl)},previous:function(){this.stopSlideshow();this.slideCarousel({x:0,y:0},d.TouchElement.ActionTypes.swipeRight,this.settings.nextPreviousSlideSpeed)},next:function(){this.stopSlideshow();this.slideCarousel({x:0,y:0},d.TouchElement.ActionTypes.swipeLeft,this.settings.nextPreviousSlideSpeed)},slideshowNext:function(){this.slideCarousel({x:0,y:0},d.TouchElement.ActionTypes.swipeLeft)},startSlideshow:function(){this.stopSlideshow();this.isSlideshowActive=true;this.slideshowTimeout=c.setTimeout(this.slideshowNext.bind(this),this.settings.slideshowDelay);d.Events.fire(this,{type:b.Carousel.EventTypes.onSlideshowStart,target:this})},stopSlideshow:function(){if(!d.isNothing(this.slideshowTimeout)){c.clearTimeout(this.slideshowTimeout);this.slideshowTimeout=null;this.isSlideshowActive=false;d.Events.fire(this,{type:b.Carousel.EventTypes.onSlideshowStop,target:this})}},onSlideByEnd:function(f){if(d.isNothing(this.isSliding)){return}var g=this.getItemEls();this.isSliding=false;if(this.lastSlideByAction===b.Carousel.SlideByAction.next){this.currentCacheIndex=this.currentCacheIndex+1}else{if(this.lastSlideByAction===b.Carousel.SlideByAction.previous){this.currentCacheIndex=this.currentCacheIndex-1}}if(this.settings.loop){if(this.lastSlideByAction===b.Carousel.SlideByAction.next){d.DOM.appendChild(g[0],this.contentEl)}else{if(this.lastSlideByAction===b.Carousel.SlideByAction.previous){d.DOM.insertBefore(g[g.length-1],g[0],this.contentEl)}}if(this.currentCacheIndex<0){this.currentCacheIndex=this.cache.images.length-1}else{if(this.currentCacheIndex===this.cache.images.length){this.currentCacheIndex=0}}}else{if(this.cache.images.length>3){if(this.currentCacheIndex>1&&this.currentCacheIndex<this.cache.images.length-2){if(this.lastSlideByAction===b.Carousel.SlideByAction.next){d.DOM.appendChild(g[0],this.contentEl)}else{if(this.lastSlideByAction===b.Carousel.SlideByAction.previous){d.DOM.insertBefore(g[g.length-1],g[0],this.contentEl)}}}else{if(this.currentCacheIndex===1){if(this.lastSlideByAction===b.Carousel.SlideByAction.previous){d.DOM.insertBefore(g[g.length-1],g[0],this.contentEl)}}else{if(this.currentCacheIndex===this.cache.images.length-2){if(this.lastSlideByAction===b.Carousel.SlideByAction.next){d.DOM.appendChild(g[0],this.contentEl)}}}}}}if(this.lastSlideByAction!==b.Carousel.SlideByAction.current){this.setContentLeftPosition();this.setImages(true)}d.Events.fire(this,{type:b.Carousel.EventTypes.onSlideByEnd,target:this,action:this.lastSlideByAction,cacheIndex:this.currentCacheIndex});if(this.isSlideshowActive){if(this.lastSlideByAction!==b.Carousel.SlideByAction.current){this.startSlideshow()}else{this.stopSlideshow()}}},onTouch:function(f,e){this.stopSlideshow();switch(f){case d.TouchElement.ActionTypes.touchStart:this.touchStartPoint=e;this.touchStartPosition={x:c.parseInt(d.DOM.getStyle(this.contentEl,"left"),0),y:c.parseInt(d.DOM.getStyle(this.contentEl,"top"),0)};break;case d.TouchElement.ActionTypes.touchMove:this.moveCarousel(e);break;case d.TouchElement.ActionTypes.touchMoveEnd:case d.TouchElement.ActionTypes.swipeLeft:case d.TouchElement.ActionTypes.swipeRight:this.slideCarousel(e,f);break;case d.TouchElement.ActionTypes.tap:break;case d.TouchElement.ActionTypes.doubleTap:break}},onImageLoad:function(g){var f=g.target;if(!d.isNothing(f.imageEl.parentNode)){d.DOM.removeClass(f.imageEl.parentNode,b.Carousel.CssClasses.itemLoading);this.resetImagePosition(f.imageEl)}d.Events.remove(f,b.Image.EventTypes.onLoad,this.imageLoadHandler);d.Events.remove(f,b.Image.EventTypes.onError,this.imageErrorHandler)},onImageError:function(g){var f=g.target;if(!d.isNothing(f.imageEl.parentNode)){d.DOM.removeClass(f.imageEl.parentNode,b.Carousel.CssClasses.itemLoading);d.DOM.addClass(f.imageEl.parentNode,b.Carousel.CssClasses.itemError)}d.Events.remove(f,b.Image.EventTypes.onLoad,this.imageLoadHandler);d.Events.remove(f,b.Image.EventTypes.onError,this.imageErrorHandler)}})}(window,window.klass,window.Code.Util));(function(d,a,e,b){e.registerNamespace("Code.PhotoSwipe.Carousel");var c=d.Code.PhotoSwipe;c.Carousel.CarouselClass=c.Carousel.CarouselClass.extend({getStartingPos:function(){var f=this.touchStartPosition;if(e.isNothing(f)){f={x:d.parseInt(e.DOM.getStyle(this.contentEl,"left"),0),y:d.parseInt(e.DOM.getStyle(this.contentEl,"top"),0)}}return f},doMoveCarousel:function(g){var f;if(e.Browser.isCSSTransformSupported){f={};f[e.Animation._transitionPrefix+"Property"]="all";f[e.Animation._transitionPrefix+"Duration"]="";f[e.Animation._transitionPrefix+"TimingFunction"]="";f[e.Animation._transitionPrefix+"Delay"]="0";f[e.Animation._transformLabel]=(e.Browser.is3dSupported)?"translate3d("+g+"px, 0px, 0px)":"translate("+g+"px, 0px)";e.DOM.setStyle(this.contentEl,f)}else{if(!e.isNothing(d.jQuery)){d.jQuery(this.contentEl).stop().css("left",this.getStartingPos().x+g+"px")}}},doSlideCarousel:function(i,h){var f,g;if(h<=0){this.slideByEndHandler();return}if(e.Browser.isCSSTransformSupported){g=e.coalesce(this.contentEl.style.webkitTransform,this.contentEl.style.MozTransform,this.contentEl.style.transform,"");if(g.indexOf("translate3d("+i)===0){this.slideByEndHandler();return}else{if(g.indexOf("translate("+i)===0){this.slideByEndHandler();return}}e.Animation.slideBy(this.contentEl,i,0,h,this.slideByEndHandler,this.settings.slideTimingFunction)}else{if(!e.isNothing(d.jQuery)){f={left:this.getStartingPos().x+i+"px"};if(this.settings.animationTimingFunction==="ease-out"){this.settings.animationTimingFunction="easeOutQuad"}if(e.isNothing(d.jQuery.easing[this.settings.animationTimingFunction])){this.settings.animationTimingFunction="linear"}d.jQuery(this.contentEl).animate(f,this.settings.slideSpeed,this.settings.animationTimingFunction,this.slideByEndHandler)}}}})}(window,window.klass,window.Code.Util,window.Code.PhotoSwipe.TouchElement));(function(c,a,d){d.registerNamespace("Code.PhotoSwipe.Toolbar");var b=c.Code.PhotoSwipe;b.Toolbar.CssClasses={toolbar:"ps-toolbar",toolbarContent:"ps-toolbar-content",toolbarTop:"ps-toolbar-top",caption:"ps-caption",captionBottom:"ps-caption-bottom",captionContent:"ps-caption-content",close:"ps-toolbar-close",play:"ps-toolbar-play",previous:"ps-toolbar-previous",previousDisabled:"ps-toolbar-previous-disabled",next:"ps-toolbar-next",nextDisabled:"ps-toolbar-next-disabled"};b.Toolbar.ToolbarAction={close:"close",play:"play",next:"next",previous:"previous",none:"none"};b.Toolbar.EventTypes={onTap:"PhotoSwipeToolbarOnClick",onBeforeShow:"PhotoSwipeToolbarOnBeforeShow",onShow:"PhotoSwipeToolbarOnShow",onBeforeHide:"PhotoSwipeToolbarOnBeforeHide",onHide:"PhotoSwipeToolbarOnHide"};b.Toolbar.getToolbar=function(){return'<div class="'+b.Toolbar.CssClasses.close+'"><div class="'+b.Toolbar.CssClasses.toolbarContent+'"></div></div><div class="'+b.Toolbar.CssClasses.play+'"><div class="'+b.Toolbar.CssClasses.toolbarContent+'"></div></div><div class="'+b.Toolbar.CssClasses.previous+'"><div class="'+b.Toolbar.CssClasses.toolbarContent+'"></div></div><div class="'+b.Toolbar.CssClasses.next+'"><div class="'+b.Toolbar.CssClasses.toolbarContent+'"></div></div>'}}(window,window.klass,window.Code.Util));(function(c,a,d){d.registerNamespace("Code.PhotoSwipe.Toolbar");var b=c.Code.PhotoSwipe;b.Toolbar.ToolbarClass=a({toolbarEl:null,closeEl:null,playEl:null,previousEl:null,nextEl:null,captionEl:null,captionContentEl:null,currentCaption:null,settings:null,cache:null,timeout:null,isVisible:null,fadeOutHandler:null,touchStartHandler:null,touchMoveHandler:null,clickHandler:null,dispose:function(){var e;this.clearTimeout();this.removeEventHandlers();d.Animation.stop(this.toolbarEl);d.Animation.stop(this.captionEl);d.DOM.removeChild(this.toolbarEl,this.toolbarEl.parentNode);d.DOM.removeChild(this.captionEl,this.captionEl.parentNode);for(e in this){if(d.objectHasProperty(this,e)){this[e]=null}}},initialize:function(f,g){var e;this.settings=g;this.cache=f;this.isVisible=false;this.fadeOutHandler=this.onFadeOut.bind(this);this.touchStartHandler=this.onTouchStart.bind(this);this.touchMoveHandler=this.onTouchMove.bind(this);this.clickHandler=this.onClick.bind(this);e=b.Toolbar.CssClasses.toolbar;if(this.settings.captionAndToolbarFlipPosition){e=e+" "+b.Toolbar.CssClasses.toolbarTop}this.toolbarEl=d.DOM.createElement("div",{"class":e},this.settings.getToolbar());d.DOM.setStyle(this.toolbarEl,{left:0,position:"absolute",overflow:"hidden",zIndex:this.settings.zIndex});if(this.settings.target===c){d.DOM.appendToBody(this.toolbarEl)}else{d.DOM.appendChild(this.toolbarEl,this.settings.target)}d.DOM.hide(this.toolbarEl);this.closeEl=d.DOM.find("."+b.Toolbar.CssClasses.close,this.toolbarEl)[0];if(this.settings.preventHide&&!d.isNothing(this.closeEl)){d.DOM.hide(this.closeEl)}this.playEl=d.DOM.find("."+b.Toolbar.CssClasses.play,this.toolbarEl)[0];if(this.settings.preventSlideshow&&!d.isNothing(this.playEl)){d.DOM.hide(this.playEl)}this.nextEl=d.DOM.find("."+b.Toolbar.CssClasses.next,this.toolbarEl)[0];this.previousEl=d.DOM.find("."+b.Toolbar.CssClasses.previous,this.toolbarEl)[0];e=b.Toolbar.CssClasses.caption;if(this.settings.captionAndToolbarFlipPosition){e=e+" "+b.Toolbar.CssClasses.captionBottom}this.captionEl=d.DOM.createElement("div",{"class":e},"");d.DOM.setStyle(this.captionEl,{left:0,position:"absolute",overflow:"hidden",zIndex:this.settings.zIndex});if(this.settings.target===c){d.DOM.appendToBody(this.captionEl)}else{d.DOM.appendChild(this.captionEl,this.settings.target)}d.DOM.hide(this.captionEl);this.captionContentEl=d.DOM.createElement("div",{"class":b.Toolbar.CssClasses.captionContent},"");d.DOM.appendChild(this.captionContentEl,this.captionEl);this.addEventHandlers()},resetPosition:function(){var f,e,g;if(this.settings.target===c){if(this.settings.captionAndToolbarFlipPosition){e=d.DOM.windowScrollTop();g=(d.DOM.windowScrollTop()+d.DOM.windowHeight())-d.DOM.height(this.captionEl)}else{e=(d.DOM.windowScrollTop()+d.DOM.windowHeight())-d.DOM.height(this.toolbarEl);g=d.DOM.windowScrollTop()}f=d.DOM.windowWidth()}else{if(this.settings.captionAndToolbarFlipPosition){e="0";g=d.DOM.height(this.settings.target)-d.DOM.height(this.captionEl)}else{e=d.DOM.height(this.settings.target)-d.DOM.height(this.toolbarEl);g=0}f=d.DOM.width(this.settings.target)}d.DOM.setStyle(this.toolbarEl,{top:e+"px",width:f});d.DOM.setStyle(this.captionEl,{top:g+"px",width:f})},toggleVisibility:function(e){if(this.isVisible){this.fadeOut()}else{this.show(e)}},show:function(e){d.Animation.stop(this.toolbarEl);d.Animation.stop(this.captionEl);this.resetPosition();this.setToolbarStatus(e);d.Events.fire(this,{type:b.Toolbar.EventTypes.onBeforeShow,target:this});this.showToolbar();this.setCaption(e);this.showCaption();this.isVisible=true;this.setTimeout();d.Events.fire(this,{type:b.Toolbar.EventTypes.onShow,target:this})},setTimeout:function(){if(this.settings.captionAndToolbarAutoHideDelay>0){this.clearTimeout();this.timeout=c.setTimeout(this.fadeOut.bind(this),this.settings.captionAndToolbarAutoHideDelay)}},clearTimeout:function(){if(!d.isNothing(this.timeout)){c.clearTimeout(this.timeout);this.timeout=null}},fadeOut:function(){this.clearTimeout();d.Events.fire(this,{type:b.Toolbar.EventTypes.onBeforeHide,target:this});d.Animation.fadeOut(this.toolbarEl,this.settings.fadeOutSpeed);d.Animation.fadeOut(this.captionEl,this.settings.fadeOutSpeed,this.fadeOutHandler);this.isVisible=false},addEventHandlers:function(){if(d.Browser.isTouchSupported){if(!d.Browser.blackberry){d.Events.add(this.toolbarEl,"touchstart",this.touchStartHandler)}d.Events.add(this.toolbarEl,"touchmove",this.touchMoveHandler);d.Events.add(this.captionEl,"touchmove",this.touchMoveHandler)}d.Events.add(this.toolbarEl,"click",this.clickHandler)},removeEventHandlers:function(){if(d.Browser.isTouchSupported){if(!d.Browser.blackberry){d.Events.remove(this.toolbarEl,"touchstart",this.touchStartHandler)}d.Events.remove(this.toolbarEl,"touchmove",this.touchMoveHandler);d.Events.remove(this.captionEl,"touchmove",this.touchMoveHandler)}d.Events.remove(this.toolbarEl,"click",this.clickHandler)},handleTap:function(g){this.clearTimeout();var f;if(g.target===this.nextEl||d.DOM.isChildOf(g.target,this.nextEl)){f=b.Toolbar.ToolbarAction.next}else{if(g.target===this.previousEl||d.DOM.isChildOf(g.target,this.previousEl)){f=b.Toolbar.ToolbarAction.previous}else{if(g.target===this.closeEl||d.DOM.isChildOf(g.target,this.closeEl)){f=b.Toolbar.ToolbarAction.close}else{if(g.target===this.playEl||d.DOM.isChildOf(g.target,this.playEl)){f=b.Toolbar.ToolbarAction.play}}}}this.setTimeout();if(d.isNothing(f)){f=b.Toolbar.ToolbarAction.none}d.Events.fire(this,{type:b.Toolbar.EventTypes.onTap,target:this,action:f,tapTarget:g.target})},setCaption:function(e){d.DOM.removeChildren(this.captionContentEl);this.currentCaption=d.coalesce(this.cache.images[e].caption,"\u00A0");if(d.isObject(this.currentCaption)){d.DOM.appendChild(this.currentCaption,this.captionContentEl)}else{if(this.currentCaption===""){this.currentCaption="\u00A0"}d.DOM.appendText(this.currentCaption,this.captionContentEl)}this.currentCaption=(this.currentCaption==="\u00A0")?"":this.currentCaption;this.resetPosition()},showToolbar:function(){d.DOM.setStyle(this.toolbarEl,{opacity:this.settings.captionAndToolbarOpacity});d.DOM.show(this.toolbarEl)},showCaption:function(){if(this.currentCaption===""||this.captionContentEl.childNodes.length<1){if(!this.settings.captionAndToolbarShowEmptyCaptions){d.DOM.hide(this.captionEl);return}}d.DOM.setStyle(this.captionEl,{opacity:this.settings.captionAndToolbarOpacity});d.DOM.show(this.captionEl)},setToolbarStatus:function(e){if(this.settings.loop){return}d.DOM.removeClass(this.previousEl,b.Toolbar.CssClasses.previousDisabled);d.DOM.removeClass(this.nextEl,b.Toolbar.CssClasses.nextDisabled);if(e>0&&e<this.cache.images.length-1){return}if(e===0){if(!d.isNothing(this.previousEl)){d.DOM.addClass(this.previousEl,b.Toolbar.CssClasses.previousDisabled)}}if(e===this.cache.images.length-1){if(!d.isNothing(this.nextEl)){d.DOM.addClass(this.nextEl,b.Toolbar.CssClasses.nextDisabled)}}},onFadeOut:function(){d.DOM.hide(this.toolbarEl);d.DOM.hide(this.captionEl);d.Events.fire(this,{type:b.Toolbar.EventTypes.onHide,target:this})},onTouchStart:function(f){f.preventDefault();d.Events.remove(this.toolbarEl,"click",this.clickHandler);this.handleTap(f)},onTouchMove:function(f){f.preventDefault()},onClick:function(f){f.preventDefault();this.handleTap(f)}})}(window,window.klass,window.Code.Util));(function(c,a,d){d.registerNamespace("Code.PhotoSwipe.UILayer");var b=c.Code.PhotoSwipe;b.UILayer.CssClasses={uiLayer:"ps-uilayer"}}(window,window.klass,window.Code.Util));(function(c,a,d){d.registerNamespace("Code.PhotoSwipe.UILayer");var b=c.Code.PhotoSwipe;b.UILayer.UILayerClass=d.TouchElement.TouchElementClass.extend({el:null,settings:null,dispose:function(){var e;this.removeEventHandlers();d.DOM.removeChild(this.el,this.el.parentNode);for(e in this){if(d.objectHasProperty(this,e)){this[e]=null}}},initialize:function(e){this.settings=e;this.el=d.DOM.createElement("div",{"class":b.UILayer.CssClasses.uiLayer},"");d.DOM.setStyle(this.el,{display:"block",position:"absolute",left:0,top:0,overflow:"hidden",zIndex:this.settings.zIndex,opacity:0});d.DOM.hide(this.el);if(this.settings.target===c){d.DOM.appendToBody(this.el)}else{d.DOM.appendChild(this.el,this.settings.target)}this.supr(this.el,{swipe:true,move:true,gesture:d.Browser.iOS,doubleTap:true,preventDefaultTouchEvents:this.settings.preventDefaultTouchEvents})},resetPosition:function(){if(this.settings.target===c){d.DOM.setStyle(this.el,{top:d.DOM.windowScrollTop()+"px",width:d.DOM.windowWidth(),height:d.DOM.windowHeight()})}else{d.DOM.setStyle(this.el,{top:"0px",width:d.DOM.width(this.settings.target),height:d.DOM.height(this.settings.target)})}},show:function(){this.resetPosition();d.DOM.show(this.el);this.addEventHandlers()},addEventHandlers:function(){this.supr()},removeEventHandlers:function(){this.supr()}})}(window,window.klass,window.Code.Util));(function(c,a,d){d.registerNamespace("Code.PhotoSwipe.ZoomPanRotate");var b=c.Code.PhotoSwipe;b.ZoomPanRotate.CssClasses={zoomPanRotate:"ps-zoom-pan-rotate"};b.ZoomPanRotate.EventTypes={onTransform:"PhotoSwipeZoomPanRotateOnTransform"}}(window,window.klass,window.Code.Util));(function(c,a,d){d.registerNamespace("Code.PhotoSwipe.ZoomPanRotate");var b=c.Code.PhotoSwipe;b.ZoomPanRotate.ZoomPanRotateClass=a({el:null,settings:null,containerEl:null,imageEl:null,transformSettings:null,panStartingPoint:null,transformEl:null,dispose:function(){var e;d.DOM.removeChild(this.el,this.el.parentNode);for(e in this){if(d.objectHasProperty(this,e)){this[e]=null}}},initialize:function(g,f,j){var i,h,e,k;this.settings=g;if(this.settings.target===c){i=document.body;h=d.DOM.windowWidth();e=d.DOM.windowHeight();k=d.DOM.windowScrollTop()+"px"}else{i=this.settings.target;h=d.DOM.width(i);e=d.DOM.height(i);k="0px"}this.imageEl=f.imageEl.cloneNode(false);d.DOM.setStyle(this.imageEl,{zIndex:1});this.transformSettings={startingScale:1,scale:1,startingRotation:0,rotation:0,startingTranslateX:0,startingTranslateY:0,translateX:0,translateY:0};this.el=d.DOM.createElement("div",{"class":b.ZoomPanRotate.CssClasses.zoomPanRotate},"");d.DOM.setStyle(this.el,{left:0,top:k,position:"absolute",width:h,height:e,zIndex:this.settings.zIndex,display:"block"});d.DOM.insertBefore(this.el,j.el,i);if(d.Browser.iOS){this.containerEl=d.DOM.createElement("div");d.DOM.setStyle(this.containerEl,{left:0,top:0,width:h,height:e,position:"absolute",zIndex:1});d.DOM.appendChild(this.imageEl,this.containerEl);d.DOM.appendChild(this.containerEl,this.el);d.Animation.resetTranslate(this.containerEl);d.Animation.resetTranslate(this.imageEl);this.transformEl=this.containerEl}else{d.DOM.appendChild(this.imageEl,this.el);this.transformEl=this.imageEl}},setStartingTranslateFromCurrentTransform:function(){var e=d.coalesce(this.transformEl.style.webkitTransform,this.transformEl.style.MozTransform,this.transformEl.style.transform),f;if(!d.isNothing(e)){f=e.match(/translate\((.*?)\)/);if(!d.isNothing(f)){f=f[1].split(", ");this.transformSettings.startingTranslateX=c.parseInt(f[0],10);this.transformSettings.startingTranslateY=c.parseInt(f[1],10)}}},getScale:function(f){var e=this.transformSettings.startingScale*f;if(this.settings.minUserZoom!==0&&e<this.settings.minUserZoom){e=this.settings.minUserZoom}else{if(this.settings.maxUserZoom!==0&&e>this.settings.maxUserZoom){e=this.settings.maxUserZoom}}return e},setStartingScaleAndRotation:function(f,e){this.transformSettings.startingScale=this.getScale(f);this.transformSettings.startingRotation=(this.transformSettings.startingRotation+e)%360},zoomRotate:function(f,e){this.transformSettings.scale=this.getScale(f);this.transformSettings.rotation=this.transformSettings.startingRotation+e;this.applyTransform()},panStart:function(e){this.setStartingTranslateFromCurrentTransform();this.panStartingPoint={x:e.x,y:e.y}},pan:function(e){var g=e.x-this.panStartingPoint.x,f=e.y-this.panStartingPoint.y,h=g/this.transformSettings.scale,i=f/this.transformSettings.scale;this.transformSettings.translateX=this.transformSettings.startingTranslateX+h;this.transformSettings.translateY=this.transformSettings.startingTranslateY+i;this.applyTransform()},zoomAndPanToPoint:function(j,e){if(this.settings.target===c){this.panStart({x:d.DOM.windowWidth()/2,y:d.DOM.windowHeight()/2});var g=e.x-this.panStartingPoint.x,f=e.y-this.panStartingPoint.y,h=g/this.transformSettings.scale,i=f/this.transformSettings.scale;this.transformSettings.translateX=(this.transformSettings.startingTranslateX+h)*-1;this.transformSettings.translateY=(this.transformSettings.startingTranslateY+i)*-1}this.setStartingScaleAndRotation(j,0);this.transformSettings.scale=this.transformSettings.startingScale;this.transformSettings.rotation=0;this.applyTransform()},applyTransform:function(){var h=this.transformSettings.rotation%360,g=c.parseInt(this.transformSettings.translateX,10),f=c.parseInt(this.transformSettings.translateY,10),e="scale("+this.transformSettings.scale+") rotate("+h+"deg) translate("+g+"px, "+f+"px)";d.DOM.setStyle(this.transformEl,{webkitTransform:e,MozTransform:e,msTransform:e,transform:e});d.Events.fire(this,{target:this,type:b.ZoomPanRotate.EventTypes.onTransform,scale:this.transformSettings.scale,rotation:this.transformSettings.rotation,rotationDegs:h,translateX:g,translateY:f})}})}(window,window.klass,window.Code.Util));(function(b,c){c.registerNamespace("Code.PhotoSwipe");var a=b.Code.PhotoSwipe;a.CssClasses={buildingBody:"ps-building",activeBody:"ps-active"};a.EventTypes={onBeforeShow:"PhotoSwipeOnBeforeShow",onShow:"PhotoSwipeOnShow",onBeforeHide:"PhotoSwipeOnBeforeHide",onHide:"PhotoSwipeOnHide",onDisplayImage:"PhotoSwipeOnDisplayImage",onResetPosition:"PhotoSwipeOnResetPosition",onSlideshowStart:"PhotoSwipeOnSlideshowStart",onSlideshowStop:"PhotoSwipeOnSlideshowStop",onTouch:"PhotoSwipeOnTouch",onBeforeCaptionAndToolbarShow:"PhotoSwipeOnBeforeCaptionAndToolbarShow",onCaptionAndToolbarShow:"PhotoSwipeOnCaptionAndToolbarShow",onBeforeCaptionAndToolbarHide:"PhotoSwipeOnBeforeCaptionAndToolbarHide",onCaptionAndToolbarHide:"PhotoSwipeOnCaptionAndToolbarHide",onToolbarTap:"PhotoSwipeOnToolbarTap",onBeforeZoomPanRotateShow:"PhotoSwipeOnBeforeZoomPanRotateShow",onZoomPanRotateShow:"PhotoSwipeOnZoomPanRotateShow",onBeforeZoomPanRotateHide:"PhotoSwipeOnBeforeZoomPanRotateHide",onZoomPanRotateHide:"PhotoSwipeOnZoomPanRotateHide",onZoomPanRotateTransform:"PhotoSwipeOnZoomPanRotateTransform"};a.instances=[];a.activeInstances=[];a.setActivateInstance=function(d){var e=c.arrayIndexOf(d.settings.target,a.activeInstances,"target");if(e>-1){throw"Code.PhotoSwipe.activateInstance: Unable to active instance as another instance is already active for this target"}a.activeInstances.push({target:d.settings.target,instance:d})};a.unsetActivateInstance=function(d){var e=c.arrayIndexOf(d,a.activeInstances,"instance");a.activeInstances.splice(e,1)};a.attach=function(e,g,l){var h,f,d,k;d=a.createInstance(e,g,l);for(h=0,f=e.length;h<f;h++){k=e[h];if(!c.isNothing(k.nodeType)){if(k.nodeType===1){k.__photoSwipeClickHandler=a.onTriggerElementClick.bind(d);c.Events.remove(k,"click",k.__photoSwipeClickHandler);c.Events.add(k,"click",k.__photoSwipeClickHandler)}}}return d};if(b.jQuery){b.jQuery.fn.photoSwipe=function(d,e){return a.attach(this,d,e)}}a.detatch=function(d){var f,e,g;for(f=0,e=d.originalImages.length;f<e;f++){g=d.originalImages[f];if(!c.isNothing(g.nodeType)){if(g.nodeType===1){c.Events.remove(g,"click",g.__photoSwipeClickHandler);delete g.__photoSwipeClickHandler}}}a.disposeInstance(d)};a.createInstance=function(e,f,j){var g,d,h;if(c.isNothing(e)){throw"Code.PhotoSwipe.attach: No images passed."}if(!c.isLikeArray(e)){throw"Code.PhotoSwipe.createInstance: Images must be an array of elements or image urls."}if(e.length<1){throw"Code.PhotoSwipe.createInstance: No images to passed."}f=c.coalesce(f,{});d=a.getInstance(j);if(c.isNothing(d)){d=new a.PhotoSwipeClass(e,f,j);a.instances.push(d)}else{throw'Code.PhotoSwipe.createInstance: Instance with id "'+j+' already exists."'}return d};a.disposeInstance=function(d){var e=a.getInstanceIndex(d);if(e<0){throw"Code.PhotoSwipe.disposeInstance: Unable to find instance to dispose."}d.dispose();a.instances.splice(e,1);d=null};a.onTriggerElementClick=function(f){f.preventDefault();var d=this;d.show(f.currentTarget)};a.getInstance=function(g){var f,e,d;for(f=0,e=a.instances.length;f<e;f++){d=a.instances[f];if(d.id===g){return d}}return null};a.getInstanceIndex=function(d){var g,f,e=-1;for(g=0,f=a.instances.length;g<f;g++){if(a.instances[g]===d){e=g;break}}return e}}(window,window.Code.Util));(function(e,f,h,i,d,g,c,j,b){h.registerNamespace("Code.PhotoSwipe");var a=e.Code.PhotoSwipe;a.PhotoSwipeClass=f({id:null,settings:null,isBackEventSupported:null,backButtonClicked:null,currentIndex:null,originalImages:null,mouseWheelStartTime:null,windowDimensions:null,cache:null,documentOverlay:null,carousel:null,uiLayer:null,toolbar:null,zoomPanRotate:null,windowOrientationChangeHandler:null,windowScrollHandler:null,windowHashChangeHandler:null,keyDownHandler:null,windowOrientationEventName:null,uiLayerTouchHandler:null,carouselSlideByEndHandler:null,carouselSlideshowStartHandler:null,carouselSlideshowStopHandler:null,toolbarTapHandler:null,toolbarBeforeShowHandler:null,toolbarShowHandler:null,toolbarBeforeHideHandler:null,toolbarHideHandler:null,mouseWheelHandler:null,zoomPanRotateTransformHandler:null,_isResettingPosition:null,_uiWebViewResetPositionTimeout:null,dispose:function(){var k;h.Events.remove(this,a.EventTypes.onBeforeShow);h.Events.remove(this,a.EventTypes.onShow);h.Events.remove(this,a.EventTypes.onBeforeHide);h.Events.remove(this,a.EventTypes.onHide);h.Events.remove(this,a.EventTypes.onDisplayImage);h.Events.remove(this,a.EventTypes.onResetPosition);h.Events.remove(this,a.EventTypes.onSlideshowStart);h.Events.remove(this,a.EventTypes.onSlideshowStop);h.Events.remove(this,a.EventTypes.onTouch);h.Events.remove(this,a.EventTypes.onBeforeCaptionAndToolbarShow);h.Events.remove(this,a.EventTypes.onCaptionAndToolbarShow);h.Events.remove(this,a.EventTypes.onBeforeCaptionAndToolbarHide);h.Events.remove(this,a.EventTypes.onCaptionAndToolbarHide);h.Events.remove(this,a.EventTypes.onZoomPanRotateTransform);this.removeEventHandlers();if(!h.isNothing(this.documentOverlay)){this.documentOverlay.dispose()}if(!h.isNothing(this.carousel)){this.carousel.dispose()}if(!h.isNothing(this.uiLayer)){this.uiLayer.dispose()}if(!h.isNothing(this.toolbar)){this.toolbar.dispose()}this.destroyZoomPanRotate();if(!h.isNothing(this.cache)){this.cache.dispose()}for(k in this){if(h.objectHasProperty(this,k)){this[k]=null}}},initialize:function(k,l,n){var m;if(h.isNothing(n)){this.id="PhotoSwipe"+new Date().getTime().toString()}else{this.id=n}this.originalImages=k;if(h.Browser.android){if(e.navigator.userAgent.match(/Android (\d+.\d+)/).toString().replace(/^.*\,/,"")>=2.1){this.isBackEventSupported=true}}if(!this.isBackEventSupported){this.isBackEventSupported=h.objectHasProperty(e,"onhashchange")}this.settings={fadeInSpeed:250,fadeOutSpeed:250,preventHide:false,preventSlideshow:false,zIndex:1000,backButtonHideEnabled:true,enableKeyboard:true,enableMouseWheel:true,mouseWheelSpeed:350,autoStartSlideshow:false,jQueryMobile:(!h.isNothing(e.jQuery)&&!h.isNothing(e.jQuery.mobile)),jQueryMobileDialogHash:"&ui-state=dialog",enableUIWebViewRepositionTimeout:false,uiWebViewResetPositionDelay:500,target:e,preventDefaultTouchEvents:true,loop:true,slideSpeed:250,nextPreviousSlideSpeed:0,enableDrag:true,swipeThreshold:50,swipeTimeThreshold:250,slideTimingFunction:"ease-out",slideshowDelay:3000,doubleTapSpeed:250,margin:20,imageScaleMethod:"fit",captionAndToolbarHide:false,captionAndToolbarFlipPosition:false,captionAndToolbarAutoHideDelay:5000,captionAndToolbarOpacity:0.8,captionAndToolbarShowEmptyCaptions:true,getToolbar:a.Toolbar.getToolbar,allowUserZoom:true,allowRotationOnUserZoom:false,maxUserZoom:5,minUserZoom:0.5,doubleTapZoomLevel:2.5,getImageSource:a.Cache.Functions.getImageSource,getImageCaption:a.Cache.Functions.getImageCaption,getImageMetaData:a.Cache.Functions.getImageMetaData,cacheMode:a.Cache.Mode.normal};h.extend(this.settings,l);if(this.settings.target!==e){m=h.DOM.getStyle(this.settings.target,"position");if(m!=="relative"||m!=="absolute"){h.DOM.setStyle(this.settings.target,"position","relative")}}if(this.settings.target!==e){this.isBackEventSupported=false;this.settings.backButtonHideEnabled=false}else{if(this.settings.preventHide){this.settings.backButtonHideEnabled=false}}this.cache=new i.CacheClass(k,this.settings)},show:function(m){var l,k;this._isResettingPosition=false;this.backButtonClicked=false;if(h.isNumber(m)){this.currentIndex=m}else{this.currentIndex=-1;for(l=0,k=this.originalImages.length;l<k;l++){if(this.originalImages[l]===m){this.currentIndex=l;break}}}if(this.currentIndex<0||this.currentIndex>this.originalImages.length-1){throw"Code.PhotoSwipe.PhotoSwipeClass.show: Starting index out of range"}this.isAlreadyGettingPage=this.getWindowDimensions();a.setActivateInstance(this);this.windowDimensions=this.getWindowDimensions();if(this.settings.target===e){h.DOM.addClass(e.document.body,a.CssClasses.buildingBody)}else{h.DOM.addClass(this.settings.target,a.CssClasses.buildingBody)}this.createComponents();h.Events.fire(this,{type:a.EventTypes.onBeforeShow,target:this});this.documentOverlay.fadeIn(this.settings.fadeInSpeed,this.onDocumentOverlayFadeIn.bind(this))},getWindowDimensions:function(){return{width:h.DOM.windowWidth(),height:h.DOM.windowHeight()}},createComponents:function(){this.documentOverlay=new d.DocumentOverlayClass(this.settings);this.carousel=new g.CarouselClass(this.cache,this.settings);this.uiLayer=new j.UILayerClass(this.settings);if(!this.settings.captionAndToolbarHide){this.toolbar=new c.ToolbarClass(this.cache,this.settings)}},resetPosition:function(){if(this._isResettingPosition){return}var k=this.getWindowDimensions();if(!h.isNothing(this.windowDimensions)){if(k.width===this.windowDimensions.width&&k.height===this.windowDimensions.height){return}}this._isResettingPosition=true;this.windowDimensions=k;this.destroyZoomPanRotate();this.documentOverlay.resetPosition();this.carousel.resetPosition();if(!h.isNothing(this.toolbar)){this.toolbar.resetPosition()}this.uiLayer.resetPosition();this._isResettingPosition=false;h.Events.fire(this,{type:a.EventTypes.onResetPosition,target:this})},addEventHandler:function(l,k){h.Events.add(this,l,k)},addEventHandlers:function(){if(h.isNothing(this.windowOrientationChangeHandler)){this.windowOrientationChangeHandler=this.onWindowOrientationChange.bind(this);this.windowScrollHandler=this.onWindowScroll.bind(this);this.keyDownHandler=this.onKeyDown.bind(this);this.windowHashChangeHandler=this.onWindowHashChange.bind(this);this.uiLayerTouchHandler=this.onUILayerTouch.bind(this);this.carouselSlideByEndHandler=this.onCarouselSlideByEnd.bind(this);this.carouselSlideshowStartHandler=this.onCarouselSlideshowStart.bind(this);this.carouselSlideshowStopHandler=this.onCarouselSlideshowStop.bind(this);this.toolbarTapHandler=this.onToolbarTap.bind(this);this.toolbarBeforeShowHandler=this.onToolbarBeforeShow.bind(this);this.toolbarShowHandler=this.onToolbarShow.bind(this);this.toolbarBeforeHideHandler=this.onToolbarBeforeHide.bind(this);this.toolbarHideHandler=this.onToolbarHide.bind(this);this.mouseWheelHandler=this.onMouseWheel.bind(this);this.zoomPanRotateTransformHandler=this.onZoomPanRotateTransform.bind(this)}if(h.Browser.android){this.orientationEventName="resize"}else{if(h.Browser.iOS&&(!h.Browser.safari)){h.Events.add(e.document.body,"orientationchange",this.windowOrientationChangeHandler)}else{var k=!h.isNothing(e.onorientationchange);this.orientationEventName=k?"orientationchange":"resize"}}if(!h.isNothing(this.orientationEventName)){h.Events.add(e,this.orientationEventName,this.windowOrientationChangeHandler)}if(this.settings.target===e){h.Events.add(e,"scroll",this.windowScrollHandler)}if(this.settings.enableKeyboard){h.Events.add(e.document,"keydown",this.keyDownHandler)}if(this.isBackEventSupported&&this.settings.backButtonHideEnabled){this.windowHashChangeHandler=this.onWindowHashChange.bind(this);if(this.settings.jQueryMobile){e.location.hash=this.settings.jQueryMobileDialogHash}else{this.currentHistoryHashValue="PhotoSwipe"+new Date().getTime().toString();e.location.hash=this.currentHistoryHashValue}h.Events.add(e,"hashchange",this.windowHashChangeHandler)}if(this.settings.enableMouseWheel){h.Events.add(e,"mousewheel",this.mouseWheelHandler)}h.Events.add(this.uiLayer,h.TouchElement.EventTypes.onTouch,this.uiLayerTouchHandler);h.Events.add(this.carousel,g.EventTypes.onSlideByEnd,this.carouselSlideByEndHandler);h.Events.add(this.carousel,g.EventTypes.onSlideshowStart,this.carouselSlideshowStartHandler);h.Events.add(this.carousel,g.EventTypes.onSlideshowStop,this.carouselSlideshowStopHandler);if(!h.isNothing(this.toolbar)){h.Events.add(this.toolbar,c.EventTypes.onTap,this.toolbarTapHandler);h.Events.add(this.toolbar,c.EventTypes.onBeforeShow,this.toolbarBeforeShowHandler);h.Events.add(this.toolbar,c.EventTypes.onShow,this.toolbarShowHandler);h.Events.add(this.toolbar,c.EventTypes.onBeforeHide,this.toolbarBeforeHideHandler);h.Events.add(this.toolbar,c.EventTypes.onHide,this.toolbarHideHandler)}},removeEventHandlers:function(){if(h.Browser.iOS&&(!h.Browser.safari)){h.Events.remove(e.document.body,"orientationchange",this.windowOrientationChangeHandler)}if(!h.isNothing(this.orientationEventName)){h.Events.remove(e,this.orientationEventName,this.windowOrientationChangeHandler)}h.Events.remove(e,"scroll",this.windowScrollHandler);if(this.settings.enableKeyboard){h.Events.remove(e.document,"keydown",this.keyDownHandler)}if(this.isBackEventSupported&&this.settings.backButtonHideEnabled){h.Events.remove(e,"hashchange",this.windowHashChangeHandler)}if(this.settings.enableMouseWheel){h.Events.remove(e,"mousewheel",this.mouseWheelHandler)}if(!h.isNothing(this.uiLayer)){h.Events.remove(this.uiLayer,h.TouchElement.EventTypes.onTouch,this.uiLayerTouchHandler)}if(!h.isNothing(this.toolbar)){h.Events.remove(this.carousel,g.EventTypes.onSlideByEnd,this.carouselSlideByEndHandler);h.Events.remove(this.carousel,g.EventTypes.onSlideshowStart,this.carouselSlideshowStartHandler);h.Events.remove(this.carousel,g.EventTypes.onSlideshowStop,this.carouselSlideshowStopHandler)}if(!h.isNothing(this.toolbar)){h.Events.remove(this.toolbar,c.EventTypes.onTap,this.toolbarTapHandler);h.Events.remove(this.toolbar,c.EventTypes.onBeforeShow,this.toolbarBeforeShowHandler);h.Events.remove(this.toolbar,c.EventTypes.onShow,this.toolbarShowHandler);h.Events.remove(this.toolbar,c.EventTypes.onBeforeHide,this.toolbarBeforeHideHandler);h.Events.remove(this.toolbar,c.EventTypes.onHide,this.toolbarHideHandler)}},hide:function(){if(this.settings.preventHide){return}if(h.isNothing(this.documentOverlay)){throw"Code.PhotoSwipe.PhotoSwipeClass.hide: PhotoSwipe instance is already hidden"}if(!h.isNothing(this.hiding)){return}this.clearUIWebViewResetPositionTimeout();this.destroyZoomPanRotate();this.removeEventHandlers();h.Events.fire(this,{type:a.EventTypes.onBeforeHide,target:this});this.uiLayer.dispose();this.uiLayer=null;if(!h.isNothing(this.toolbar)){this.toolbar.dispose();this.toolbar=null}this.carousel.dispose();this.carousel=null;h.DOM.removeClass(e.document.body,a.CssClasses.activeBody);this.documentOverlay.dispose();this.documentOverlay=null;this._isResettingPosition=false;a.unsetActivateInstance(this);h.Events.fire(this,{type:a.EventTypes.onHide,target:this});this.goBackInHistory()},goBackInHistory:function(){if(this.isBackEventSupported&&this.settings.backButtonHideEnabled){if(!this.backButtonClicked){e.history.back()}}},play:function(){if(this.isZoomActive()){return}if(!this.settings.preventSlideshow){if(!h.isNothing(this.carousel)){if(!h.isNothing(this.toolbar)&&this.toolbar.isVisible){this.toolbar.fadeOut()}this.carousel.startSlideshow()}}},stop:function(){if(this.isZoomActive()){return}if(!h.isNothing(this.carousel)){this.carousel.stopSlideshow()}},previous:function(){if(this.isZoomActive()){return}if(!h.isNothing(this.carousel)){this.carousel.previous()}},next:function(){if(this.isZoomActive()){return}if(!h.isNothing(this.carousel)){this.carousel.next()}},toggleToolbar:function(){if(this.isZoomActive()){return}if(!h.isNothing(this.toolbar)){this.toolbar.toggleVisibility(this.currentIndex)}},fadeOutToolbarIfVisible:function(){if(!h.isNothing(this.toolbar)&&this.toolbar.isVisible&&this.settings.captionAndToolbarAutoHideDelay>0){this.toolbar.fadeOut()}},createZoomPanRotate:function(){this.stop();if(this.canUserZoom()&&!this.isZoomActive()){h.Events.fire(this,a.EventTypes.onBeforeZoomPanRotateShow);this.zoomPanRotate=new b.ZoomPanRotateClass(this.settings,this.cache.images[this.currentIndex],this.uiLayer);this.uiLayer.captureSettings.preventDefaultTouchEvents=true;h.Events.add(this.zoomPanRotate,a.ZoomPanRotate.EventTypes.onTransform,this.zoomPanRotateTransformHandler);h.Events.fire(this,a.EventTypes.onZoomPanRotateShow);if(!h.isNothing(this.toolbar)&&this.toolbar.isVisible){this.toolbar.fadeOut()}}},destroyZoomPanRotate:function(){if(!h.isNothing(this.zoomPanRotate)){h.Events.fire(this,a.EventTypes.onBeforeZoomPanRotateHide);h.Events.remove(this.zoomPanRotate,a.ZoomPanRotate.EventTypes.onTransform,this.zoomPanRotateTransformHandler);this.zoomPanRotate.dispose();this.zoomPanRotate=null;this.uiLayer.captureSettings.preventDefaultTouchEvents=this.settings.preventDefaultTouchEvents;h.Events.fire(this,a.EventTypes.onZoomPanRotateHide)}},canUserZoom:function(){var l,k;if(h.Browser.msie){l=document.createElement("div");if(h.isNothing(l.style.msTransform)){return false}}else{if(!h.Browser.isCSSTransformSupported){return false}}if(!this.settings.allowUserZoom){return false}if(this.carousel.isSliding){return false}k=this.cache.images[this.currentIndex];if(h.isNothing(k)){return false}if(k.isLoading){return false}return true},isZoomActive:function(){return(!h.isNothing(this.zoomPanRotate))},getCurrentImage:function(){return this.cache.images[this.currentIndex]},onDocumentOverlayFadeIn:function(k){e.setTimeout(function(){var l=(this.settings.target===e)?e.document.body:this.settings.target;h.DOM.removeClass(l,a.CssClasses.buildingBody);h.DOM.addClass(l,a.CssClasses.activeBody);this.addEventHandlers();this.carousel.show(this.currentIndex);this.uiLayer.show();if(this.settings.autoStartSlideshow){this.play()}else{if(!h.isNothing(this.toolbar)){this.toolbar.show(this.currentIndex)}}h.Events.fire(this,{type:a.EventTypes.onShow,target:this});this.setUIWebViewResetPositionTimeout()}.bind(this),250)},setUIWebViewResetPositionTimeout:function(){if(!this.settings.enableUIWebViewRepositionTimeout){return}if(!(h.Browser.iOS&&(!h.Browser.safari))){return}if(!h.isNothing(this._uiWebViewResetPositionTimeout)){e.clearTimeout(this._uiWebViewResetPositionTimeout)}this._uiWebViewResetPositionTimeout=e.setTimeout(function(){this.resetPosition();this.setUIWebViewResetPositionTimeout()}.bind(this),this.settings.uiWebViewResetPositionDelay)},clearUIWebViewResetPositionTimeout:function(){if(!h.isNothing(this._uiWebViewResetPositionTimeout)){e.clearTimeout(this._uiWebViewResetPositionTimeout)}},onWindowScroll:function(k){this.resetPosition()},onWindowOrientationChange:function(k){this.resetPosition()},onWindowHashChange:function(k){var l="#"+((this.settings.jQueryMobile)?this.settings.jQueryMobileDialogHash:this.currentHistoryHashValue);if(e.location.hash!==l){this.backButtonClicked=true;this.hide()}},onKeyDown:function(k){if(k.keyCode===37){k.preventDefault();this.previous()}else{if(k.keyCode===39){k.preventDefault();this.next()}else{if(k.keyCode===38||k.keyCode===40){k.preventDefault()}else{if(k.keyCode===27){k.preventDefault();this.hide()}else{if(k.keyCode===32){if(!this.settings.hideToolbar){this.toggleToolbar()}else{this.hide()}k.preventDefault()}else{if(k.keyCode===13){k.preventDefault();this.play()}}}}}}},onUILayerTouch:function(p){if(this.isZoomActive()){switch(p.action){case h.TouchElement.ActionTypes.gestureChange:this.zoomPanRotate.zoomRotate(p.scale,(this.settings.allowRotationOnUserZoom)?p.rotation:0);break;case h.TouchElement.ActionTypes.gestureEnd:this.zoomPanRotate.setStartingScaleAndRotation(p.scale,(this.settings.allowRotationOnUserZoom)?p.rotation:0);break;case h.TouchElement.ActionTypes.touchStart:this.zoomPanRotate.panStart(p.point);break;case h.TouchElement.ActionTypes.touchMove:this.zoomPanRotate.pan(p.point);break;case h.TouchElement.ActionTypes.doubleTap:this.destroyZoomPanRotate();this.toggleToolbar();break;case h.TouchElement.ActionTypes.swipeLeft:this.destroyZoomPanRotate();this.next();this.toggleToolbar();break;case h.TouchElement.ActionTypes.swipeRight:this.destroyZoomPanRotate();this.previous();this.toggleToolbar();break}}else{switch(p.action){case h.TouchElement.ActionTypes.touchMove:case h.TouchElement.ActionTypes.swipeLeft:case h.TouchElement.ActionTypes.swipeRight:this.fadeOutToolbarIfVisible();this.carousel.onTouch(p.action,p.point);break;case h.TouchElement.ActionTypes.touchStart:case h.TouchElement.ActionTypes.touchMoveEnd:this.carousel.onTouch(p.action,p.point);break;case h.TouchElement.ActionTypes.tap:this.toggleToolbar();break;case h.TouchElement.ActionTypes.doubleTap:if(this.settings.target===e){p.point.x-=h.DOM.windowScrollLeft();p.point.y-=h.DOM.windowScrollTop()}var n=this.cache.images[this.currentIndex].imageEl,o=e.parseInt(h.DOM.getStyle(n,"top"),10),k=e.parseInt(h.DOM.getStyle(n,"left"),10),l=k+h.DOM.width(n),m=o+h.DOM.height(n);if(p.point.x<k){p.point.x=k}else{if(p.point.x>l){p.point.x=l}}if(p.point.y<o){p.point.y=o}else{if(p.point.y>m){p.point.y=m}}this.createZoomPanRotate();if(this.isZoomActive()){this.zoomPanRotate.zoomAndPanToPoint(this.settings.doubleTapZoomLevel,p.point)}break;case h.TouchElement.ActionTypes.gestureStart:this.createZoomPanRotate();break}}h.Events.fire(this,{type:a.EventTypes.onTouch,target:this,point:p.point,action:p.action})},onCarouselSlideByEnd:function(k){this.currentIndex=k.cacheIndex;if(!h.isNothing(this.toolbar)){this.toolbar.setCaption(this.currentIndex);this.toolbar.setToolbarStatus(this.currentIndex)}h.Events.fire(this,{type:a.EventTypes.onDisplayImage,target:this,action:k.action,index:k.cacheIndex})},onToolbarTap:function(k){switch(k.action){case c.ToolbarAction.next:this.next();break;case c.ToolbarAction.previous:this.previous();break;case c.ToolbarAction.close:this.hide();break;case c.ToolbarAction.play:this.play();break}h.Events.fire(this,{type:a.EventTypes.onToolbarTap,target:this,toolbarAction:k.action,tapTarget:k.tapTarget})},onMouseWheel:function(l){var m=h.Events.getWheelDelta(l),k=l.timeStamp-(this.mouseWheelStartTime||0);if(k<this.settings.mouseWheelSpeed){return}this.mouseWheelStartTime=l.timeStamp;if(this.settings.invertMouseWheel){m=m*-1}if(m<0){this.next()}else{if(m>0){this.previous()}}},onCarouselSlideshowStart:function(k){h.Events.fire(this,{type:a.EventTypes.onSlideshowStart,target:this})},onCarouselSlideshowStop:function(k){h.Events.fire(this,{type:a.EventTypes.onSlideshowStop,target:this})},onToolbarBeforeShow:function(k){h.Events.fire(this,{type:a.EventTypes.onBeforeCaptionAndToolbarShow,target:this})},onToolbarShow:function(k){h.Events.fire(this,{type:a.EventTypes.onCaptionAndToolbarShow,target:this})},onToolbarBeforeHide:function(k){h.Events.fire(this,{type:a.EventTypes.onBeforeCaptionAndToolbarHide,target:this})},onToolbarHide:function(k){h.Events.fire(this,{type:a.EventTypes.onCaptionAndToolbarHide,target:this})},onZoomPanRotateTransform:function(k){h.Events.fire(this,{target:this,type:a.EventTypes.onZoomPanRotateTransform,scale:k.scale,rotation:k.rotation,rotationDegs:k.rotationDegs,translateX:k.translateX,translateY:k.translateY})}})}(window,window.klass,window.Code.Util,window.Code.PhotoSwipe.Cache,window.Code.PhotoSwipe.DocumentOverlay,window.Code.PhotoSwipe.Carousel,window.Code.PhotoSwipe.Toolbar,window.Code.PhotoSwipe.UILayer,window.Code.PhotoSwipe.ZoomPanRotate)); var ItemsCollection=Backbone.Collection.extend({skip:0,DEFUALT_TAKE_VALUE:25,_selectedItem:null,initialize:function(){this._itemsReadyCb=[];this.bind("itemClicked",this.onItemClicked,this);this._alreadyGotData=false;this.EOF=false},successCallback:function(a,d,c){this._alreadyGotData=true;if(d!==executeTypeEnum.HIT_AND_RUN_SILENT){this.reset()}var e=this.parse(a);if(e.models&&e.models.length>0){this.add(e.models);e.models=this.last(e.models.length);this.skip+=e.models.length;if(this.isEOF(a,e)){this.EOF=true;this.trigger("eof")}if(a.paging&&a.paging.next){this._next=a.paging.next}}else{this.EOF=true;this.trigger("eof")}e.isEOF=this.EOF;this.trigger("getItemsSuccess",e.metaData,e,c);if(this.length>0&&this._itemsReadyCb.length>0){var b=this;$.each(this._itemsReadyCb,function(f,g){Utils.Helpers.funcWrapper(g)(b)});this._itemsReadyCb=[]}},isEOF:function(a,b){if(a.paging){if(a.paging.next){return false}else{return true}}else{if((b.models.length===0)||b.models.length<this.getParams().take){return true}}return false},isExpiredCache:function(){if(this.length==0){return false}var a=this.getParams();a.skip=0;a.take=a.take||this.DEFUALT_TAKE_VALUE;return !Services.isCacheValid(this.getServiceName(),a)},getExecuteOptions:function(b){var a={executeType:executeTypeEnum.FORCE_NETWORK};if(_.isNumber(b)){b={executeType:b}}else{if(!$.isPlainObject(b)){b={}}}return $.extend({},a,b)},getNextItems:function(e,c){var e=this.getExecuteOptions(e);this._alreadyGotData=false;var b=function(f){if(!this._alreadyGotData){this.trigger("loadingStateChanged",false);this.trigger("getItemsFail",e.executeType,f,c)}};var a=function(f,g){this.trigger("loadingStateChanged",false);this.successCallback(f,e.executeType,c)}.hitch(this);if(this.invalid){this.EOF=true;this.trigger("eof");b.hitch(this)(true);return}if(e.executeType!==executeTypeEnum.HIT_AND_RUN_SILENT){this.resetParams()}this.trigger("loadingStateChanged",true);this.trigger("getNextItems");var d=this.getParams();d.skip=this.skip;d.take=d.take||this.DEFUALT_TAKE_VALUE;Services.executeService(this.getServiceName(),d,a.hitch(this),b.hitch(this),e,this._next)},onItemClicked:function(a){var b=!!(this._selectedItem&&this._selectedItem.cid===a.cid);if(this._selectedItem&&!b){this._selectedItem.set({selected:false})}if(!b){this._selectedItem=a;this._selectedItem.set({selected:true})}this.trigger("itemSelected",a,b)},onItemsReady:function(a){if(this.length>0){Utils.Helpers.funcWrapper(a)(this)}else{this._itemsReadyCb.push(a)}},parse:function(a){return null},getServiceName:function(){return""},getParams:function(){return{}},resetParams:function(){this.EOF=false;this._next=null;this.skip=0},reset:function(){Backbone.Collection.prototype.reset.apply(this);this.resetParams()}}); var ItemModel=Backbone.Model.extend({defaults:{selected:false}}); var BaseTemplateModel=Backbone.Model.extend({defaults:{selectedItem:null},onItemSelected:function(b){var a=this.get("selectedItem");var c=(a&&a.cid===b.cid);if(a&&!c){a.set({selected:false})}if(!c){this.set({selectedItem:b})}this.trigger("itemSelected",[b,c])}}); var ItemsModel=Backbone.Model.extend({defaults:{items:null,loadingType:loadingTypeEnum.NORMAL,isLoading:false},initialize:function(){var a=this.createItemsCollection();if(a){this.set({items:a});a.bind("itemSelected",this._onItemSelected,this);a.bind("loadingStateChanged",this._onLoadingStateChanged,this)}},_onLoadingStateChanged:function(a){this.set("isLoading",a)},createItemsCollection:function(){return new ItemsCollection()},_onItemSelected:function(a,b){this.trigger("itemSelected",a,b)},isExpiredCache:function(){var a=this.get("items");if(a){return a.isExpiredCache()}else{return false}},getItems:function(c,b){var a=this.get("items");if(a){a.getNextItems(c,b)}}}); GoogleMapsView=Backbone.View.extend({className:"google-map-view scroll_wrapper",initialize:function(){this._map=null;this._markersArray=[];this._infoWindow=null;this._loadGoogleMaps(this.options.callback)},render:function(){this._infoWindow=new google.maps.InfoWindow();var a={zoom:8,mapTypeId:google.maps.MapTypeId.ROADMAP};a.disableDefaultUI=(DEVICE!==deviceTypeEnum.android);if(this.options.googleOptions){$.extend(a,this.options.googleOptions)}this._map=new google.maps.Map(this.el,a);this.addMarkers(this.options.markers);return this},createMarker:function(a,f,h,j,k,g){var b=new google.maps.MarkerImage("marker-panel.png",new google.maps.Size(100,39),new google.maps.Point(0,0),new google.maps.Point(50,39));var e={coord:[1,1,1,20,18,20,18,1],type:"poly"};var d=new google.maps.LatLng(f,h);var c=new google.maps.Marker({position:d,map:a,title:j,address:k});var i=new GoogleMarkerLabel({map:a,marker:c,cbMarkerClicked:g});i.bindTo("position",c,"position");i.set("title",j);i.set("address",k);c.label=i;return c},addMarker:function(f,g,c,e){if(e!=""){}var h=e.header||"";var b=e.address||"";var a=this.createMarker(this._map,g,c,h,b,this._onMarkerClicked);this._markersArray[f]=a;var d=this;google.maps.event.addListener(a,"click",function(){d._showMarker.hitch(d)(a)})},_onMarkerClicked:function(a){if(navigator.google_map&&navigator.google_map.showDirections){navigator.google_map.showDirections(null,null,{lat:a.position.lat(),lng:a.position.lng()})}},clearAllMarkers:function(){for(markerId in this._markersArray){var a=this._markersArray[markerId];a.setMap(null)}this._markersArray=[]},addMarkers:function(g){if(!(g&&g.length)){return}var e=new google.maps.LatLngBounds();for(var c=0;c<g.length;c++){var a=g[c];var f=a.location?a.location.lat:0;var b=a.location?a.location.lng:0;this.addMarker(c+1,f,b,{header:a.header,address:a.address});var d=new google.maps.LatLng(f,b);e.extend(d)}this.refresh(function(){if(g.length>1){this._map.fitBounds(e)}else{this.showMarkerById(1)}}.hitch(this))},_showMarker:function(a){this._map.setCenter(a.position)},showMarkerById:function(b){var a=this._markersArray[b];if(a){this._showMarker(a)}},refresh:function(b){var a=this;setTimeout(function(){google.maps.event.trigger(a._map,"resize");a._map.setZoom(a._map.getZoom());if(typeof(b)==="function"){b()}},1)},_loadGoogleMaps:function(a){$.getScript("http://www.google.com/jsapi?key=ABCDEFG",function(){google.load("maps","3",{other_params:"sensor=false",callback:function(){a()}})})}}); function GoogleMarkerLabel(a){this.setValues(a);this.$title=$('<div class="google-marker-title"></div>');this.$address=$('<div class="google-marker-address"></div>');this.$text=$('<div class="google-marker-text"></div>').append($("<div></div>").append(this.$title).append(this.$address)).append('<div class="google-marker-arrow"><div class="sprite sprite-map_direct_icon"></div></div>');this.$div=$('<div class="google-marker-label"></div>').append(this.$text).append($('<div class="google-marker-bubble-triangle"></div>'));return this}GoogleMarkerLabel.prototype.onAdd=function(){var e=this.getPanes().overlayImage;e.appendChild(this.$div[0]);var c=this.$text;var a=this.get("marker");var b=this.get("cbMarkerClicked");if(b&&typeof(b)==="function"&&a){google.maps.event.addListener(a.map,"click",function(k){var f=k.pixel.x;var l=k.pixel.y+Utils.Html.getHeaderHeight();var h=c.offset().left;var g=c.offset().left+c.width()+parseInt(c.css("marginLeft"))+parseInt(c.css("marginRight"))+parseInt(c.css("paddingLeft"))+parseInt(c.css("paddingRight"));var j=c.offset().top;var i=c.offset().top+c.height()+parseInt(c.css("marginTop"))+parseInt(c.css("marginBottom"))+parseInt(c.css("paddingTop"))+parseInt(c.css("paddingBottom"));if((f>=h&&f<=g)&&(l>=j&&l<=i)){b(a)}})}var d=this;this.listeners_=[google.maps.event.addListener(this,"position_changed",function(){d.draw()}),google.maps.event.addListener(this,"text_changed",function(){d.draw()}),google.maps.event.addListener(this,"zindex_changed",function(){d.draw()})]};GoogleMarkerLabel.prototype.onRemove=function(){this.$div.remove();for(var b=0,a=this.listeners_.length;b<a;++b){google.maps.event.removeListener(this.listeners_[b])}};GoogleMarkerLabel.prototype.draw=function(){var b=this.getProjection();var a=b.fromLatLngToDivPixel(this.get("position"));this.$div.css({left:a.x+"px",top:a.y+"px",display:"block",zIndex:this.get("zIndex")});var d=this.get("title");var c=this.get("address");if(!d||d===""){d=c;c=null;this.$title.css("marginTop",8)}this.$title.html(d);if(!c||c===""){this.$address.remove()}else{this.$address.html(c)}};GoogleMarkerLabel.prototype.toggle=function(){this.$div.toggle()};var GoogleMarkerLabelClassCreator={createClass:function(){var b=new google.maps.OverlayView;for(var a in b){GoogleMarkerLabel.prototype[a]=b[a]}}}; (function(){var d;var b=false;var c=function(){if(d){d.$el.one("pageshow",function(){b=false});$.mobile.changePage("#"+d.id,{transition:"slide",reverse:IS_RTL})}};var a=function(f,e){if(PLATFORM==platformEnum.nativeApp){if(DEVICE==deviceTypeEnum.android){navigator.uiManager.showMap(null,null,e.toJSON())}else{if(DEVICE==deviceTypeEnum.iphone){navigator.appManager.showOnMap(null,null,e.toJSON())}}return}if(b){return}b=true;d=f.find(".map-page-view");if(d){d.remove()}e.set({callback:c});d=new MapPageView({model:e,id:"map_view_"+Utils.Helpers.generateGUID()});d.$el.attr("data-buttons","back");f.append(d.el);d.render()};window.MapManager={show_on_map:a}})(); var MediaPlayerModel=Backbone.Model.extend({defaults:{statusArrowUp:true,currentTrack:null,currentTrackIndex:-1,currentSeekTime:0,currentTrackDuration:0,timeForward:true},initialize:function(){}}); MediaPlayerBottomBarView=Backbone.View.extend({className:"media_player_bottom_bar",events:{"tap .media_player_time":"onTimeClick","tap .media_player_arrow":"onMinimizeMaximizeClick"},initialize:function(){this.model.bind("change:time",this.onTimeChanged.hitch(this));this.model.bind("change:currentTrack",this.onTrackChanged.hitch(this));this.model.bind("change:statusLoading",this.onStatusLoadingChanged.hitch(this));this.model.bind("change:statusArrowUp",this.onStatusArrowChanged.hitch(this));this.timeForward=true},render:function(){var b=this.options.template;var a=b.bottom_bar();this.$el.html(a);this.updateArrowDisplay(this.model.get("statusArrowUp"));return this},updateArrowDisplay:function(b){var a=this.$el.find(".media_player_arrow div");if(b){a.removeClass("sprite-arrowDown").addClass("sprite-arrowUp")}else{a.removeClass("sprite-arrowUp").addClass("sprite-arrowDown")}},onTimeChanged:function(d,b){var a=this.$el.find(".media_player_time");var e=this.model.get("timeForward");if(e){a.text(Utils.TimeDate.durationDisplayTime(b))}else{var c=this.model.get("duration");a.text("-"+Utils.TimeDate.durationDisplayTime(c-b))}},onTrackChanged:function(b,a){var c=this.$el.find(".media_player_song_name");c.text(a.title)},onStatusLoadingChanged:function(a,d){var c=this.$el.find(".media_player_loading_indicator");var b=this.$el.find(".media_player_equalizer");if(d){b.removeClass("media_player_equalizer sprite sprite-equalizer").addClass("media_player_loading_indicator mask_sprite sprite-ajax-loader_small spin clr_audioPlayer_icn")}else{c.removeClass("media_player_loading_indicator mask_sprite sprite-ajax-loader_small spin clr_audioPlayer_icn").addClass("media_player_equalizer sprite sprite-equalizer")}},onTimeClick:function(b){b.preventDefault();var c=this.model.get("timeForward");this.model.set({timeForward:!c});var a=this.model.get("time");this.onTimeChanged(a,a)},onMinimizeMaximizeClick:function(a){a.preventDefault();this.trigger("minimizeMaximizeClick")},onStatusArrowChanged:function(b,a){this.updateArrowDisplay(a)}}); MediaPlayerTopBarView=Backbone.View.extend({className:"media_player_top_bar",events:{"tap .media_player_prev_button":"onPrevClick","tap .media_player_playpause_button":"onPlayPauseClick","tap .media_player_next_button":"onNextClick"},initialize:function(){this.model.bind("change:statusPlaying",this.onStatusChanged.hitch(this),this);this.model.bind("change:time",this.onTimeChange.hitch(this),this)},render:function(){var b=this.options.template;var a=b.top_bar();this.$el.html(a);this._$seekBar=this.$el.find(".media_player_seek_bar_background");this._$seekBar.bind(TouchHandler.START_EVENT,this._seekbarTouchStartHandler.hitch(this));this._$seekBar.bind(TouchHandler.MOVE_EVENT,this._seekbarTouchMoveHandler.hitch(this));this._$seekBar.bind(TouchHandler.END_EVENT,this._seekbarTouchEndHandler.hitch(this));return this},onPrevClick:function(a){a.preventDefault();this.trigger("prevClicked")},onPlayPauseClick:function(a){a.preventDefault();this.trigger("playPauseClicked")},onNextClick:function(a){a.preventDefault();this.trigger("nextClicked")},onTimeChange:function(c,a){if(!this._touchSeekStarted){var b=this.model.get("duration");this._updateSeekBar(a/b)}},_updateSeekBar:function(a){this.$el.find(".media_player_seek_bar_position").width(a*100+"%")},_updateSeekInTouch:function(c,a){var b=TouchHandler.getXFromEvent(c)-a.left;b=Math.max(Math.min(b,this._$seekBar.width()),0);this._newSeek=b/this._$seekBar.width();this._updateSeekBar(this._newSeek)},_seekbarTouchStartHandler:function(c){var d=this.model.get("statusLoading");var b=this.model.get("duration");if((b==0)||d){return true}this._touchSeekStarted=true;if(c.originalEvent){c=c.originalEvent}if(c.preventDefault){c.preventDefault()}var a=$(c.target).offset();this._updateSeekInTouch(c,a);return true},_seekbarTouchMoveHandler:function(b){if(!this._touchSeekStarted){return false}if(b.originalEvent){b=b.originalEvent}if(b.preventDefault){b.preventDefault()}var a=$(b.target).offset();this._updateSeekInTouch(b,a);return true},_seekbarTouchEndHandler:function(c){if(this._touchSeekStarted){this._touchSeekStarted=false;var b=this.model.get("duration");var a=this._newSeek*b;this.model.set({timePosition:a});this._touchSeekStarted=false}},onStatusChanged:function(c,a){var b=$(".media_player_playpause_button div");if(a){b.removeClass("sprite-play").addClass("sprite-pause")}else{b.removeClass("sprite-pause").addClass("sprite-play")}}}); MediaPlayerView=Backbone.View.extend({className:"media_player_root clr_audioPlayer_brdr",initialize:function(){this._player=new AudioPlayer();this._player.registerCurrentTimeChanged(this._onCurrentTimeChanged.hitch(this));this._player.registerLoadedMetaData(this._onLoadedMetaData.hitch(this));this._player.registerModeChanged(this._onModeChanged.hitch(this));this._player.registerErrorPlaying(this._onErrorPlaying.hitch(this));this._player.registerMediaEnded(this._onMediaEnded.hitch(this));this.timeSign=true;this.model.bind("change:timePosition",this.onTimePositionChanged.hitch(this),this);this.model.bind("change:statusArrowUp",this._renderBackgroundColor.hitch(this),this)},render:function(){var a=this.options.templateId;if(!a||!audioPlayerTemplates[a]){a="1"}var b=mediaPlayerTemplates[a];this.barTop=new MediaPlayerTopBarView({model:this.model,template:b});this.barTop.bind("prevClicked",this.onPrev.hitch(this));this.barTop.bind("playPauseClicked",this.onPlayPause.hitch(this));this.barTop.bind("nextClicked",this.onNext.hitch(this));this.barBottom=new MediaPlayerBottomBarView({model:this.model,template:b});this.barBottom.bind("minimizeMaximizeClick",this.onMinimizeMaximizeClick.hitch(this),this);this.$el.html(this.barTop.render().el).append(this.barBottom.render().el).attr("dir","ltr");this._updateBarsVisibility(this.model.get("statusArrowUp"));this._renderBackgroundColor();return this},_updateBarsVisibility:function(a){if(a){$(this.barTop.el).show()}else{$(this.barTop.el).hide()}},_renderBackgroundColor:function(){if(this.model.get("statusArrowUp")){this.$el.addClass("clr_audioPlayer_bg").removeClass("clr_audioPlayer_bgMini")}else{this.$el.addClass("clr_audioPlayer_bgMini").removeClass("clr_audioPlayer_bg")}},destroyPlayer:function(){this._player.pause()},_onCurrentTimeChanged:function(a){if(!this._player.isLoading()){this.model.set({time:a})}},_onLoadedMetaData:function(){this.model.set({duration:this._player.getDuration()})},_onModeChanged:function(d,a){var b=this._player.isLoading();var c=((d===this._player.modeEnum.play)||(d===this._player.modeEnum.loading));this.model.set({statusLoading:b,statusPlaying:c})},_onErrorPlaying:function(c){var a=this.$el.parent().is(":visible");if(!a){return}var b="";if(c===this._player.errorEnum.noPlayer){if(PLATFORM===platformEnum.simulator){b=_T("DialogMessageAudioNotSupportedSimulator")}else{b=_T("DialogMessageAudioNotSupportedDevice")}}else{if(c===this._player.errorEnum.errorOccured){if(PLATFORM===platformEnum.simulator){b=_T("DialogMessageAudioTypeNotSupportedSimulator")}else{b=_T("DialogMessageAudioTypeNotSupportedDevice")}}}conduitApi.UI.showToastMessage(null,null,b,this.$el)},_onMediaEnded:function(){this.onNext()},onTimePositionChanged:function(a,b){this._player.setCurrentTime(b)},onPrev:function(){var a=this.model.get("currentTrackIndex");if(a>0){this.play(a-1)}else{this._player.setCurrentTime(0)}},onPlayPause:function(){if(this._player.getMode()===this._player.modeEnum.stop){this._player.play()}else{this._player.pause()}},onNext:function(){var a=this.model.get("tracks");var b=this.model.get("currentTrackIndex");if(b<a.length-1){this.play(b+1)}},onMinimizeMaximizeClick:function(){var a=this.model.get("statusArrowUp");a=!a;this.model.set({statusArrowUp:a});this._updateBarsVisibility(a)},setTracks:function(a){this.model.set({tracks:a.concat()})},play:function(c){var b=this.model.get("tracks");if(!b||typeof(c)==="undefined"||c<0||c>=b.length){return}var a=b[c];this.model.set({currentTrack:a,currentTrackIndex:c,currentSeekTime:0});this._player.setUrl(a.stream.url);this._player.play()}}); var mediaPlayerTemplates={"1":{top_bar:_.template('<div class="media_player_play_buttons"><div class="media_player_prev_button"><div class="mask_sprite sprite-prev clr_audioPlayer_icn" /></div><div class="media_player_playpause_button"><div class="mask_sprite sprite-play clr_audioPlayer_icn" /></div><div class="media_player_next_button"><div class="mask_sprite sprite-next clr_audioPlayer_icn" /></div></div><div class="media_player_seek_bar"><div class="media_player_seek_bar_background clr_audioPlayer_seekBar_bg clr_audioPlayer_seekBar_brdr"><div class="media_player_seek_bar_position clr_audioPlayer_seekBar_seekFill"></div></div></div>'),bottom_bar:_.template('<table class="media_player_bottom_bar"><tr><td><div class="media_player_equalizer sprite sprite-equalizer"></div></td><td><div class="media_player_time clr_audioPlayer_txt">00:00</div></td><td class="media_player_song_name_cell clr_audioPlayer_hdlTxt"><div class="media_player_song_name ellipsis"></div></td><td class="media_player_arrow"><div class="mask_sprite sprite-arrowUp clr_audioPlayer_icn"></div></td></tr></table>')}}; var UserModel=ItemModel.extend({defaults:{id:"",img:"",name:"",meta:{company:"",country:"",field:"",job_title:"",summary:""}},initialize:function(){var a=this.get("img");if(a&&a.original){this.set({img:a.original})}var b=this.get("meta");b.company=this.get("company")||b.company;b.country=this.get("country")||b.country;b.field=this.get("field")||b.field;b.job_title=this.get("jobTitle")||b.job_title;b.summary=this.get("summary")||b.summary},getShareInfo:function(){return{}}}); var UserProfileView=Backbone.View.extend({className:"user_details_container clr_contTypeB_bg clr_contTypeB_brdr",render:function(){var a=$.extend({},this.model.toJSON());var b=[];if(a.meta.company){b.push(a.meta.company)}if(a.meta.field){b.push(a.meta.field)}if(a.meta.country){b.push(a.meta.country)}a.extraInfo=b.join(", ");this.$el.append(userProfileTemplates.userProfile(a));return this}}); var userProfileTemplates={};userProfileTemplates.userProfile=_.template('<% if (img) { %><div class="user_profile_image sliced_image" style="background-image:url(\'<%= img %>\');"></div><% } %><% if (name) { %> <div class="user_profile_name clr_contTypeB_hdlTxt"><%= name %></div><% } %><% if (meta.job_title) { %><div class="user_profile_title clr_contTypeB_txt"><%= meta.job_title %></div><% } %><% if (extraInfo) { %><div class="user_profile_extraInfo clr_contTypeB_txt"><%=extraInfo %></div><% } %>'); var InputPanelModel=Backbone.Model.extend({defaults:{cbSend:null},initialize:function(){}}); var InputPanelView=Backbone.View.extend({className:"input_panel",render:function(){var a=$.extend({},this.options.options);this.$el.html(inputPanelTemplates.inputPanel(a));this._$okBtn=this.$(".button_send");this._$okBtn.tap(this._onSend.hitch(this));this._$textArea=this.$(".text_input");this._$textArea.keyup(this._inputEdit.hitch(this));this._inputEdit();return this},_onSend:function(){if(!this._$okBtn.hasClass("disabled")){var b=this._$textArea.val();this._$textArea.val("");this._inputEdit();var a=this.model.get("cbSend");Utils.Helpers.funcWrapper(a)(b)}},_inputEdit:function(){if(this._$textArea.val()===""){this._$okBtn.addClass("disabled")}else{this._$okBtn.removeClass("disabled")}}}); var inputPanelTemplates={inputPanel:_.template('<div class="inputPanel clr_comment_bg clr_contTypeB_subTxt"><div class="input_container"><textarea rows="1" class="text_input clr_form_input_bg clr_form_input_brdr clr_form_input_txt" placeholder="<%= placeHolderTxt %>"><%= initialTxt %></textarea></div><div class="button_send clr_contTypeB_btn_bg clr_contTypeB_btn_brdr clr_contTypeB_btn_hdlTxt" data-role="button"><%= sendBtnTxt %></div></div>')}; var ChatModel=ItemsModel.extend({defaults:{discussionId:null,participants:[]},createItemsCollection:function(){var a=new MessagesCollection();a.discussionId=this.get("discussionId");a.participants=this.get("participants");return a},findDiscussionId:function(c,d){var a=this.get("discussionId");if(a){Utils.Helpers.funcWrapper(c)(a);return}var b=new InboxCollection(null,{});var e=function(f,k){var g=this.get("participants");var j=function(n){if(!n||n.length!==g.length){return false}for(var m=0;m<n.length;m++){for(var l=0;l<g.length;l++){if(n[m].id===g[l].id){break}}if(l===g.length){return false}}return true};for(var h=0;h<f.length;h++){if(j(f[h].participants)){a=f[h].discussionId;this.set({discussionId:a});this.get("items").discussionId=a;Utils.Helpers.funcWrapper(c)(a);return}}Utils.Helpers.funcWrapper(d)()};b.bind("getItemsSuccess",e,this);b.bind("getItemsFail",d,this);b.getNextItems(executeTypeEnum.FORCE_NETWORK)},sendMessage:function(h,d,j){var b=ProfileManager.getUserId();var l={text:j};var a=null;if(this.get("participants").length){a=this.get("participants")[0].id}var f=this;var g=this.get("items");var e=function(n){var m=n.Id;f.set({discussionId:m});g.discussionId=m;Utils.Helpers.funcWrapper(h)()};var k={postParams:{toId:a,discussionId:this.get("discussionId"),message:l}};var i={fromId:b};Services.executeService("DISCUSSION_MESSAGES_SEND_POST",i,e,d,k);var c={fromId:b,ts:new Date().getTime(),message:l};var l=g.createChatMessageModel(c);g.add(l,{isNew:true})},addUserdMessage:function(a,b,e){var d=this.get("items");var c=d.createChatMessageModel(e);d.add(c,{isNew:true})}}); var ChatMessageModel=Backbone.Model.extend({defaults:{fromId:"",name:"",img:"",message:{text:""},ts:0,timeStr:"",isMe:false}}); var MessagesCollection=ItemsCollection.extend({model:ChatMessageModel,getServiceName:function(){return"DISCUSSION_MESSAGES_GET"},parse:function(a){var c=[];if(a.length){for(var b=0;b<a.length;b++){if(a[b].ts){a[b].ts=a[b].ts*1000}c[b]=this.createChatMessageModel(a[b])}}return{models:c}},createChatMessageModel:function(c){c.isMe=(ProfileManager.getUserId()===c.fromId);var b={};if(c.isMe){b=$.extend(b,ProfileManager.getUserProfile());if(b.img&&b.img.original){b.img=b.img.original}}else{for(var a=0;a<this.participants.length;a++){if(this.participants[a].id===c.fromId){b=this.participants[a];break}}}c.name=b.name;c.img=b.img;c.timeStr=new Date(c.ts).format("dateTime");return new ChatMessageModel(c)},getParams:function(){var a={skip:this.skip,discussionId:this.discussionId};return a}}); ChatPageView=Backbone.View.extend({className:"chat_page",initialize:function(){this._initOptions();this.$el.attr({"data-role":"page","data-buttons":"back refresh"});this.$el.bind("pageshow",this.onPageShow.hitch(this));this.$el.bind("pagehide",this.onPageHide.hitch(this));this.$el.bind("refresh",this.handleRefreshClick.hitch(this));this.$el.bind("silentRefresh",this.handleSilentRefresh.hitch(this));var a=this.model.get("items");if(a){a.bind("getItemsSuccess",this._onGetItemsSuccess,this);a.bind("getNextItems",this._renderShowMoreButton,this);a.bind("getItemsFail",this.onGetDataFail,this);a.bind("add",this._renderOneItem,this);a.bind("reset",this._reset,this);a.bind("eof",this._renderShowMoreButton,this)}},_initOptions:function(){var a={showMoreStr:_T("HtmlTextPaginationShowMoreItems"),loadingStr:_T("HtmlTextPaginationLoadingItems"),failStr:_T("ToastMessagePaginationFailedGetItems")};this.options=$.extend({},a,this.options)},onPageShow:function(){var a={};if(!this.alreadyOpen){this.alreadyOpen=true;a.initialTxt=this.options.message}inputPanelDriver.openPanel(this.onSendMessage.hitch(this),null,a);this.refreshing=true;cqm.showLoading(_T("HtmlTextPaginationRefreshItems"),this.$el,true);var c=function(){this.model.getItems(executeTypeEnum.FORCE_NETWORK)};var b=function(){this.refreshing=false;cqm.hideLoading(this.$el)};this.model.findDiscussionId(c.hitch(this),b.hitch(this))},onPageHide:function(){inputPanelDriver.closePanel(null,null)},render:function(){this.$el.html(chatTemplates.chatPage());var b=this.$(".header_container");var a=new ChatHeaderView({model:this.model});b.html(a.render().el);this.$itemsList=this.$(".messages_list");this.$myScrollWrapper=this.$(".scroll_wrapper");this._reset();this._renderItems();this._renderShowMoreButton();Scrolling.init(this.$myScrollWrapper);this._scrollDown();return this},_reset:function(){this.$itemsList.html("")},_renderOneItem:function(c,d,a){var b=this.createItemView(c);if(a&&a.isNew){this.$itemsList.append(b.render().el);this._refreshScroll();this._scrollDown()}else{this.$itemsList.prepend(b.render().el)}},_scrollDown:function(){var a=this.$myScrollWrapper.height();var b=this.$myScrollWrapper.find(".scroller").height();var c=b;setTimeout(function(){if(c>0){Scrolling.scrollTo(this.$myScrollWrapper,c,500)}}.hitch(this),500)},createItemView:function(b){if(b.get("isMe")){var a=new MyChatMessageView({model:b})}else{var a=new UserChatMessageView({model:b})}return a},_renderItems:function(){var a=this.model.get("items");if(a){a.each(this._renderOneItem.hitch(this))}},handleRefreshClick:function(){if(this.model.get("discussionId")){this.refreshing=true;cqm.showLoading(_T("HtmlTextPaginationRefreshItems"),this.$el,true);this.model.getItems(executeTypeEnum.FORCE_NETWORK)}},handleSilentRefresh:function(){},_onGetItemsSuccess:function(a,c,b){if(this.refreshing){this.refreshing=false;cqm.hideLoading(this.$el)}this._renderShowMoreButton();this._refreshScroll();this._scrollDown()},_refreshScroll:function(){Scrolling.onContentChanged(this.$myScrollWrapper)},_renderShowMoreButton:function(){},_cbRetry:function(){this.model.getItems(executeTypeEnum.HIT_AND_RUN)},_cbCancel:function(){this.model.set({eof:true})},onGetDataFail:function(c,b){cqm.hideLoading(this.$el);if(PLATFORM!=platformEnum.simulator){if(c===executeTypeEnum.HIT_AND_RUN){var a={title:_T("DialogCaptionError"),message:this.options.failStr,buttons:[{text:_T("ButtonRetry"),cb:this._cbRetry.hitch(this)},{text:_T("ButtonCancel"),cb:this._cbCancel.hitch(this)}]};conduitApi.UI.showDialogBox(null,null,a)}else{conduitApi.UI.showToastMessage(null,null,this.options.failStr,this.$el);this._cbCancel()}}else{if(!b){conduitApi.UI.showToastMessage(null,null,this.options.failStr,this.$el);this._cbCancel()}}},_onShowMoreTap:function(a){a.preventDefault();this.model.getItems(executeTypeEnum.HIT_AND_RUN_SILENT)},onSendMessage:function(a){this.model.sendMessage(null,null,a)}}); var ChatHeaderView=Backbone.View.extend({className:"chat_header clr_contTypeB_bg clr_contTypeB_brdr",render:function(){var d=_T("HtmlTextChatHeaderChattingWith");var b="";var a=this.model.get("participants");for(var c=0;c<a.length;c++){if(c>0){b+=", "}b+=a[c].name}this.$el.html(chatTemplates.header({text:d,name:b}));return this}}); var UserChatMessageView=Backbone.View.extend({tagName:"li",className:"user chat_message",render:function(){var a=this.model.toJSON();a.text=Utils.String.sanitizeText(a.message.text,true);this.$el.html(chatTemplates.userMessage(a));return this}}); var MyChatMessageView=Backbone.View.extend({tagName:"li",className:"my chat_message",render:function(){var a=this.model.toJSON();a.text=Utils.String.sanitizeText(a.message.text,true);this.$el.html(chatTemplates.myMessage(a));return this}}); var chatTemplates={chatPage:_.template('<div class="scroll_wrapper"><div class="scroller">	<div class="header_container"></div>	<div class="show_prev_container"></div>	<ul class="messages_list">	</ul>	<div class="scroll_bug_fix"></div></div></div>'),userMessage:_.template('<div class="message_item clr_liveChat_bubbleOther_bg">	<div class="text size_1 clr_liveChat_bubbleOther_txt <% if(img){ %> with_img <% } %> ">		<%= text %>	</div>	<% if(img){ %>		<div class="icon_image sliced_image" style="background-image:url(\'<%= img %>\')"></div>	<% } %></div><div class="triangle clr_liveChat_bubbleOther_triangle"></div><div class="message_time size_0 clr_liveChat_bubbleOther_subTxt clr_liveChat_bubbleOther_bg">	<%= timeStr %></div>'),myMessage:_.template('<div class="message_item clr_liveChat_bubbleMe_bg">	<div class="text size_1 clr_liveChat_bubbleMe_txt <% if(img){ %> with_img <% } %> ">		<%= text %>	</div>	<% if(img){ %>		<div class="icon_image sliced_image" style="background-image:url(\'<%= img %>\')"></div>	<% } %></div><div class="triangle clr_liveChat_bubbleMe_triangle"></div><div class="message_time size_0 clr_liveChat_bubbleMe_subTxt clr_liveChat_bubbleMe_bg">	<%= timeStr %></div>'),header:_.template('<div class="chat_with clr_contTypeB_subTxt size_title_0">	<%= text %></div><div class="discussion_name clr_contTypeB_hdlTxt size_title_3">	<%= name %></div>')}; var ChooseDialog=(function(){var b={};var a=null;var e=function(){if(a){a.remove();a=null;$(window).unbind("throttledresize",c)}};var d=function(){if(DEVICE===conduitApi.platform.deviceInfo.deviceTypeEnum.android&&PLATFORM==conduitApi.platform.deviceInfo.platformEnum.nativeApp){conduitApi.app.removeBackButton()}e()};b.execute=function(k,m,i,o){o=o||{};if(typeof(o.dialogTitle)==="undefined"){o.dialogTitle=""}if(typeof(o.cancelTitle)==="undefined"){o.cancelTitle=_T("ButtonCancel")}if(typeof(o.dialogWidth)==="undefined"){o.dialogWidth=200}var g={title:o.dialogTitle,cancel:o.cancelTitle};var l=chooseDialogTemplates.dialog_tpl(g);a=$(l);var f=o.dialogWidth;var j=(o.dialogWidth/2)+6;a.find(".choose_dialog").css({width:f+"px",marginLeft:"-"+j+"px"});var n=a.find(".choose_buttons_container");_.each(k,function(q,p){if(typeof(q.returnValue)==="undefined"){q.returnValue=p}if(typeof(q.href)==="undefined"){q.href="javascript:void(null);";var s=true}g={title:q.title,href:q.href};l=chooseDialogTemplates.button_tpl(g);var r=$(l);if(s){r.tap(function(t){t.preventDefault();$.mobile.closeDialog(function(){Utils.Helpers.funcWrapper(m)(q.returnValue);d()});return false})}n.append(r)});var h=a.find(".button_cancel");h.tap(function(p){p.preventDefault();$.mobile.closeDialog(function(){Utils.Helpers.funcWrapper(i)();d()});return false});$.mobile.openDialog(e);if(DEVICE===conduitApi.platform.deviceInfo.deviceTypeEnum.android&&PLATFORM==conduitApi.platform.deviceInfo.platformEnum.nativeApp){conduitApi.app.addBackButton(null,null,null,true,{cb:function(){history.back()},isDialog:true})}$("body").prepend(a);$(window).bind("throttledresize",c);c()};var c=function(){var f=window.innerHeight+"px";var g=window.innerWidth+"px";a.css({height:f,width:g})};return b}()); var chooseDialogTemplates={dialog_tpl:_.template('<div class="choose_dialog_layer clr_appGeneral_dialog_bg"><div class="choose_dialog clr_contTypeB_bg clr_contTypeB_subTxt"><%= title %><div class="choose_dialog_buttons_container"><div class="choose_buttons_container"></div><div class="button_cancel choose_dialog_button clr_appGeneral_dialog_btn2_bg clr_appGeneral_dialog_btn2_brdr clr_appGeneral_dialog_btn2_hdlTxt" data-role="button"><%= cancel %></div></div></div></div>'),button_tpl:_.template('<a href="<%= href %>" target="_blank" class="choose_dialog_button clr_contTypeB_btn_bg clr_contTypeB_btn_brdr clr_contTypeB_btn_hdlTxt" data-role="button"><%= title %></a>')}; var DatePickerDialog=(function(){var s={};var n=null;var i=null;var f=[];var p=null;var q=null;var g=null;var r=0;var o=0;var c=0;var b=1900;var k=2100;var d=function(){$(".ui-page-active").find("input, select, textarea").not(":disabled").addClass("bugfix-android-clickbleed").attr("disabled","disabled")};var l=function(){$(".ui-page-active").find(".bugfix-android-clickbleed").removeClass("bugfix-android-clickbleed").removeAttr("disabled")};var t=function(){setTimeout(l,500);if(n){n.remove();n=null;$(window).unbind("throttledresize",j);$("#app").show()}};var m=function(){if(DEVICE===conduitApi.platform.deviceInfo.deviceTypeEnum.android&&PLATFORM==conduitApi.platform.deviceInfo.platformEnum.nativeApp){conduitApi.app.removeBackButton()}t()};s.execute=function(x,w,y){var v={initialDate:""};y=_.extend({},v,y);var A={ok:_T("HtmlTextDatePickerDialogButtonOk"),cancel:_T("HtmlTextDatePickerDialogButtonCancel"),clear:_T("HtmlTextDatePickerDialogButtonClear")};var z=datePickerDialogTemplates.dialog_tpl(A);n=$(z);i=n.find(".dateDisplay");p=n.find(".display_day");q=n.find(".display_month");g=n.find(".display_year");u(x,w);a(y);$.mobile.openDialog(t);d();if(DEVICE===conduitApi.platform.deviceInfo.deviceTypeEnum.android&&PLATFORM==conduitApi.platform.deviceInfo.platformEnum.nativeApp){conduitApi.app.addBackButton(null,null,null,true,{cb:function(){history.back()},isDialog:true})}$("body").prepend(n);$(window).bind("throttledresize",j);j()};var u=function(B,x){_$okBtn=n.find(".button_ok");_$okBtn.tap(function(E){E.preventDefault();if(!$(E.target).hasClass("disabled")){$.mobile.closeDialog(m);Utils.Helpers.funcWrapper(B)(h())}return false});_$clearBtn=n.find(".button_clear");_$clearBtn.tap(function(E){E.preventDefault();if(!$(E.target).hasClass("disabled")){$.mobile.closeDialog(m);Utils.Helpers.funcWrapper(B)("")}return false});var y=n.find(".button_cancel");y.tap(function(E){E.preventDefault();$.mobile.closeDialog(function(){Utils.Helpers.funcWrapper(x)();m()});return false});var z=n.find(".plus_day");z.tap(function(E){E.preventDefault();if(r<Utils.TimeDate.daysInMonth(o-1,c)){r++}else{r=1}e();return false});var D=n.find(".plus_month");D.tap(function(E){E.preventDefault();if(o<12){o++}else{o=1}e();return false});var v=n.find(".plus_year");v.tap(function(E){E.preventDefault();if(c<k){c++;e()}return false});var C=n.find(".minus_day");C.tap(function(E){E.preventDefault();if(r>1){r--}else{r=Utils.TimeDate.daysInMonth(o-1,c)}e();return false});var w=n.find(".minus_month");w.tap(function(E){E.preventDefault();if(o>1){o--}else{o=12}e();return false});var A=n.find(".minus_year");A.tap(function(E){E.preventDefault();if(c>b){c--;e()}return false})};var h=function(){return Utils.String.addLeadingZeros(c,4)+"-"+Utils.String.addLeadingZeros(o,2)+"-"+Utils.String.addLeadingZeros(r,2)};var a=function(w){f=[0,_T("_month1s"),_T("_month2s"),_T("_month3s"),_T("_month4s"),_T("_month5s"),_T("_month6s"),_T("_month7s"),_T("_month8s"),_T("_month9s"),_T("_month10s"),_T("_month11s"),_T("_month12s")];if(w.initialDate){var v=new Date(w.initialDate)}else{var v=new Date()}r=v.getDate();o=v.getMonth()+1;c=v.getYear()+1900;e()};var e=function(){r=Math.min(r,Utils.TimeDate.daysInMonth(o-1,c));var v=new Date(h());i.html(v.format("dddd, <br> mmmm dd, yyyy"));p.text(r);q.text(f[o]);g.text(c)};var j=function(){var v=$(".app_content_container").height();var w=window.innerWidth+"px";n.css({height:v,width:w})};return s}()); var datePickerDialogTemplates={dialog_tpl:_.template('<div class="datePicker_dialog_layer clr_appGeneral_dialog_bg"><div class="datePicker_dialog clr_comment_bg"><div class="dateDisplay"></div><div class="seperator_line"></div><div class="datePicker_dialog_buttons_container"><div class="plus_day inc_dec_button inc" data-role="button">+</div><div class="plus_month inc_dec_button inc" data-role="button">+</div><div class="plus_year inc_dec_button inc" data-role="button">+</div></div><div class="display_day mini_display"></div><div class="display_month mini_display"></div><div class="display_year mini_display"></div><div class="datePicker_dialog_buttons_container"><div class="minus_day inc_dec_button dec" data-role="button">-</div><div class="minus_month inc_dec_button dec" data-role="button">-</div><div class="minus_year inc_dec_button dec" data-role="button">-</div></div><div class="datePicker_dialog_buttons_container control_buttons"><div class="button_cancel set_button" data-role="button"><%= cancel %></div><div class="button_clear set_button" data-role="button"><%= clear %></div><div class="button_ok set_button" data-role="button"><%= ok %></div></div></div></div>')}; var TimePickerDialog=(function(){var j={};var b=null;var p=null;var f=null;var n=null;var a=0;var o=0;var e=function(){$(".ui-page-active").find("input, select, textarea").not(":disabled").addClass("bugfix-android-clickbleed").attr("disabled","disabled")};var m=function(){$(".ui-page-active").find(".bugfix-android-clickbleed").removeClass("bugfix-android-clickbleed").removeAttr("disabled")};var l=function(){setTimeout(m,500);if(b){b.remove();b=null;$(window).unbind("throttledresize",c);$("#app").show()}};var i=function(){if(DEVICE===conduitApi.platform.deviceInfo.deviceTypeEnum.android&&PLATFORM==conduitApi.platform.deviceInfo.platformEnum.nativeApp){conduitApi.app.removeBackButton()}l()};j.execute=function(s,r,t){var q={initialDate:""};t=_.extend({},q,t);var v={ok:_T("HtmlTextDatePickerDialogButtonOk"),cancel:_T("HtmlTextDatePickerDialogButtonCancel"),clear:_T("HtmlTextDatePickerDialogButtonClear")};var u=timePickerDialogTemplates.dialog_tpl(v);b=$(u);p=b.find(".timeDisplay");f=b.find(".display_hour");n=b.find(".display_minute");d(s,r);k(t);$.mobile.openDialog(l);e();if(DEVICE===conduitApi.platform.deviceInfo.deviceTypeEnum.android&&PLATFORM==conduitApi.platform.deviceInfo.platformEnum.nativeApp){conduitApi.app.addBackButton(null,null,null,true,{cb:function(){history.back()},isDialog:true})}$("body").prepend(b);$(window).bind("throttledresize",c);c()};var d=function(u,t){_$okBtn=b.find(".button_ok");_$okBtn.tap(function(x){x.preventDefault();if(!$(x.target).hasClass("disabled")){$.mobile.closeDialog(i);Utils.Helpers.funcWrapper(u)(h())}return false});_$clearBtn=b.find(".button_clear");_$clearBtn.tap(function(x){x.preventDefault();if(!$(x.target).hasClass("disabled")){$.mobile.closeDialog(i);Utils.Helpers.funcWrapper(u)("")}return false});var r=b.find(".button_cancel");r.tap(function(x){x.preventDefault();$.mobile.closeDialog(function(){Utils.Helpers.funcWrapper(t)();i()});return false});var s=b.find(".plus_hour");s.tap(function(x){x.preventDefault();if(a<23){a++}else{a=0}g();return false});var q=b.find(".plus_minute");q.tap(function(x){x.preventDefault();if(o<59){o++}else{o=0}g();return false});var v=b.find(".minus_hour");v.tap(function(x){x.preventDefault();if(a>0){a--}else{a=23}g();return false});var w=b.find(".minus_minute");w.tap(function(x){x.preventDefault();if(o>0){o--}else{o=59}g();return false})};var h=function(){return Utils.String.addLeadingZeros(a,2)+":"+Utils.String.addLeadingZeros(o,2)};var k=function(r){a=0;o=0;if(r.initialDate){var q=r.initialDate.split(":");if(q.length>1){o=parseInt(q[1]);a=parseInt(q[0])}}g()};var g=function(){var r=(a*60+o)*60;var q=new Date(Utils.TimeDate.toUTCTime(r));p.text(q.format("shortTime"));f.text(Utils.String.addLeadingZeros(a,2));n.text(Utils.String.addLeadingZeros(o,2))};var c=function(){var q=$(".app_content_container").height();var r=window.innerWidth+"px";b.css({height:q,width:r})};return j}()); var timePickerDialogTemplates={dialog_tpl:_.template('<div class="timePicker_dialog_layer clr_appGeneral_dialog_bg"><div class="timePicker_dialog clr_comment_bg"><div class="timeDisplay"></div><div class="seperator_line"></div><div class="timePicker_dialog_buttons_container"><div class="plus_hour inc_dec_button inc" data-role="button">+</div><div class="plus_minute inc_dec_button inc" data-role="button">+</div></div><div class="display_hour mini_display"></div><div class="display_minute mini_display"></div><div class="timePicker_dialog_buttons_container"><div class="minus_hour inc_dec_button dec" data-role="button">-</div><div class="minus_minute inc_dec_button dec" data-role="button">-</div></div><div class="timePicker_dialog_buttons_container control_buttons"><div class="button_cancel set_button" data-role="button"><%= cancel %></div><div class="button_clear set_button" data-role="button"><%= clear %></div><div class="button_ok set_button" data-role="button"><%= ok %></div></div></div></div>')}; var UploadImageDialog=(function(){var c={};var a=null;var g=null;var b=null;var f=function(){if(a){a.remove();a=null;$(window).unbind("throttledresize",d);$("#app").show()}};var e=function(){if(DEVICE===conduitApi.platform.deviceInfo.deviceTypeEnum.android&&PLATFORM==conduitApi.platform.deviceInfo.platformEnum.nativeApp){conduitApi.app.removeBackButton()}f()};c.execute=function(k,j,l){var i={imageURI:"",dialogCaption:_T("DialogCaptionLiveAlbumPostPhoto"),cancelTitle:_T("DialogButtonLiveAlbumPostPhotoCancel"),okTitle:_T("DialogButtonLiveAlbumPostPhotoOk"),inputPlaceholder:_T("HtmlTextLiveAlbumAddComment")};l=_.extend({},i,l);var m=uploadImageDialogTemplates.dialog_tpl(l);a=$(m);b=a.find(".button_ok");b.tap(function(o){o.preventDefault();$.mobile.closeDialog(function(){e()});var n=g.val();Utils.Helpers.funcWrapper(k)(n);return false});var h=a.find(".button_cancel");h.tap(function(n){n.preventDefault();$.mobile.closeDialog(function(){Utils.Helpers.funcWrapper(j)();e()});return false});g=a.find(".text_input");$.mobile.openDialog(f);if(DEVICE===conduitApi.platform.deviceInfo.deviceTypeEnum.android&&PLATFORM==conduitApi.platform.deviceInfo.platformEnum.nativeApp){conduitApi.app.addBackButton(null,null,null,true,{cb:function(){history.back()},isDialog:true})}$("body").prepend(a);$(window).bind("throttledresize",d);d()};var d=function(){var h=window.innerHeight+"px";var i=window.innerWidth+"px";a.css({height:h,width:i})};return c}()); var uploadImageDialogTemplates={dialog_tpl:_.template('<div class="uploadImage_dialog_layer clr_appGeneral_dialog_bg"><div class="uploadImage_dialog clr_contTypeB_bg clr_contTypeB_subTxt"><% if (dialogCaption) { %><div class="dialogCaption"><%= dialogCaption %></div><% } %><% if(imageURI){ %><div class="image_wrapper"><img class="image" src="<%= imageURI %>" /></div><% } %><div class="input_container"><textarea rows="3" class="text_input clr_form_input_bg clr_form_input_brdr clr_form_input_txt" placeholder="<%= inputPlaceholder %>" /></div><div class="buttons_container"><div class="button_cancel dialog_button clr_appGeneral_dialog_btn2_bg clr_appGeneral_dialog_btn2_brdr clr_appGeneral_dialog_btn2_hdlTxt" data-role="button"><%= cancelTitle %></div><div class="button_ok dialog_button clr_contTypeB_btn_bg clr_contTypeB_btn_brdr clr_contTypeB_btn_hdlTxt" data-role="button"><%= okTitle %></div></div></div>')}; var CommentDialog=(function(){var c={};var b=null;var g=null;var a=null;var f=function(){if(b){b.remove();b=null;$(window).unbind("throttledresize",d);$("#app").show()}};var e=function(){if(DEVICE===conduitApi.platform.deviceInfo.deviceTypeEnum.android&&PLATFORM==conduitApi.platform.deviceInfo.platformEnum.nativeApp){conduitApi.app.removeBackButton()}f()};c.execute=function(k,j,l){l=l||{};if(typeof(l.okTitle)==="undefined"){l.okTitle=_T("HtmlTextCommentDialogButtonOk")}if(typeof(l.cancelTitle)==="undefined"){l.cancelTitle=_T("HtmlTextCommentDialogButtonCancel")}if(typeof(l.inputPlaceholder)==="undefined"){l.inputPlaceholder=_T("HtmlTextCommentDialogPlaceholder")}var n={ok:l.okTitle,cancel:l.cancelTitle,placeholder:l.inputPlaceholder};var m=commentDialogTemplates.dialog_tpl(n);b=$(m);a=b.find(".button_ok");a.tap(function(p){p.preventDefault();if(!$(p.target).hasClass("disabled")){$.mobile.closeDialog(function(){e()});var o=g.val();Utils.Helpers.funcWrapper(k)(o)}return false});var i=b.find(".button_cancel");i.tap(function(o){o.preventDefault();$.mobile.closeDialog(function(){Utils.Helpers.funcWrapper(j)();e()});return false});g=b.find(".text_input");g.keyup(h);h();$.mobile.openDialog(f);if(DEVICE===conduitApi.platform.deviceInfo.deviceTypeEnum.android&&PLATFORM==conduitApi.platform.deviceInfo.platformEnum.nativeApp){conduitApi.app.addBackButton(null,null,null,true,{cb:function(){history.back()},isDialog:true})}$("body").prepend(b);$(window).bind("throttledresize",d);d();g.focus()};var h=function(){if(g.val()===""){a.addClass("disabled")}else{a.removeClass("disabled")}};var d=function(){var i=window.innerHeight+"px";var j=window.innerWidth+"px";b.css({height:i,width:j})};return c}()); var commentDialogTemplates={dialog_tpl:_.template('<div class="comment_dialog clr_comment_bg clr_contTypeB_subTxt"><div class="input_container clr_comment_panel_bg clr_comment_panel_brdr"><textarea rows="3" class="text_input clr_form_input_bg clr_form_input_brdr clr_form_input_txt" placeholder="<%= placeholder %>" /></div><div class="comment_dialog_buttons_container"><div class="button_cancel comment_dialog_button clr_appGeneral_dialog_btn2_bg clr_appGeneral_dialog_btn2_brdr clr_appGeneral_dialog_btn2_hdlTxt" data-role="button"><%= cancel %></div><div class="button_ok comment_dialog_button clr_contTypeB_btn_bg clr_contTypeB_btn_brdr clr_contTypeB_btn_hdlTxt" data-role="button"><%= ok %></div></div></div>')}; var LoginOverlay=(function(){var a={};a.execute=function(f,e){var c={dialogTitle:_T("HtmlTextLoginOverlayTitle"),loginText:_T("HtmlTextLoginOverlayLogin"),container:$(".ui-page-active"),};var e=$.extend({},c,e);var g=e.container.find(".loginOverlay");if(ProfileManager.getUserId()){Utils.Helpers.funcWrapper(f)(false);g.remove();return}else{if(g.length==1){return}}var b=new LoginOverlayView(e);var d=function(){b.remove();delete b;Utils.Helpers.funcWrapper(f)(true)};b.bind("loginDone",d);e.container.prepend(b.render().el)};return a}()); var loginOverlayTemplates={loginOverlay:_.template('<div class="login_dialog"><div class="dialogTitle"><%= dialogTitle %></div><div class="linkedin_icon sprite sprite-aboutus_linkedin"></div><div class="button_login" data-role="button"><%= loginText %></div><span class="spin" style="position: opacity; static: .9; margin: 0 auto; width: 35px; height: 35px; background-color: transparent; background-image: url(app/interface/web/img/ajax-loader.png);  -webkit-border-radius: 20px; border-radius: 20px; background-size: 35px 35px; margin-top: 24px; "></span></div>')}; LoginOverlayView=Backbone.View.extend({className:"loginOverlay",render:function(){this.$el.html(loginOverlayTemplates.loginOverlay(this.options));var a=this.$(".button_login");a.tap(this._onLoginClick.hitch(this));return this},_onLoginClick:function(){if(this._inProccess){return}var c=this;c._inProccess=true;var b=function(){c._inProccess=false;c.$el.removeClass("processing")};var a=function(){c._inProccess=false;c.$el.removeClass("processing");c.trigger("loginDone")};this.$el.addClass("processing");ProfileManager.login(a,b,ProfileManager.socialProviderEnum.LINKEDIN)}}); var ShareControlHelper={getShareOptionsForModel:function(b){var a=b.get("shareOptions");if(!a){var c=b.get("shareInfo");if(!c&&b.getShareInfo){c=b.getShareInfo()}if(c){var a={allowEdit:true,shareInfo:c}}}return a},addShareControlButton:function(h,e,g,d){if(!h||h.length===0||!e){return}var c=ShareControlHelper.getShareOptionsForModel(e);if(!c||!c.shareInfo){return}var f=this;function b(){function l(){c=ShareControlHelper.getShareOptionsForModel(e);f._shareOptions=c;f.onShareButtonClick()}if(g){g.tap(l)}else{var k=_T("HtmlTextShareButtonText");if(typeof(c.shareInfo.shareButtonText)!="undefined"){k=c.shareInfo.shareButtonText}var i={text:k,icon:"share"};d=_.extend(i,d);var j=new FlatButtonView(d);j.bind("onButtonClicked",l);g=j.render().$el}h.prepend(g)}function a(i){if(i&&i.length>0){b.hitch(this)()}}conduitApi.social.getSupportedServices(c.shareInfo,a.hitch(this),a.hitch(this))},onShareButtonClick:function(){function b(c){if(c&&c.length>0){var g=[];var e=[_T("DialogCaptionFacebook"),_T("DialogCaptionTwitter"),_T("DialogCaptionEmail")];var f=this;_.each(c,function(h,j){g[j]={title:e[h],returnValue:h};if(PLATFORM===conduitApi.platform.deviceInfo.platformEnum.webApp){if(h==conduitApi.social.socialServicesEnum.Facebook){g[j].href=f._getFaceBookHref()}else{if(h==conduitApi.social.socialServicesEnum.Twitter){g[j].href=f._getTwitterHref()}}}});var d={dialogTitle:_T("DialogCaptionShareControlDialog")};ChooseDialog.execute(g,this.onServiceSelected.hitch(this),null,d)}}if(PLATFORM===conduitApi.platform.deviceInfo.platformEnum.nativeApp){var a=this._shareOptions.shareInfo.emailDesc;this._shareOptions.shareInfo.emailDesc=decodeURIComponent(Utils.ShareInfo.getEMailBody(this._shareOptions.shareInfo));navigator.appManager.share(this._shareOptions.shareInfo);this._shareOptions.shareInfo.emailDesc=a}else{conduitApi.social.getSupportedServices(this._shareOptions.shareInfo,b.hitch(this),b.hitch(this))}},_getTwitterHref:function(){var b=this._shareOptions.shareInfo.url||"";var e=encodeURIComponent(b);var c="https://twitter.com/intent/tweet?url="+e;var f=this._shareOptions.shareInfo.twitterTitle||this._shareOptions.shareInfo.title||"";var d=AppManager.app().get("appLink");if(d&&!b.startsWith(d)){var a=".\n "+_T("SShareTweetedFromLink",{appLink:d});f+=a}if(f){f=encodeURIComponent(f);c+="&text="+f}return c},_getFaceBookHref:function(){var b=encodeURIComponent(this._shareOptions.shareInfo.url);var f=this._shareOptions.shareInfo.fbDesc||this._shareOptions.shareInfo.shortDesc;var e=this._shareOptions.shareInfo.fbTitle||this._shareOptions.shareInfo.title;var a=this._shareOptions.shareInfo.imageUrl;if((LAYOUT===layoutFormat.wide)&&f&&e&&a){var c="http://www.facebook.com/sharer.php?m2w&s=100";var d=encodeURIComponent("[url]")+"="+b;c+="&p"+d;if(f){var d=encodeURIComponent("[summary]")+"="+encodeURIComponent(f);c+="&p"+d}if(e){var d=encodeURIComponent("[title]")+"="+encodeURIComponent(e);c+="&p"+d}if(a){var d=encodeURIComponent("[images][0]")+"="+encodeURIComponent(a);c+="&p"+d}}else{var c="http://www.facebook.com/sharer.php?u="+b;if(f){var d=encodeURIComponent(f);c+="&t="+d}}return c},onServiceSelected:function(a){function b(){var c="";switch(parseInt(a)){case conduitApi.social.socialServicesEnum.Facebook:c=_T("DialogMessageShareFailPostFacebook");break;case conduitApi.social.socialServicesEnum.Twitter:c=_T("DialogMessageShareFailTweet");break}conduitApi.UI.showToastMessage(null,null,c)}conduitApi.social.share(null,b,a,this._shareOptions)},showSimulatorMessage:function(){cqm.showToastMessage("Share is not supported in simulator mode.")}}; FlatButtonView=Backbone.View.extend({className:"flat_button clr_contTypeB_actBtn_bg clr_contTypeB_actBtn_brdr clr_contTypeB_actBtn_hdlTxt",attributes:{"data-role":"button"},render:function(){var b=buttonTemplates.button(this.options);this.$el.html(b);if(this.options.dropDown&&this.options.dropDown.length){var d=$(buttonTemplates.dropDown({}));this.$el.append(d);for(var a=0;a<this.options.dropDown.length;a++){var c=buttonTemplates.comboSelectionOption(this.options.dropDown[a]);d.append(c)}d.bind("touchstart mousedown",function(f){f.stopPropagation()});d.change(this.onDropdownChange.hitch(this))}else{this.$el.tap(this.onButtonTap.hitch(this))}if(this.options.big){this.$el.addClass("big fullWidth")}else{if(this.options.floatBtn){this.$el.addClass("float responsive")}else{this.$el.addClass("order responsive")}}return this},onButtonTap:function(a){a.preventDefault();this.trigger("onButtonClicked")},onDropdownChange:function(c){c.preventDefault();var a=null;var b=null;this.$("select option:selected").each(function(){a=$(this).val();b=$(this).attr("-data-newCaption")});this.trigger("onButtonClicked",a);if(b){this.changeCaption(b)}},changeCaption:function(a){this.$(".text").text(a)}}); var buttonTemplates={button:_.template('<div class="icon mask_sprite sprite-<%= icon %> clr_contTypeB_actBtn_icn" ></div><span class="text"><%= text %></span>'),dropDown:_.template('<select class="drop_down_list"></select>'),comboSelectionOption:_.template('<option value="<%= value %>"<% if(typeof(selected)!= "undefined" && selected){ %> selected="selected"<% } %><% if(typeof(newCaption)!= "undefined" && newCaption){ %> -data-newCaption="<%= newCaption %>"<% } %>><%= caption %></option>')}; var ShareIconsView=Backbone.View.extend({className:"share-icons",render:function(){var a=this.model.toJSON();this.$el.html(shareIconsTemplates.iconsTemplate(a));this.$(".twitter").tap(this._twitterClicked.hitch(this));this.$(".facebook").tap(this._facebookClicked.hitch(this));this.$(".myspace").tap(this._myspaceClicked.hitch(this));this.$(".linkedin").tap(this._linkedinClicked.hitch(this));this.$(".link").tap(this._linkClicked.hitch(this));this.$(".info").tap(this._infoClicked.hitch(this));return this},_twitterClicked:function(a){a.preventDefault();conduitApi.app.openLink(null,null,{url:this.model.get("buttons").twitter})},_facebookClicked:function(a){a.preventDefault();conduitApi.app.openLink(null,null,{url:this.model.get("buttons").facebook})},_myspaceClicked:function(a){a.preventDefault();conduitApi.app.openLink(null,null,{url:this.model.get("buttons").mySpace})},_linkedinClicked:function(a){a.preventDefault();conduitApi.app.openLink(null,null,{url:this.model.get("buttons").linkedin})},_linkClicked:function(a){a.preventDefault();conduitApi.app.openLink(null,null,{url:this.model.get("buttons").webSite})},_infoClicked:function(a){a.preventDefault();this.model.trigger("infoClicked",this.model)}}); var shareIconsTemplates={};shareIconsTemplates.iconsTemplate=_.template('<% if (typeof(buttons) != "undefined" && buttons) { %><% if (buttons.twitter) { %><div class="twitter icon sprite sprite-aboutus_twitter"></div><% } %><% if (buttons.facebook) { %><div class="facebook icon sprite sprite-aboutus_facebook"></div><% } %><% if (buttons.linkedin) { %><div class="linkedin icon sprite sprite-aboutus_linkedin"></div><% } %><% if (buttons.webSite) { %><div class="link icon sprite sprite-aboutus_link"></div><% } %><% if (buttons.mySpace) { %><div class="myspace icon sprite sprite-aboutus_myspace"></div><% } %><% if (buttons.email) { %><a href="mailto:<%= buttons.email %>" ><div class="icon sprite sprite-aboutus_email" alt="" /></a><% } %><% if (buttons.info) { %><div class="info icon sprite sprite-aboutus_info"></div><% } %><% } %>'); var StaticPageView=Backbone.View.extend({className:"staticPage_simulator clr_contTypeA_classicItem_bg",render:function(){var a={img:Utils.String.translateIfNeed(this.model.get("staticPages").simulator.img),title:Utils.String.translateIfNeed(this.model.get("staticPages").simulator.title),text:Utils.String.translateIfNeed(this.model.get("staticPages").simulator.text)};this.$el.html(staticPagesTemplates.staticPageTemplate(a));var b=this.$(".scroll_wrapper");Scrolling.init(b);return this}}); var staticPagesTemplates={};staticPagesTemplates.staticPageTemplate=_.template('<div class="scroll_wrapper"><div class="scroller">	<div class="no_entry_icon"><img src="<%= img %>"></div>	<div class="size_title_4 clr_contTypeB_hdlTxt title"><%= title %></div>	<div class="size_title_2 clr_contTypeB_subTxt text"><%= text %></div></div></div>'); var TracksCollection=ItemsCollection.extend({initialize:function(a,b){ItemsCollection.prototype.initialize.apply(this);this.params={params:{}};if(a&&a.length>0){var c=this.parse({items:a});this.add(c.models)}if(b&&b.url){this.params.url=b.url}else{this.invalid=true}},parse:function(a){var d={};if(a&&a.items){var f=[];var e=this.params.skip|0;for(var c=0;c<a.items.length;c++){var b=ItemsTransformer.transformItem(a.items[c]);if(b){if(a.title){b.collectionTitle=a.title}f[c]=new TrackModel();f[c].buildFromJSON(b);f[c].set({index:e+c,albumImageUrl:a.imageUrl})}}d.models=f;d.metaData=a}return d},getServiceName:function(){return"CMS_MEDIA_AUDIO_GET"},getParams:function(){return this.params}}); var AudioModel=Backbone.Model.extend({}); var AlbumModel=ItemsModel.extend({initialize:function(){var a=this.get("params");if(!a){return}ItemsModel.prototype.initialize.apply(this,arguments);this.set({id:a.id});this.get("items").bind("getItemsSuccess",this._onGetItemsSuccess,this)},createItemsCollection:function(){var a=this.get("params");return new TracksCollection(null,a)},_onGetItemsSuccess:function(a){this.set({meta:a});this.trigger("getItemsSuccess",this)}}); var AlbumPreviewModel=Backbone.Model.extend({initialize:function(){var c=this.get("params");if(!c||!c.url){return}var a={url:c.url,params:{}};var b=Services.generateUrl("CMS_MEDIA_ART_GET",a);if(b&&b!==""){this.set({imageUrl:b})}}}); var TrackModel=ItemModel.extend({initialize:function(){},buildFromJSON:function(c){this.set(c);if(PLATFORM===platformEnum.nativeApp){var b="";var a=this.get("purchase");if(a&&a.methods){for(var d=0;d<a.methods.length;d++){var e=a.methods[d];if(e.type===2&&e.url){b=UrlGenerator.generateUrl(e.url,{})}}}this.set({buyLink:b})}}}); var AudioTemplateView=TemplateView.extend({initialize:function(){TemplateView.prototype.initialize.apply(this);var a=this.model.get("meta");this._audioModel=new AudioModel({meta:a})},render:function(b){var e=this.model.get("meta");var a=e.pageLayout;if(a!==0){a=0}this.template=audioTemplates[a];var d=null;if(e.items.length>1){d=new AlbumsListView({model:this._audioModel,template:this.template,id:"home_"+Utils.Helpers.generateGUID()});d.bind("albumSelected",this.onAlbumSelected.hitch(this),this)}else{if(e.items.length==1&&e.items[0].params){d=this.createAlbumDetailsPage(e.items[0])}else{d=this.createAlbumDetailsPage({})}}this.$el.addClass("audio_page");var c=$(d.render().el);if(e.items.length>1){c.attr({"data-role":"page","data-buttons":"navigation"})}else{c.attr({"data-role":"page","data-buttons":"navigation refresh"})}this._homePagesViews[b]=d;this.$el.html(c);return this},_addPage:function(c,a){var b=$(c.render().el);this.$el.append(b);if(a){b.attr({"data-role":"page","data-buttons":"back refresh"});b.bind("silentRefresh",c.handleSilentRefresh.hitch(c));b.bind("refresh",c.handleRefreshClick.hitch(c))}else{b.attr({"data-role":"page","data-buttons":"back"})}var d="#"+c.id;$.mobile.changePage(d,{transition:"slide",reverse:IS_RTL})},createAlbumDetailsPage:function(a){if(this.albumPage){this.albumPage.remove()}this.albumPage=new AlbumDetailsView({model:new AlbumModel(a),template:this.template,id:"album_page_details_"+Utils.Helpers.generateGUID()});this.albumPage.bind("trackPlay",this.onTrackPlay,this);this.albumPage.bind("trackBuy",this.onTrackBuy,this);this.albumPage.model.bind("itemSelected",this.onTrackSelected,this);this.albumPage.bind("albumTracksAddToFavorites",this.onAlbumTracksAddToFavorites,this);return this.albumPage},onAlbumSelected:function(a){var b=this.createAlbumDetailsPage(a.toJSON());this._addPage(b,true)},_createTrackPage:function(f,d){if(this.trackPage){this.trackPage.remove()}this.trackPage=new TrackDetailsView({model:f,template:this.template,id:"track_page_details_"+Utils.Helpers.generateGUID()});var c=this.trackPage;c.bind("onFavoritesButtonTap",this.onFavoritesButtonTap,this);c.bind("trackBuy",this.onTrackBuy,this);var b=this;var a=null;if(d){function e(){var h=c.$el;if(!conduitApi.platform.media.isSupported()){conduitApi.UI.showToastMessage(null,null,_T("DialogMessageMediaNotSupported"),h)}else{var j=h.find(".audio_media_player_container");if(j.length>0){h=j}function i(){var m=f.get("index");var l=b.albumPage.model;var k=l.get("items").toJSON();conduitApi.platform.media.setTracks(function(){conduitApi.platform.media.play(null,null,m)},null,k);$(c.el).bind("pagehide",function(){h.trigger("hide")})}function g(){cqm.showToastMessage(_T("ToastMessageAudioInitFail"),h)}conduitApi.platform.media.init(i,g,h)}}$(c.el).bind("pageshow",function(){e()})}this._addPage(c,false)},onTrackPlay:function(a){this._createTrackPage(a,true)},onTrackSelected:function(b,a){this._createTrackPage(b,true)},onTrackBuy:function(a){},onFavoritesButtonTap:function(c,a){if(c&&window.FavoritesManager){if(a){FavoritesManager.addTrack(c);var b=_T("ToastMessageTrackAddedToFavorites")}else{FavoritesManager.removeTrack(c);var b=_T("ToastMessageTrackRemovedFromFavorites")}FavoritesManager.save();cqm.showToastMessage(b)}},onAlbumTracksAddToFavorites:function(b){var a=b.models;if(a&&a.length>0&&window.FavoritesManager){_.each(a,function(e,d){FavoritesManager.addTrack(e)});FavoritesManager.saveList();var c={title:_T("DialogCaptionAddedToFavorites"),message:_T("DialogMessageAlbumAddedToFavorites"),buttons:[{text:_T("ButtonClose")}]};conduitApi.UI.showDialogBox(null,null,c)}}}); var AudioWideTemplateView=TemplateView.extend({initialize:function(){TemplateView.prototype.initialize.apply(this);var a=this.model.get("meta");this._audioModel=new AudioModel({meta:a})},render:function(b){var e=this.model.get("meta");var a=e.pageLayout;if(a!==0){a=0}this.template=audioTemplates[a];var d=null;if(e.items.length>1){d=new AlbumsListView({model:this._audioModel,template:this.template,id:"home_"+Utils.Helpers.generateGUID()});d.bind("albumSelected",this.onAlbumSelected.hitch(this),this)}else{d=this.createAlbumDetailsPage(e.items[0])}this.$el.addClass("audio_page");var c=$(d.render().el);if(e.items.length>1){c.attr({"data-role":"page","data-buttons":"navigation"})}else{c.attr({"data-role":"page","data-buttons":"navigation refresh"})}c.addClass("wide");this._homePagesViews[b]=d;this.$el.html(c);if(e.items.length===1){this.bindAlbumPage()}return this},_addPage:function(b){var a=$(b.render().el);this.$el.append(a);a.attr({"data-role":"page","data-buttons":"back"});b.addRefreshButton(true);var c="#"+b.id;$.mobile.changePage(c,{transition:"slide",reverse:IS_RTL})},createAlbumDetailsPage:function(a){this.albumPage=new AlbumDetailsView({model:new AlbumModel(a),template:this.template,id:"album_page_details_"+Utils.Helpers.generateGUID()});if(this.dividedScreenView){this.dividedScreenView.remove()}this.dividedScreenView=new DividedScreenView({id:"divided_screen_"+Utils.Helpers.generateGUID()});this.dividedScreenView.setView1(this.albumPage.render());return this.dividedScreenView},bindAlbumPage:function(){this.albumPage.bind("trackPlay",this.onTrackPlay,this);this.albumPage.bind("trackBuy",this.onTrackBuy,this);this.albumPage.model.bind("itemSelected",this.onTrackSelected,this);this.albumPage.model.get("items").onItemsReady(this.onItemsReady.hitch(this));this.albumPage.bind("tracksListUpdated",this.onAlbumTracksListUpdated,this)},onAlbumTracksListUpdated:function(c){var b=c.model;var a=b.get("items").toJSON();conduitApi.platform.media.setTracks(null,null,a)},onAlbumSelected:function(a){this.createAlbumDetailsPage(a.toJSON());this._addPage(this.dividedScreenView);this.bindAlbumPage()},_createTrackMiniPage:function(h,d){var c=new TrackDetailsView({model:h,template:this.template,id:"track_page_details_"+Utils.Helpers.generateGUID()});c.bind("onFavoritesButtonTap",this.onFavoritesButtonTap,this);c.bind("trackBuy",this.onTrackBuy,this);if(this.$playerContainer){this.$playerContainer.children().trigger("destroyPlayer").remove();this.$playerContainer=null}this.dividedScreenView.setView2(c.render());if(d){this.$playerContainer=$(c.el);var g=$(c.el).find(".audio_media_player_container");if(g.length>0){this.$playerContainer=g}var b=this;function f(){var k=h.get("index");var j=b.albumPage.model;var i=j.get("items").toJSON();conduitApi.platform.media.setTracks(function(){conduitApi.platform.media.play(null,null,k)},null,i);$(this.dividedScreenView.el).bind("pagehide",function(){if(this.$playerContainer){this.$playerContainer.trigger("hide")}}.hitch(this))}function a(){cqm.showToastMessage(_T("ToastMessageAudioInitFail"),this.$playerContainer)}conduitApi.platform.media.init(f.hitch(this),a,this.$playerContainer)}var e=$(c.el).find(".scroll_wrapper");Scrolling.onContentChanged(e)},onTrackPlay:function(a){this._createTrackMiniPage(a,true)},onTrackSelected:function(b,a){if(!a){this._createTrackMiniPage(b,true)}},onTrackBuy:function(a){},onFavoritesButtonTap:function(c,a){if(c&&window.FavoritesManager){if(a){FavoritesManager.addTrack(c);var b=_T("ToastMessageTrackAddedToFavorites")}else{FavoritesManager.removeTrack(c);var b=_T("ToastMessageTrackRemovedFromFavorites")}FavoritesManager.save();cqm.showToastMessage(b)}},onAlbumTracksAddToFavorites:function(b){var a=b.models;if(a&&a.length>0&&window.FavoritesManager){_.each(a,function(e,d){FavoritesManager.addTrack(e)});FavoritesManager.saveList();var c={title:_T("DialogCaptionAddedToFavorites"),message:_T("DialogMessageAlbumAddedToFavorites"),buttons:[{text:_T("ButtonClose")}]};conduitApi.UI.showDialogBox(null,null,c)}},onItemsReady:function(b){if(b.length>0){var a=b.at(0);a.trigger("itemClicked",a)}}}); var AlbumsListView=Backbone.View.extend({className:"clr_contTypeA_bg",render:function(){this.$el.html('<div class="scroll_wrapper"><div class="scroller"></div></div>');var d=this.$el.find(".scroller");var e=this.$el.find(".scroll_wrapper");var c=this.options.template.albums_list_item_tpl;d.html(this.options.template.albums_list_tpl());this.$itemsList=d.find(".albums_list");var a=this.model.get("meta").items;var b=this;_.each(a,function(f,g){b._renderOneAlbum(c,f)});Scrolling.init(e);$(window).bind("throttledresize",this.onResize.hitch(this));this.$el.bind("pageshow",this.onPageShow.hitch(this));this.$el.bind("pagehide",this.onPageHide.hitch(this));this.onPageHide();return this},_renderOneAlbum:function(c,d){if(d){var a=new AlbumPreviewModel(d);var b=new AlbumView({model:a,template:c});b.bind("albumClicked",this.onAlbumSelected,this);this.$itemsList.append(b.render().el)}},onResize:function(){if(this.isPageShow){this.updateThumbnailsMargin()}},onPageShow:function(){this.isPageShow=true;this.updateThumbnailsMargin()},onPageHide:function(){this.isPageShow=false},updateThumbnailsMargin:function(){Utils.Html.setGridMargin(this.$itemsList,{minMargin:8})},onAlbumSelected:function(a){this.trigger("albumSelected",a)}}); var AlbumView=Backbone.View.extend({className:"albums_list_item",events:{tap:"itemClicked"},render:function(){var d=this.$el;var b=this;var a=this.options.template;var c={albumId:this.model.get("id")||"",title:this.model.get("title")||"",imageUrl:null};d.html(a(c));$('<img src="'+b.model.get("imageUrl")+'">').load(function(){var e=d.find(".album_list_item_image");e.css("background-image","url("+b.model.get("imageUrl")+")")});return this},itemClicked:function(a){a.preventDefault();conduitApi.analytics.addEvent(null,null,conduitApi.analytics.usageEventTypeEnum.ViewChanged,{viewId:this.model.get("id")});this.trigger("albumClicked",this.model)}}); var AlbumDetailsView=ItemsView.extend({initialize:function(){this.$el.html('<div class="album_details_page scroll_wrapper"><div class="scroller"></div></div>');var a=this.options.template;var b=this.$el.find(".scroll_wrapper");Scrolling.init(b);this.model.bind("getItemsSuccess",this.cbGetItemsSuccess.hitch(this));ItemsView.prototype.initialize.apply(this,arguments);this.model.getItems(executeTypeEnum.HIT_AND_RUN)},createItemView:function(b){var a=new TrackView({model:b,template:this.options.template});a.bind("trackPlay",this.onTrackPlay.hitch(this),this);return a},getRootView:function(){return this.$el.find(".scroller")},_createHeader:function(){if(this.header){return}if(this.model.get("hideHeader")){return}if(this.model.get("logoImgUrl")){this.header=new LogoHeaderView({model:this.model})}else{var b=this.model.get("meta");this.header=new AlbumDetailsHeaderView({model:this.model,template:this.options.template});var a=b.imageUrl;if(a){this.$el.css("background",a)}}var c=this.$el.find(".scroller");c.prepend(this.header.render().el)},cbGetItemsSuccess:function(){this._createHeader();this.trigger("tracksListUpdated",this)},onTrackPlay:function(a){this.trigger("trackPlay",a)},onAddToFavorites:function(){var a=this.model.get("items");this.trigger("albumTracksAddToFavorites",a)}}); var AlbumDetailsHeaderView=Backbone.View.extend({render:function(){var i=this.options.template;var j=_T("HtmlTextAddAlbumToFavorites");var k=this.model.get("meta");var e=k.author;var g=k.title;var h=k.imageUrl||"pages/audio/img/record202.jpg";var c="";if(k.purchase&&k.purchase.methods&&k.purchase.methods.length>0){c=k.purchase.methods}var d={imageUrl:h,author:e,title:g,addToFavText:j,purchase:c};this.$el.html(i.album_header_tpl(d));if(c){var b=new PurchaseItemModel({methods:c});var f=new PurchaseItemView({model:b});var a=this.$el.find(".buy_album_container");f.buyString=_T("HtmlTextPurchaseItemBuyAlbum");f.colorClass="clr_contTypeC_btn_bg clr_contTypeC_btn_brdr clr_contTypeC_btn_hdlTxt";a.html(f.render().el)}return this}}); var TrackView=Backbone.View.extend({className:"tracks_list_item clr_contTypeB_trackItem_bg clr_contTypeB_trackItem_brdr t3d",events:{"tap .track_play_button":"onTrackPlay","tap .track_title":"onTrackClicked","tap .track_remove_button":"onTrackRemove"},initialize:function(){this.model.bind("change:selected",this.onSelectedChange,this);this.model.bind("change:editMode",this.onEditModeChange,this);this.model.bind("change:isPurchase",this.render,this)},render:function(){var l=this.$el;var i=this.options.template;var d=this.model.get("index")||"";var m=encodeURIComponent(this.model.get("author"))||"";var f=encodeURIComponent(this.model.get("collectionTitle"))||"";var h=this.model.get("title")||"";var a=this.model.get("purchase");var b="";var k=this.model.get("isPurchase")||false;if(a&&a.methods&&a.methods.length>0&&!k){b=a.methods}var g={index:d,title:h,purchase:b};l.html(i.track_item_tpl(g)).attr("data-role","button");var c=this;if(b){function j(o){console.log("got items: "+o);if(o&&o.length>0){var q=o[0];console.log("item status: "+q.status);if(q.status==="exist"&&q.url){c.model.get("stream").url=q.url;c.model.set({isPurchase:true});return}}var r=new PurchaseItemModel({itemModel:c.model,methods:b});var p=new PurchaseItemView({model:r});var n=l.find(".buy_button_container");n.html(p.render().el)}if(DEVICE===deviceTypeEnum.iphone&&PLATFORM===platformEnum.nativeApp){var e=[{artistName:m,albumName:f,songName:encodeURIComponent(h)}];Cordova.exec(j,null,"iPodLib","queryMediaItems",[{items:e}])}else{var e=[{artistName:m,albumName:f,songName:h,status:"exist",url:"ipod-library://item/item.m4a?id=1534809840205560650"}];j()}}return this},onSelectedChange:function(){if(LAYOUT===layoutFormat.wide){if(this.model.get("selected")){this.$el.addClass("selected")}else{this.$el.removeClass("selected")}}},onTrackPlay:function(a){a.preventDefault();this.trigger("trackPlay",this.model)},onTrackClicked:function(a){this.model.trigger("itemClicked",this.model)},onTrackRemove:function(a){this.trigger("trackRemove",this)},onEditModeChange:function(a,e){var b=this.$el;var c=b.find(".track_title");var d=b.find(".track_arrange_button");c.unbind(TouchHandler.START_EVENT).unbind(TouchHandler.MOVE_EVENT).unbind(TouchHandler.END_EVENT);d.unbind(TouchHandler.START_EVENT).unbind(TouchHandler.MOVE_EVENT).unbind(TouchHandler.END_EVENT);if(e){c.bind(TouchHandler.START_EVENT,this.onTouchStart.hitch(this)).bind(TouchHandler.MOVE_EVENT,this.onTouchMove.hitch(this)).bind(TouchHandler.END_EVENT,this.onTouchEnd.hitch(this));d.bind(TouchHandler.START_EVENT,this.onTouchStart.hitch(this)).bind(TouchHandler.MOVE_EVENT,this.onTouchMove.hitch(this)).bind(TouchHandler.END_EVENT,this.onTouchEnd.hitch(this))}},onTouchStart:function(a){this.touchDown=true;a.preventDefault();a.stopImmediatePropagation();var b=this.$el;this.start_x=b.offset().left;this.start_y=b.offset().top;this.trigger("trackDragStart",this)},onTouchMove:function(d){if(this.touchDown){var e=this.$el;var b=e.offset().left;var f=e.offset().top;if((d.pageX>b+e.width()&&d.pageX<b)||(d.pageY>f+e.height()&&d.pageY<f)){this.touchDown=false}else{var c=d.pageX-this.start_x;var a=d.pageY-this.start_y;this.trigger("trackDrag",this,{x:c,y:a})}d.preventDefault()}},onTouchEnd:function(a){if(this.touchDown){this.trigger("trackDragEnd",this)}this.touchDown=false}}); var TrackDetailsView=Backbone.View.extend({className:"clr_contTypeA_bg",events:{"tap .track_buy_button":"onTrackBuy","tap .track_addfavorites_button":"onFavoritesButtonTap"},initialize:function(){this.model.bind("change:isPurchase",this.render,this)},render:function(){this.$el.html('<div class="track_details_page scroll_wrapper"><div class="scroller"></div></div>');this.$el.css("background",this.model.imageUrl).attr("data-role","page");var b=this.$el.find(".scroller");var c=this.$el.find(".scroll_wrapper");var a=this.options.template;b.html(this.renderHeader(a));b.append(this.renderDetails(a));this.setAddToFavoritesImage();Scrolling.init(c);return this},renderHeader:function(d){var g=this.model;var c=g.get("largeThumbnail");if(!c||c===""){c=g.get("albumImageUrl")}var b=g.get("index");if(typeof(b)!="undefined"){b++;if(b<10){b="0"+b}b=_T("HtmlTextAudioTrackNumber",{number:b})}else{b=""}var a=window.FavoritesManager&&FavoritesManager.isEnabled()&&!this.options.isFavoritePage;if(a){this.isInFavorites=FavoritesManager.contains(this.model)}var f=g.get("title")||"";var e={imageUrl:c,index:b,title:f,favoritesEnabled:a};return d.track_header_tpl(e)},renderDetails:function(s){var k=$('<div class="track_details"></div>');if(!this.options.isFavoritePage){var p=this.model.get("isPurchase")||false;var d=this.model.get("purchase");if(d&&d.methods&&d.methods.length>0&&!p){var e=new PurchaseItemModel({itemModel:this.model,methods:d.methods});var i=new PurchaseItemView({model:e});var n=$('<div class="buy_button_container_details"></div>');n.html(i.render().el);k.html(n)}}var r=this.model;var o=r.get("description");if(o){var g=$("<div></div>");g.html(s.track_details_paragraph_tpl({title:_T("HtmlTextAudioDetails"),text:o}));var l=g.find(".track_details_text");l.html("");var a=new HtmlContainerControl();a.renderHtml(l,o,{changeColors:true});k.append(g)}var m=r.get("vocals");if(m){var q=$("<div></div>");q.html(s.track_details_paragraph_tpl({title:_T("HtmlTextAudioVocals"),text:m}));var l=q.find(".track_details_text");l.html("");var a=new HtmlContainerControl();a.renderHtml(l,m,{changeColors:true});k.append(q)}var c=r.get("author");if(c){var j=$("<div></div>");j.html(s.track_details_paragraph_tpl({title:_T("HtmlTextAudioWriters"),text:c}));var l=j.find(".track_details_text");l.html("");var a=new HtmlContainerControl();a.renderHtml(l,c,{changeColors:true});k.append(j)}var f="";var b=r.get("textItems");if(b&&b.length>0){_.each(b,function(u,t){f+=u.text});f=f.replace(/\n/g,"<br/>");var h=$("<div></div>");h.html(s.track_details_paragraph_tpl({title:_T("HtmlTextAudioLyrics"),text:f}));var l=h.find(".track_details_text");l.html("");var a=new HtmlContainerControl();a.renderHtml(l,f,{changeColors:true});k.append(h)}return k},onTrackBuy:function(a){a.preventDefault();this.trigger("trackBuy",this.model)},setAddToFavoritesImage:function(){if(!this.$add2FavImg){var a=this.$el.find(".track_addfavorites_button");this.$add2FavImg=a.find(".image");this.$add3FavText=a.find(".text")}if(this.$add2FavImg){if(this.isInFavorites){this.$add2FavImg.removeClass("sprite-starPlus").addClass("sprite-starMinus");this.$add3FavText.html(_T("HtmlTextRemoveTrackFromFavorites"))}else{this.$add2FavImg.removeClass("sprite-starMinus").addClass("sprite-starPlus");this.$add3FavText.html(_T("HtmlTextAddTrackToFavorites"))}}},onFavoritesButtonTap:function(a){a.preventDefault();this.isInFavorites=!this.isInFavorites;this.setAddToFavoritesImage();this.trigger("onFavoritesButtonTap",this.model,this.isInFavorites)}}); var audioTemplates={0:{albums_list_tpl:_.template('<div class="albums_list clr_contTypeB_hdlTxt"></div'),albums_list_item_tpl:_.template('<div class="album_list_item_image"<% if(imageUrl){ %> style="background-image:url(<%= imageUrl %>);"<% } %>rel-id="<%= albumId %>"></div><div class="size_title_1 _2_lines album_item_title clr_contTypeB_hdlTxt"><%= title %></div>'),album_header_tpl:_.template('<div class="album_header theme_infobar_text" style="background-image:url(<%= imageUrl %>);"><div class="audio_header_box clr_contTypeC_bg"><% if(author){ %><div class="size_title_0 _1_line album_author clr_contTypeC_subTxt ellipsis"><%= author %></div><% } %><% if(title){ %><div class="size_title_3 max_2_lines album_title clr_contTypeC_hdlTxt"><%= title %></div><% } %><% if(purchase){ %><div class="buy_album_container"></div><% } %></div>'),album_tracks_list_tpl:_.template('<div class="album_tracks_list"><div>'),track_item_tpl:_.template('<div class="sprite sprite-play_circle track_play_button" /><div class="size_title_0 _1_line track_title clr_contTypeB_hdlTxt ellipsis<% if(purchase){ %> purchasable<% } %>"><%= title %></div><% if(purchase){ %><div class="buy_button_container" /><% } %>'),track_header_tpl:_.template('<div class="audio_media_player_container"></div><div class="track_header theme_infobar_text" style="background-image:url(<%= imageUrl %>);"><div class="audio_header_box clr_contTypeC_bg"><div class="size_title_0 track_index clr_contTypeC_subTxt"><%= index %></div><div class="size_title_3 max_3_lines track_title clr_contTypeC_hdlTxt"><%= title %></div><% if (favoritesEnabled) { %><div class="track_addfavorites_button"><div class="image mask_sprite clr_contTypeB_subIcn" /><div class="text clr_contTypeC_subTxt"></div></div><% } %></div></div>'),track_details_paragraph_tpl:_.template('<div class="size_title_1 track_details_title clr_contTypeA_hdlTxt"><%= title %></div><div class="track_details_text clr_contTypeA_txt"><%= text %></div>')}}; var agendaTemplates={};agendaTemplates.homePageTemplate=_.template('<div class="scroll_wrapper"><div class="scroller"></div></div>');agendaTemplates.dateHeaderTemplate=_.template('<a class="date-button prev clr_contTypeB_btn_bg clr_contTypeB_btn_brdr clr_contTypeB_btn_hdlTxt" data-role="button"><div class="nav_icon mask_sprite sprite-arrow-left clr_contTypeB_btn_icn"></div></a><a class="date-button next clr_contTypeB_btn_bg clr_contTypeB_btn_brdr clr_contTypeB_btn_hdlTxt" data-role="button"><div class="nav_icon mask_sprite sprite-arrow-right clr_contTypeB_btn_icn"></div></a><div class="day_caption clr_contTypeB_hdlTxt"></div><div class="date_caption clr_contTypeB_hdlTxt"></div>');agendaTemplates.hallHeaderTemplate=_.template('<div class="triangle up clr_tab2Bar_triangle"></div><div class="triangle down clr_tab2Bar_triangle"></div><div class="slideable_bar"><a class="center hall_caption clr_tab2Bar_item_txt selected clr_tab2Bar_item_bg"><div class="hall_container ellipsis"><%= name %></div></a><% if(prev){ %><a class="prev hall_caption clr_tab2Bar_item_txt clr_tab2Bar_item_bg"><div class="hall_container ellipsis"><%= prev %></div></a><% } %><% if(next){ %><a class="next hall_caption clr_tab2Bar_item_txt clr_tab2Bar_item_bg"><div class="hall_container ellipsis"><%= next %></div></a><% } %><% if(prev2){ %><a class="prev2 hall_caption clr_tab2Bar_item_txt clr_tab2Bar_item_bg"><div class="hall_container ellipsis"><%= prev2 %></div></a><% } %><% if(next2){ %><a class="next2 hall_caption clr_tab2Bar_item_txt clr_tab2Bar_item_bg"><div class="hall_container ellipsis"><%= next2 %></div></a><% } %></div>');agendaTemplates.calendarTemplate=_.template('<div class="calendar" style="height:<%= calHeight %>px;"></div><div class="sessionsContainer" style="height:<%= calHeight %>px;"></div>');agendaTemplates.calendarBoxTemplate=_.template('<div class="calendar_box clr_contTypeA_calBoxBrdr1" style="height:<%= height %>px;top:<%= top %>px;"></div>');agendaTemplates.calendarBox2Template=_.template('<div class="calendar_box clr_contTypeA_calBoxBrdr2" style="height:<%= height %>px;top:<%= top %>px;"></div>');agendaTemplates.calendarTimeTemplate=_.template('<div class="calendar_time clr_contTypeA_txt" style="top:<%= top %>px;"><%= time %></div>');agendaTemplates.singleLineEvent=_.template('<div class="event_title single_line clr_contTypeA_<%= colorCode %>_hdlTxt"><%= title %></div><div class="event_time single_line clr_contTypeA_<%= colorCode %>_subTxt"><%= time %></div>');agendaTemplates.multiLinesEvent=_.template('<div class="event_title multi_lines" style="max-height:<%= textMaxHeight %>px;"><div class="clr_contTypeA_<%= colorCode %>_hdlTxt<% if(ellipsis){ %> ellipsis<% } %>" style="line-height:<%= textLineHeight %>px;"><%= title %></div><div class="event_description clr_contTypeA_<%= colorCode %>_txt" style="line-height:<%= textLineHeight %>px;"><%= description %></div></div><div class="event_location clr_contTypeA_<%= colorCode %>_subTxt<% if(ellipsis){ %> ellipsis<% } %>" style="max-height:<%= locationMaxHeight %>px;line-height:<%= textLineHeight %>px;"><%= location %></div><div class="event_time multi_lines clr_contTypeA_<%= colorCode %>_subTxt"><%= time %></div><div class="event_speakers clr_contTypeA_<%= colorCode %>_subTxt"><%= speaker %></div><% if(USE_AGENDA_FAVORITES){ %><div class="fav_button_container clr_contTypeA_<%= colorCode %>_btn_bg"></div><% } %>');agendaTemplates.addFavButton=_.template('<div class="fav_icon mask_sprite sprite-starEmpty clr_contTypeA_contentSession_btn_icn"></div>');agendaTemplates.removeFavButton=_.template('<div class="fav_icon mask_sprite sprite-starFull clr_contTypeA_contentSession2_btn_icn"></div>');agendaTemplates.fullSession=_.template('<div class="scroll_wrapper"><div class="scroller"><div class="itemContainer clr_contTypeA_bg clr_contTypeA_brdr t3d feed_classic_item"><div class="session_title clr_contTypeA_hdlTxt"><%= title %></div><% if(date){ %><div class="left agenda_icon mask_sprite sprite-speakers-date clr_contTypeA_subIcn"></div><div class="left session_date session_text clr_contTypeA_txt"><%= date %></div><div class="clearfix"></div><% } %><% if(time){ %><div class="left agenda_icon mask_sprite sprite-speakers-time clr_contTypeA_subIcn"></div><div class="left session_text clr_contTypeA_txt"><%= time %></div><div class="clearfix"></div><% } %><% if(location){ %><div class="left agenda_icon mask_sprite sprite-speakers-location clr_contTypeA_subIcn"></div><div class="left session_location session_text clr_contTypeA_txt"><%= location %></div><div class="clearfix"></div><% } %><div class="buttonsContainer"></div></div><% if(speakersStr || description){ %><div class="itemContainer clr_contTypeB_headerItem_bg clr_contTypeB_headerItem_brdr"><% if(description){ %><div class="session_description_title clr_contTypeB_hdlTxt"><%= detailsStr %></div><div class="session_description session_text clr_contTypeB_txt"><%= description %></div><% } %><% if(speakersStr){ %><div class="session_speakers clr_contTypeB_subTxt"><%= speakersStr %></div><% } %></div><ul class="speakersContainer"></ul><% } %></div></div>');agendaTemplates.speakerInSession=_.template('<div class="slide_arrow_image mask_sprite sprite-arrow clr_contTypeA_icn"></div><% if(image){ %><img class="speakerImage" src="<%= image %>" /><% } %><div class="dataContainer"><div class="speakerName clr_contTypeB_hdlTxt ellipsis"><%= name %></div><div class="speakerTitle clr_contTypeB_subTxt ellipsis"><%= title %></div></div>');agendaTemplates.fullSpeaker=_.template('<div class="scroll_wrapper"><div class="scroller"><div class="itemContainer clr_contTypeA_bg clr_contTypeA_brdr t3d feed_classic_item"><% if(typeof(image)!= "undefined" && image){ %><img class="speakerBigImage" src="<%= image %>" /><% } %><div class="dataContainer"><div class="speaker_name clr_contTypeA_hdlTxt"><%= name %></div><div class="speaker_title clr_contTypeA_subTxt"><%= jobTitle %></div><div class="speaker_company clr_contTypeA_subTxt"><%= companyName %></div></div><div class="clearfix"></div><% if(typeof(bio)!= "undefined" && bio){ %><div class="bioStaticText clr_contTypeA_hdlTxt"><%= bioStaticText %></div><div class="speaker_bio clr_contTypeA_txt"><%= bio %></div><% } %><div class="share-icons-container"></div></div><ul class="sessionsContainerInSpeaker"></ul></div></div>');agendaTemplates.sessionInSpeaker=_.template('<div class="slide_arrow_image mask_sprite sprite-arrow clr_contTypeA_icn"></div><div class="session_title_in_speaker ellipsis clr_contTypeB_hdlTxt"><%= title %></div><div class="left icon_in_speaker mask_sprite sprite-speakers-date clr_contTypeA_subIcn"></div><div class="left session_date session_text_in_speaker clr_contTypeA_txt"><%= date %></div><div class="right session_text_in_speaker clr_contTypeA_txt"><%= time %></div><div class="right icon_in_speaker mask_sprite sprite-speakers-time clr_contTypeA_subIcn"></div>');agendaTemplates.speakerInList=_.template('<% if(typeof(image)!= "undefined" && image){ %><img class="speakerBigImage" src="<%= image %>" /><% } %><div class="dataContainer"><div class="speaker_name clr_contTypeA_hdlTxt"><%= name %></div><div class="speaker_title clr_contTypeA_subTxt"><%= jobTitle %></div><div class="speaker_company clr_contTypeA_subTxt"><%= companyName %></div></div><div class="clearfix"></div><% if(typeof(bio)!= "undefined" && bio){ %><div class="speaker_bio short clr_contTypeA_txt"><%= bio %></div><% } %><% if(typeof(nextSessionTitle)!= "undefined" && nextSessionTitle){ %><div class="nextSessionTitle ellipsis clr_contTypeA_hdlTxt clr_contTypeA_hdlTxtBrdr"><%= nextSessionTitle %></div><div class="dates_container"><div class="left icon_in_speaker mask_sprite sprite-speakers-date clr_contTypeA_subIcn"></div><div class="left session_date session_text_in_speaker clr_contTypeA_txt"><%= nextSessionDate %></div><div class="right session_text_in_speaker clr_contTypeA_txt"><%= nextSessionTime %></div><div class="right icon_in_speaker mask_sprite sprite-speakers-time clr_contTypeA_subIcn"></div></div><% } %>'); var AgendaModel=ItemsModel.extend({createItemsCollection:function(){var a=new AgendaCollection(null,this.get("params"));a.bind("onSessionSelected",this._onSessionSelected,this);a.bind("onSpeakerSelected",this._onSpeakerSelected,this);return a},_onSessionSelected:function(a){this.trigger("onSessionSelected",a)},_onSpeakerSelected:function(a){this.trigger("onSpeakerSelected",a)}}); var ConferenceModel=Backbone.Model.extend({FAVORITES_ARRAY_STORAGE_KEY:"AGENDA_FAVORITES_ARRAY",_favoritesSessionsArray:[],defaults:{description:"",conferenceId:"",halls:null,name:"",sessions:null,speakers:null,currHallIndex:0,currHallId:0,currDate:0,minDate:0,maxDate:0,hallsCollection:null,speakersCollection:null,sessionsCollection:null,isFavMode:false,hallsInDateCollection:null},initialize:function(){this._getFavoritesFromStorage();var c=new Backbone.Collection();_.each(this.get("halls"),function(g){g.id=g.hallId;c.add(g)});var b=new SpeakersCollection();_.each(this.get("speakers"),function(g){g.id=g.speakerId;b.add(g)});var a=new SessionsCollection();_.each(this.get("sessions"),function(g){g.id=g.sessionId;g.startDate=Utils.TimeDate.toUTCTime(g.startDate);g.endDate=Utils.TimeDate.toUTCTime(g.endDate);g.conferenceName=this.get("name");g.isInFavorites=(this._favoritesSessionsArray.indexOf(g.id)>-1);g.hallModel=c.get(g.hallId);if(g.speakers){g.speakersModels=$.map(g.speakers,function(h){return b.get(h)})}else{g.speakersModels=[]}a.add(g)}.hitch(this));a.bind("change:isInFavorites",this._onFavoritesChanged,this);b.each(function(h){var g=[];a.each(function(i){if(_.include(i.get("speakers"),h.get("id"))){g.push(i)}});h.set({sessionsModels:g})});a.bind("onSessionSelected",this._onSessionSelected,this);b.bind("onSpeakerSelected",this._onSpeakerSelected,this);var e=AgendaTemplateHelper.trimTime(new Date()).getTime();if(a.length){var f=0;var d=9999999999999;a.each(function(h){var g=h.get("startDate");g=AgendaTemplateHelper.trimTime(new Date(g)).getTime();if(g>f){f=g}if(g<d){d=g}})}else{var f=e;var d=e}if(e>f||e<d){e=d}this.set({currDate:e,minDate:d,maxDate:f,hallsCollection:c,speakersCollection:b,sessionsCollection:a});this._updateHallsInDate()},_updateHallsInDate:function(b){var h=new Backbone.Collection();var f=this.get("hallsCollection");var g=this.get("currDate");for(var e=0;e<f.length;e++){var a=f.at(e);if(this.isSessionsInHall(a)){h.add(a)}}var d=this.get("currHallId");var c=0;if(d){for(var e=0;e<h.length;e++){var a=h.at(e);if(a.get("id")===d){c=e;break}}}var a=h.at(c);if(a){d=a.get("id")}else{d=null}this.set({hallsInDateCollection:h,currHallId:d,currHallIndex:c})},_onFavoritesChanged:function(a){if(a.get("isInFavorites")){this._addSessionToFavorites(a.get("id"))}else{this._removeSessionFromFavorites(a.get("id"))}},_onSessionSelected:function(a){this.trigger("onSessionSelected",a)},_onSpeakerSelected:function(a){this.trigger("onSpeakerSelected",a)},_getFavoritesFromStorage:function(){if(conduitApi.platform.storage.isSupported()){var a=conduitApi.platform.storage.getItem(null,null,this.FAVORITES_ARRAY_STORAGE_KEY,true);if(a){this._favoritesSessionsArray=JSON.parse(a)}}},_setFavoritesToStorage:function(){if(conduitApi.platform.storage.isSupported()){var a=JSON.stringify(this._favoritesSessionsArray);conduitApi.platform.storage.setItem(null,null,this.FAVORITES_ARRAY_STORAGE_KEY,a,true)}},_addSessionToFavorites:function(b){var a=this._favoritesSessionsArray.indexOf(b);if(a===-1){this._favoritesSessionsArray.push(b);this._setFavoritesToStorage()}},isFavoritesEmpty:function(){return(this._favoritesSessionsArray.length===0)},isSessionsInDate:function(b){var a=this.get("sessionsCollection");var e=b+AgendaTemplateHelper.ONE_DAY;for(var d=0;d<a.length;d++){var f=a.at(d);if(!this.get("isFavMode")||this._favoritesSessionsArray.indexOf(f.get("id"))>-1){var c=f.get("startDate");if(c>=b&&c<e){return true}}}return false},isSessionsInHall:function(c){var b=this.get("sessionsCollection");var a=c.get("id");var f=this.get("currDate");var h=f+AgendaTemplateHelper.ONE_DAY;for(var e=0;e<b.length;e++){var g=b.at(e);if(!this.get("isFavMode")||this._favoritesSessionsArray.indexOf(g.get("id"))>-1){if(g.get("hallId")===a){var d=g.get("startDate");if(d>=f&&d<h){return true}}}}return false},getNextDate:function(){for(var a=this.get("currDate")+AgendaTemplateHelper.ONE_DAY;a<=this.get("maxDate");a+=AgendaTemplateHelper.ONE_DAY){if(this.isSessionsInDate(a)){return a}}return null},getPrevDate:function(){for(var a=this.get("currDate")-AgendaTemplateHelper.ONE_DAY;a>=this.get("minDate");a-=AgendaTemplateHelper.ONE_DAY){if(this.isSessionsInDate(a)){return a}}return null},changeFavMode:function(b){this.set({isFavMode:b});if(!this.isSessionsInDate(this.get("currDate"))){var a=this.getNextDate();if(a){this.set({currDate:a})}else{var c=this.getPrevDate();if(c){this.set({currDate:c})}}}this._updateHallsInDate();this.trigger("favModeChanged")},changeDate:function(a){this.set({currDate:a});this._updateHallsInDate();this.trigger("dateChanged");this.trigger("hallChanged");this.trigger("calendarChanged")},changeHall:function(c){this.set({currHallIndex:c});var a=this.get("hallsInDateCollection").at(c);if(a){var b=a.get("id")}else{var b=null}this.set({currHallId:b});this.trigger("hallChanged");this.trigger("calendarChanged")},_removeSessionFromFavorites:function(b){var a=this._favoritesSessionsArray.indexOf(b);if(a>-1){this._favoritesSessionsArray.splice(a,1);this._setFavoritesToStorage()}},getCurrentSessions:function(){var b=[];var c=this.get("currHallId");var d=this.get("currDate");if(c&&d){var e=d+AgendaTemplateHelper.ONE_DAY;var a=this.get("sessionsCollection");a.each(function(g){if(g.get("hallId")===c){if(!this.get("isFavMode")||this._favoritesSessionsArray.indexOf(g.get("id"))>-1){var f=g.get("startDate");if(f>=d&&f<e){b.push(g)}}}}.hitch(this))}return b}}); var SessionModel=Backbone.Model.extend({defaults:{description:"",title:"",conferenceId:"",speakers:null,currHallIndex:0,startDate:0,endDate:0},getShareInfo:function(){var c={};var a=this.get("conferenceName");var d="";var b=this.get("title");if(b){d=_T("SAgendaShareSession",{sessionTitle:b})}c.twitterTitle=d;if(a){c.title=a;c.shortDesc=d}else{c.title=d}return c}}); var SpeakerModel=Backbone.Model.extend({defaults:{bio:"",companyName:"",image:"",jobTitle:"",name:"",speakerId:"",speakerLinks:[],sessionsModels:[],buttons:{}},initialize:function(){this.set({buttons:AgendaTemplateHelper.linkTypesToButtons(this.get("speakerLinks"))})}}); var AgendaCollection=ItemsCollection.extend({model:ConferenceModel,initialize:function(b,a){ItemsCollection.prototype.initialize.apply(this);if(!a||!a.id){this.invalid=true}this.params=a},parse:function(a){var b={};if(a){var c=[new ConferenceModel(a)];b.models=c}return b},getServiceName:function(){return"CMS_CONFERENCE_GET"},getParams:function(){return this.params}}); var SpeakersCollection=Backbone.Collection.extend({model:SpeakerModel}); var SessionsCollection=Backbone.Collection.extend({model:SessionModel}); var AgendaTemplateHelper={ONE_DAY:1000*60*60*24,MINUTE_HEIGHT:2.5,linksButtonsEnum:{UNKNOWN:0,FACEBOOK:1,TWITTER:2,LINKEDIN:3,MYSPACE:4,WEB_SITE:5,MAIL:6,INFO:7,YOUTUBE:8,SKYPE:9},linkTypesToButtons:function(a){var d={};for(var b=0;b<a.length;b++){var c="";switch(a[b].linkType){case this.linksButtonsEnum.UNKNOWN:c="unknown";break;case this.linksButtonsEnum.FACEBOOK:c="facebook";break;case this.linksButtonsEnum.TWITTER:c="twitter";break;case this.linksButtonsEnum.LINKEDIN:c="linkedin";break;case this.linksButtonsEnum.MYSPACE:c="mySpace";break;case this.linksButtonsEnum.WEB_SITE:c="webSite";break;case this.linksButtonsEnum.MAIL:c="email";break;case this.linksButtonsEnum.INFO:c="info";break;case this.linksButtonsEnum.YOUTUBE:c="youtube";break;case this.linksButtonsEnum.SKYPE:c="skype";break}if(c){var e=a[b].link;d[c]=e}}return d},getMinutes:function(c){var b=new Date(c);var a=b.getHours()*60;a+=b.getMinutes();return a},trimTime:function(a){var b=new Date(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0);return b},minutesToPixels:function(a){return Math.floor(this.MINUTE_HEIGHT*a)},sortArray:function(f,e){for(var d=0;d<f.length-1;d++){for(var c=d+1;c<f.length;c++){var b=f[d];if(b.get(e)>f[c].get(e)){f[d]=f[c];f[c]=b}}}}}; var AgendaTemplateView=TemplateView.extend({render:function(b){var d=this.model.get("meta");var a=d[this.options.tabsName][b];var e=this.model.get("type")==="ff4532d2-9137-8da2-f97f-be8b3ddd08e4";var f=new AgendaModel(a);var c=new AgendaView({model:f,id:"agenda_"+Utils.Helpers.generateGUID(),isSpeakers:e,pageId:this.model.get("id")});f.bind("onSessionSelected",this._onSessionSelected,this);f.bind("onSpeakerSelected",this._onSpeakerSelected,this);f.getItems(executeTypeEnum.HIT_AND_RUN);this.$el.append(c.render().el);this._homePagesViews[b]=c;TemplateView.prototype.render.apply(this,[b]);return this},_onSessionSelected:function(a){var b=new FullSessionView({model:a,id:"details_"+Utils.Helpers.generateGUID()});this.$el.append(b.render().el);$.mobile.changePage("#"+b.id,{transition:"slide",reverse:IS_RTL})},_onSpeakerSelected:function(a){var b=new FullSpeakerView({model:a,id:"details_"+Utils.Helpers.generateGUID()});this.$el.append(b.render().el);$.mobile.changePage("#"+b.id,{transition:"slide",reverse:IS_RTL})}}); var AgendaView=ItemsView.extend({attributes:{"data-role":"page"},initialize:function(){this.$el.html(agendaTemplates.homePageTemplate());Scrolling.init(this.$el.find(".scroll_wrapper"));this.$scroller=this.$el.find(".scroller");this.$el.bind("refresh",this.handleRefreshClick.hitch(this));this.$el.bind("silentRefresh",this.handleSilentRefresh.hitch(this));if(USE_AGENDA_FAVORITES&&!this.options.isSpeakers){this.isFavMode=false;this._favBtnHandle=-1;this.$el.bind("pageshow",this._handlePageShow.hitch(this));this.$el.bind("pagebeforehide",this._handlePageHide.hitch(this));this.$el.attr({"data-buttons":"navigation"})}else{this.$el.attr({"data-buttons":"navigation refresh"})}ItemsView.prototype.initialize.apply(this)},getRootView:function(){return this.$scroller},createItemView:function(a){if(this.options.isSpeakers){return new SpeakersListView({model:a})}else{this.conferenceModel=a;this.conferenceModel.changeFavMode(this.isFavMode);return new ConferenceView({model:a})}},_addFavBtn:function(){var c;if(this.isFavMode){c="in_fav.png"}else{c="not_in_fav.png"}var b=true;function d(e){this._favBtnHandle=e}var a=this.options.pageId;conduitApi.app.addInfoBarButton.hitch({slaveId:a})(d.hitch(this),null,c,b,this._favBtnClicked.hitch(this))},_removeFavBtn:function(b){var a=this.options.pageId;if(this._favBtnHandle!==-1){conduitApi.app.removeInfoBarButton.hitch({slaveId:a})(b,b,this._favBtnHandle)}},_handlePageShow:function(){this._addFavBtn()},_handlePageHide:function(){this._removeFavBtn()},_favBtnClicked:function(){if(!this.isFavMode&&this.conferenceModel.isFavoritesEmpty()){cqm.showToastMessage(_T("DialogMessageAgendaNoFav"));return}this.isFavMode=(!this.isFavMode);this.conferenceModel.changeFavMode(this.isFavMode);this._removeFavBtn(function(){this._addFavBtn()}.hitch(this))},addTabsView:function(a){this.getRootView().prepend(a)}}); var CalendarView=Backbone.View.extend({className:"calendar_view clr_contTypeA_bg t3d",initialize:function(){this.model.bind("calendarChanged",this.viewChanged,this)},render:function(){var a=this.model.getCurrentSessions();AgendaTemplateHelper.sortArray(a,"startDate");var r=0;if(a.length){r=AgendaTemplateHelper.getMinutes(a[0].get("startDate"));r=Math.floor(r/60)*60}var p=24*60+15;var q=AgendaTemplateHelper.minutesToPixels(p-r)+2;this.$el.html(agendaTemplates.calendarTemplate({calHeight:q}));var u=this.$(".calendar");var m=this.$(".sessionsContainer");for(var s=r;s<p;s+=30){if(s%60===0){var l=new Date(1999,1,1,(s/60)%24,0,0,0).format("htt");var v={top:AgendaTemplateHelper.minutesToPixels(s-r),height:AgendaTemplateHelper.minutesToPixels(15),time:l};var t=agendaTemplates.calendarBoxTemplate(v);var j=agendaTemplates.calendarTimeTemplate(v);u.append(t).append(j)}else{var v={top:AgendaTemplateHelper.minutesToPixels(s-r),height:AgendaTemplateHelper.minutesToPixels(15)};var t=agendaTemplates.calendarBox2Template(v);u.append(t)}}var n=0;var d=0;var f=10;for(var s=0;s<a.length;s++){var k=AgendaTemplateHelper.getMinutes(a[s].get("startDate"));var g=Math.max(AgendaTemplateHelper.getMinutes(a[s].get("endDate")),k+f);a[s].set({displayEndMinutes:g});var e=(n>k);var w=(d>k);if(e&&w){continue}else{if(e){var c=sessionSideEnum.RIGHT;d=g}else{if(w){var c=sessionSideEnum.LEFT;n=g}else{var h=((s+1<a.length)&&(g>AgendaTemplateHelper.getMinutes(a[s+1].get("startDate"))));if(h){var c=sessionSideEnum.LEFT;n=g}else{var c=sessionSideEnum.BOTH;n=g;d=g}}}}var b=new SessionInCalView({model:a[s],side:c});m.append(b.render().el);k-=r;var o=AgendaTemplateHelper.minutesToPixels(k)+1+2;b.$el.css({top:o+"px"})}return this},viewChanged:function(){this.render();this.$myScrollWrapper=this.$myScrollWrapper||Scrolling.getMyScrollerWrapper(this.$el);Scrolling.onContentChanged(this.$myScrollWrapper)}}); var ConferenceView=Backbone.View.extend({initialize:function(){if(USE_AGENDA_FAVORITES){this.model.bind("favModeChanged",this.render,this)}},render:function(){this.$el.html("");var c=new DateHeaderView({model:this.model});this.$el.append(c.render().el);if(this.model.get("hallsInDateCollection").length){var b=new HallHeaderView({model:this.model});this.$el.append(b.render().el)}var a=new CalendarView({model:this.model});this.$el.append(a.render().el);this.$myScrollWrapper=this.$myScrollWrapper||Scrolling.getMyScrollerWrapper(this.$el);Scrolling.onContentChanged(this.$myScrollWrapper);return this}}); var DateHeaderView=Backbone.View.extend({className:"date_header clr_contTypeB_headerItem_bg clr_contTypeB_headerItem_brdr t3d",initialize:function(){this.model.bind("dateChanged",this.updateUiState,this)},updateUiDate:function(){var b=this.model.get("currDate");var a=new Date(b);this.$dayCaption.text(a.format("dddd"));this.$dateCaption.text(a.format("d mmm"))},getNextDate:function(){return IS_RTL?this.model.getPrevDate():this.model.getNextDate()},getPrevDate:function(){return IS_RTL?this.model.getNextDate():this.model.getPrevDate()},updateUiState:function(){this.updateUiDate();var d=this.getPrevDate();var b=this.getNextDate();this.prevDisabled=!d;this.nextDisabled=!b;var c=!(this.prevDisabled&&this.nextDisabled);(this.nextDisabled?$.fn.addClass:$.fn.removeClass).apply(this.$nextButton,["disabled"]);(this.prevDisabled?$.fn.addClass:$.fn.removeClass).apply(this.$prevButton,["disabled"]);var a=(c?$.fn.show:$.fn.hide);a.apply(this.$prevButton);a.apply(this.$nextButton)},render:function(){this.$el.html(agendaTemplates.dateHeaderTemplate());this.$dateCaption=this.$el.find(".date_caption");this.$dayCaption=this.$el.find(".day_caption");this.$nextButton=this.$el.find(".date-button.next, .date-button.next .nav_icon");this.$prevButton=this.$el.find(".date-button.prev, .date-button.prev .nav_icon");this.updateUiState();var a=this;this.$(".prev").tap(function(b){if(a.prevDisabled){return}a.model.changeDate(a.getPrevDate())});this.$(".next").tap(function(b){if(a.nextDisabled){return}a.model.changeDate(a.getNextDate())});return this}}); var FullSessionView=Backbone.View.extend({className:"speech-page",initialize:function(){this.$el.attr({"data-role":"page","data-buttons":"back"});if(USE_AGENDA_FAVORITES){this.model.bind("change:isInFavorites",this._renderFavButton,this)}},render:function(){var b=new Date(this.model.get("startDate")).format("shortTime");var h=new Date(this.model.get("endDate")).format("shortTime");var d=new Date(this.model.get("startDate")).format("fullDate");var l=this.model.get("locationText")||"";var j=this.model.get("hallModel");if(j){var k=j.get("name")||"";if(l&&k){l+=", "}l+=k}var o="";var c=this.model.get("speakersModels");if(c.length===1){o=_T("HtmlTextAgendaOneSpeaker")}else{if(c.length>1){o=_T("HtmlTextAgendaSpeakersCount",{number:c.length})}}var f={title:this.model.get("title"),time:b+" - "+h,date:d,location:l,detailsStr:_T("HtmlTextAgendaSessionDetails"),description:this.model.get("description"),speakersStr:o};this.$el.html(agendaTemplates.fullSession(f));if(c.length){var a=this.$(".speakersContainer");for(var g=0;g<c.length;g++){var e=new SpeakerInSessionView({model:c[g]});a.append(e.render().el)}}var n=this.$el.find(".buttonsContainer");ShareControlHelper.addShareControlButton(n,this.model);if(PLATFORM===platformEnum.nativeApp&&navigator&&navigator.events){var m=new FlatButtonView({text:_T("HtmlTextEventsAdd2CalStr"),icon:"events-add2cal"});m.bind("onButtonClicked",this._add2Calendar,this);n.append(m.render().el)}if(USE_AGENDA_FAVORITES){this.addFavButtton=new FlatButtonView({text:_T("HtmlTextAgendaAddToFav"),icon:"starEmpty"});this.addFavButtton.bind("onButtonClicked",this._onAddFavTap,this);n.append(this.addFavButtton.render().el);this.removeFavButtton=new FlatButtonView({text:_T("HtmlTextAgendaRemoveFromFav"),icon:"starFull"});this.removeFavButtton.bind("onButtonClicked",this._onRemoveFavTap,this);n.append(this.removeFavButtton.render().el);this._renderFavButton()}if(window.Scrolling){Scrolling.init(this.$(".scroll_wrapper"))}return this},_add2Calendar:function(){var b=this.model.get("locationText")||"";var c=this.model.get("hallModel");if(c){var a=c.get("name")||"";if(b&&a){b+=", "}b+=a}var d={startTime:this.model.get("startDate")/1000,endTime:this.model.get("endDate")/1000,title:this.model.get("title"),description:this.model.get("descrition"),eventLocation:b,allDayEvent:false};navigator.events.addToCalendar(d)},_onAddFavTap:function(){this.model.set({isInFavorites:true})},_onRemoveFavTap:function(){this.model.set({isInFavorites:false})},_renderFavButton:function(){if(this.model.get("isInFavorites")){this.addFavButtton.$el.hide();this.removeFavButtton.$el.show()}else{this.removeFavButtton.$el.hide();this.addFavButtton.$el.show()}}}); var FullSpeakerView=Backbone.View.extend({className:"speaker-page",initialize:function(){this.$el.attr({"data-role":"page","data-buttons":"back"})},render:function(){var c=this.model.toJSON();c.bioStaticText=_T("HtmlTextSpeakersBioTitle");this.$el.html(agendaTemplates.fullSpeaker(c));var b=this.$(".scroll_wrapper");this.$("IMG").error(function(){$(this).remove();Scrolling.onContentChanged(b)});var g=this.model.get("sessionsModels");if(g.length){var f=this.$(".sessionsContainerInSpeaker");for(var e=0;e<g.length;e++){var a=new SessionInSpeakerView({model:g[e]});f.append(a.render().el)}}var d=new ShareIconsView({model:this.model});this.$(".share-icons-container").append(d.render().el);if(window.Scrolling){Scrolling.init(b)}return this}}); var HallHeaderView=Backbone.View.extend({className:"hall_header clr_tab2Bar_bg t3d",initialize:function(){this.model.bind("hallChanged",this.render,this)},render:function(){var p=this.model.get("currHallIndex");var i=this.model.get("hallsInDateCollection");var l=i.at(p);var a="";if(l&&l.get("name")){a=l.get("name")}var q=p-1;var m=p+1;var o=(q<0);var f=(m>=i.length);var c="";var l=i.at(q);if(l&&l.get("name")){c=l.get("name")}var g="";var l=i.at(m);if(l&&l.get("name")){g=l.get("name")}var b="";var l=i.at(q-1);if(l&&l.get("name")){b=l.get("name")}var k="";var l=i.at(m+1);if(l&&l.get("name")){k=l.get("name")}var d={name:a,next:g,prev:c,next2:k,prev2:b};this.$el.html(agendaTemplates.hallHeaderTemplate(d));var e=this.$(".slideable_bar");var h=this;if(!o){var j=function(s){if(IS_RTL){var r="-50%"}else{var r="50%"}e.css({"-webkit-transition-property":"all","-webkit-transition-duration":"0.5s","-webkit-transition-timing-function":"ease-out",left:r,"-webkit-perspective":1000,"-webkit-backface-visibility":"hidden"});setTimeout(function(){h.model.changeHall(q)},500)};this.$(".prev").one("tap",j);if(IS_RTL){e.bind("swipeleft",function(r){r.preventDefault();j();return false})}else{e.bind("swiperight",function(r){r.preventDefault();j();return false})}}if(!f){var n=function(s){if(IS_RTL){var r="50%"}else{var r="-50%"}e.css({"-webkit-transition-property":"all","-webkit-transition-duration":"0.5s","-webkit-transition-timing-function":"ease-out",left:r,"-webkit-perspective":1000,"-webkit-backface-visibility":"hidden"});setTimeout(function(){h.model.changeHall(m)},500)};this.$(".next").one("tap",n);if(IS_RTL){e.one("swiperight",n)}else{e.one("swipeleft",n)}}return this}}); var sessionSideEnum={LEFT:1,RIGHT:2,BOTH:3};var SessionInCalView=Backbone.View.extend({className:"session_in_cal",FAV_COLOR_CODE:"contentSession2",NORMAL_COLOR_CODE:"contentSession",initialize:function(){if(USE_AGENDA_FAVORITES){this.model.bind("change:isInFavorites",this.render,this)}this.$el.tap(function(a){this.model.trigger("onSessionSelected",this.model)}.hitch(this))},render:function(){if(this.options.side===sessionSideEnum.LEFT){this.$el.addClass("half left")}else{if(this.options.side===sessionSideEnum.RIGHT){this.$el.addClass("half right")}}var a=AgendaTemplateHelper.getMinutes(this.model.get("startDate"));var e=this.model.get("displayEndMinutes");var f=(e-a);var k=AgendaTemplateHelper.minutesToPixels(f)-4;this.$el.css({height:k+"px"});var d={title:this.model.get("title"),time:new Date(this.model.get("startDate")).format("h:MM")};if(USE_AGENDA_FAVORITES&&this.model.get("isInFavorites")){d.colorCode=this.FAV_COLOR_CODE;this.$el.addClass("clr_contTypeA_"+this.FAV_COLOR_CODE+"_bg").removeClass("clr_contTypeA_"+this.NORMAL_COLOR_CODE+"_bg")}else{d.colorCode=this.NORMAL_COLOR_CODE;this.$el.removeClass("clr_contTypeA_"+this.FAV_COLOR_CODE+"_bg").addClass("clr_contTypeA_"+this.NORMAL_COLOR_CODE+"_bg")}if(k<50){this.$el.html(agendaTemplates.singleLineEvent(d))}else{var m="";var c=this.model.get("speakersModels");if(c.length===1){m=c[0].get("name")||"";var h=c[0].get("companyName");if(m&&h){m=m+" | "+h}}else{if(c.length>1){m=_T("HtmlTextAgendaSpeakersCount",{number:c.length})}}var j=20;var i=k-25;i=Math.floor(i/j)*j;var g=k-55;g=Math.floor(g/j)*j;d.speaker=m;d.location="";if(this.options.side===sessionSideEnum.BOTH){d.location=this.model.get("locationText")||""}d.description=this.model.get("description")||"";d.textLineHeight=j;d.textMaxHeight=i;d.locationMaxHeight=g;d.ellipsis=(i===j);d.USE_AGENDA_FAVORITES=USE_AGENDA_FAVORITES;this.$el.html(agendaTemplates.multiLinesEvent(d))}var l=this.$(".fav_button_container");if(l.length){if(!this.model.get("isInFavorites")){var b=$(agendaTemplates.addFavButton({}));b.tap(function(n){n.preventDefault();this.model.set({isInFavorites:true});return false}.hitch(this))}else{var b=$(agendaTemplates.removeFavButton({}));b.tap(function(n){n.preventDefault();this.model.set({isInFavorites:false});return false}.hitch(this))}l.append(b)}return this}}); var SessionInSpeakerView=Backbone.View.extend({className:"session_in_speaker itemArrowContainer clr_contTypeB_headerItem_bg clr_contTypeB_headerItem_brdr",render:function(){var c=new Date(this.model.get("startDate")).format("shortTime");var a=new Date(this.model.get("endDate")).format("shortTime");var b=new Date(this.model.get("startDate")).format("shortDate");var d={title:this.model.get("title"),time:c+" - "+a,date:b};this.$el.html(agendaTemplates.sessionInSpeaker(d));this.$el.tap(function(f){this.model.trigger("onSessionSelected",this.model);f.preventDefault()}.hitch(this));return this}}); var SpeakerInListView=Backbone.View.extend({className:"speaker_in_List itemContainer clr_contTypeB_bubbleItem_bg clr_contTypeB_bubbleItem_brdr feed_bubble_item",tagName:"li",render:function(){this.$el.attr("data-role","button");var h=this.model.toJSON();var m=this.model.get("sessionsModels");if(m.length){var a=new Date().getTime();var f=9999999999999;var e=-1;for(var g=0;g<m.length;g++){var j=new Date(m[g].get("startDate")).getTime();if(j>a&&j<f){f=j;e=g}}if(e>-1){var c=m[e];var b=new Date(c.get("startDate")).format("shortTime");var k=new Date(c.get("endDate")).format("shortTime");var d=new Date(c.get("startDate")).format("shortDate");h.nextSessionTitle=c.get("title");h.nextSessionDate=d;h.nextSessionTime=b+" - "+k}}this.$el.html(agendaTemplates.speakerInList(h));var l=this;this.$("IMG").error(function(){$(this).remove();var i=Scrolling.getMyScrollerWrapper(l.$el);Scrolling.onContentChanged(i)});this.$el.tap(function(i){this.model.trigger("onSpeakerSelected",this.model)}.hitch(this));return this}}); var SpeakerInSessionView=Backbone.View.extend({className:"speaker_in_session itemArrowContainer clr_contTypeB_headerItem_bg clr_contTypeB_headerItem_brdr",tagName:"li",render:function(){this.$el.attr("data-role","button");var a=this.model.get("name")||"";var d=this.model.get("image")||"";var f=this.model.get("jobTitle")||"";var c=this.model.get("companyName")||"";if(f&&c){f+=", "}if(c){f+=c}var e={name:a,image:d,title:f};this.$el.html(agendaTemplates.speakerInSession(e));var b=this;this.$("IMG").error(function(){$(this).remove();var g=Scrolling.getMyScrollerWrapper(b.$el);Scrolling.onContentChanged(g)});this.$el.tap(function(g){this.model.trigger("onSpeakerSelected",this.model);g.preventDefault()}.hitch(this));return this}}); var SpeakersListView=Backbone.View.extend({className:"speakers_list_container",render:function(){this.skip=0;this.take=15;this.$el.html("");this.renderNextBulk();return this},renderNextBulk:function(){var b=this.model.get("speakersCollection");for(var a=0;a<this.take&&this.skip<b.length;a++){var c=new SpeakerInListView({model:b.at(this.skip)});this.$el.append(c.render().el);this.skip++}if(this.skip<b.length){this.renderShowMore()}this.$myScrollWrapper=this.$myScrollWrapper||Scrolling.getMyScrollerWrapper(this.$el);Scrolling.onContentChanged(this.$myScrollWrapper);this.$("IMG").load(function(){Scrolling.onContentChanged(this.$myScrollWrapper)}.hitch(this))},renderShowMore:function(){var a=$(commonTemplates.showMoreButtonWithoutLoading({showMoreStr:_T("HtmlTextPaginationShowMoreItems")}));this.$el.append(a);var b=this;a.tap(function(c){c.preventDefault();$(this).remove();b.renderNextBulk()})}}); var blogTemplates={};blogTemplates.blogPostSummary_0=_.template('<div class="text-container"><div class="size_0 time clr_contTypeB_subTxt"><%= formattedDatetime %></div><div class="size_title_3 title clr_contTypeB_hdlTxt"><%= formattedTitle %></div><div class="size_1 max_3_lines description clr_contTypeB_txt"><%= formattedShortDesc %></div></div><% if(imageUrl){ %><div class="image sliced_image" style="background-image:url(\'<%= imageUrl %>\')"></div><% } %>');blogTemplates.blogPostSummary_4=_.template('<% if(imageUrl){ %><div class="image-container clr_images_image1_brdr clr_images_image1_bg"><div class="image sliced_image" style="background-image:url(\'<%= imageUrl %>\')"></div></div><% } %><div class="size_0 time clr_contTypeB_subTxt"><%= formattedDatetime %></div><div class="size_title_3 title clr_contTypeB_hdlTxt"><%= formattedTitle %></div><% if(formattedShortDesc){ %><div class="size_1 max_3_lines description clr_contTypeB_txt"><%= formattedShortDesc %></div><% } %>');blogTemplates.blogPostSummary_2=_.template('<div class="image sliced_image" style="background-image:url(\'<%= imageUrl %>\');"></div><div class="text-place-holder"><div class="text-container clr_contTypeC_bg"><div class="size_0 time clr_contTypeC_subTxt"><%= formattedDatetime %></div><div class="size_title_3 title clr_contTypeC_hdlTxt"><%= formattedTitle %></div></div></div><div class="size_1 max_3_lines description clr_contTypeB_txt"><%= formattedShortDesc %></div>');blogTemplates.blogPostSummary_5=_.template('<div class="image sliced_image" style="background-image:url(\'<%= imageUrl %>\');"><div class="text-container clr_contTypeC_bg"><div class="size_0 time clr_contTypeC_subTxt"><%= formattedDatetime %></div><div class="size_title_3 title clr_contTypeC_hdlTxt"><%= formattedTitle %></div></div></div>');blogTemplates.blogPostSummary_6=_.template('<div class="size_0 time clr_contTypeB_subTxt"><%= formattedDatetime %></div><div class="size_title_3 title clr_contTypeB_hdlTxt"><%= formattedTitle %></div>');blogTemplates.blogPostSummary_3=_.template('<div class="size_0 time clr_contTypeB_subTxt"><%= formattedDatetime %></div><div class="size_title_3 title clr_contTypeB_hdlTxt"><%= formattedTitle %></div><% if(imageUrl){ %><div class="image sliced_image" style="background-image:url(\'<%= imageUrl %>\');" /><% } %><div class="size_1 max_3_lines description clr_contTypeB_txt"><%= formattedShortDesc %></div>');blogTemplates.blogPost=_.template('<div class="scroll_wrapper"><div class="scroller t3d"><div class="header box_padding clr_contTypeB_headerItem_bg clr_contTypeB_headerItem_brdr"><div class="size_title_3 title clr_contTypeB_hdlTxt"><%= title %></div><% if(typeof(author) != "undefined"){ %><div class="author clr_contTypeB_subTxt"><%= author %></div><% } %><div class="size_0 time clr_contTypeB_subTxt"><%= formattedDatetime %></div><div class="control_buttons_container"></div></div><div class="size_1 description_full box_padding clr_contTypeA_bg"></div></div></div>');blogTemplates.postsList=_.template('<div class="scroll_wrapper"><div class="scroller"></div></div>');blogTemplates.viewOriginalSiteButton=_.template('<div class="view_original_container"><div class="view_original_button clr_appGeneral_floatBtn_bg clr_appGeneral_floatBtn_brdr clr_appGeneral_floatBtn_hdlTxt clr_appGeneral_floatBtn_icn" data-role="button"><%= viewOriginalSite %></div></div>'); var BlogPostModel=ItemModel.extend({initialize:function(){var a=this.get("contentWithHtml");if(!a){a=this.get("descriptionWithHtml")}var c=null;if(PLATFORM===platformEnum.nativeApp){var b=this.get("geo");if(b){b.lon=b["long"]}c=HtmlModule.manipulateHtml(a,{changeColors:true})}this.set({shareInfo:this.getShareInfo(),fullHtmlContent:a,manipulatedHtml:c})},getShareInfo:function(){var a=this.get("socialInfo");a.emailTitle=_T("SRssShareEmailSubject",{title:this.get("blogTitle")});a.emailDesc=a.title+"\n\n"+a.shortDesc;return a}}); var BlogPostsModel=ItemsModel.extend({createItemsCollection:function(){return new BlogPostsCollection(null,{extraInfo:this.get("params"),feedUrl:this.get("url"),take:this.get("take")})}}); var BlogPostsCollection=ItemsCollection.extend({model:BlogPostModel,POSTS_TAKE_COUNT:25,initialize:function(b,a){ItemsCollection.prototype.initialize.apply(this);if(!a.feedUrl){this.invalid=true}this.params={feedUrl:a.feedUrl,extraInfo:a.extraInfo,take:a.take||this.POSTS_TAKE_COUNT}},getServiceName:function(){return"CMS_FEEDS_GET"},parse:function(a){if(a&&a.link){this.trigger("viewOriginalSite",a.link)}if(this.skip==0&&a.items&&a.items.length>0){a.items[0].isFirst=true}_.each(a.items,function(b){b.blogTitle=a.title});return{models:a.items}},getParams:function(){this.params.skip=this.skip;return this.params}}); var BlogTemplateView=TemplateView.extend({render:function(a){var d=this.model.get("meta");var b=new BlogPostsModel(d[this.options.tabsName][a]);if(d.pageLayout==1||!d.pageLayout||d.pageLayout<0||d.pageLayout>6){d.pageLayout=0}b.set({layoutId:d.pageLayout,layoutParams:d.layoutParams});b.bind("itemSelected",this.onPostSelected,this);var c=new BlogPostsView({model:b,id:"home_"+Utils.Helpers.generateGUID(),showMoreStr:_T("HtmlTextBlogShowMorePosts"),loadingStr:_T("HtmlTextBlogLoadingPosts"),failStr:_T("ToastMessageBlogFailedGetPosts")});this.$el.append(c.render().el);b.getItems(executeTypeEnum.HIT_AND_RUN);this._homePagesViews[a]=c;TemplateView.prototype.render.apply(this,[a]);return this},_onDetailsPageShow:function(){if(window.Scrolling){Scrolling.resetScroll()}},onPostSelected:function(a,b){if(this.detailsPage){this.detailsPage.remove()}this.detailsPage=new BlogPostView({model:a,id:"details_"+Utils.Helpers.generateGUID()});this.detailsPage.bind("onShowOnMapTap",this._onShowOnMapTap,this);this.$el.append(this.detailsPage.render().el);$("#"+this.detailsPage.id).bind("pageshow",this._onDetailsPageShow.hitch(this));$.mobile.changePage("#"+this.detailsPage.id,{transition:"slide",reverse:IS_RTL})},_onShowOnMapTap:function(b){var c=b.get("geo");if(c.lat&&c["long"]){var a={location:{lat:c.lat,lng:c["long"]},header:b.get("formattedTitle"),address:""};var b=new Backbone.Model({markers:[a]});MapManager.show_on_map(this.$el,b)}}}); var BlogWideTemplateView=TemplateView.extend({initialize:function(b,a){TemplateView.prototype.initialize.apply(this);this.dividedScreenView=[];this.detailsPage=[]},render:function(b){var d=this.model.get("meta");var c=new BlogPostsModel(d[this.options.tabsName][b]);if(d.pageLayout==1||!d.pageLayout||d.pageLayout<0||d.pageLayout>6){d.pageLayout=0}c.set({layoutId:d.pageLayout});this.listView=new BlogPostsView({model:c,id:"home_"+Utils.Helpers.generateGUID(),showMoreStr:_T("HtmlTextBlogShowMorePosts"),loadingStr:_T("HtmlTextBlogLoadingPosts"),failStr:_T("ToastMessageBlogFailedGetPosts")});this.dividedScreenView[b]=new DividedScreenView({id:"divided_screen_"+Utils.Helpers.generateGUID()});var a=function(e,f){this.onItemSelected(e,f,b)};c.bind("itemSelected",a,this);c.get("items").onItemsReady(this.onItemsReady.hitch(this));this.dividedScreenView[b].setView1(this.listView.render());this.$el.append(this.dividedScreenView[b].render().addRefreshButton(true).el);this._homePagesViews[b]=this.dividedScreenView[b];TemplateView.prototype.render.apply(this,[b]);c.getItems(executeTypeEnum.HIT_AND_RUN);return this},onItemSelected:function(b,c,a){if(!c){if(this.detailsPage[a]){this.detailsPage[a].remove();this.detailsPage[a]=null}this.detailsPage[a]=new BlogPostView({model:b,id:"details_"+Utils.Helpers.generateGUID()});this.detailsPage[a].bind("onShowOnMapTap",this._onShowOnMapTap,this);this.dividedScreenView[a].setView2(this.detailsPage[a].render())}},onItemsReady:function(b){if(b.length>0){var a=b.at(0);a.trigger("itemClicked",a)}},_onShowOnMapTap:function(b){var c=b.get("geo");if(c.lat&&c["long"]){var a={location:{lat:c.lat,lng:c["long"]},header:b.get("formattedTitle"),address:""};var b=new Backbone.Model({markers:[a]});MapManager.show_on_map(this.$el,b)}}}); var BlogPostSummaryView=Backbone.View.extend({tagName:"li",className:"clr_contTypeB_bubbleItem_bg clr_contTypeB_bubbleItem_brdr t3d feed_bubble_item",events:{tap:"itemClicked"},initialize:function(){this.model.bind("change:selected",this.onSelectedChange,this)},render:function(){this.$el.attr("data-role","button");this.model.set({formattedDatetime:Utils.TimeDate.timeAsText(this.model.get("datetime")),formattedShortDesc:Utils.String.sanitizeText($.trim(this.model.get("description"))),formattedTitle:$.trim(this.model.get("socialInfo").title)});var a=blogTemplates["blogPostSummary_"+this.options.layoutType];if(this.options.layoutType==0&&this.model.get("isFirst")){a=blogTemplates.blogPostSummary_2;this.$el.addClass("layout-2")}else{this.$el.addClass("layout-"+this.options.layoutType)}if(this.options.layoutParams){if(this.options.layoutParams.useFlat){this.$el.removeClass("feed_bubble_item")}}this.$el.append(a(this.model.toJSON()));if(this.model.get("imageUrl")){this.$el.addClass("with-image")}else{this.$el.addClass("no-image")}return this},onSelectedChange:function(){if(LAYOUT===layoutFormat.wide){if(this.model.get("selected")){this.$el.addClass("selected")}else{this.$el.removeClass("selected")}}},itemClicked:function(a){a.preventDefault();this.model.trigger("itemClicked",this.model)}}); var BlogPostView=Backbone.View.extend({className:"blog-post",initialize:function(){this.$el.attr({"data-role":"page","data-buttons":"back"})},render:function(){var c=this.model.toJSON();if(c.author){c.author=_T("HtmlTextBlogbyAuthor",{author:c.author})}this.$el.append(blogTemplates.blogPost(c));if(window.Scrolling){Scrolling.init(this.$el.find(".scroll_wrapper"))}var a=this.$el.find(".description_full");var b=new HtmlContainerControl();var d=this.model.get("fullHtmlContent");b.renderHtml(a,d,{changeColors:true});if(this.model.get("link")){a.append(templates.viewOriginalTemplate({text:_T("HtmlTextBlogViewOriginalPost")}))}this.$el.find(".view-orig-container").tap(this._onViewOrigTap.hitch(this));this.addButtons(c);return this},addButtons:function(a){var c=this.$el.find(".control_buttons_container");if(a.geo){var b=new FlatButtonView({text:_T("HtmlTextShowOnMapButtonStr"),icon:"show-on-map"});b.bind("onButtonClicked",this._onShowOnMapTap,this);c.append(b.render().el)}ShareControlHelper.addShareControlButton(c,this.model)},_onShowOnMapTap:function(){this.trigger("onShowOnMapTap",this.model)},_onViewOrigTap:function(a){a.preventDefault();conduitApi.app.openLink(null,null,{url:this.model.get("link")})},appendToView:function(a){this.$el.find(".scroller").append(a)}}); var BlogPostsView=ItemsView.extend({initialize:function(){this.$el.attr({"data-role":"page","data-buttons":"navigation refresh"});this.$el.html(blogTemplates.postsList());Scrolling.init(this.$el.find(".scroll_wrapper"));this.$scroller=this.$el.find(".scroller");this.$el.bind("refresh",this.handleRefreshClick.hitch(this));this.$el.bind("silentRefresh",this.handleSilentRefresh.hitch(this));var a=this.model.get("items");if(a){a.bind("viewOriginalSite",this._onViewOriginalSite,this)}ItemsView.prototype.initialize.apply(this)},_onViewOriginalSite:function(a){if(this.model.get("showViewOriginalSite")){if(!this.$viewOriginalSite){this.$viewOriginalSite=$(blogTemplates.viewOriginalSiteButton({viewOriginalSite:_T("HtmlTextBlogViewOriginalSite")}));this.getRootView().append(this.$viewOriginalSite);this.$viewOriginalSite.tap(this._onViewOriginalTap.hitch(this))}this.viewOriginalLink=a}},_onViewOriginalTap:function(){if(this.viewOriginalLink){conduitApi.app.openLink(null,null,{url:this.viewOriginalLink,title:this.viewOriginalLink})}},getRootView:function(){return this.$scroller},createItemView:function(a){return new BlogPostSummaryView({model:a,layoutType:this.model.get("layoutId"),layoutParams:this.model.get("layoutParams"),id:"blog_post_view_"+Utils.Helpers.generateGUID()})},addTabsView:function(a){this.getRootView().prepend(a)}}); var usersTemplates={};usersTemplates.usersPage=_.template('<div class="scroll_wrapper"><div class="scroller"><div class="noUsersContainer"></div><div class="search_placement"></div></div></div>');usersTemplates.search_view=_.template('<div class="search_container clr_contTypeB_bg clr_contTypeB_brdr">	<form class="search_form" action="javascript:void(0)">		<input type="text" class="search_input rounded_corners_all clr_form_input_bg clr_form_input_brdr clr_form_input_txt" placeholder="" />		<a class="search_button clr_contTypeB_btn_bg clr_contTypeB_btn_brdr clr_contTypeB_btn_hdlTxt rounded_corners_all" data-role="button">			<div class="mask_sprite sprite-search clr_contTypeB_btn_icn"></div>		</a>		<input type="submit" style="display: none">	</form></div>');usersTemplates.userInList=_.template('<div class="image sliced_image" style="background-image:url(\'<%= img %>\')"></div><div class="user_data">	<div class="size_title_1 user_name clr_contTypeA_hdlTxt"><%= name %></div>	<% if (job_title_full) { %>		<div class="size_0 user_title clr_contTypeA_subTxt">			<%= job_title_full %>		</div>	<% } %>	<% if (extra_info) { %>		<div class="size_0 user_field clr_contTypeA_subTxt">			<%= extra_info %>		</div>	<% } %></div> <div class="slide_arrow_image mask_sprite sprite-arrow clr_contTypeA_icn"></div>');usersTemplates.userPage=_.template('<div class="scroll_wrapper"><div class="scroller">	<div class="user_profile_container">	</div>	<div class="user_action_say_hello user_action clr_contTypeA_bg clr_contTypeA_brdr" data-role="button">		<div class="user_action_icon sprite sprite-aboutus_chat"></div>		<div class="vertical_align_container">			<div class="user_action_caption clr_contTypeA_txt"><%= _T("UserSayHelloTo", { user_caption : name }) %></div>		</div>	</div> 	<div class="user_action_google user_action clr_contTypeA_bg clr_contTypeA_brdr" data-role="button">		<div class="user_action_icon sprite sprite-aboutus_google"></div>		<div class="vertical_align_container">			<div class="user_action_caption clr_contTypeA_txt"><%= _T("UserGoogle", { user_caption : name }) %></div>		</div>	</div> </div></div>');usersTemplates.noSearchResults=_.template('<div class="no_results_container no_search_results_container clr_contTypeB_bg clr_contTypeB_brdr"><div class="icon mask_sprite sprite-noSearchItemsIcn clr_contTypeB_subIcn"></div><div class="title size_title_4 clr_contTypeB_hdlTxt"><%= _T("UserSearchNoResultsFound") %></div><div class="subtitle size_title_1 clr_contTypeB_subTxt"><%= _T("UserSearchNoResultsFoundSubtitle") %></div></div>'); var UsersModel=ItemsModel.extend({createItemsCollection:function(){var a=new UsersCollection(null,this.get("params"));a.defaultImg=this.get("defaultImg");return a}}); var UsersCollection=ItemsCollection.extend({model:UserModel,POSTS_TAKE_COUNT:25,initialize:function(b,a){ItemsCollection.prototype.initialize.apply(this);this.params=$.extend({search_term:""},a)},getServiceName:function(){return"CMS_USERS_SEARCH_GET"},parse:function(a){var c=this.defaultImg,g=[],b,e;var f=a.users,d=f.length-1;for(;d>=0;d--){b=f[d];if(!b.img&&c){b.img=c}e=new UserModel(b);e.bind("openChat",this.onOpenChat,this);g.push(e)}return{models:g,metaData:{total:a.total}}},onOpenChat:function(a,b){this.trigger("openChatHack",a,b)},getParams:function(){this.params.skip=this.skip;return this.params}}); var UsersTemplateView=TemplateView.extend({events:{"tap .search_button":"onUsersSearchButtonClicked","submit .search_form":"onUsersSearchButtonClicked",},render:function(b){var c=this.model.get("meta");var a=new UsersModel(c[this.options.tabsName][b]);a.set({pageLayout:c.pageLayout});a.bind("itemSelected",this.onUserSelected,this);a.get("items").bind("openChatHack",this.onOpenChat,this);this.mainView=new UsersView({model:a,id:"home_"+Utils.Helpers.generateGUID()});this.$el.append(this.mainView.render().el);a.getItems(executeTypeEnum.HIT_AND_RUN);this._homePagesViews[b]=this.mainView;TemplateView.prototype.render.apply(this,[b]);return this},onOpenChat:function(a,c){if(this.chatPage){this.chatPage.remove()}var b=new ChatModel({discussionId:null,participants:[a]});this.chatPage=new ChatPageView({model:b,message:c,id:"chatPage_"+Utils.Helpers.generateGUID()});this.$el.append(this.chatPage.render().el);$.mobile.changePage("#"+this.chatPage.id,{transition:"slide",reverse:IS_RTL})},_onDetailsPageShow:function(){if(window.Scrolling){Scrolling.resetScroll()}},onUsersSearchButtonClicked:function(c){var f=$(c.target).closest("[data-role=page]"),d=f.find(".search_input"),a=$.trim(d.val());var b=this.usersSearchResults(a);d.val("");d.blur()},onUserSelected:function(a,b){if(this.detailsPage){this.detailsPage.remove()}this.detailsPage=new UserFullView({model:a,id:"details_"+Utils.Helpers.generateGUID()});this.$el.append(this.detailsPage.render().el);$("#"+this.detailsPage.id).bind("pageshow",this._onDetailsPageShow.hitch(this));$.mobile.changePage("#"+this.detailsPage.id,{transition:"slide",reverse:IS_RTL})},usersSearchResults:function(c){if(this.searchPage!=null){this.searchPage.remove()}var d=this.mainView.model.get("params");$.extend(d,{search_term:c});var a=new UsersModel({params:d});a.bind("itemSelected",this.onUserSelected,this);""+a.get("items").bind("openChat",this.onOpenChat,this);var b=new UsersView({model:a,id:"search_res"+Utils.Helpers.generateGUID(),});b.$el.attr("data-buttons","back");a.getItems(executeTypeEnum.HIT_AND_RUN);this.searchPage=b;this.$el.append(b.render().el);b.$el.find(".search_placement").hide();$.mobile.changePage("#"+this.searchPage.id,{transition:"slide",reverse:IS_RTL})}}); var UserFullView=Backbone.View.extend({className:"user_page",initialize:function(){this.$el.attr({"data-role":"page","data-buttons":"back"});this.$el.bind("pageshow",this.onPageShow.hitch(this));this.$el.bind("pagehide",this.onPageHide.hitch(this))},render:function(){var d=this.model.toJSON();this.$el.append(usersTemplates.userPage(d));var h=new UserProfileView({model:this.model});var c=this.$(".user_profile_container");c.html(h.render().el);var a=this.model.get("name");if(a){var i=this.$(".user_action_google");var f=this.createGoogleSearchLink(this.model.get("name"));i.bind("tap",{href:f},this.onLinkTap)}var g=this.$(".user_action_say_hello");if(g){if(this.model.get("id")===ProfileManager.getUserId()){g.remove()}else{g.tap(this.onSayHello.hitch(this))}}if(window.Scrolling){Scrolling.init(this.$(".scroll_wrapper"))}var e=this;var b=function(){Scrolling.onContentChanged(e.$(".scroll_wrapper"))};if(ProfileManager.getUserId()){b()}else{ProfileManager.login(b,null,ProfileManager.socialProviderEnum.LINKEDIN)}return this},onSayHello:function(c){var a=this.model.toJSON();var b="Hi there! I'm having a blast at SXSW. You?";this.model.trigger("openChat",a,b)},onLinkTap:function(b){var a={url:b.data.href,openInCurrentWindow:false};conduitApi.app.openLink(null,null,a);return false},onSendMessage:function(a){alert(a)},onPageShow:function(){},onPageHide:function(){},createGoogleSearchLink:function(a){return"http://www.google.com/search?q="+encodeURIComponent(a)}}); var UserShortView=Backbone.View.extend({tagName:"li",className:"t3d users_list_item clr_contTypeA_bg clr_contTypeA_brdr",events:{tap:"itemClicked"},initialize:function(){this.model.bind("change:selected",this.onSelectedChange,this)},render:function(){this.$el.attr("data-role","button");var b=$.extend({},this.model.toJSON());var c=b.meta.job_title;if(c&&b.meta.company){c=_T("SUserJobTitleFull",{job_title:c,company:b.meta.company})}var a=b.meta.field;if(a&&b.meta.country){a=a+", "+b.meta.country}b.job_title_full=c;b.extra_info=a;this.$el.append(usersTemplates.userInList(b));return this},onSelectedChange:function(){if(LAYOUT===layoutFormat.wide){if(this.model.get("selected")){this.$el.addClass("selected")}else{this.$el.removeClass("selected")}}},itemClicked:function(a){a.preventDefault();this.model.trigger("itemClicked",this.model)}}); var UsersView=ItemsView.extend({attributes:{"data-role":"page","data-buttons":"navigation refresh"},initialize:function(){this.$el.html(usersTemplates.usersPage());Scrolling.init(this.$(".scroll_wrapper"));this.$scroller=this.$(".scroller");this.$noUsersContainer=this.$(".noUsersContainer");this.$scroller.find(".search_placement").append(usersTemplates.search_view());this.$el.bind("refresh",this.handleRefreshClick.hitch(this));this.$el.bind("silentRefresh",this.handleSilentRefresh.hitch(this));this.$el.bind("pageshow",this.onPageShow.hitch(this));ItemsView.prototype.initialize.apply(this)},onPageShow:function(){var b=this;var a=function(c){if(c){b.handleRefreshClick()}};LoginOverlay.execute(a)},getRootView:function(){return this.$scroller},createItemView:function(a){return new UserShortView({model:a,pageLayout:this.model.get("pageLayout")})},_reset:function(){this.$scroller.removeClass("noUsers");this.$noUsersContainer.removeClass("noUsers").html("");ItemsView.prototype._reset.apply(this,arguments)},onNoResults:function(){this.$scroller.addClass("noUsers");this.$noUsersContainer.addClass("noUsers").html(usersTemplates.noSearchResults())},addTabsView:function(a){this.getRootView().prepend(a)}}); var pollTemplates={};pollTemplates.mainPage=_.template('<div class="scroll_wrapper"><div class="scroller"></div></div>');pollTemplates.pollItem=_.template('<% if(typeof(questionImage)!= "undefined" && questionImage){ %><div class="header sliced_image" style="background-image:url(<%= questionImage %>);"><% if(typeof(text)!= "undefined" && text){ %><div class="header_box clr_contTypeC_bg"><div class="size_title_3 max_3_lines question_title clr_contTypeC_hdlTxt"><%= text %></div></div><% } %></div><% } %><li class ="answersContainer"></li>');pollTemplates.pollAnswer=_.template('<% if(answerImage){ %><div class="answerImage sliced_image link" style="background-image:url(<%= answerImage %>);"></div><% } %><div class="data_container link"><% if(answerText){ %><div class="size_title_1 answerText clr_contTypeA_hdlTxt"><%= answerText %></div><% } %><% if(answerDescription){ %><p class="size_1 answerDescription clr_contTypeA_txt"><%= answerDescription %></p><% } %></div><% if(wasAnswer){ %><% if(isTheChosenOne){ %><div class="done-icon sprite sprite-v_icon"></div><% } %><% }else{ %><div class="button_container"></div><% } %>'); var PollModel=ItemsModel.extend({createItemsCollection:function(){return new PollCollection(null,this.get("params"))}}); var PollItemModel=ItemModel.extend({STORAGE_KEY:"POLL_ANSWERED",initialize:function(){this._getAnsweredFromStorage();var a=[];_.each(this.get("answers"),function(b){b.wasAnswer=!!this._lastAnswer;b.isTheChosenOne=(this._lastAnswer===b.answerId);b.questionModel=this;var c=new PollAnswerModel(b);a.push(c)}.hitch(this));this.set({answersModels:a})},vote:function(g,a,e){_.each(this.get("answersModels"),function(h){h.set({wasAnswer:true})});var c=function(){_.each(this.get("answersModels"),function(h){h.set({wasAnswer:false})});Utils.Helpers.funcWrapper(e)()};var b=function(){g.set({isTheChosenOne:true});this._lastAnswer=g.get("answerId");this._setAnsweredToStorage();Utils.Helpers.funcWrapper(a)()};var d={postParams:{pollResultHeader:{deviceType:DeviceToken.getDeviceToken(),latitude:null,longitude:null,uuid:UserManager.getUserId(),appId:APP_ID},pollResultData:{pollId:this.get("pollId"),answers:[{questionId:this.get("questionId"),answerId:g.get("answerId"),answerText:null}]}}};var f={};Services.executeService("CONTACT_POLLS_POST",f,b.hitch(this),c.hitch(this),d)},_getAnsweredFromStorage:function(){if(conduitApi.platform.storage.isSupported()){var a=conduitApi.platform.storage.getItem(null,null,this.STORAGE_KEY+this.get("questionId "),true);if(a){this._lastAnswer=JSON.parse(a)}}},_setAnsweredToStorage:function(){if(conduitApi.platform.storage.isSupported()){var a=JSON.stringify(this._lastAnswer);conduitApi.platform.storage.setItem(null,null,this.STORAGE_KEY+this.get("questionId "),a,true)}}}); var PollAnswerModel=Backbone.Model.extend({defaults:{wasAnswer:false,isTheChosenOne:false,answerDescription:"",answerId:"",answerImage:"",answerLink:"",answerText:""},vote:function(a,b){this.get("questionModel").vote(this,a,b)}}); var PollCollection=ItemsCollection.extend({model:PollItemModel,initialize:function(b,a){ItemsCollection.prototype.initialize.apply(this);if(!a||!a.pollId){this.invalid=true}this.params=a},getServiceName:function(){return"CMS_POLLS_GET"},parse:function(a){var b=this.params.pollId;_.each(a.questions,function(c){c.pollId=b});return{models:a.questions}},getParams:function(){return this.params}}); var PollTemplateView=TemplateView.extend({render:function(b){var c=this.model.get("meta");var a=new PollModel(c[this.options.tabsName][b]);var d=new PollView({model:a,id:"home_"+Utils.Helpers.generateGUID()});this.$el.append(d.render().el);a.getItems(executeTypeEnum.HIT_AND_RUN);this._homePagesViews[b]=d;TemplateView.prototype.render.apply(this,[b]);return this}}); var PollItemView=Backbone.View.extend({tagName:"li",render:function(){this.$el.append(pollTemplates.pollItem(this.model.toJSON()));var a=this.$(".answersContainer");var b=this.model.get("answersModels");_.each(b,function(d){var c=new PollAnswerView({model:d});a.append(c.render().el)});return this}}); var PollAnswerView=Backbone.View.extend({tagName:"li",className:"answer_item clr_contTypeA_bg clr_contTypeA_brdr",initialize:function(){this.model.bind("change:wasAnswer",this.render,this);this.model.bind("change:isTheChosenOne",this.render,this)},render:function(){this.$el.html(pollTemplates.pollAnswer(this.model.toJSON()));if(this.model.get("wasAnswer")){if(this.model.get("isTheChosenOne")){this.$el.addClass("selected")}}else{var c=this.$(".button_container");var b=new FlatButtonView({text:_T("HtmlTextPollVoteButton"),icon:"like_icon"});b.bind("onButtonClicked",this.onVoteClick,this);c.append(b.render().el)}var a=this.$(".link");a.tap(this.onLinkClick.hitch(this));return this},onVoteClick:function(){var a=function(f){conduitApi.UI.dismissActivityIndicator(null,null,this.$el);var e=[{text:_T("ButtonClose")}];conduitApi.UI.showDialogBox(null,null,{title:_T("DialogCaptionSuccess"),message:_T("DialogMessagePollVoteSuccess"),buttons:e})};var b=function(f){conduitApi.UI.dismissActivityIndicator(null,null,this.$el);var e=[{text:_T("ButtonClose")}];conduitApi.UI.showDialogBox(null,null,{title:_T("DialogCaptionError"),message:_T("DialogMessagePollVoteFail"),buttons:e})};var c=[{text:_T("ButtonOk"),cb:function(){conduitApi.UI.startActivityIndicator(function(){this.model.vote(a,b)}.hitch(this),null,_T("IndicatorLoading"),this.$el)}.hitch(this)},{text:_T("ButtonCancel")}];conduitApi.UI.showDialogBox(null,null,{title:_T("DialogCaptionConfirm"),message:_T("DialogMessagePollAreYouSureVote",{text:this.model.get("answerText")}),buttons:c})},onLinkClick:function(b){b.preventDefault();var a=this.model.get("answerLink");if(a){if(conduitApi.app.isSupported()){conduitApi.app.openLink(null,null,{url:a,title:this.model.get("answerText")})}}}}); var PollView=ItemsView.extend({initialize:function(){this.$el.attr({"data-role":"page","data-buttons":"navigation refresh"});this.$el.html(pollTemplates.mainPage({}));Scrolling.init(this.$(".scroll_wrapper"));this.$scroller=this.$(".scroller");this.$el.bind("refresh",this.handleRefreshClick.hitch(this));this.$el.bind("silentRefresh",this.handleSilentRefresh.hitch(this));ItemsView.prototype.initialize.apply(this)},getRootView:function(){return this.$scroller},createItemView:function(a){return new PollItemView({model:a,id:"poll_view_"+Utils.Helpers.generateGUID()})},addTabsView:function(a){this.getRootView().prepend(a)}}); var quizTemplates={quizzes_list_page_tpl:_.template('<div class="scroll_wrapper"><div class="scroller"><% if(header){ %><div class="quizzes_header clr_contTypeB_headerItem_bg clr_contTypeB_headerItem_brdr"><% if(header.title){ %><div class="size_title_3 quizzes_title clr_contTypeB_hdlTxt"><%= header.title %></div><% } %><% if(header.descr){ %><div class="size_1 quizzes_descr clr_contTypeB_txt"><%= header.descr %></div><% } %></div><% } %><div class="quizzes_list clr_contTypeA_bg"></div></div></div>'),quiz_list_item_tpl:_.template('<div class="quiz_list_item_image sliced_image"<% if(imageUrl){ %> style="background-image:url(<%= imageUrl %>);"<% } %>></div><% if(title){ %><div class="quiz_list_item_title clr_contTypeC_bg clr_contTypeC_hdlTxt ellipsis"><%= title %></div><% } %>'),quiz_tpl:_.template('<div class="scroll_wrapper"><div class="scroller"><% if(typeof(coverImage)!= "undefined" && coverImage){ %><div class="header sliced_image" style="background-image:url(<%= coverImage %>);"><% if(typeof(title)!= "undefined" && title){ %><div class="header_box clr_contTypeC_bg"><div class="size_title_3 max_3_lines quiz_title clr_contTypeC_hdlTxt"><%= title %></div></div><% } %></div><% } %><div class ="dataFrame active"></div><div class ="dataFrame inactive"></div></div></div>'),start_quiz_frame:_.template('<div class ="textFrame clr_contTypeA_bg"><% if(description){ %><div class="size_1 quiz_description clr_contTypeA_txt"><%= description %></div><% } %><div class="startQuizButton_container"><a class="startQuizButton clr_contTypeA_btn_bg clr_contTypeA_btn_brdr clr_contTypeA_btn_hdlTxt" data-role="button"><%= startButtonText %></a></div></div>'),questions_frame:_.template('<div class="questionPositionContainer clr_tab2Bar_bg"></div><div class ="questionFrame t3d current"></div><div class ="questionFrame t3d next"></div>'),question_frame:_.template('<div class="questionPosition clr_tab2Bar_item_txt selected"><%= questionPosition %></div><div class ="textFrame clr_contTypeA_bg"><% if(question){ %><div class="size_1 quiz_question clr_contTypeA_txt"><%= question %></div><% } %><div class="answersContainer"></div></div>'),answer_tpl:_.template('<a class="answerButton clr_contTypeA_btn_bg clr_contTypeA_btn_brdr clr_contTypeA_btn_hdlTxt"><%= answerText %></a>'),result_tpl:_.template('<span class="size_title_1 result_bold clr_contTypeB_hdlTxt"><%= result %></span>'),end_quiz_tpl:_.template('<div class="end_page inactive clr_contTypeB_bg"><div class="scroll_wrapper"><div class="scroller"><% if(title){ %><div class="size_title_3 quiz_end_title clr_contTypeB_hdlTxt"><%= title %></div><% } %><div class="size_1 quiz_result clr_contTypeB_subTxt"><%= result %></div><% if(gradeImage){ %><div class="gradeImage sliced_image" style="background-image:url(<%= gradeImage %>);"></div><% } else { %><div class="gradeText"><%= gradeText %></div><% } %><div class="buttonsContainer"></div></div></div></div>')}; var QuizModel=ItemsModel.extend({initialize:function(){var a=this.get("params");if(!a){return}ItemsModel.prototype.initialize.apply(this,arguments);this.set({id:a.id});this.get("items").bind("getItemsSuccess",this._onGetItemsSuccess,this)},createItemsCollection:function(){var a=this.get("params");return new QuizCollection(null,a)},getGradeText:function(){var d=this.get("points");var e=this.get("quizData");var a=this.get("grades");var c=Math.floor(100*d/e.questionsCount)+"%";if(a){for(var b=0;b<a.length;b++){if(a[b].value<=d){if(a[b].text){c=a[b].text}}}}return c},getGradeImage:function(){var d=this.get("points");var e=this.get("quizData");var a=this.get("grades");var b="";if(a){for(var c=0;c<a.length;c++){if(a[c].value<=d){if(a[c].imageUrl){b=a[c].imageUrl}}}}return b},_onGetItemsSuccess:function(a){this.set({meta:a});this.trigger("getItemsSuccess",this)},getShareInfo:function(){var c={};var b=this.get("quizData").title;var a=_T("SQuizShareTitle",{title:b});var d=_T("SQuizShareBody",{title:b,grade:this.getGradeText()});c.shortDesc=d;c.title=a;return c}}); var QuestionModel=ItemModel.extend({buildFromJSON:function(a){this.set(a)}}); var QuizCollection=ItemsCollection.extend({model:QuestionModel,initialize:function(b,a){ItemsCollection.prototype.initialize.apply(this);if(!a||!a.pollId){this.invalid=true}this.params=a},getServiceName:function(){return"CMS_POLLS_GET"},parse:function(a){a.questionsCount=a.questions.length;return{models:a.questions,metaData:a}},getParams:function(){return this.params}}); var QuizTemplateView=TemplateView.extend({render:function(a){var c=this.model.get("meta");var b=null;if(c.items.length>1){b=new QuizzesListView({model:this.model,id:"home_"+Utils.Helpers.generateGUID()});b.bind("quizSelected",this.onQuizSelected,this)}else{if(c.items.length==1&&c.items[0].params){b=this.createQuizPage(c.items[0])}else{b=this.createQuizPage({})}}this._homePagesViews[a]=b;this.$el.html(b.render().el);return this},createQuizPage:function(b){var a=new QuizView({model:new QuizModel(b),id:"quiz_page_"+Utils.Helpers.generateGUID()});return a},onQuizSelected:function(c){var a=this.createQuizPage(c.toJSON());a.$el.attr({"data-buttons":"back refresh"});this.$el.append(a.render().el);var b="#"+a.id;$.mobile.changePage(b,{transition:"slide",reverse:IS_RTL})}}); var QuizzesListView=Backbone.View.extend({attributes:{"data-role":"page","data-buttons":"navigation",id:this.id},initialize:function(){$(window).bind("throttledresize",this.onResize.hitch(this));this.$el.bind("pageshow",this.onPageShow.hitch(this));this.$el.bind("pagehide",this.onPageHide.hitch(this));this.onPageHide()},render:function(){var d=this.model.get("meta").header||null;this.$el.html(quizTemplates.quizzes_list_page_tpl({header:d}));var c=this.$(".scroll_wrapper");this.$quizzesList=this.$(".quizzes_list");var a=this.model.get("meta").items;var b=this;_.each(a,function(f,e){b._renderOneQuiz(f)});Scrolling.init(c);return this},_renderOneQuiz:function(b){var c=new QuizModel(b);var a=new QuizItemView({model:c});a.bind("quizClicked",this.onQuizSelected,this);this.$quizzesList.append(a.render().el)},updateThumbnailsMargin:function(){if(this.$quizzesList){Utils.Html.setGridMargin(this.$quizzesList)}},onResize:function(){if(this.isPageShow){this.updateThumbnailsMargin()}},onPageShow:function(){this.isPageShow=true;setTimeout(function(){this.updateThumbnailsMargin()}.hitch(this),10)},onPageHide:function(){this.isPageShow=false},onQuizSelected:function(a){this.trigger("quizSelected",a)}}); var QuizItemView=Backbone.View.extend({className:"quiz_list_item",events:{tap:"itemClicked"},render:function(){this.$el.html(quizTemplates.quiz_list_item_tpl(this.model.toJSON()));return this},itemClicked:function(a){a.preventDefault();conduitApi.analytics.addEvent(null,null,conduitApi.analytics.usageEventTypeEnum.ViewChanged,{viewId:this.model.get("id")});this.trigger("quizClicked",this.model)}}); var QuizView=BaseItemsView.extend({attributes:{"data-role":"page","data-buttons":"navigation refresh",id:this.id},initialize:function(){this.$el.bind("refresh",this.handleRefreshClick.hitch(this));BaseItemsView.prototype.initialize.apply(this,arguments);this.model.getItems(executeTypeEnum.FORCE_NETWORK)},_onGetItemsSuccess:function(a){if(this.refreshing){this.refreshing=false;cqm.hideLoading(this.$el)}this._renderShowMoreButton();this.model.set({quizData:a});this._buildQuiz()},getRootView:function(){return this.$el},_buildQuiz:function(){this.model.set({points:0});this.questionIndex=0;var a=this.model.get("quizData");this.$quizPage=$(quizTemplates.quiz_tpl(a));this.$el.html(this.$quizPage);this.$scrollWrapper=this.$(".scroll_wrapper");Scrolling.init(this.$scrollWrapper);this._buildStartScreen()},_buildStartScreen:function(){var c={description:this.model.get("quizData").description||"",startButtonText:_T("HtmlTextQuizStartQuizButton")};var a=this.$(".dataFrame.active");a.html(quizTemplates.start_quiz_frame(c));var b=a.find(".startQuizButton");b.tap(this._gotoFirstQuestion.hitch(this))},_gotoFirstQuestion:function(){if(this.in_animation){return}this.in_animation=true;if(this.model.get("quizData").questionsCount==0){this.in_animation=false;this._gotoEndScreen();return}this._buildQuestionsContainer();this._buildQuestionScreen(this.$(".questionFrame.current"));var a=this.$(".dataFrame");var b=this.$(".dataFrame.active");var c=this.$(".dataFrame.inactive");a.css({"-webkit-transition-duration":"0.5s",height:"0"});b.removeClass("active").addClass("inactive");c.removeClass("inactive").addClass("active");setTimeout(function(){a.css({"-webkit-transition-duration":"0s"});c.css({height:"auto"});b.remove();Scrolling.onContentChanged(this.$scrollWrapper);this.in_animation=false}.hitch(this),500)},_buildQuestionsContainer:function(){var a=this.$(".dataFrame.inactive");a.html(quizTemplates.questions_frame())},_buildQuestionScreen:function(b){var g=this.model.get("quizData");var k=_T("HtmlTextQuizQuestionPosition",{index:this.questionIndex+1,total:g.questionsCount});var l=this.model.get("items").at(this.questionIndex);var d={questionPosition:k,question:l.get("text")||""};b.html(quizTemplates.question_frame(d));var h=this;var n=function(i){$(this).addClass("ui-btn-hover");h._gotoNextQuestion()};var c=function(i){$(this).addClass("ui-btn-hover");h._gotoNextQuestion(true)};var a=b.find(".answersContainer");var j=l.get("answers");for(var e=0;e<j.length;e++){var m=j[e];var f=$(quizTemplates.answer_tpl(m));a.append(f);if(m.isAnswer){f.tap(c)}else{f.tap(n)}}},_gotoNextQuestion:function(b){if(this.in_animation){return}this.in_animation=true;this.questionIndex++;if(b){this.model.set({points:this.model.get("points")+1})}if(this.questionIndex>=this.model.get("quizData").questionsCount){this.in_animation=false;this._gotoEndScreen();return}var d=this.$(".questionFrame.next");this._buildQuestionScreen(d);var a=this.$(".questionFrame");var c=this.$(".questionFrame.current");a.css({"-webkit-transition-duration":"0.5s",height:"0"});c.removeClass("current").addClass("prev");d.removeClass("next").addClass("current");setTimeout(function(){a.css({"-webkit-transition-duration":"0s"});d.css({height:"auto"});c.removeClass("prev").addClass("next");Scrolling.onContentChanged(this.$scrollWrapper);this.in_animation=false}.hitch(this),500)},_gotoEndScreen:function(){var a=this._buildEndScreen();this.$el.html(a);setTimeout(function(){a.removeClass("inactive").addClass("active")},10);this.$scrollWrapper=this.$(".scroll_wrapper");Scrolling.init(this.$scrollWrapper)},_buildEndScreen:function(){var e=this.model.get("quizData");var a=this.model.get("points")+" / "+e.questionsCount;a=quizTemplates.result_tpl({result:a});a=_T("HtmlTextQuizHowManyCorrect",{count:a});var f={title:e.title||"",result:a,gradeText:this.model.getGradeText(),gradeImage:this.model.getGradeImage()};var b=$(quizTemplates.end_quiz_tpl(f));var c=b.find(".buttonsContainer");var d=new FlatButtonView({text:_T("HtmlTextQuizRetryButton"),icon:"la-retry"});d.bind("onButtonClicked",this.handleRefreshClick,this);c.append(d.render().el);ShareControlHelper.addShareControlButton(c,this.model,null,{floatBtn:true});return b}}); var PhotoModel=Backbone.Model.extend({defaults:{description:null,id:null,index:-1,largeImage:"",mediumImage:"",smallImage:"",photoTime:-1,selected:false,socialInfo:null,title:null},initialize:function(){this.set({shareInfo:this.getShareInfo()})},getShareInfo:function(){var a=this.get("socialInfo");if(a){if(a.title){a.title=_T("SSharePhotoSubjectWithTitle",{title:a.title})}else{a.title=_T("SSharePhotoSubject")}}return a},getLargestImage:function(){return this.get("largeImage")||this.get("mediumImage")||this.get("smallImage")},getSmallestImage:function(){return this.get("smallImage")||this.get("mediumImage")||this.get("largeImage")},getMediumImage:function(a){if(a){return this.get("mediumImage")||this.get("largeImage")||this.get("smallImage")}else{return this.get("mediumImage")||this.get("smallImage")||this.get("largeImage")}}}); var instagramTemplates={userPanelView_tpl:_.template('<div class="scroll_wrapper"><div class="scroller"><div class="main_user_panel"><div class="userInfoPanel"></div><div class="thumbGridPanel showMoreGapBug"></div></div></div></div>'),userInfoPanelView_tpl:_.template('<div class="infoPanel box_padding clr_contTypeB_headerItem_bg clr_contTypeB_headerItem_brdr"><div class="avatar sliced_image" style="background-image:url(\'<%= profile_picture %>\')"></div><div class="user_texts"><div class="responsive size_title_3 clr_contTypeB_hdlTxt"><%= username %></div><div class="responsive size_title_2 number_box"><div class="info-box clr_contTypeB_hdlTxt"><%= media %></div><div class="responsive size_title_0 info-box-footer clr_contTypeB_subTxt"><%= photosText %></div></div><div class="responsive size_title_2 number_box cursor"><a class="followers clr_contTypeB_hdlTxt"><div class="info-box"><%= followed_by %></div><div class="responsive size_title_0 info-box-footer clr_contTypeB_lnkTxt"><%= followersText %></div></a></div><div class="responsive size_title_2 number_box cursor"><a class="following clr_contTypeB_hdlTxt"><div class="info-box"><%= follows %></div><div class="responsive size_title_0 info-box-footer clr_contTypeB_lnkTxt"><%= followingText %></div></a></div></div><div class="clearfix"></div></div>'),thumbGridView_tpl:_.template('<ul class="thumbPanel photoGridView"></ul>'),photoThumbView_tpl:_.template('<img class="thumbnail" src="<%= smallImage %>" />'),detailedPhotoView_tpl:_.template('<div class="scroll_wrapper"><div class="scroller"><div class="box_padding clr_contTypeB_headerItem_bg clr_contTypeB_headerItem_brdr"><div class="avatar sliced_image" style="background-image:url(\'<%= profilePictureUrl %>\')"></div><div class="comment_texts"><div class="responsive size_title_1 clr_contTypeB_hdlTxt user_name"><%= username %></div><% if(title){ %><div class="responsive size_1 clr_contTypeB_txt"><%= title %></div><% } %><% if(photoTime){ %><div class="responsive size_0 clr_contTypeB_subTxt photoTime"><%= photoTime %></div><% } %></div><div class="clearfix"></div></div><div class="clr_contTypeA_bg box_padding"><div class="detailsPhoto_imageContainer"><img class="full-image-view" src= <%= standard_resolution %> /><div class="likesCommentsBar"><% if (likes_count) { %><div class="likesIcon showLikes cursor left"><span class="mask_sprite sprite-insta-heart clr_contTypeA_subIcn"></span><span class="cursor likesCount responsive size_title_0 clr_contTypeA_subTxt"><%= likes_count %> <span class="clr_contTypeA_lnkTxt cursor"><%= likes_str %></span></span></div><% } %><% if (comments_count) { %><div class="commentsIcon showComments cursor right"><span class="mask_sprite sprite-insta-bubble clr_contTypeA_subIcn"></span><span class="cursor commentsCount responsive size_title_0 clr_contTypeA_subTxt"><%= comments_count %> <span class="clr_contTypeA_lnkTxt cursor"><%= comments_str %></span></span></div><% } %></div></div></div></div></div>'),privateUser_tpl:_.template('<div class="privateUserBlock clr_contTypeA_bg"><div class="responsive size_title_4 privateUserMain clr_contTypeA_hdlTxt"><%= privateUserMain %></div><div class="responsive size_title_1 privateUserSecondary clr_contTypeA_subTxt"><%= privateUserSecondary %></div></div>'),itemsCollection_tpl:_.template('<div class="scroll_wrapper"><div class="scroller"><ul class="itemsCollection showMoreGapBug"></ul></div></div>'),item_tpl:_.template('<div class="listPanel box_classic_padding clr_contTypeA_classicItem_bg clr_contTypeA_classicItem_brdr"><div class="mini-avatar sliced_image" style="background-image:url(\'<%= profilePictureUrl %>\')"></div><div class="comment_texts"><div class="responsive size_title_1 clr_contTypeA_lnkTxt small_user_name"><%= displayName || username%></div><% if(typeof(text)!= "undefined" && text){ %><div class="responsive size_1 clr_contTypeA_txt"><%= text %></div><% } %></div><div class="clearfix"></div></div>')}; var CommentsCollectionModel=Backbone.Model.extend({defaults:function(){},initialize:function(a){this.set("id",a.user.id);this.set("created_time",a.created_time);this.set("text",a.text);this.set("username",a.user.username);this.set("displayName",a.user.displayName);this.set("profilePictureUrl",a.user.profilePictureUrl);this.set("comment_id",a.id)}}); var InstagramModel=ItemsModel.extend({createItemsCollection:function(){var a=new InstagramPhotoCollection(null,this.toJSON());a.on("thumb:click",this._onThumbClick,this);a.on("commentsList:click",this._onCommentsClick,this);a.on("likesList:click",this._onLikesClick,this);a.on("getUser:click",this._onUserClick,this);a.on("getFollowers:click",this._onFollowersClick,this);a.on("getFollowing:click",this._onFollowingClick,this);return a},_onGetItemsSuccess:function(a){if(a){this.set(a)}},_onThumbClick:function(a){this.trigger("thumb:click",a)},_onCommentsClick:function(a){this.trigger("commentsList:click",a)},_onLikesClick:function(a){this.trigger("likesList:click",a)},_onUserClick:function(a){this.trigger("getUser:click",a)},_onFollowersClick:function(a){this.trigger("getFollowers:click",a)},_onFollowingClick:function(a){this.trigger("getFollowing:click",a)},getItemsCollectionsNames:function(){return[""]}}); var FollowsModel=ItemsModel.extend({createItemsCollection:function(){var a=new FollowsCollection(null,this.toJSON());a.on("getUser:click",this._onUserClick,this);return a},_onUserClick:function(a){this.trigger("getUser:click",a)},_onGetItemsSuccess:function(a){if(a){this.set(a)}},getItemsCollectionsNames:function(){return[""]}}); var LikesCollectionModel=Backbone.Model.extend({defaults:function(){return{id:null,username:"",full_name:"",profile_picture:"",}},}); var InstagramUser=Backbone.Model.extend({defaults:function(){return{username:"",bio:"",website:"",profile_picture:"",full_name:"",media:"",followed_by:"",follows:"",profile_id:""}},initialize:function(){},}); var SocialModel=Backbone.Model.extend({defaults:function(){return{displayName:"",id:null,link:"",profilePictureUrl:"",username:"",}},initialize:function(){},}); var InstagramPhotoCollection=ItemsCollection.extend({initialize:function(b,a){ItemsCollection.prototype.initialize.apply(this);this.params={type:a.type,userName:a.userName,extraInfo:a.params||{},take:a.PHOTOS_TAKE_COUNT}},parse:function(a){var d={};var e=[];if(a&&a.photos){var b=a.owner;_.each(a.photos,function(g,f){e[f]=new PhotoModel(g);e[f].set({profilePictureUrl:b.profilePictureUrl,username:b.username,displayName:b.displayName,})});d.models=e;var c=new InstagramUser({username:b.username,displayName:b.displayName,profile_picture:b.profilePictureUrl,media:a.totalPhotos,followed_by:b.meta.totalFollowers,follows:b.meta.totalFollows,profile_id:b.id,});c.on("getFollowers:click",this._onFollowersClick,this);c.on("getFollowing:click",this._onFollowingClick,this);d.metaData={userModel:c}}return d},_onFollowersClick:function(a){this.trigger("getFollowers:click",a)},_onFollowingClick:function(a){this.trigger("getFollowing:click",a)},getServiceName:function(){return"CMS_PHOTOS_GET"},getParams:function(){return this.params}}); var FollowsCollection=ItemsCollection.extend({initialize:function(b,a){ItemsCollection.prototype.initialize.apply(this);this.params={relationType:a.relationType,provider:a.type,userId:a.userName,extraInfo:a.params||{},take:a.PHOTOS_TAKE_COUNT}},parse:function(a){var b={};var c=[];if(a&&a.relations){_.each(a.relations[0].Value,function(e,d){c[d]=new SocialModel();c[d].set({displayName:e.displayName,id:e.id,link:e.link,profilePictureUrl:e.profilePictureUrl,username:e.username,})});b.models=c}return b},getServiceName:function(){return"CMS_USERS_GET"},getParams:function(){return this.params}}); var UserMainPanelView=Backbone.View.extend({attributes:{"data-role":"page","data-buttons":"navigation refresh"},initialize:function(a){this.userInfoPanelView=null;this.userGridPanelView=null;this.model.get("items").on("getItemsSuccess",this.getItemsSuccess,this);this.template=instagramTemplates.userPanelView_tpl},handleRefreshClick:function(){if(this.userGridPanelView){this.userGridPanelView.handleRefreshClick()}},getItemsSuccess:function(a){this.initInfoPanel_View(a.userModel);this.$(".userInfoPanel").empty().append(this.userInfoPanelView.el)},clearView:function(a){a.off();a.remove();a=null},initInfoPanel_View:function(a){if(this.userInfoPanelView){this.clearView(this.userInfoPanelView)}this.userInfoPanelView=new UserInfoPanelView({model:a});this.userInfoPanelView.render()},render:function(){$(this.el).html(this.template());Scrolling.init(this.$(".scroll_wrapper"));this.$el.bind("refresh",this.handleRefreshClick.hitch(this));this.userGridPanelView=new UserGridPanelView({model:this.model});this.userGridPanelView.bind("privateUser",this._onPrivateUser,this);this.$(".thumbGridPanel").append(this.userGridPanelView.render().el);this.$el.bind("pageshow",this._onPageShow.hitch(this));this.$el.bind("pagehide",this._onPageHide.hitch(this));return this},_onPrivateUser:function(){var a={privateUserMain:_T("HtmlTextInstagramPrivateUserMainText"),privateUserSecondary:_T("HtmlTextInstagramPrivateUserSecondaryText")};this.$el.html(instagramTemplates.privateUser_tpl(a))},_onPageShow:function(){setTimeout(function(){this.userGridPanelView.onPageShow.hitch(this.userGridPanelView)()}.hitch(this),10)},_onPageHide:function(){this.userGridPanelView.onPageHide.hitch(this.userGridPanelView)()},addTabsView:function(a){this.$(".scroller").prepend(a)}}); var UserInfoPanelView=Backbone.View.extend({initialize:function(){this.template=instagramTemplates.userInfoPanelView_tpl},events:{"tap .followers":"handleFollowers","tap .following":"handleFollowing"},handleFollowers:function(a){a.preventDefault();this.model.trigger("getFollowers:click",this.model)},handleFollowing:function(a){a.preventDefault();this.model.trigger("getFollowing:click",this.model)},render:function(){var a=this;var e={photosText:_T("HtmlTextInstagramPhotosCount"),followersText:_T("HtmlTextInstagramFollowersCount"),followingText:_T("HtmlTextInstagramFollowingCount"),profile_picture:this.model.get("profile_picture")};e.username=this.model.get("displayName")||this.model.get("username");var d=localization.formatNumber(this.model.get("media"));e.media=d||"0";var c=localization.formatNumber(this.model.get("followed_by"));e.followed_by=c||"0";var b=localization.formatNumber(this.model.get("follows"));e.follows=b||"0";$(this.el).html(this.template(e));return this}}); var UserGridPanelView=ItemsView.extend({className:"thumbPanel",initialize:function(){ItemsView.prototype.initialize.apply(this);this.$itemsList.addClass("clr_contTypeA_bg");$(window).bind("throttledresize",this.onResize.hitch(this));var a=this.model.get("items");if(a){a.bind("getItemsSuccess",this.onResize,this)}},createItemView:function(b){var a=new ThumbView({model:b});return a},onResize:function(){if(this.isPageShow){this.updateThumbnailsMargin()}},onPageShow:function(){this.isPageShow=true;this.updateThumbnailsMargin();this.$itemsList.css({visibility:"visible"})},onPageHide:function(){this.isPageShow=false;this.$itemsList.css({visibility:"hidden"})},updateThumbnailsMargin:function(){var a={minWidth:80,margin:6,setAlsoMargin:true,setAlsoMarginTop:true};if(LAYOUT===layoutFormat.wide){a.minWidth=150}Utils.Html.setGridSizes(this.$itemsList,a)},onGetDataFail:function(b,a){this.trigger("privateUser")},getRootView:function(){return this.$el}}); var ThumbView=Backbone.View.extend({model:PhotoModel,tagName:"li",initialize:function(a){this.template=instagramTemplates.photoThumbView_tpl},events:{tap:"itemClicked"},remove:function(){$(this.el).remove()},itemClicked:function(a){a.preventDefault();this.model.trigger("thumb:click",this.model)},render:function(){$(this.el).html(this.template(this.model.toJSON()));return this},}); var DetailedPhotoView=Backbone.View.extend({attributes:{"data-role":"page","data-buttons":"back",id:this.id},model:PhotoModel,events:{"tap .showComments":"showComments","tap .showLikes":"showLikes","tap .full-image-view":"openGallery"},initialize:function(){this.template=instagramTemplates.detailedPhotoView_tpl},showComments:function(a){a.preventDefault();this.model.trigger("commentsList:click",this.model)},showLikes:function(a){a.preventDefault();this.model.trigger("likesList:click",this.model)},openGallery:function(b){b.preventDefault();var a=[{title:this.model.get("title"),photoTime:this.model.get("photoTime"),largeImage:this.model.getLargestImage(),photoModel:this.model}];new PhotoGalleryManager().pressedImage(a,0)},render:function(){var a={likes_count:0,comments_count:0,likes_str:_T("HtmlTextInstagramLikes"),comments_str:_T("HtmlTextInstagramComments"),title:this.model.get("title"),photoTime:Utils.TimeDate.timeAsText(this.model.get("photoTime")),username:this.model.get("displayName")||this.model.get("username"),profilePictureUrl:this.model.get("profilePictureUrl"),standard_resolution:this.model.getLargestImage()};if(this.model.get("additionalInfo").likes.likes){a.likes_count=localization.formatNumber(this.model.get("additionalInfo").likes.likes)}if(this.model.get("additionalInfo").totalComments){a.comments_count=localization.formatNumber(this.model.get("additionalInfo").totalComments)}this.$el.html(this.template(a));var b=this.$(".scroll_wrapper");Scrolling.init(b);this.$("IMG").load(function(){Scrolling.onContentChanged(b)}.hitch(this)).error(function(){$(this).remove()});return this},}); var InstagramItemView=Backbone.View.extend({tagName:"li",initialize:function(a){this.template=instagramTemplates.item_tpl},events:{tap:"itemClicked"},itemClicked:function(a){a.preventDefault();this.model.trigger("getUser:click",this.model)},render:function(){var a=this.model.toJSON();a.text=this.options.text;$(this.el).html(this.template(a));return this}}); var InstagramCommentView=Backbone.View.extend({tagName:"li",initialize:function(a){this.template=instagramTemplates.item_tpl},events:{tap:"itemClicked"},remove:function(){$(this.el).remove()},itemClicked:function(a){a.preventDefault();this.model.trigger("getUser:click",this.model)},render:function(){$(this.el).html(this.template(this.model.toJSON()));return this},}); var CommentsCollectionView=Backbone.View.extend({attributes:{"data-role":"page","data-buttons":"back",id:this.id},initialize:function(a){this.template=instagramTemplates.itemsCollection_tpl},addAll:function(){var b=this;var a;_.each(this.collection,function(d,c){a=new CommentsCollectionModel(d);a.on("getUser:click",b._onUserClick,b);b.addOne(a)})},addOne:function(b){var a=new InstagramCommentView({model:b});this.$(".itemsCollection").append(a.render().el)},_onUserClick:function(a){this.trigger("getUser:click",a)},render:function(){$(this.el).html(this.template());this.addAll();Scrolling.init(this.$(".scroll_wrapper"));return this}}); var LikesCollectionView=Backbone.View.extend({attributes:{"data-role":"page","data-buttons":"back",id:this.id},initialize:function(a){this.template=instagramTemplates.itemsCollection_tpl},addAll:function(){var a=this;var b;_.each(this.collection,function(d,c){b=new LikesCollectionModel(d);b.on("getUser:click",a._onUserClick,a);a.addOne(b)})},addOne:function(a){view=new InstagramItemView({model:a,text:_T("HtmlTextInstagramUserLikePhoto")});this.$(".itemsCollection").append(view.render().el)},_onUserClick:function(a){this.trigger("getUser:click",a)},render:function(){$(this.el).html(this.template());this.addAll();Scrolling.init(this.$(".scroll_wrapper"));return this}}); var InstagramTemplateView=TemplateView.extend({getFollowing:function(a){var b={type:"instagram",relationType:"follows",userName:a.get("profile_id")};this.innerGetFollows(b)},getFollowers:function(a){var b={type:"instagram",relationType:"followed-by",userName:a.get("profile_id")};this.innerGetFollows(b)},innerGetFollows:function(c){var a=new FollowsModel(c);a.on("getUser:click",this.getUser,this);var b=new FollowsPanelView({model:a,id:"Follows"+Utils.Helpers.generateGUID()});this.$el.append(b.render().el);a.getItems(executeTypeEnum.HIT_AND_RUN);$.mobile.changePage("#"+b.id,{transition:"slide",reverse:IS_RTL});return this},getUser:function(b){var d={title:"Instagram",type:"instagram",userName:b.get("id")};var b=this._createInstagramModel(d);var a=new UserMainPanelView({model:b,id:"home_"+Utils.Helpers.generateGUID()});var c=a.render().$el;c.attr({"data-buttons":"refresh back"});this.$el.append(c);b.getItems(executeTypeEnum.HIT_AND_RUN);$.mobile.changePage("#"+a.id,{transition:"slide",reverse:IS_RTL})},_createInstagramModel:function(b){var a=new InstagramModel(b);a.on("thumb:click",this.getDetailedPhoto,this);a.on("likesList:click",this.getLikesCollection,this);a.on("commentsList:click",this.getCommentsCollection,this);a.on("getUser:click",this.getUser,this);a.on("getFollowers:click",this.getFollowers,this);a.on("getFollowing:click",this.getFollowing,this);return a},render:function(c){this.index=c;var b=this.model.get("meta")[this.options.tabsName][c];var d=this._createInstagramModel(b);var a=new UserMainPanelView({model:d,id:"home_"+Utils.Helpers.generateGUID()});this.$el.append(a.render().el);this._homePagesViews[c]=a;TemplateView.prototype.render.apply(this,[c]);d.getItems(executeTypeEnum.HIT_AND_RUN);return this},getDetailedPhoto:function(a){var b=new DetailedPhotoView({model:a,id:"details_"+Utils.Helpers.generateGUID()});this.$el.append(b.render().el);$.mobile.changePage("#"+b.id,{transition:"slide",reverse:IS_RTL})},getLikesCollection:function(b){var a=new LikesCollectionView({collection:b.get("additionalInfo").likes.likeUsers,id:"likes_"+Utils.Helpers.generateGUID()});a.on("getUser:click",this.getUser,this);this.$el.append(a.render().el);$.mobile.changePage("#"+a.id,{transition:"slide",reverse:IS_RTL})},getCommentsCollection:function(b){var a=new CommentsCollectionView({collection:b.get("additionalInfo").comments,id:"comments_"+Utils.Helpers.generateGUID()});a.on("getUser:click",this.getUser,this);this.$el.append(a.render().el);$.mobile.changePage("#"+a.id,{transition:"slide",reverse:IS_RTL})}}); var SocialCollectionView=ItemsView.extend({initialize:function(){ItemsView.prototype.initialize.apply(this)},createItemView:function(b){var a=new InstagramItemView({model:b});return a},getRootView:function(){return this.$el},}); var FollowsPanelView=Backbone.View.extend({attributes:{"data-role":"page","data-buttons":"back"},initialize:function(a){this.template=instagramTemplates.itemsCollection_tpl},render:function(){$(this.el).html(this.template());Scrolling.init(this.$(".scroll_wrapper"));var a=new SocialCollectionView({model:this.model,});this.$(".itemsCollection").append(a.render().el);return this}}); var twitterTemplates={tweet_li:_.template('<div class="tweet-image"><img src="<%= userJSON.imageUrl %>" alt="<%= userJSON.displayName %>" class="user-profile-link" /></div><div class="tweet-content"><div class="tweet-header"><div class="size_title_1 tweet-screen-name tweet-header-name clr_contTypeB_hdlTxt"><%= userJSON.userName %></div><div class="size_title_0 tweet-full-name clr_contTypeB_subTxt"><%= userJSON.displayName %></div><br/><% if (formattedRetweeterName) { %><div class="retweet-image mask_sprite clr_contTypeB_subIcn sprite-retweet"></div><div class="size_title_0 retweeter-name clr_contTypeB_subTxt"><%= formattedRetweeterName %></div><% } %></div><div class="size_1 tweet-text clr_contTypeB_txt"><%= formattedDescription %></div><div class="size_0 tweet-time clr_contTypeB_subTxt"><%= formattedDatetime %></div><div class="time-tweet-image mask_sprite clr_contTypeB_subIcn sprite-tweet"></div></div>'),tweetDescriptionOnly:_.template('<div class="tweet detailed-tweet t3d"><div class="tweet-content"><div class="size_1 tweet-text clr_contTypeA_txt"><%= formattedDescription %></div><div class="time-tweet-image mask_sprite clr_contTypeB_subIcn sprite-tweet"></div><div class="size_0 tweet-time clr_contTypeA_subTxt"><%= formattedDatetime %></div><br/><% if (typeof(retweeterName) != "undefined") { %></br><div class="retweet-image mask_sprite clr_contTypeB_subIcn sprite-retweet"></div><div class="size_0 retweeter-text clr_contTypeA_subTxt"><%= retweetText %></div><div class="size_0 retweeter-name clr_contTypeA_lnkTxt" ><%= retweeterName %></a><% } %></div><div class="control_buttons_container"></div></div>'),userHeader:_.template('<div class="tweet-user t3d user_header_bcolor"><div class="tweet-user-image"><img src="<%= imageUrl %>" alt="<%= displayName %>" class="user-profile-link" /></div><div class="tweet-user-details"><h1 class="size_title_3 clr_contTypeB_hdlTxt"><%= displayName %></h1><div class="size_title_0 screen-name clr_contTypeB_subTxt"><span dir="ltr">@<%= userName %></span></div><div class="ff clearfix"><% if(typeof(totalStatusesStr) != "undefined"){ %><div class="tweets"><div class="size_title_2 count clr_contTypeB_hdlTxt"><%= totalStatusesStr %></div><span class="size_title_0 clr_contTypeB_subTxt stats"><%= tweetsStaticText %></span></div><% } %><% if(typeof(totalFollowersStr) != "undefined"){ %><div class="followers"><div class="size_title_2 count clr_contTypeB_hdlTxt"><%= totalFollowersStr %></div><span class="size_title_0 clr_contTypeB_subTxt stats"><%= fallowersStaticText %></span></div><% } %></div></div><a class="tweet-follow-button clr_contTypeB_btn_bg clr_contTypeB_btn_brdr clr_contTypeB_btn_hdlTxt" data-role="button" ><%= fallowStaticText %></a></div>'),queryHeader:_.template('<div class="tweet-search t3d clr_contTypeB_bg clr_contTypeB_brdr""><h1 class="size_title_3 clr_contTypeB_hdlTxt">#<%= query %></h1></div>')}; var TwitterTemplateHelper={createUserModel:function(b){var a=new TwitterUserModel({userName:b.userName,displayName:b.displayName,screenName:b.screenName,imageUrl:b.imageUrl,totalFollowers:b.totalFollowers,totalStatuses:b.totalStatuses,totalFollowersStr:localization.formatNumber(b.totalFollowers),totalStatusesStr:localization.formatNumber(b.totalStatuses),fallowersStaticText:_T("HtmlTextTwitterFollowers"),tweetsStaticText:_T("HtmlTextTwitterTweets"),fallowStaticText:_T("HtmlTextTwitterFollowButton")});return a}}; var TwitterModel=ItemsModel.extend({TWEET_LIST_TYPE_USER:0,TWEET_LIST_TYPE_LIST:1,TWEET_LIST_TYPE_QUERY:2,initialize:function(){var a=this.get("params");if(!a){return}ItemsModel.prototype.initialize.apply(this,arguments);this.set({type:a.type});this.get("items").bind("getItemsSuccess",this._onGetItemsSuccess,this)},createItemsCollection:function(){var a=this.get("params");var b=parseInt(a.type);switch(b){case this.TWEET_LIST_TYPE_USER:return new UserTweetsCollection(null,a);case this.TWEET_LIST_TYPE_LIST:return new QueryTweetsCollection(null,a);case this.TWEET_LIST_TYPE_QUERY:return new QueryTweetsCollection(null,a);default:return new QueryTweetsCollection(null,a)}},_onGetItemsSuccess:function(a){if(a){if(a.user){this.set({user:a.user})}else{if(a.query){this.set({query:a.query})}}}}}); var TweetModel=ItemModel.extend({initialize:function(){var c="";var f=this.get("retweeter");if(f&&f.name){c=_T("HtmlTextTwitterRetweet",{retweeterName:f.name})}var b="";var d=this.get("description");if(d){b=this._updateTextWithStyledLinks(d)}var e=this.get("time");var a="";if(e){a=Utils.TimeDate.timeAsText(e)}this.set({formattedRetweeterName:c,retweetText:_T("HtmlTextTwitterRetweetDetails"),formattedDescription:b,formattedDatetime:a,showOnMapButtonStr:_T("HtmlTextShowOnMapButtonStr"),shareInfo:this.getShareInfo()})},_rgxTweetUserName:new RegExp("\\[twit=(.*?)](.*?)\\[/twit]","g"),_rgxTweetLink:new RegExp("\\[url\\](.*?)\\[/url\\]","g"),_rgxTweetTrend:new RegExp("\\[trend=(.*?)](.*?)\\[/trend]","g"),select:function(){this.trigger("tweetSelected",this)},_updateTextWithStyledLinks:function(e,d){if(!d){d=""}var a=this.get("layoutId");if(a==1){var c="clr_contTypeA_lnkTxt"}else{var c="clr_contTypeB_lnkTxt"}var b='<a data-href="$2" class="'+c+'" urlSrc="http://twitter.com/$1" class="LinkURL slide"'+d+">$2</a>";e=e.replace(this._rgxTweetUserName,b);b='<a data-href="$1" class="'+c+'" urlSrc="$1" class="LinkURL slide"'+d+">$1</a>";e=e.replace(this._rgxTweetLink,b);b='<a data-href="#$1" class="'+c+'" urlSrc="http://mobile.twitter.com/searches?q=%23$1" class="LinkURL slide"'+d+">#$1</a>";e=e.replace(this._rgxTweetTrend,b);return e},getShareInfo:function(){var a=this.get("user");var d=this.get("socialInfo")||{};var c=a.get("userName")||a.get("displayName");if(c){var b=c.indexOf("@twitter.com");if(b>0){c=c.substring(0,b)}}if(!d.url||d.url===""){d.url="http://twitter.com/"+c}d.title=_T("STwitterShareEmailSubject",{name:c});if(d.shortDesc){d.twitterTitle=d.shortDesc}d.twitterFrom="@"+c;return d}}); var TwitterUserModel=Backbone.Model.extend({}); var UserTweetsCollection=ItemsCollection.extend({model:TweetModel,TWEETS_TAKE_COUNT:20,initialize:function(b,a){ItemsCollection.prototype.initialize.apply(this);if(a&&a.userName){this.params={type:a.type,userName:a.userName,extraInfo:a.params||{},take:this.TWEETS_TAKE_COUNT,layoutId:a.layoutId}}else{this.invalid=true}},parse:function(a){var d={};if(a&&a.statuses){var f=[];for(var b=0;b<a.statuses.length;b++){var e=a.statuses[b];e.user=TwitterTemplateHelper.createUserModel({userName:e.screenName||this.params.userName,displayName:e.user||a.user,screenName:e.sscreenName,imageUrl:e.icon||a.icon,totalFollowers:e.totalFollowers||a.totalFollowers,totalStatuses:e.totalStatuses||a.totalStatuses});f[b]=new TweetModel(e)}d.models=f;var c=TwitterTemplateHelper.createUserModel({userName:this.params.userName,displayName:a.user,screenName:this.params.screenName||this.params.userName,imageUrl:a.icon,totalFollowers:a.totalFollowers,totalStatuses:a.totalStatuses});d.metaData={user:c}}return d},getServiceName:function(){return"CMS_TWITTER_USER_GET"},getParams:function(){return this.params},isEOF:function(a,b){if(typeof(a.hasMoreItems)!=="undefined"){return !a.hasMoreItems}else{return ItemsCollection.prototype.isEOF.apply(this,[a,b])}}}); var QueryTweetsCollection=ItemsCollection.extend({model:TweetModel,TWEETS_TAKE_COUNT:20,initialize:function(b,a){ItemsCollection.prototype.initialize.apply(this);if(a&&a.userName){this.params={type:a.type,query:a.userName,extraInfo:a.params||{},take:this.TWEETS_TAKE_COUNT,layoutId:a.layoutId}}else{this.invalid=true}},parse:function(a){var f={};if(a&&a.results){var h=[];for(var e=0;e<a.results.length;e++){var g=a.results[e];var d=function(k){var m=null;var i=k;if(k.indexOf("@")>0){var j=k.split(" ");m=j.shift().split("@")[0];var l=j.join(" ");i=l.substring(1,l.length-1)}var n={userName:m,displayName:i};return n};var c=d(g.user);g.user=TwitterTemplateHelper.createUserModel({userName:c.userName||g.screenName,displayName:c.displayName,screenName:g.screenName,imageUrl:g.icon});var b=new TweetModel(g);h[e]=b}f.models=h;f.metaData={query:this.params.query}}return f},getServiceName:function(){return"CMS_TWITTER_QUERY_GET"},getParams:function(){this.params.skip=this.skip;return this.params},isEOF:function(a,b){if(typeof(a.hasMoreItems)!=="undefined"){return !a.hasMoreItems}else{return ItemsCollection.prototype.isEOF.apply(this,[a,b])}}}); var TwitterTemplateView=TemplateView.extend({render:function(b){var c=this.model.get("meta");var d=c[this.options.tabsName][b]||{};d.layoutId=c.pageLayout;this._twitterModel=new TwitterModel({params:d});var a=new TweetsView({model:this._twitterModel,id:"home_"+Utils.Helpers.generateGUID()});this._twitterModel.bind("itemSelected",this._onItemSelected,this);a.bind("onLinkPressed",this._onLinkPressed,this);this.el.appendChild(a.render().el);this._twitterModel.getItems(executeTypeEnum.HIT_AND_RUN);this._homePagesViews[b]=a;TemplateView.prototype.render.apply(this,[b]);return this},_onItemSelected:function(d,c){var a="details_"+Utils.Helpers.generateGUID();var b=new DetailedTweetPageView({model:d,id:a});this.$el.append(b.render().el);b.bind("onLinkPressed",this._onLinkPressed,this);$.mobile.changePage("#"+a,{transition:"slide",reverse:IS_RTL})},_onLinkPressed:function(f){var g=f.link;var e=f.model;if(g&&e){var c="home_"+Utils.Helpers.generateGUID();var d={userName:g.substring(1),layoutId:e.get("layoutId")};if(g.startsWith("@")){d.type="0"}else{if(g.startsWith("#")){d.type="2"}else{if(g.startsWith("http")){conduitApi.app.openLink(null,null,{url:g,title:"Conduit",isModal:false});return}}}if(this._inTwitterLink){return}this._inTwitterLink=true;conduitApi.UI.startActivityIndicator(null,null,_T("IndicatorLoading"));var a=new TwitterModel({params:d});var b=new TweetsView({model:a,id:c});$(b.el).attr("data-buttons","back");a.bind("itemSelected",this._onItemSelected,this);b.bind("onLinkPressed",this._onLinkPressed,this);this.$el.append(b.render().el);var h=true;var i=a.get("items");i.bind("getItemsSuccess",function(){conduitApi.UI.dismissActivityIndicator();if(h){h=false;$.mobile.changePage("#"+c,{transition:"slide",reverse:IS_RTL});this._inTwitterLink=false}}.hitch(this));i.bind("getItemsFail",function(){conduitApi.UI.dismissActivityIndicator();if(h){h=false;this._inTwitterLink=false}}.hitch(this));a.getItems(executeTypeEnum.HIT_AND_RUN)}}}); var TwitterWideTemplateView=TemplateView.extend({initialize:function(b,a){TemplateView.prototype.initialize.apply(this);this.twitterDepth=0;this.dividedScreenView=[];this.detailsPage=[]},render:function(c){this.twitterDepth++;var b=this.twitterDepth;var d=this.model.get("meta");var e=d[this.options.tabsName][c];this._twitterModel=new TwitterModel({params:e});this.listView=new TweetsView({model:this._twitterModel,id:"home_"+Utils.Helpers.generateGUID()});this.listView.bind("onLinkPressed",this._onLinkPressed,this);this.listView.bind("onLinkPressed",this._onLinkPressed,this);this.dividedScreenView[b]=new DividedScreenView({id:"divided_screen_"+Utils.Helpers.generateGUID()});var a=function(f,g){this.onItemSelected(f,g,b)};this._twitterModel.bind("itemSelected",a,this);this._twitterModel.get("items").onItemsReady(this.onItemsReady.hitch(this));this.dividedScreenView[b].setView1(this.listView.render());this.$el.append(this.dividedScreenView[b].render().addRefreshButton(true).el);this._homePagesViews[c]=this.dividedScreenView[b];TemplateView.prototype.render.apply(this,[c]);this._twitterModel.getItems(executeTypeEnum.HIT_AND_RUN);return this},onItemSelected:function(b,d,a){if(!d){if(this.detailsPage[a]){this.detailsPage[a].remove();this.detailsPage[a]=null}var c="details_"+Utils.Helpers.generateGUID();this.detailsPage[a]=new DetailedTweetPageView({model:b,id:c});this.detailsPage[a].bind("onLinkPressed",this._onLinkPressed,this);this.dividedScreenView[a].setView2(this.detailsPage[a].render())}},onItemsReady:function(b){if(b.length>0){var a=b.at(0);a.trigger("itemClicked",a)}},_onLinkPressed:function(h){var j=h.link;var e=h.model;if(j&&e){var c="home_"+Utils.Helpers.generateGUID();var d={userName:j.substring(1),layoutId:e.get("layoutId")};if(j.startsWith("@")){d.type="0"}else{if(j.startsWith("#")){d.type="2"}else{if(j.startsWith("http")){conduitApi.app.openLink(null,null,{url:j,title:"Conduit",isModal:false});return}}}if(this._inTwitterLink){return}this._inTwitterLink=true;conduitApi.UI.startActivityIndicator();var f=this;this.twitterDepth++;var m=this.twitterDepth;var a=new TwitterModel({params:d});var b=new TweetsView({model:a,id:c});var i="divided_screen_"+Utils.Helpers.generateGUID();this.dividedScreenView[m]=new DividedScreenView({id:i});var g=function(n,o){f.onItemSelected(n,o,m)};a.bind("itemSelected",g);this.dividedScreenView[m].setView1(b.render());this.$el.append(this.dividedScreenView[m].render().el);$(this.dividedScreenView[m].el).attr("data-buttons","back");b.bind("onLinkPressed",this._onLinkPressed,this);var k=true;var l=a.get("items");l.bind("getItemsSuccess",function(){conduitApi.UI.dismissActivityIndicator();if(k){k=false;var n=l.at(0);n.trigger("itemClicked",n);$.mobile.changePage("#"+i,{transition:"slide",reverse:IS_RTL});this._inTwitterLink=false}}.hitch(this));l.bind("getItemsFail",function(){conduitApi.UI.dismissActivityIndicator();if(k){k=false;this._inTwitterLink=false}}.hitch(this));a.getItems(executeTypeEnum.HIT_AND_RUN)}}}); var DetailedTweetPageView=Backbone.View.extend({events:{"tap a":"onLinkPressed"},initialize:function(){this.$el.attr({"data-role":"page","data-buttons":"back"});this.homePageId="home_"+Utils.Helpers.generateGUID();this.detailsPageId="details_"+Utils.Helpers.generateGUID()},render:function(){var a=document.createElement("div");a.className="scroll_wrapper";this.scrollerElement=document.createElement("div");this.scrollerElement.className="scroller";a.appendChild(this.scrollerElement);this.el.appendChild(a);var b=$(a);Scrolling.init(b);this.renderHeader();this.renderTweet();this.renderDetails();return this},renderHeader:function(){var b=this.model.get("user");if(b){var a=new UserHeaderView({model:b,layoutId:this.model.get("layoutId")});this.scrollerElement.appendChild(a.render().el)}return this},renderTweet:function(){var b=this.model;if(b){var a=new DetailedTweetView({model:b,layoutId:this.model.get("layoutId")});a.bind("onRetweeterTap",this.retweeterTap,this);this.scrollerElement.appendChild(a.render().el)}},renderDetails:function(){},onLinkPressed:function(a){a.preventDefault();this.trigger("onLinkPressed",{link:a.target.innerHTML,model:this.model})},retweeterTap:function(){var a="@"+this.model.get("retweeter").name;this.trigger("onLinkPressed",{link:a,model:this.model})}}); var DetailedTweetView=Backbone.View.extend({className:"detailed-tweet clr_contTypeA_bg",render:function(){var a=this.model.toJSON();var b=this.model.get("retweeter");if(b&&b.name){a.retweeterName=b.name}this.$el.append(twitterTemplates.tweetDescriptionOnly(a));this.$el.find(".retweeter-name").tap(this.retweeterTap.hitch(this));ShareControlHelper.addShareControlButton(this.$el.find(".control_buttons_container"),this.model);return this},retweeterTap:function(a){a.preventDefault();this.trigger("onRetweeterTap")}}); var SearchHeaderView=Backbone.View.extend({render:function(){this.$el.append(twitterTemplates.queryHeader(this.model.toJSON()));return this}}); var TweetListView=ItemsView.extend({createItemView:function(b){var a=new TweetView({model:b,layoutId:this.options.layoutId});a.bind("onLinkPressed",this.onLinkPressed,this);return a},onLinkPressed:function(a){this.trigger("onLinkPressed",a)},getRootView:function(){return this.$el}}); var TweetView=Backbone.View.extend({tagName:"li",className:"tweet t3d",events:{tap:"itemClicked"},_rgxTweetUserName:new RegExp("\\[twit=(.*?)](.*?)\\[/twit]","g"),_rgxTweetLink:new RegExp("\\[url\\](.*?)\\[/url\\]","g"),_rgxTweetTrend:new RegExp("\\[trend=(.*?)](.*?)\\[/trend]","g"),initialize:function(){this.model.bind("change:selected",this.onSelectedChange,this)},_updateTextWithStyledLinks:function(e,d){if(!d){d=""}var a=this.options.layoutId;if(a==1){var c="clr_contTypeA_lnkTxt"}else{var c="clr_contTypeB_lnkTxt"}var b='<a href="javascript:void(0)" class="'+c+'" urlSrc="http://twitter.com/$1" class="LinkURL slide"'+d+">$2</a>";e=e.replace(this._rgxTweetUserName,b);b='<a href="javascript:void(0)" class="'+c+'" urlSrc="$1" class="LinkURL slide"'+d+">$1</a>";e=e.replace(this._rgxTweetLink,b);b='<a href="javascript:void(0)" class="'+c+'" urlSrc="http://mobile.twitter.com/searches?q=%23$1" class="LinkURL slide"'+d+">#$1</a>";e=e.replace(this._rgxTweetTrend,b);return e},render:function(){this.model.set({userJSON:this.model.get("user").toJSON()});var b=this.model.toJSON();var a=this.options.layoutId;if(a==1){var c="clr_contTypeA_classicItem_bg clr_contTypeA_classicItem_brdr feed_classic_item";b.colorClassType="A"}else{a=0;var c="clr_contTypeB_bubbleItem_bg clr_contTypeB_bubbleItem_brdr feed_bubble_item";b.colorClassType="B"}this.$el.html(twitterTemplates.tweet_li(b)).attr("data-role","button").addClass(c);this.$el.find("a").bind("tap",this.itemClicked.hitch(this));return this},onSelectedChange:function(){if(LAYOUT===layoutFormat.wide){if(this.model.get("selected")){this.$el.addClass("selected")}else{this.$el.removeClass("selected")}}},itemClicked:function(b){b.preventDefault();var c=b.target;var a=c.nodeName=="A";if(a){this.trigger("onLinkPressed",{link:c.innerHTML,model:this.model})}else{this.model.trigger("itemClicked",this.model)}return false}}); var UserHeaderView=Backbone.View.extend({className:"clr_contTypeB_headerItem_bg clr_contTypeB_headerItem_brdr t3d",events:{"tap .tweet-follow-button":"_followButtonClicked"},render:function(){var c=this.model.toJSON();this.$el.html(twitterTemplates.userHeader(c));this.model.bind("change:isFollowing",this._onIsFollowingChanged,this);var b=this.model.get("isFollowing");if(typeof(b)==="undefined"){var a=this;TwitterManager.isFollowingUser(this.model.get("screenName"),function(d){a.model.set({isFollowing:d})},function(){a.model.set({isFollowing:false})})}return this},_onIsFollowingChanged:function(c,d){var a=this.$el.find(".tweet-follow-button");var b=_T("HtmlTextTwitterFollowButton");if(d){b=_T("HtmlTextTwitterUnfollowButton")}a.text(b)},_followButtonClicked:function(b){b.preventDefault();var a=this.model.get("screenName");TwitterManager.followUser(a);return false}}); var TweetsView=Backbone.View.extend({initialize:function(){this.$el.attr({"data-role":"page","data-buttons":"navigation refresh"});this.model.bind("change:user",this.renderHeader,this);this.model.bind("change:query",this.renderHeader,this);this.$el.bind("refresh",this.handleRefreshClick.hitch(this));this.$el.bind("silentRefresh",this.handleSilentRefresh.hitch(this))},handleRefreshClick:function(){if(this.tweetListView){this.tweetListView.handleRefreshClick()}},handleSilentRefresh:function(){if(this.tweetListView){this.tweetListView.handleSilentRefresh()}},render:function(){var b=document.createElement("div");b.className="scroll_wrapper";this.scrollerElement=document.createElement("div");this.scrollerElement.className="scroller";b.appendChild(this.scrollerElement);this.el.appendChild(b);var d=$(b);Scrolling.init(d);var c=this.model.get("params");if(c){this.tweetListView=new TweetListView({model:this.model,layoutId:this.model.get("params").layoutId,showMoreStr:_T("HtmlTextTwitterShowMoreTweets"),loadingStr:_T("HtmlTextTwitterLoadingTweets")});this.tweetListView.bind("onLinkPressed",this.onLinkPressed,this);var a=this.tweetListView.render().el;this.$header=$('<div class="header_container"></div>');$(this.scrollerElement).append(this.$header).append(a)}return this},renderHeader:function(){var e=this.model.get("type");if(e==this.model.TWEET_LIST_TYPE_USER||e==this.model.TWEET_LIST_TYPE_LIST){var d=this.model.get("user");if(d){var c=new UserHeaderView({model:d,layoutId:this.model.get("params").layoutId});c.bind("onLinkPressed",this.onLinkPressed,this);var f=c.render().el;this.$header.html(f)}}else{var b=new SearchHeaderView({model:this.model,layoutId:this.model.get("params").layoutId});var a=b.render().el;this.$header.html(a)}return this},onLinkPressed:function(a){this.trigger("onLinkPressed",a)},addTabsView:function(a){$(this.scrollerElement).prepend(a)}}); var photosTemplates={previews_list_tpl:_.template('<ul class="previews_list"></ul>'),album_preview_tpl:_.template('<div class="album_item touch_active clr_contTypeB_bubbleItem_bg clr_contTypeB_bubbleItem_brdr" data-role="button" rel2="<%= albumIndex %>"><div class="size_title_2 photos_count clr_contTypeB_txt">0</div><div class="size_0 photos_static_text clr_contTypeB_subTxt"><%= photosStaticText %></div><div class="preview_images active"></div><div class="preview_images inactive"></div></div>'),preview_no_images_tpl:_.template('<div class="preview_no_images clr_contTypeB_subBg"><div class="center"><div class="message clr_contTypeB_subTxt"><%= staticText %></div></div></div>'),album_properties_preview_tpl:_.template('<% if (coverUrl!== "") { %><div class="album_cover sliced_image" style="background-image: url(\'<%= coverUrl %>\');" /><% } %><div class="album_texts"><div class="size_title_3 _1_line ellipsis album_cover_name clr_contTypeB_hdlTxt"><%= name %></div><% if (descr!== "") { %><div class="size_1 album_description clr_contTypeB_txt"><%= descr %></div><% } %></div>'),preview_image_tpl:_.template('<div class="preview_image sliced_image" style="width: <%= width %>px;height: <%= height %>px;margin-top: <%= marginTop %>px;margin-right: <%= marginRight %>px;margin-left: <%= marginLeft %>px;<% if (typeof(lazyLoad) != "undefined" && lazyLoad) { %>" data-image="<%= imgSrc %>" <% } else { %>background-image: url(<%= imgSrc %>);" <% } %>rel="<%= id %>" />'),photosListMarkup:_.template('<div class="scroll_wrapper"><div class="scroller"></div></div>'),albumHeaderMarkup:_.template('<% if (typeof(albumImage) != "undefined" && albumImage) { %><div class="album_header_item album_image sliced_image" style="background-image: url(<%= albumImage %>);"></div><% } %><div class="album_header_item flexboxChild-wideChild flexbox flexbox-center"><div class="album_texts_container"><div class="size_title_3 album_name clr_contTypeB_hdlTxt"> <%= albumName %> </div><% if (typeof(albumDescr) != "undefined" && albumDescr) { %><div class="size_1 album_descr clr_contTypeB_txt"> <%= albumDescr %> </div><% } %></div></div><div class="album_header_item numbers_box flexbox flexbox-vertical flexbox-end"><div class="size_title_2 photos_count_number clr_contTypeB_subTxt"> <%= count %> </div><div class="flexboxChild-wideChild size_0 _1_line photos_count_str clr_contTypeB_txt"> <%= photosStr %> </div><% if (typeof(uploadButton) != "undefined" && uploadButton) { %><div data-role="button" class="upload_button clr_contTypeB_actBtn_bg clr_contTypeB_actBtn_brdr clr_contTypeB_actBtn_hdlTxt"><div class="icon mask_sprite sprite-takePhoto clr_contTypeB_actBtn_icn"></div></div><% } %></div>'),thumbnail:{0:_.template('<div class="image_thumbnail_container clr_images_image2_brdr clr_images_image2_bg"><div class="image_thumbnail sliced_image" style="background-image: url(<%= imageSrc %>); height: <%= imageWidth %>px; width: <%= imageWidth %>px;"></div></div>'),1:_.template('<div class="image_thumbnail sliced_image" style="background-image: url(<%= imageSrc %>); height: <%= imageWidth %>px; width: <%= imageWidth %>px;"></div><div class="photo_title clr_contTypeB_hdlTxt" style="max-width: <%= imageWidth %>px;"><%= title %></div>'),2:_.template('<div class="photo_blog_container"><div class="photo_blog_img" style="background-image: url(\'<%= imageSrc %>\');"></div><div class="photo_blog_user_container<% if (userImage) { %> withImage<% } %>"><% if (userImage) { %><div class="userImage sliced_image" style="background-image: url(<%= userImage %>);"></div><% } %><div class="userTexts"><% if (byUser) { %><div class="size_title_1 byUser clr_contTypeA_hdlTxt"><%= byUser %></div><% } %><div class="size_1 photo_blog_title clr_contTypeA_txt"><%= title %></div></div></div><div class="size_0 photo_blog_poster clr_contTypeA_subTxt"><%= timeText %></div></div>'),3:_.template('<img class="image_thumbnail clr_images_image2_brdr clr_images_image2_bg" src="<%= imageSrc %>" style="height: <%= imageWidth %>px;"></img>'),4:_.template('<img class="photo_vertical_img" src="<%= imageSrc %>" /><% if (title) { %><div class="image_title clr_contTypeC_subTxt <% if (position === "top") { %>top<% } else if (position === "middle") { %>middle<% } else { %>bottom<% } %>"><%= title %></div><% } %>'),8:_.template('<div class="image_thumbnail_container clr_images_image2_brdr clr_images_image2_bg"><div class="image_thumbnail sliced_image" style="background-image: url(<%= imageSrc %>);"></div></div>'),9:_.template('<div class="image_thumbnail_container clr_images_image2_brdr clr_images_image2_bg"><div class="image_thumbnail sliced_image" style="background-image: url(<%= imageSrc %>);"></div></div>')},largeImage:_.template('<div class="large_img sliced_image clr_appGeneral_bg" style="background-image:url(<%= imageSrc %>);"><% if (title) { %><div class="header_box clr_contTypeC_bg"><div class="image_title clr_contTypeC_hdlTxt"><%= title %></div></div><% } %></div>'),slideViewMarkup:_.template('<div class="slide_container" dir="ltr"><div class="horizontal_strip"><div class="image sliced_image cool_border_image clr_appGeneral_bg"></div><div class="image sliced_image cool_border_image clr_appGeneral_bg"></div><div class="image sliced_image cool_border_image clr_appGeneral_bg"></div><div class="image sliced_image cool_border_image clr_appGeneral_bg"></div><div class="image sliced_image cool_border_image clr_appGeneral_bg"></div><div class="image sliced_image cool_border_image clr_appGeneral_bg"></div><div class="image sliced_image cool_border_image clr_appGeneral_bg"></div></div></div><div class="size_1 album_description clr_contTypeB_hdlTxt"></div>'),arrowsViewMarkup:_.template('<div class="slide_panel" dir="ltr"><div class="prev button_arrow clr_contTypeB_actBtn_bg clr_contTypeB_actBtn_brdr clr_contTypeB_actBtn_hdlTxt clr_contTypeB_actBtn_icn" data-role="button"><div class="icon mask_sprite sprite-arrow-left clr_contTypeB_actBtn_icn"></div></div><div class="image sliced_image cool_border_image clr_appGeneral_bg"></div><div class="next button_arrow clr_contTypeB_actBtn_bg clr_contTypeB_actBtn_brdr clr_contTypeB_actBtn_hdlTxt clr_contTypeB_actBtn_icn" data-role="button"><div class="icon mask_sprite sprite-arrow-right clr_contTypeB_actBtn_icn"></div></div></div><div class="circles_container" dir="ltr"></div><div class="size_1 album_description clr_contTypeB_hdlTxt"></div>'),circleButtonMarkup:_.template('<div class="circle_button clr_contTypeB_actBtn_bg clr_contTypeB_actBtn_brdr clr_contTypeB_actBtn_hdlTxt clr_contTypeB_actBtn_icn<% if (disabled) { %> disabled<% } %>" data-role="button"></div>'),photoUploadMarkup:_.template('<img class="thumbnail" src="<%= imageURI %>" /><div class="uploading"><div class="loading-txt clr_contTypeB_txt"><%= uploadTxt %></div><div class="loading-indicator mask_sprite sprite-ajax-loader_small spin clr_contTypeA_subIcn"></div></div><div class="fail-bar"><div class="error-message clr_contTypeB_txt"><%= errorMessage %></div><div class="button retry-button clr_contTypeB_btn_bg clr_contTypeB_btn_brdr clr_contTypeB_btn_hdlTxt"><div class="button-icon mask_sprite sprite-la-retry clr_contTypeB_btn_icn"></div></div><div class="button cancel-button clr_contTypeB_btn_bg clr_contTypeB_btn_brdr clr_contTypeB_btn_hdlTxt"><div class="button-icon mask_sprite sprite-la-cancel clr_contTypeB_btn_icn"></div></div></div>')}; var PhotosModel=ItemsModel.extend({initialize:function(){ItemsModel.prototype.initialize.apply(this,arguments);var a=this.get("items");if(a){a.bind("getItemsSuccess",this._onGetItemsSuccess,this)}var b=new Backbone.Collection();this.set({uploadingImagesCollection:b})},createItemsCollection:function(){var b=this.toJSON();var a=this.get("layoutId");if(a===4||a===5||a===6||a===7){b.PHOTOS_TAKE_COUNT=8}else{b.PHOTOS_TAKE_COUNT=25}return new PhotosCollection(null,b)},_onGetItemsSuccess:function(a){if(a){this.set(a)}this._addUploadingToCollection()},_getUploadUrl:function(){if(!this.uploadServiceUrl){var b=this.get("params").groupId;var a=this.get("userName");var c={albumId:a,groupId:b};this.uploadServiceUrl=Services.generateUrl("LIVE_ALBUM_PHOTO_V2_POST",c)}return this.uploadServiceUrl},uploadImage:function(e,d){var c=this;function a(k,g){var i="http://graph.facebook.com/"+k.fbId+"/picture";var l=new Object();l.message=d;l.userId=k.fbId;l.userType=PhotoUploadUserTypes.FACEBOOK;l.userImageUrl=i;l.userProfileUrl="http://www.facebook.com/"+k.fbId;if(g&&g.link){l.userProfileUrl=g.link}l.username="";if(g&&g.name){l.username=g.name}var h=new PhotoUploadModel({imageURI:e,postParams:l,largeImage:e,title:d,photoTime:parseInt((new Date().getTime())/1000),from:{imageUrl:i,name:_T("HtmlTextLiveAlbumUploadedByYou")}});var j=function(m){if(m){h.set({id:Utils.Helpers.generateGUID(),upload_id:m.result.photo.id});c.get("uploadingImagesCollection").add(h);h.set({state:PhotoUploadModel.STATE.SUCCESS});c._addUploadingToCollection()}};c.get("uploadingImagesCollection").add(h);h.bind("onRetry",c._uploadImage,c);h.bind("onCancel",c._onCancelUpload,c);c._uploadImage(h)}function f(){}var b={useLoginForm:true};conduitApi.social.getAccessTokens(a,f,conduitApi.social.socialServicesEnum.Facebook,b)},_uploadImage:function(a){a.set({state:PhotoUploadModel.STATE.UPLOADING});var d=a.get("imageURI");var h=a.get("postParams");var b=new FileUploadOptions();b.fileKey="file";b.fileName=d.substr(d.lastIndexOf("/")+1);b.mimeType="image/jpeg";var g=parseInt(new Date().getTime()/1000);h.dateTaken=g;a.set({photoTime:g});b.params=h;var e=this._getUploadUrl();var f=new FileTransfer();var c=this;f.upload(d,e,function(i){if(i.response){if(DEVICE===deviceTypeEnum.iphone){i.response=decodeURIComponent(i.response)}i=JSON.parse(i.response)}if(i.success){c._imageUploadSuccess(a,i)}else{c._imageUploadFailed(a,i)}},function(i){c._imageUploadFailed(a,i)},b)},_onCancelUpload:function(a){this.get("uploadingImagesCollection").remove(a)},_imageUploadFailed:function(a){a.set({state:PhotoUploadModel.STATE.FAIL})},_imageUploadSuccess:function(a,b){if(b&&b.result&&b.result.photo&&b.result.photo.id){a.set({id:Utils.Helpers.generateGUID(),upload_id:b.result.photo.id});if(navigator.liveAlbum.uploadImageSucceeded){a.set({instagramShare:AppSettingsManager.getSettings().get("instagramShare")});navigator.liveAlbum.uploadImageSucceeded(null,null,a.toJSON())}}a.set({state:PhotoUploadModel.STATE.SUCCESS});this._addUploadingToCollection()},_addUploadingToCollection:function(){var b=this.get("uploadingImagesCollection");var a=this.get("items");b.each(function(c){if(c.get("state")===PhotoUploadModel.STATE.SUCCESS){var e=c.get("upload_id");var d=c.get("id");if(a.get(e)){b.remove(c)}else{if(!a.get(d)){a.add(c,{at:0});a.trigger("singleAdd")}}}})},getPhotosArrayForGallery:function(){var a=[];var d=this.get("items");if(d){for(var c=0;c<d.models.length;c++){var b=d.at(c);a[c]={title:b.get("title"),photoTime:b.get("photoTime"),largeImage:b.getLargestImage(),photoModel:b}}}return a}}); var PhotoUploadModel=PhotoModel.extend({defaults:{state:0}});PhotoUploadModel.STATE={UPLOADING:0,FAIL:1,SUCCESS:2}; var PhotosCollection=ItemsCollection.extend({model:PhotoModel,initialize:function(b,a){ItemsCollection.prototype.initialize.apply(this);if(a.type){switch(a.type){case"picasa":case"facebook":case"flickr":case"smugmug":if(!a.userName||!a.params||!a.params.albumName){this.invalid=true}break;case"tumblr":case"twitpic":if(!a.userName){this.invalid=true}break;case"livealbum":if(!a.userName||!a.params.groupId){this.invalid=true}break;case"mrss":if(!a.params||!a.params.albumId){this.invalid=true}break}}else{this.invalid=true}this.params={type:a.type,userName:a.userName,extraInfo:a.params||{},take:a.PHOTOS_TAKE_COUNT};if(a.uploadButton){this.params.extraInfo.expiration=1}this.overrideDescription=a.overrideDescription},parse:function(a){var e={};if(a&&a.photos){var d=a.description;if(this.overrideDescription===null||typeof(this.overrideDescription)==="object"){this.overrideDescription=""}if(typeof(this.overrideDescription)==="string"){d=this.overrideDescription}var f=[];for(var c=0;c<a.photos.length;c++){a.photos[c].albumDescription=d;if(typeof(this.overrideDescription)==="string"){a.photos[c].title=this.overrideDescription}f[c]=new PhotoModel(a.photos[c])}e.models=f;var b=new Backbone.Model({count:a.totalPhotos,albumName:a.albumName,albumDescr:d,albumImage:a.coverPhotoUrl||""});e.metaData={album:b}}return e},getServiceName:function(){return"CMS_PHOTOS_GET"},getParams:function(){return this.params}}); var PhotosTemplateView=TemplateView.extend({DEFAULT_LAYOUT:8,LIVE_ALBUM_TYPE:"26ae8ccc-5464-7979-4fdf-3a13f166ffff",defaultExecuteOptions:{executeType:executeTypeEnum.HIT_AND_RUN},initialize:function(){TemplateView.prototype.initialize.apply(this);if(PLATFORM==platformEnum.simulator){$.extend(this.defaultExecuteOptions,{executeType:executeTypeEnum.FORCE_NETWORK,forceServerNoCache:true})}var a=this.model.get("meta");if(this.model.get("type")==this.LIVE_ALBUM_TYPE){a.pageLayout=2;a.usePreviews=true}this._galleryManager=new PhotoGalleryManager();this._photosModels=[];this.coverViews=[];this.photosViews=[];if((typeof(a.pageLayout)!=="number")||a.pageLayout<0||a.pageLayout>10){a.pageLayout=this.DEFAULT_LAYOUT}if(LAYOUT===layoutFormat.wide&&(a.pageLayout===2||a.pageLayout===4||a.pageLayout===5||a.pageLayout===6||a.pageLayout===7)){a.pageLayout=this.DEFAULT_LAYOUT}this.model.set({meta:a})},render:function(b){var f=this.model.get("meta");if(f.usePreviews||f.pageLayout===9){var d=new PreviewsListView({id:"albums_"+Utils.Helpers.generateGUID()});d.render();var c=f[this.options.tabsName];$.each(c,function(g){this.createPhotosModel(g);this.coverViews[g]=new AlbumPreviewView({model:this._photosModels[g],albumIndex:g})}.hitch(this));d.addTabs(this.coverViews);if(LAYOUT===layoutFormat.wide){this.dividedScreenView=new DividedScreenView({id:"divided_screen_"+Utils.Helpers.generateGUID(),bubblePageEvents:true});this.dividedScreenView.setView1(d);this.$el.append(this.dividedScreenView.render().addRefreshButton(true).el);this._homePagesViews[b]=this.dividedScreenView;d.bind("albumSelected",function(h,g,j){if(this.photosPage){this.removePhotosView(this.photosPage);this.photosPage=null}this.photosPage=this.createPhotosView(h,g);this.photosPage.$el.attr({"data-role":"","data-buttons":""});this.dividedScreenView.setView2(this.photosPage.render());this.photosPage.trigger("pageshow")}.hitch(this));var a=this.coverViews[0];if(a){a.trigger("albumClicked",a.model)}}else{this._homePagesViews[b]=d;this.$el.append(d.el);d.bind("albumSelected",function(j,g,k){if(!this.photosViews[g]){this.photosViews[g]=this.createPhotosView(j,g);this.photosViews[g].$el.attr({"data-buttons":"back refresh"});this.$el.append(this.photosViews[g].render().el)}var h="#"+this.photosViews[g].id;$.mobile.changePage(h,{transition:"slide",reverse:IS_RTL})}.hitch(this))}}else{this.createPhotosModel(b);var e=this.createPhotosView(this._photosModels[b],b);this.$el.append(e.render().el);this._homePagesViews[b]=e;TemplateView.prototype.render.apply(this,[b])}return this},createPhotosModel:function(b){var c=this.model.get("meta");var a=c[this.options.tabsName][b];if(a){a.layoutId=c.pageLayout;a.layoutParams=c.layoutParams;a.uploadButton=this.model.get("type")==this.LIVE_ALBUM_TYPE}this._photosModels[b]=new PhotosModel(a);this._photosModels[b].set({layoutId:c.pageLayout,albumIndex:b});this._photosModels[b].getItems(this.defaultExecuteOptions)},createPhotosView:function(b,a){var c=new PhotosView({model:b,id:"photos_"+Utils.Helpers.generateGUID()});c.bind("onPhotoSelected",this._onPhotoSelected,this);c.bind("onUploadButtonClick",function(){this._onUploadButtonClick(a)},this);return c},removePhotosView:function(a){a.unbind("onPhotoSelected",this._onPhotoSelected,this);a.unbind("onUploadButtonClick");a.remove()},_onUploadButtonClick:function(a){if(PLATFORM===platformEnum.simulator){cqm.showToastMessage("Camera is not supported in simulator mode");return}var c=[{title:_T("DialogButtonLiveAlbumChoosePhotoTake"),returnValue:"CAMERA"},{title:_T("DialogButtonLiveAlbumChoosePhotoChoose"),returnValue:"PHOTOLIBRARY"}];var b={};ChooseDialog.execute(c,function(d){this._takePhoto(d,a)}.hitch(this),null,b)},_takePhoto:function(f,b){var g=this;var i={CAMERA:navigator.camera.PictureSourceType.CAMERA,PHOTOLIBRARY:navigator.camera.PictureSourceType.PHOTOLIBRARY};var k={quality:80,destinationType:navigator.camera.DestinationType.FILE_URI,sourceType:i[f],targetWidth:1024,targetHeight:1024};var h=this.model.get("meta");var e=h[this.options.tabsName][b];if(e.options){_.extend(k,e.options)}var h=this.model.get("meta");var d=h[this.options.tabsName][b];d.filters=d.filters||{};var a=d.filters["device_"+DEVICE];g.translateFiltersNames(a);k.extraOptions={isShowPhotoDialog:true,dialogCaption:_T("DialogCaptionLiveAlbumPostPhoto"),cancelTitle:_T("DialogButtonLiveAlbumPostPhotoCancel"),okTitle:_T("DialogButtonLiveAlbumPostPhotoOk"),inputPlaceholder:_T("HtmlTextLiveAlbumAddComment"),filters:a,watermark:d.watermark,augmentedReality:d.augmentedReality,activityUploading:_T("UploadStatusLiveAlbumImageUploading"),activitySent:_T("UploadStatusLiveAlbumImageSent"),activityFailed:_T("UploadStatusLiveAlbumProcessFailed"),overlay:d.overlay};var j=function(l){k.imageURI=l;g._cbCaptureImageSuccess(b,k)};var c=function(){};if(((DEVICE===deviceTypeEnum.iphone)&&(PLATFORM===platformEnum.nativeApp))||(((k.sourceType==i.CAMERA)&&k.extraOptions.augmentedReality)&&((DEVICE===deviceTypeEnum.android)&&(PLATFORM===platformEnum.nativeApp)&&(OS_VERSION>=11)))){navigator.liveAlbum.takePicture(j,c,k)}else{navigator.camera.getPicture(j,c,k)}},translateFiltersNames:function(b){if(b){for(var a=b.length-1;a>=0;a--){b[a].name=Utils.String.translateIfNeed(b[a].name)}}},_cbCaptureImageSuccess:function(b,c){var e=this;var a=function(){};var d=function(f){e._cbUploadImageDlgOk(f.imageURI,f.textMessage,b)};navigator.liveAlbum.uploadImageDialog(d,a,c)},_cbUploadImageDlgOk:function(c,b,a){this._photosModels[a].uploadImage(c,b)},_onPhotoSelected:function(a,c){var b=this._photosModels[a].getPhotosArrayForGallery();this._galleryManager.pressedImage(b,c)}}); var AlbumPreviewView=BaseItemsView.extend({tagName:"li",className:"album_cover",initialize:function(){BaseItemsView.prototype.initialize.apply(this);this.model.bind("change:selected",this.onSelectedChange,this);$(window).bind("throttledresize",this.onResize.hitch(this));this.$el.tap(function(a){a.preventDefault();conduitApi.analytics.addEvent(null,null,conduitApi.analytics.usageEventTypeEnum.ViewChanged,{viewId:this.model.get("id")});this.trigger("albumClicked",this.model)}.hitch(this))},_onGetItemsSuccess:function(){this.render();BaseItemsView.prototype._onGetItemsSuccess.apply(this)},_updatePhotosCount:function(){var b=this.model.get("album");var a=b&&b.get("count");this.$el.find(".photos_count").html(a||"0")},onSelectedChange:function(){if(LAYOUT===layoutFormat.wide){if(this.model.get("selected")){this.$(".album_item").addClass("selected")}else{this.$(".album_item").removeClass("selected")}}},_reset:function(){var c={photosStaticText:_T("HtmlTextLiveAlbumPhotos"),albumIndex:this.options.albumIndex};this.$el.html(photosTemplates.album_preview_tpl(c));this._initAlbumProperties();var b={staticText:'<div class="loading_album_icon mask_sprite sprite-ajax-loader_small spin clr_appGeneral_loadingSmallIcn"></div><div class="loading_album_text">'+_T("HtmlTextLiveAlbumLoadingAlbum")+"</div>"};var a=photosTemplates.preview_no_images_tpl(b);this.$el.find(".preview_images.active").html(a)},updateImagesSizes:function(){var d=this.model.get("items");var a=d.length;if(a>0){var b=this.$el.find(".preview_images.active .preview_image:first-child");var c=this._getImageSizes(0);b.css("width",c.width+"px").css("height",c.height+"px").css("margin-top",c.marginTop+"px");if(IS_RTL){b.css("margin-right",c.marginLeft+"px")}else{b.css("margin-left",c.marginLeft+"px")}}},_getImageSizes:function(a){var d={height:40,width:40,marginTop:4,marginLeft:4};if(a===0){var c=this.model.get("items");var b=c.length;var f=this.$el.find(".preview_images.active");var e=Math.max(f.width(),40);d.height=d.height*2+d.marginTop;if(b===1){d.width=e}else{if(b<4){d.width=e-d.marginLeft-d.width}else{if(b<6){d.width=e-d.marginLeft*2-d.width*2}else{d.width=e-d.marginLeft*3-d.width*3}}}d.marginLeft=0;d.marginTop=0}else{if((b<4&&a<2)||(b<6&&a<3)||(a<4)){d.marginTop=0}}return d},_renderItems:function(){if(!this.model.get("album")){return}this._updatePhotosCount();var d=this.model.get("items");items=d.models.slice(-7);var a=$.map(items,function(k,g){var j=this._getImageSizes(items.length-1-g);if(IS_RTL){j.marginRight=j.marginLeft;j.marginLeft=0}else{j.marginRight=0}var i=k.getMediumImage();var l=false;var m={width:j.width,height:j.height,marginTop:j.marginTop,marginLeft:j.marginLeft,marginRight:j.marginRight,imgSrc:i,lazyLoad:l,id:k.get("id")};var h=$(photosTemplates.preview_image_tpl(m));return h}.hitch(this));var e=this.$el.find(".preview_images.active");var c=this.$el.find(".preview_images.inactive");if(a.length>0){c.html("");$.each(a,function(g,h){c.prepend(h)})}else{var f={staticText:_T("HtmlTextPhotosNoImages")};var b=photosTemplates.preview_no_images_tpl(f);c.html(b)}c.removeClass("inactive").addClass("active");e.removeClass("active").addClass("inactive")},_initAlbumProperties:function(){var b={coverUrl:"",name:this.model.get("title")||"",descr:this.model.get("description")||""};var a=photosTemplates.album_properties_preview_tpl(b);this.$el.find(".album_item").prepend(a)},onResize:function(){if(this.isPageShow){this.updateImagesSizes()}},onPageShow:function(){this.isPageShow=true;this.updateImagesSizes()},onPageHide:function(){this.isPageShow=false},_renderShowMoreButton:function(){}}); var PreviewsListView=Backbone.View.extend({coverViews:[],_selectedItem:null,initialize:function(){this.$el.attr({"data-role":"page","data-buttons":"navigation refresh"});this.$el.bind("pageshow",this.onPageShow.hitch(this));this.$el.bind("pagehide",this.onPageHide.hitch(this));this.bind("pageshow",this.onPageShow.hitch(this));this.bind("pagehide",this.onPageHide.hitch(this));this.$el.bind("refresh",this.handleRefreshClick.hitch(this));this.$el.bind("silentRefresh",this.handleSilentRefresh.hitch(this))},render:function(b){this.$el.html('<div class="scroll_wrapper"><div class="scroller"></div></div>');var c=this.$el.find(".scroller");this.$scrollWrapper=this.$el.find(".scroll_wrapper");var a=photosTemplates.previews_list_tpl;c.html(a(b));this.$listContainer=c.find(".previews_list");Scrolling.init(this.$scrollWrapper);return this},onItemClicked:function(a){var b=!!(this._selectedItem&&this._selectedItem.cid===a.cid);if(this._selectedItem&&!b){this._selectedItem.set({selected:false})}if(!b){this._selectedItem=a;this._selectedItem.set({selected:true})}this.trigger("albumSelected",a,a.get("albumIndex"),b)},onPageShow:function(){$.each(this.coverViews,function(a){setTimeout(function(){this.coverViews[a].onPageShow.hitch(this.coverViews[a])()}.hitch(this),10)}.hitch(this))},onPageHide:function(){$.each(this.coverViews,function(a){this.coverViews[a].onPageHide.hitch(this.coverViews[a])()}.hitch(this))},handleRefreshClick:function(){$.each(this.coverViews,function(a){this.coverViews[a].handleRefreshClick()}.hitch(this))},handleSilentRefresh:function(){$.each(this.coverViews,function(a){this.coverViews[a].handleSilentRefresh()}.hitch(this))},addTabs:function(a){this.coverViews=a;$.each(a,function(b){this.$listContainer.append(this.coverViews[b].render().el);this.coverViews[b].onPageShow();this.coverViews[b].bind("albumClicked",this.onItemClicked.hitch(this))}.hitch(this));Scrolling.init(this.$scrollWrapper)}}); var ThumbnailView=Backbone.View.extend({tagName:"li",IMAGE_WIDTH_NARROW:73,IMAGE_WIDTH_WIDE:150,events:{tap:"itemClicked"},initialize:function(){this.$el.attr("data-role","button")},render:function(){var b={title:this.model.get("title")};if(this.options.layoutId===2){this.$el.addClass("clr_contTypeA_bg clr_contTypeA_brdr");var a=this.model.get("photoTime");b.timeText=Utils.TimeDate.timeAsText(a);b.imageSrc=this.model.getLargestImage();b.userImage="";b.byUser="";var c=this.model.get("from");if(c){if(c.imageUrl){b.userImage=c.imageUrl}if(c.name){b.byUser=_T("HtmlTextLiveAlbumByUploader",{name:c.name})}}}else{if(this.options.layoutId===0||this.options.layoutId===1||this.options.layoutId===3||this.options.layoutId===8||this.options.layoutId===9){this.$el.addClass("thumbnail-view");if(LAYOUT===layoutFormat.wide){b.imageWidth=this.IMAGE_WIDTH_WIDE;b.imageSrc=this.model.getMediumImage(true)}else{b.imageWidth=this.IMAGE_WIDTH_NARROW;b.imageSrc=this.model.getMediumImage(true)}}else{if(this.options.layoutId===4){this.$el.addClass("photo_vertical_item");b.imageSrc=this.model.getLargestImage();if(this.options.layoutParams&&this.options.layoutParams.descriptionPosition){b.position=this.options.layoutParams.descriptionPosition}else{b.position="bottom"}}}}this.$el.html(photosTemplates.thumbnail[this.options.layoutId](b));if(this.options.layoutId===4||this.options.layoutId===3){this.$el.find("IMG").load(function(){var d=Scrolling.getMyScrollerWrapper(this.$el);Scrolling.onContentChanged(d)}.hitch(this)).error(function(){$(this).remove()})}return this},itemClicked:function(a){a.preventDefault();if(this.options.layoutId!==4){this.model.trigger("itemClicked",this.model)}}}); var ThumbnailColumnView=Backbone.View.extend({tagName:"li",className:"t3d sliced_image column-thumbnail-view animation",events:{tap:"itemClicked"},render:function(){this.$el.css({"background-image":"url("+this.model.getMediumImage(true)+")"});return this},itemClicked:function(a){a.preventDefault();this.model.trigger("itemClicked",this.model)}}); var PhotosView=Backbone.View.extend({initialize:function(){this.$el.attr({"data-role":"page","data-buttons":"navigation refresh"});this.model.bind("change:album",this._renderHeader,this);this.model.bind("itemSelected",this._onPhotoSelected,this);this.$el.bind("refresh",this.handleRefreshClick.hitch(this));this.$el.bind("silentRefresh",this.handleSilentRefresh.hitch(this))},handleRefreshClick:function(){if(this.photosListView){this.photosListView.handleRefreshClick()}},handleSilentRefresh:function(){if(this.photosListView){this.photosListView.handleSilentRefresh()}},render:function(){var b=parseInt(this.model.get("layoutId"));if(false&&b===5){this.$scroller=this.$el}else{this.$el.html(photosTemplates.photosListMarkup());this.$scroller=this.$el.find(".scroller");Scrolling.init(this.$el.find(".scroll_wrapper"))}this.$headerContainer=$("<div></div>").appendTo(this.$scroller);var a={model:this.model,id:"photos_view_"+Utils.Helpers.generateGUID()};this.$el.addClass("layout-"+b);if(b===0||b===1||b===2||b===3||b===4||b===8||b===9){if(b===8||b===9){this.$el.addClass("change_size")}this.photosListView=new PhotosListView(a)}else{if(b===5){this.photosListView=new PhotosShowView(a)}else{if(b===6){this.photosListView=new PhotosSlideView(a)}else{if(b===7){this.photosListView=new PhotosArrowsView(a)}else{if(b===10){this.photosListView=new PhotosColumnsView(a)}}}}}this.$scroller.append(this.photosListView.render().el);if(b===0||b===1||b===3||b===5||b===8||b===9||b===10){this.$el.bind("pageshow",this._onPageShow.hitch(this));this.$el.bind("pagehide",this._onPageHide.hitch(this));this.bind("pageshow",this._onPageShow.hitch(this));this.bind("pagehide",this._onPageHide.hitch(this));this.photosListView.onPageHide.hitch(this.photosListView)()}if(b===6||b===7){this.$el.addClass("clr_contTypeB_fullPage_bg")}this._renderHeader();return this},_onPageShow:function(){setTimeout(function(){this.photosListView.onPageShow.hitch(this.photosListView)()}.hitch(this),10)},_onPageHide:function(){this.photosListView.onPageHide.hitch(this.photosListView)()},_onPhotoSelected:function(c,d){var a=this.model.get("items");var b=a.indexOf(c);this.trigger("onPhotoSelected",this.model.get("albumIndex"),b)},_onUploadButtonClick:function(){this.trigger("onUploadButtonClick")},_renderHeader:function(){if(this.model.get("hideHeader")){return}var b=null;var a=this.model.get("album");if(this.model.get("logoImgUrl")){b=new LogoHeaderView({model:this.model})}else{if(a){a.set({uploadButton:this.model.get("uploadButton")});b=new PhotosAlbumHeaderView({model:a,id:"photos_album_header_view_"+Utils.Helpers.generateGUID()});b.bind("onUploadButtonClick",this._onUploadButtonClick,this)}}if(b){this.$headerContainer.html(b.render().el)}},addTabsView:function(a){this.$scroller.prepend(a)}}); var PhotosAlbumHeaderView=Backbone.View.extend({className:"flexbox album_header clr_contTypeB_headerItem_bg clr_contTypeB_headerItem_brdr",render:function(){var a=this.model.toJSON();a.photosStr=_T("HtmlTextLiveAlbumPhotos");a.uploadButton=(a.uploadButton&&PLATFORM!==platformEnum.webApp);this.$el.html(photosTemplates.albumHeaderMarkup(a));this.$(".upload_button").tap(this.onUploadButtonClick.hitch(this));return this},onUploadButtonClick:function(){this.trigger("onUploadButtonClick")}}); var PhotosListView=ItemsView.extend({initialize:function(){ItemsView.prototype.initialize.apply(this);var c=this.model.get("uploadingImagesCollection");if(c){c.bind("add",this.onAddUploadingPhoto,this)}var a=this.model.get("layoutId");if(a===0||a===1||a===3||a===8||a===9){if(a===3||a===1){this.$itemsList.addClass("clr_contTypeA_bg");if(a===3){this.$itemsList.addClass("centered_grid")}}$(window).bind("throttledresize",this.onResize.hitch(this));var b=this.model.get("items");if(b){b.bind("getItemsSuccess singleAdd",this.onResize,this)}}},createItemView:function(a){var b=new ThumbnailView({model:a,layoutId:this.model.get("layoutId"),layoutParams:this.model.get("layoutParams"),id:"thumbnail_view_"+Utils.Helpers.generateGUID()});return b},getRootView:function(){return this.$el},onResize:function(){if(this.isPageShow){this.updateThumbnailsMargin()}},onPageShow:function(){this.isPageShow=true;this.updateThumbnailsMargin();this.$itemsList.css({visibility:"visible"})},onPageHide:function(){this.isPageShow=false;this.$itemsList.css({visibility:"hidden"})},updateThumbnailsMargin:function(){var a=this.model.get("layoutId");if(a===0||a===1){Utils.Html.setGridMargin(this.$itemsList)}else{if(a===8||a===9){if(LAYOUT===layoutFormat.wide){var b={minWidth:150,setAlsoMarginTop:true,margin:10}}else{var b={minWidth:80,setAlsoMarginTop:false,margin:4}}Utils.Html.setGridSizes(this.$itemsList,b)}}},onAddUploadingPhoto:function(a){var b=new PhotoUploadView({model:a});this.getRootView().prepend(b.render().el);this.$myScrollWrapper=this.$myScrollWrapper||Scrolling.getMyScrollerWrapper(this.$el);Scrolling.onContentChanged(this.$myScrollWrapper)}}); var PhotosShowView=BaseItemsView.extend({initialize:function(){BaseItemsView.prototype.initialize.apply(this);$(window).bind("throttledresize",this.onResize.hitch(this))},_onGetItemsSuccess:function(){this.render();BaseItemsView.prototype._onGetItemsSuccess.apply(this)},$fadeContainerHandle:function(){if(!this.$fadeContainer){this.$fadeContainer=$('<div class = "fade_container"></div>');this.$el.append(this.$fadeContainer)}return this.$fadeContainer},_renderItems:function(){if(this._timerHandle!==null){clearTimeout(this._timerHandle);this._timerHandle=null}var a=this.model.get("items");if(a.length>0){if(!this.photoModel){this.photoModel=new PhotoModel();this.photoView=new PhotosLargeImageView({model:this.photoModel});this.photoModel2=new PhotoModel();this.photoView2=new PhotosLargeImageView({model:this.photoModel2});this.$fadeContainerHandle().append(this.photoView.$el).append(this.photoView2.$el);this.initPhotoViewsCss()}this.prepareNextImage(true)}},_timerHandle:null,SLIDESHOW_DELAY:3000,selectNextImage:function(d,c){if(this._timerHandle!==null){clearTimeout(this._timerHandle);this._timerHandle=null}var a=(d/1000)+"s";this.photoView2.$el.css({"-webkit-transition-property":"opacity","-webkit-transition-duration":a,"-webkit-transition-timing-function":"ease-out",opacity:"1"});this.photoView.$el.css({"-webkit-transition-property":"opacity","-webkit-transition-duration":a,"-webkit-transition-timing-function":"linear",opacity:"0"});setTimeout(this.swapPhotos.hitch(this),d);var b=this.model.get("items");if(c&&b.length>1){this.prepareNextImage();this.setTimer()}},setTimer:function(){this._timerHandle=setTimeout(function(){if(this.isNextImageReady){this.selectNextImage(400,true)}else{this.setTimer()}}.hitch(this),this.SLIDESHOW_DELAY)},prepareNextImage:function(a){this.isNextImageReady=false;var f=this.model.get("items");if(typeof(this.imageIndex)==="undefined"){this.imageIndex=0}else{this.imageIndex=(this.imageIndex+1)%f.length}var g=f.at(this.imageIndex);if(g){var e=this;var c=g.getLargestImage();var b=new Image();b.onload=function(){e.photoModel2.set(g.toJSON());e.isNextImageReady=true;if(a){e.selectNextImage(0,true)}};var d=function(){e.prepareNextImage(a)};b.onerror=d;b.onabort=d;b.src=c}},swapPhotos:function(){var a=this.photoModel2;this.photoModel2=this.photoModel;this.photoModel=a;a=this.photoView2;this.photoView2=this.photoView;this.photoView=a},initPhotoViewsCss:function(){this.photoView.$el.css({"-webkit-transition-duration":"0s",opacity:"1","z-index":"0"});this.photoView2.$el.css({"-webkit-transition-duration":"0s",opacity:"0","z-index":"1"})},updatePhotoHeight:function(){var c=this.$fadeContainerHandle().offset().top;var b={includeHeader:true};var a=Utils.Html.getInnerHeight(b)-c;if(a<100){a=100}this.$fadeContainerHandle().css({height:a+"px"});var d=Scrolling.getMyScrollerWrapper(this.$el);Scrolling.onContentChanged(d)},onResize:function(){if(this.isPageShow){this.updatePhotoHeight()}},onPageShow:function(){this.isPageShow=true;this.updatePhotoHeight()},onPageHide:function(){this.isPageShow=false},_renderShowMoreButton:function(){}}); var PhotosColumnsView=ItemsView.extend({columns:[],margin:0,columnWidth:0,initialize:function(){ItemsView.prototype.initialize.apply(this);$(window).bind("throttledresize",this.onResize.hitch(this))},_reset:function(){ItemsView.prototype._reset.apply(this);this.loadedImages=[];this._recalcColumns()},_renderOneItem:function(e){var c=this.createItemView(e);this.$itemsList.append(c.render().el);var g=Math.floor((Math.random()*500));var f=Math.floor((Math.random()*300));c.$el.css({top:g,left:f,width:0,height:0});var a=new Image();var d=this;a.onload=function(){var h={itemView:c,imageRatio:this.height/this.width};c.$el.addClass("clr_images_image2_brdr");d.loadedImages.push(h);d._changeItemPosition(h)};var b=function(){c.remove()};a.onerror=b;a.onabort=b;setTimeout(function(){a.src=e.getMediumImage(true)},1)},createItemView:function(a){var b=new ThumbnailColumnView({model:a});return b},getRootView:function(){return this.$el},onResize:function(){if(this.isPageShow){this.updateThumbnailsMargin()}},onPageShow:function(){this.isPageShow=true;this.updateThumbnailsMargin()},onPageHide:function(){this.isPageShow=false},updateThumbnailsMargin:function(){this._recalcColumns();for(var a=0;a<this.loadedImages.length;a++){var b=this.loadedImages[a];this._changeItemPosition(b)}},_recalcColumns:function(){if(LAYOUT===layoutFormat.wide){var d=8;var b=160}else{var d=4;var b=100}var a=0;var f=b+d;var e=this.$itemsList.width()-d;if(e>0){a=Math.floor(e/f);if(a>0){e=e-(a*d);f=Math.floor(e/a)}}this.margin=d;this.columnWidth=f;this.columns=[];for(var c=0;c<a;c++){this.columns[c]=0}},_changeItemPosition:function(j){if(!this.columns.length){return}var m=999999;var o=0;var k=0;for(var h=0;h<this.columns.length;h++){if(this.columns[h]<m){m=this.columns[h];k=h}if(this.columns[h]>o){o=this.columns[h]}}var l=m+this.margin;var e=k*(this.margin+this.columnWidth)+this.margin;var b=this.columnWidth;var n=Math.floor(this.columnWidth*j.imageRatio);if(false&&$.support.cssTransitions){var g=100;var c=Math.floor(g*j.imageRatio);var f="scale("+(b/g)+")";var d="translate("+e+"px, "+l+"px)";j.itemView.$el.css({width:g,height:c,"-webkit-transition-property":"all","-webkit-transition-duration":"1.25s","-webkit-transition-timing-function":"ease-out","-webkit-transform":f+" "+d})}else{j.itemView.$el.css({top:l,left:e,width:b,height:n})}var a=l+n;this.columns[k]=a;if(a>o){this.$itemsList.css({height:a,marginBottom:15});this.updateScroller()}},updateScroller:function(){if(!this.waitForUpdate){this.waitForUpdate=true;setTimeout(function(){this.waitForUpdate=false;var a=Scrolling.getMyScrollerWrapper(this.$el);Scrolling.onContentChanged(a)}.hitch(this),1000)}}}); var PhotosSlideView=BaseItemsView.extend({className:"slide_view",_onGetItemsSuccess:function(){this.render();var a=Scrolling.getMyScrollerWrapper(this.$el);Scrolling.onContentChanged(a);BaseItemsView.prototype._onGetItemsSuccess.apply(this)},_reset:function(){this.$el.html(photosTemplates.slideViewMarkup());this._$slideContainer=this.$el.find(".slide_container");this._$iconsStrip=this.$el.find(".horizontal_strip");this._currImageIndex=-1;this._page=0;var a=this.$el.find(".image");this.$descr=this.$el.find(".album_description");this._$imagesArray=[$(a[0]),$(a[1]),$(a[2]),$(a[3]),$(a[4]),$(a[5]),$(a[6])];this._supportNav=false},_renderItems:function(){var b=this.model.get("album")?this.model.get("album").get("albumDescr"):null;if(b){this.$descr.html(b).show()}else{this.$descr.hide()}var a=this.model.get("items");if(a.length>0){if(a.length>1){this._bindNavEvents();this._supportNav=true;this._$imagesArray[0].show();this._$imagesArray[1].show();this._$imagesArray[2].show();this._$imagesArray[4].show();this._$imagesArray[5].show();this._$imagesArray[6].show()}else{this._$imagesArray[0].hide();this._$imagesArray[1].hide();this._$imagesArray[2].hide();this._$imagesArray[4].hide();this._$imagesArray[5].hide();this._$imagesArray[6].hide()}this.setImage(0,0)}},_setStripLeft:function(a,b){this._$iconsStrip.animate({left:a},b)},_setImageLeft:function(b,a){b.css({left:a+"px"})},_bindNavEvents:function(){this._currImageIndex=-1;this._imageWidth=225;this._page=0;this._touchNavStarted=false;this._curX;this._totalXDiff=0;var c=this;var b=("ontouchstart" in window);var h=("WebKitCSSMatrix" in window&&"m11" in new WebKitCSSMatrix());if(h){this._setStripLeft=function(j,k){this._$iconsStrip.css({"-webkit-transition":"all "+k+"ms","-webkit-transition-timing-function":"ease-out","-webkit-transform":"translate3d("+j+"px,0,0)"})};this._setImageLeft=function(k,j){k.css({"-webkit-transform":"translate3d("+j+"px,0,0)"})}}if(b){_getXFromEvent=function(j){return j.changedTouches[0].pageX}}else{if($.browser.msie){_getXFromEvent=function(j){return j.clientX}}else{_getXFromEvent=function(j){return j.pageX}}}var e=b?"touchstart":"mousedown";var f=b?"touchmove":"mousemove";var d=b?"touchend":"mouseup";var i=function(j){c._touchNavStarted=true;c._totalXDiff=0;if(j.originalEvent){j=j.originalEvent}if(j.preventDefault){j.preventDefault()}c._curX=_getXFromEvent(j);return true};var a=function(l){if(!c._touchNavStarted){return false}if(l.originalEvent){l=l.originalEvent}if(l.preventDefault){l.preventDefault()}var j=_getXFromEvent(l);var k=j-c._curX;c._totalXDiff+=k;c._curX=j;c._setStripLeft(-(c._page*c._imageWidth)+c._totalXDiff,0);return true};var g=function(m){if(c._touchNavStarted){if(m.originalEvent){m=m.originalEvent}if(m.preventDefault){m.preventDefault()}var j=_getXFromEvent(m);var k=j-c._curX;c._totalXDiff+=k;var n=-c._totalXDiff/c._imageWidth;if(n>0.2&&n<1){n=1}if(n<-0.2&&n>-1){n=-1}n=Math.round(n);var l=c._currImageIndex+n;c.setImage(l,250);c._touchNavStarted=false}return true};c._$slideContainer.bind(e,i);c._$slideContainer.bind(f,a);c._$slideContainer.bind(d,g)},setImageSrc:function(d){var e=this.model.get("items");var a=e.length;var b=(this._currImageIndex+d-3+2*a)%a;var c=this._$imagesArray[d];var f=e.at(b).getLargestImage();c.css({"background-image":"url("+f+")"})},setImagePosition:function(c){var b=this._$imagesArray[c];var a=this._page+c-3;a=a*this._imageWidth;this._setImageLeft(b,a)},setImage:function(b,d){var g=this.model.get("items");var a=g.length;if(this._currImageIndex===-1){this._currImageIndex=0;this.setImageSrc(3);this.setImagePosition(3);if(this._supportNav){this.setImageSrc(0);this.setImageSrc(1);this.setImageSrc(2);this.setImageSrc(4);this.setImageSrc(5);this.setImageSrc(6);this.setImagePosition(0);this.setImagePosition(1);this.setImagePosition(2);this.setImagePosition(4);this.setImagePosition(5);this.setImagePosition(6)}}var c=b-this._currImageIndex;this._currImageIndex=(b+a)%a;this._page+=c;if(this._supportNav&&c!==0){if(c>0){var f=0;while(f<c){var e=this._$imagesArray[6];this._$imagesArray[6]=this._$imagesArray[0];this._$imagesArray[0]=this._$imagesArray[1];this._$imagesArray[1]=this._$imagesArray[2];this._$imagesArray[2]=this._$imagesArray[3];this._$imagesArray[3]=this._$imagesArray[4];this._$imagesArray[4]=this._$imagesArray[5];this._$imagesArray[5]=e;f++}f=0;while(f<c){this.setImageSrc(6-f);this.setImagePosition(6-f);f++}}else{var f=0;while(f>c){var e=this._$imagesArray[0];this._$imagesArray[0]=this._$imagesArray[6];this._$imagesArray[6]=this._$imagesArray[5];this._$imagesArray[5]=this._$imagesArray[4];this._$imagesArray[4]=this._$imagesArray[3];this._$imagesArray[3]=this._$imagesArray[2];this._$imagesArray[2]=this._$imagesArray[1];this._$imagesArray[1]=e;f--}f=0;while(f>c){this.setImageSrc(-f);this.setImagePosition(-f);f--}}}this._setStripLeft(-this._page*this._imageWidth,d)},_renderShowMoreButton:function(){}}); var PhotosArrowsView=BaseItemsView.extend({className:"arrows_view",_onGetItemsSuccess:function(){this.render();var a=Scrolling.getMyScrollerWrapper(this.$el);Scrolling.onContentChanged(a);BaseItemsView.prototype._onGetItemsSuccess.apply(this)},_reset:function(){this.$el.html(photosTemplates.arrowsViewMarkup());this.$prevArrow=this.$el.find(".prev.button_arrow");this.$nextArrow=this.$el.find(".next.button_arrow");this.$image=this.$el.find(".image");this.$circles=this.$el.find(".circles_container");this.$descr=this.$el.find(".album_description");this.imageIndex=0;var a=this;this.$prevArrow.tap(function(d){d.preventDefault();var c=$(d.target);if(!c.hasClass("disabled")&&!c.parent().hasClass("disabled")){var b=a.model.get("items").length;a.imageIndex=(a.imageIndex-1+b)%b;a.renderElements()}});this.$nextArrow.tap(function(d){d.preventDefault();var c=$(d.target);if(!c.hasClass("disabled")&&!c.parent().hasClass("disabled")){var b=a.model.get("items").length;a.imageIndex=(a.imageIndex+1)%b;a.renderElements()}});this.renderElements()},renderElements:function(){var d=this.model.get("items");if(d.length<2){this.$prevArrow.hide();this.$nextArrow.hide();this.$circles.hide()}else{this.$prevArrow.show();var a=this.model.get("layoutParams")&&this.model.get("layoutParams").loop;if(!a){if(this.imageIndex>0){this.$prevArrow.removeClass("disabled")}else{this.$prevArrow.addClass("disabled")}}this.$nextArrow.show();if(!a){if(this.imageIndex<d.length-1){this.$nextArrow.removeClass("disabled")}else{this.$nextArrow.addClass("disabled")}}var c="";for(var b=0;b<d.length;b++){var f={disabled:(b!==this.imageIndex)};c+=photosTemplates.circleButtonMarkup(f)}this.$circles.show().html(c)}var e=d.at(this.imageIndex);if(e){this.$image.css({"background-image":"url("+e.getLargestImage()+")"})}},_renderItems:function(){var a=this.model.get("album")?this.model.get("album").get("albumDescr"):null;if(a){this.$descr.html(a).show()}else{this.$descr.hide()}this.renderElements()},_renderShowMoreButton:function(){}}); var PhotosLargeImageView=Backbone.View.extend({tagName:"div",className:"fade_element",initialize:function(){this.model.bind("change",this.render,this)},render:function(){var a={title:this.model.get("title"),imageSrc:this.model.getLargestImage()};this.$el.html(photosTemplates.largeImage(a));return this}}); var PhotoUploadView=Backbone.View.extend({className:"photo-upload-view clr_contTypeA_bg clr_contTypeA_brdr",initialize:function(){this.model.bind("change:state",this._onStateChanged,this)},render:function(){var a=this.model.toJSON();a.errorMessage=_T("HtmlTextLiveAlbumUploadingFailed");a.uploadTxt=_T("HtmlTextLiveAlbumUploadingImage");this.$el.html(photosTemplates.photoUploadMarkup(a));this.$failBar=this.$el.find(".fail-bar");this.$failBar.find(".retry-button").tap(this._onRetryTap.hitch(this));this.$failBar.find(".cancel-button").tap(this._onCancelTap.hitch(this));this.$uploading=this.$el.find(".uploading");return this},_onStateChanged:function(){var a=this.model.get("state");switch(a){case PhotoUploadModel.STATE.UPLOADING:this.$failBar.hide();this.$uploading.show();break;case PhotoUploadModel.STATE.FAIL:this.$failBar.show();this.$uploading.hide();break;case PhotoUploadModel.STATE.SUCCESS:this.remove();break}},_onRetryTap:function(a){a.preventDefault();this.model.trigger("onRetry",this.model)},_onCancelTap:function(a){a.preventDefault();var b=Scrolling.getMyScrollerWrapper(this.$el);this.remove();Scrolling.onContentChanged(b);this.model.trigger("onCancel",this.model)}}); var ContactUsModel=Backbone.Model.extend({initialize:function(){var a=this.get("long");if(a){this.set({lng:a})}}}); var contactUsTemplates={};contactUsTemplates.detailsPageTemplate=_.template('<div class="scroll_wrapper"><div class="scroller"><% if (typeof(logoImgUrl) != "undefined" && logoImgUrl) { %><img class="logoImgCenter" src="<%= logoImgUrl %>" /><% } %><div class="info_container clr_contTypeB_bg"><% if (typeof(header) != "undefined" && header) { %><div class="size_title_1 header clr_contTypeB_hdlTxt"><%= header %></div><% } %><% if (typeof(text) != "undefined" && text) { %><div class="size_1 text contact-text clr_contTypeB_txt"><%= text %></div><% } %></div><div class="scroller_bug"></div></div></div>');contactUsTemplates.buttonsPanelTemplate=_.template('<div class="buttons_container <% if (buttonsCount > 5) { %>small_buttons<% } else if (buttonsCount > 4) { %>med_buttons<% } else { %>large_buttons<% } %>"><% if (typeof(phone) != "undefined" && phone) { %><% if (PLATFORM == platformEnum.simulator) { %><a href="javascript:void(0)" class="phone action_button clr_contTypeB_actBtn_bg clr_contTypeB_actBtn_brdr clr_contTypeB_actBtn_hdlTxt" data-role="button"><% } else { %><a href="tel:<%= phone %>" class="call action_button  clr_contTypeB_actBtn_bg clr_contTypeB_actBtn_brdr clr_contTypeB_actBtn_hdlTxt" data-role="button"><% } %><div class="button_icon mask_sprite sprite-phone clr_contTypeB_actBtn_icn"></div></a><% } %><% if (typeof(fax) != "undefined" && fax) { %><% if (PLATFORM == platformEnum.simulator) { %><a href="javascript:void(0)" class="fax action_button clr_contTypeB_actBtn_bg clr_contTypeB_actBtn_brdr clr_contTypeB_actBtn_hdlTxt" data-role="button"><% } else { %><a href="tel:<%= fax %>" class="fax action_button  clr_contTypeB_actBtn_bg clr_contTypeB_actBtn_brdr clr_contTypeB_actBtn_hdlTxt" data-role="button"><% } %><div class="button_icon mask_sprite sprite-fax clr_contTypeB_actBtn_icn"></div></a><% } %><% if (typeof(mail) != "undefined" && mail) { %><% if (PLATFORM == platformEnum.simulator) { %><a href="javascript:void(0)" class="email action_button clr_contTypeB_actBtn_bg clr_contTypeB_actBtn_brdr clr_contTypeB_actBtn_hdlTxt" data-role="button"><% } else { %><a href="mailto:<%= mail %>" class="action_button clr_contTypeB_actBtn_bg clr_contTypeB_actBtn_brdr clr_contTypeB_actBtn_hdlTxt" data-role="button"><% } %><div class="button_icon mask_sprite sprite-email clr_contTypeB_actBtn_icn"></div></a><% } %><% if (typeof(url) != "undefined" && url) { %><a href="javascript:void(0)" class="web-site link action_button clr_contTypeB_actBtn_bg clr_contTypeB_actBtn_brdr clr_contTypeB_actBtn_hdlTxt" data-role="button"><div class="button_icon mask_sprite sprite-link clr_contTypeB_actBtn_icn"></div></a><% } %><% if (typeof(address) != "undefined" && address) { %><a class="action_button map clr_contTypeB_actBtn_bg clr_contTypeB_actBtn_brdr clr_contTypeB_actBtn_hdlTxt" data-role="button"><div class="button_icon mask_sprite sprite-map clr_contTypeB_actBtn_icn"></div></a><% } %><% if ((typeof(header) != "undefined" && header) || (typeof(text) != "undefined" && text) ){ %><a class="action_button info clr_contTypeB_actBtn_bg clr_contTypeB_actBtn_brdr clr_contTypeB_actBtn_hdlTxt" data-role="button"><div class="button_icon mask_sprite sprite-info clr_contTypeB_actBtn_icn"></div></a><% } %></div>');contactUsTemplates.contactUsTemplate=[];contactUsTemplates.contactUsTemplate[0]=_.template('<div class="scroll_wrapper"><div class="scroller"><% if (typeof(logoImgUrl) != "undefined" && logoImgUrl) { %><img class="logoImgCenter" src="<%= logoImgUrl %>" /><% } %><% if ((typeof(header) != "undefined" && header) || (typeof(text) != "undefined" && text) ){ %><div class="header-wrapper clr_contTypeB_headerItem_bg clr_contTypeB_headerItem_brdr"><% if (typeof(header) != "undefined" && header) { %><div class="size_title_3 header clr_contTypeB_hdlTxt"><%= header %></div><% } %><% if (typeof(text) != "undefined" && text) { %><div class="size_1 contact-text clr_contTypeB_txt"><%= text %></div><% } %></div><% } %><% if (typeof(address) != "undefined" && address) { %><a class="map item clr_contTypeA_bg clr_contTypeA_brdr" data-role="button"><div class="icon mask_sprite sprite-map clr_contTypeA_icn" alt="" /><div class="size_title_1 text clr_contTypeA_hdlTxt"><%= address %></div></a><% } %><% if (typeof(phone) != "undefined" && phone) { %><% if (PLATFORM == platformEnum.simulator) { %><a class="phone item clr_contTypeA_bg clr_contTypeA_brdr" href="javascript:void(0)" data-role="button" ><% }else{ %><a class="item clr_contTypeA_bg clr_contTypeA_brdr" href="tel:<%= phone %>" data-role="button" ><% } %><div class="icon mask_sprite sprite-phone clr_contTypeA_icn" alt="" /><div class="size_title_1 text clr_contTypeA_hdlTxt"><%= phone %></div></a><% } %><% if (typeof(fax) != "undefined" && fax) { %><% if (PLATFORM == platformEnum.simulator) { %><a class="fax item clr_contTypeA_bg clr_contTypeA_brdr" href="javascript:void(0)" data-role="button" ><% }else{ %><a class="item clr_contTypeA_bg clr_contTypeA_brdr" href="tel:<%= fax %>" data-role="button" ><% } %><div class="icon mask_sprite sprite-fax clr_contTypeA_icn" alt="" /><div class="size_title_1 text clr_contTypeA_hdlTxt"><%= fax %></div></a><% } %><% if (typeof(mail) != "undefined" && mail) { %><% if (PLATFORM == platformEnum.simulator) { %><a class="email item clr_contTypeA_bg clr_contTypeA_brdr" href="javascript:void(0)" data-role="button" ><% }else{ %><a class="item clr_contTypeA_bg clr_contTypeA_brdr" href="mailto:<%= mail %>" data-role="button" ><% } %><div class="icon mask_sprite sprite-email clr_contTypeA_icn" alt="" /><div class="size_title_1 text clr_contTypeA_hdlTxt"><%= mail %></div></a><% } %><% if (typeof(url) != "undefined" && url ) { %><a class="web-site item clr_contTypeA_bg clr_contTypeA_brdr" href="javascript:void(0)" data-role="button" ><div class="icon mask_sprite sprite-link clr_contTypeA_icn" alt="" /><div class="size_title_1 text clr_contTypeA_hdlTxt"><%= urlTitle %></div></a><% } %><% if (typeof(description) != "undefined" && description) { %><div class="size_1 item description clr_contTypeA_bg clr_contTypeA_brdr clr_contTypeA_hdlTxt" ></div><% } %></div></div>');contactUsTemplates.contactUsTemplate[1]=_.template('<div class="scroll_wrapper clr_contTypeB_bg"><div class="scroller"><% if (typeof(logoImgUrl) != "undefined" && logoImgUrl) { %><img class="logoImgCenter" src="<%= logoImgUrl %>" /><% } %><% if (typeof(imgUrl) != "undefined" && imgUrl) { %><div class="headerImg" style="background-image: url(<%= imgUrl %>)"></div><% } %><% if ((typeof(description) != "undefined" && description)){ %><div class="header-wrapper"><div class="size_1 description clr_contTypeB_hdlTxt"></div></div><% } %><% if (typeof(phone) != "undefined" && phone) { %><div class="call item clr_contTypeB_brdr"><% if (PLATFORM == platformEnum.simulator) { %><a href="javascript:void(0)" class="phone iconWrapper clr_contTypeB_actBtn_bg clr_contTypeB_actBtn_brdr clr_contTypeB_actBtn_hdlTxt" data-role="button"><div class="icon mask_sprite sprite-phone clr_contTypeB_actBtn_icn"></div><%= callStr %></a><% }else{ %><a href="tel:<%= phone %>" class="iconWrapper clr_contTypeB_actBtn_bg clr_contTypeB_actBtn_brdr clr_contTypeB_actBtn_hdlTxt" data-role="button"><div class="icon mask_sprite sprite-phone clr_contTypeB_actBtn_icn"></div><%= callStr %></a><% } %><div class="size_title_1 text clr_contTypeA_hdlTxt"><h3><%= phoneNumberStr %>:</h3><p><%= phone %></p></div></div><% } %><% if (typeof(extraPhones) != "undefined" && extraPhones && extraPhones.length > 0) { %><% _.each(extraPhones, function (extraPhone) { %><div class="call item clr_contTypeB_brdr"><% if (PLATFORM == platformEnum.simulator) { %><a href="javascript:void(0)" class="phone iconWrapper clr_contTypeB_actBtn_bg clr_contTypeB_actBtn_brdr clr_contTypeB_actBtn_hdlTxt" data-role="button"><div class="icon mask_sprite sprite-phone clr_contTypeB_actBtn_icn"></div><%= callStr %></a><% }else{ %><a href="tel:<%= extraPhone.phone %>" class="iconWrapper clr_contTypeB_actBtn_bg clr_contTypeB_actBtn_brdr clr_contTypeB_actBtn_hdlTxt" data-role="button"><div class="icon mask_sprite sprite-phone clr_contTypeB_actBtn_icn"></div><%= callStr %></a><% } %><div class="size_title_1 text clr_contTypeA_hdlTxt"><h3><%= extraPhone.title %></h3><p><%= extraPhone.phone %></p></div></div><% }); %><% } %><% if (typeof(fax) != "undefined" && fax) { %><div class="fax item clr_contTypeB_brdr"><% if (PLATFORM == platformEnum.simulator) { %><a href="javascript:void(0)" class="fax iconWrapper clr_contTypeB_actBtn_bg clr_contTypeB_actBtn_brdr clr_contTypeB_actBtn_hdlTxt" data-role="button"><div class="icon mask_sprite sprite-fax clr_contTypeB_actBtn_icn"></div><%= faxStr %></a><% }else{ %><a href="tel:<%= phone %>" class="iconWrapper clr_contTypeB_actBtn_bg clr_contTypeB_actBtn_brdr clr_contTypeB_actBtn_hdlTxt" data-role="button"><div class="icon mask_sprite sprite-fax clr_contTypeB_actBtn_icn"></div><%= faxStr %></a><% } %><div class="size_title_1 text clr_contTypeA_hdlTxt"><h3><%= faxNumberStr %>:</h3><p><%= fax %></p></div></div><% } %><% if (typeof(address) != "undefined" && address) { %><div class="item clr_contTypeB_brdr"><a class="map iconWrapper clr_contTypeB_actBtn_bg clr_contTypeB_actBtn_brdr clr_contTypeB_actBtn_hdlTxt" data-role="button"><div class="icon mask_sprite sprite-map clr_contTypeB_actBtn_icn"></div><%= mapStr %></a><div class="size_title_1 text clr_contTypeA_hdlTxt"><h3><%= addressStr %>:</h3><p><%= address %></p></div></div><% } %><% if (typeof(mail) != "undefined" && mail) { %><div class="email item clr_contTypeB_brdr"><% if (PLATFORM == platformEnum.simulator) { %><a href="javascript:void(0)" class="email iconWrapper clr_contTypeB_actBtn_bg clr_contTypeB_actBtn_brdr clr_contTypeB_actBtn_hdlTxt" data-role="button"><div class="icon mask_sprite sprite-email clr_contTypeB_actBtn_icn"></div><%= emailStr %></a><% } else { %><a href="mailto:<%= mail %>" class="iconWrapper clr_contTypeB_actBtn_bg clr_contTypeB_actBtn_brdr clr_contTypeB_actBtn_hdlTxt" data-role="button"><div class="icon mask_sprite sprite-email clr_contTypeB_actBtn_icn"></div><%= emailStr %></a><% } %><div class="size_title_1 text clr_contTypeA_hdlTxt"><h3><%= contactUsStr %>:</h3><p><%= mail %></p></div></div><% } %><% if (typeof(url) != "undefined" && url) { %><div class="link item clr_contTypeB_brdr"><a href="javascript:void(0)" class="web-site iconWrapper clr_contTypeB_actBtn_bg clr_contTypeB_actBtn_brdr clr_contTypeB_actBtn_hdlTxt" data-role="button"><div class="icon mask_sprite sprite-link clr_contTypeB_actBtn_icn"></div><%= linkStr %></a><div class="size_title_1 text clr_contTypeA_hdlTxt"><h3><%= webSiteStr %>:</h3><p><%= urlTitle %></p></div></div><% } %></div></div>');contactUsTemplates.contactUsTemplate[2]=_.template('<div class="scroll_wrapper clr_contTypeB_bg"><div class="scroller"><div class="sidebar-wrapper "><% if ((typeof(imgUrl) != "undefined" && imgUrl) || (typeof(logoImgUrl) != "undefined" && logoImgUrl)) { %><div class="sidebarImg"><% if(typeof(logoImgUrl) != "undefined" && logoImgUrl){ %><div class="logoImgUrl" style="background-image: url(<%= logoImgUrl %>)"></div><% } %><% if(typeof(imgUrl) != "undefined" && imgUrl){ %><div style="background-image: url(<%= imgUrl %>)"></div><% } %></div><% } %><% if (typeof(phone) != "undefined" && phone) { %><% if (PLATFORM == platformEnum.simulator) { %><a href="javascript:void(0)" class="phone item clr_contTypeB_actBtn_bg clr_contTypeB_actBtn_brdr clr_contTypeB_actBtn_hdlTxt" data-role="button"><% } else { %><a href="tel:<%= phone %>" class="call item clr_contTypeB_actBtn_bg clr_contTypeB_actBtn_brdr clr_contTypeB_actBtn_hdlTxt" data-role="button"><% } %><div class="icon mask_sprite sprite-phone clr_contTypeB_actBtn_icn"></div><span class="size_title_1"><%= callNowStr %></span></a><% } %><% if (typeof(fax) != "undefined" && fax) { %><% if (PLATFORM == platformEnum.simulator) { %><a href="javascript:void(0)" class="fax item clr_contTypeB_actBtn_bg clr_contTypeB_actBtn_brdr clr_contTypeB_actBtn_hdlTxt" data-role="button"><% } else { %><a href="tel:<%= fax %>" class="fax item clr_contTypeB_actBtn_bg clr_contTypeB_actBtn_brdr clr_contTypeB_actBtn_hdlTxt" data-role="button"><% } %><div class="icon mask_sprite sprite-fax clr_contTypeB_actBtn_icn"></div><span class="size_title_1"><%= faxStr %></span></a><% } %><% if (typeof(address) != "undefined" && address) { %><a class="item map clr_contTypeB_actBtn_bg clr_contTypeB_actBtn_brdr clr_contTypeB_actBtn_hdlTxt" data-role="button"><div class="icon mask_sprite sprite-map clr_contTypeB_actBtn_icn"></div><span class="size_title_1"><%= mapStr %></span></a><% } %><% if (typeof(mail) != "undefined" && mail) { %><% if (PLATFORM == platformEnum.simulator) { %><a href="javascript:void(0)" data-role="button" class="email item clr_contTypeB_actBtn_bg clr_contTypeB_actBtn_brdr clr_contTypeB_actBtn_hdlTxt"><% } else { %><a href="mailto:<%= mail %>" data-role="button" class="email item clr_contTypeB_actBtn_bg clr_contTypeB_actBtn_brdr clr_contTypeB_actBtn_hdlTxt"><% } %><div class="icon mask_sprite sprite-email clr_contTypeB_actBtn_icn"></div><span class="size_title_1"><%= emailStr %></span></a><% } %><% if (typeof(url) != "undefined" && url) { %><a href="javascript:void(0)" class="web-site link item clr_contTypeB_actBtn_bg clr_contTypeB_actBtn_brdr clr_contTypeB_actBtn_hdlTxt" data-role="button"><div class="icon mask_sprite sprite-link clr_contTypeB_actBtn_icn"></div><span class="size_title_1"><%= linkStr %></span></a><% } %></div><% if ((typeof(header) != "undefined" && header) || (typeof(text) != "undefined" && text) || (typeof(description) != "undefined" && description) ){ %><div class="header-wrapper"><% if (typeof(header) != "undefined" && header) { %><div class="size_title_3 header clr_contTypeB_hdlTxt"><%= header %></div><% } %><% if (typeof(text) != "undefined" && text) { %><div class="size_1 text contact-text clr_contTypeB_txt"><%= text %></div><% } %><% if (typeof(description) != "undefined" && description) { %><div class="size_1 description contact-text clr_contTypeB_txt"></div><% } %></div><% } %><div class="clearfix"></div></div></div>');contactUsTemplates.contactUsTemplate[3]=_.template('<div class="sliced_image"<% if (typeof(imgUrl) != "undefined" && imgUrl) { %> style="background-image: url(<%= imgUrl %>)"<% } %>><div class="scroll_wrapper clr_contTypeB_fullPage2_bg"><div class="scroller"><% if (typeof(logoImgUrl) != "undefined" && logoImgUrl) { %><img class="logoImgCenter" src="<%= logoImgUrl %>" /><% } %><%= buttonsPanel %><% if (typeof(description) != "undefined" && description) { %><div class="size_1 description contact-text clr_contTypeB_txt"></div><% } %></div></div></div>');contactUsTemplates.contactUsTemplate[4]=_.template('<div class="scroll_wrapper clr_contTypeB_bg sliced_image"<% if (typeof(imgUrl) != "undefined" && imgUrl) { %> style="background-image: url(<%= imgUrl %>)"<% } %>><div class="scroller"><div class="background_Img sliced_image clr_contTypeB_bg"><% if (typeof(description) != "undefined" && description) { %><div class="size_1 description contact-text clr_contTypeB_txt"></div><% } %><%= buttonsPanel %></div><% if (typeof(logoImgUrl) != "undefined" && logoImgUrl) { %><img class="logoImgCenter" src="<%= logoImgUrl %>" /><% } %></div></div>');contactUsTemplates.contactUsTemplate[5]=_.template('<div class="scroll_wrapper clr_contTypeB_fullPage2_bg"><div class="scroller"><% if (typeof(logoImgUrl) != "undefined" && logoImgUrl) { %><img class="logoImgCenter" src="<%= logoImgUrl %>" /><% } %><div class="box"><div class="description-wrapper"><% if (typeof(description) != "undefined" && description) { %><div class="size_1 description contact-text clr_contTypeB_txt"></div><% } %></div><div class="image-wrapper"><% if (typeof(imgUrl) != "undefined" && imgUrl) { %><img class="imgUrl" src="<%= imgUrl %>" /><% } %></div><div class="clearfix"></div></div><%= buttonsPanel %><div class="scroller_bug"></div></div></div>'); var ContactUsView=Backbone.View.extend({initialize:function(){this.$el.attr({"data-role":"page","data-buttons":"navigation"});var a=this.model.get("layoutId")||0;if(a>contactUsTemplates.contactUsTemplate.length-1||a<0){a=0}this.model.set({layoutId:a});this.$el.addClass("layout-"+a)},render:function(){var a=this.model.get("layoutId");var d=contactUsTemplates.contactUsTemplate[a];var c=this.model.toJSON();c.urlTitle=c.urlTitle||c.url;c.webSiteStr=_T("HtmlTextContactUsWebSiteStr");c.contactUsStr=_T("HtmlTextContactUsContactUsStr");c.addressStr=_T("HtmlTextContactUsAddressStr");c.phoneNumberStr=_T("HtmlTextContactUsPhoneNumberStr");c.faxNumberStr=_T("HtmlTextContactUsFaxNumberStr");c.callNowStr=_T("HtmlTextContactUsCallNowStr");c.callStr=_T("HtmlTextContactUsCallStr");c.faxStr=_T("HtmlTextContactUsFaxStr");c.emailStr=_T("HtmlTextContactUsEmailStr");c.mapStr=_T("HtmlTextContactUsMapStr");c.linkStr=_T("HtmlTextContactUsLinkStr");c.header=Utils.String.sanitizeText(c.header,true);c.text=Utils.String.sanitizeText(c.text,true);c.address=Utils.String.sanitizeText(c.address,true);c.phone=Utils.String.sanitizeText(c.phone,true);c.fax=Utils.String.sanitizeText(c.fax,true);c.mail=Utils.String.sanitizeText(c.mail,true);c.urlTitle=Utils.String.sanitizeText(c.urlTitle,true);c.buttonsCount=0;if(c.phone){c.buttonsCount++}if(c.fax){c.buttonsCount++}if(c.mail){c.buttonsCount++}if(c.address){c.buttonsCount++}if(c.url){c.buttonsCount++}if(c.header||c.text){c.buttonsCount++}c.buttonsPanel=contactUsTemplates.buttonsPanelTemplate(c);this.$el.html(d(c));var e=this.$el.find(".scroll_wrapper");this.$el.find("IMG").load(function(){Scrolling.onContentChanged(e)}).error(function(){$(this).remove()});var b=new HtmlContainerControl();b.renderHtml(this.$el.find("div.description"),c.description,{changeColors:false});Scrolling.init(e);if(PLATFORM==platformEnum.simulator){this.$el.find(".phone").tap(this._showNotSupportedMsg);this.$el.find(".fax").tap(this._showNotSupportedMsg);this.$el.find(".email").tap(this._showNotSupportedMsg)}this.$el.find(".web-site").tap(this._onWebSiteTap.hitch(this));this.$el.find(".map").tap(this._onMapClicked.hitch(this));this.$el.find(".info").tap(this._onInfoClicked.hitch(this));return this},_onMapClicked:function(a){a.preventDefault();this.trigger("showOnMapClicked",this.model)},_onInfoClicked:function(a){a.preventDefault();this.trigger("infoClicked",this.model)},_showNotSupportedMsg:function(a){a.preventDefault();cqm.showToastMessage("This action is not supported in simulator mode.")},_onWebSiteTap:function(b){b.preventDefault();var a=this.model.get("url");conduitApi.app.openLink(null,null,{url:a})},addTabsView:function(a){this.$el.find(".scroller").prepend(a)}}); var ContactUsInfoView=Backbone.View.extend({className:"info_page clr_contTypeB_fullPage2_bg",initialize:function(){this.$el.attr({"data-role":"page","data-buttons":"back"})},render:function(){var a=this.model.toJSON();this.$el.html(contactUsTemplates.detailsPageTemplate(a));var b=this.$el.find(".scroll_wrapper");this.$el.find("IMG").load(function(){Scrolling.onContentChanged(b)}).error(function(){$(this).remove()});Scrolling.init(b);return this}}); var ContactUsTemplateView=TemplateView.extend({render:function(a){var e=this.model.get("meta");var d=e[this.options.tabsName][a];if(d&&typeof(d.layoutId)==="undefined"){d.layoutId=e.pageLayout||0}var c=new ContactUsModel(d);this._changePageParams.homePageId="home_"+Utils.Helpers.generateGUID();var b=new ContactUsView({model:c,id:this._changePageParams.homePageId});b.bind("showOnMapClicked",this._onMapClicked,this);b.bind("infoClicked",this._onInfoClicked,this);this.$el.append(b.render().el);this._homePagesViews[a]=b;TemplateView.prototype.render.apply(this,[a]);return this},_onInfoClicked:function(a){if(this._contactUsInfoView){this._contactUsInfoView.remove()}this._contactUsInfoView=new ContactUsInfoView({model:a,id:"details_"+Utils.Helpers.generateGUID()});this.$el.append(this._contactUsInfoView.render().el);$.mobile.changePage("#"+this._contactUsInfoView.id,{transition:"slide",reverse:IS_RTL})},_onMapClicked:function(c){var d=c.get("lat");var b=c.get("long");if(d&&b){var a={location:{lat:d,lng:b},header:c.get("header"),address:""};var c=new Backbone.Model({markers:[a],googleOptions:{zoom:14}});MapManager.show_on_map(this.$el,c)}}}); var ExternalPageModel=Backbone.Model.extend({defaults:{url:""}}); var ExternalPageTemplateView=TemplateView.extend({render:function(b){var d=this.model.get("meta");var a=new ExternalPageModel(d);var c=new ExternalPageView({model:a,id:"home_"+Utils.Helpers.generateGUID()});this.$el.append(c.render().el);if(window.AppManager&&AppManager.addSlave){AppManager.addSlave(c.el,this.model.get("id"),function(){})}this._homePagesViews[b]=c;return this}}); var ExternalPageView=Backbone.View.extend({tagName:"iframe",className:"external_page",initialize:function(){this.id="external_"+Utils.Helpers.generateGUID();this.$el.attr({id:this.id,"data-role":"page","data-buttons":"navigation",frameborder:"0",scrolling:"no",allowtransparency:"true"})},render:function(){this.$el.attr("src",this.model.get("url"));return this},getChangePageParams:function(){var a={pageId:this.id,changeHash:true};return a}}); var CommentModel=Backbone.Model.extend({defaults:{id:null,likesCount:0,fromName:"",fromPicture:"",createdTime:0,message:"",wasLike:false},like:function(){var c=this;var a=function(e){c.trigger("likeCommentSuccess",c);if(e===true){c.set({likesCount:c.get("likesCount")+1,wasLike:true})}};var b=function(e){c.trigger("likeCommentFail",c)};var d=this.get("id");FacebookLib.likeItem(d,a,b)},unlike:function(){var c=this;var a=function(e){c.trigger("unlikeCommentSuccess",c);if(e===true){c.set({likesCount:c.get("likesCount")-1,wasLike:false})}};var b=function(e){c.trigger("unlikeCommentFail",c)};var d=this.get("id");FacebookLib.unlikeItem(d,a,b)}}); var PostModel=ItemsModel.extend({defaults:{id:null,picture:"",videoUrl:"",likesCount:0,likesCountStatus:FacebookCountStatus.ok,likesCountText:"0",commentsCount:0,commentsCountStatus:FacebookCountStatus.ok,commentsCountText:"0",fromName:"",fromPicture:"",createdTime:0,message:"",name:"",icon:"",type:"",wasLike:false,likeable:false,commentable:false,selected:false},initialize:function(){ItemsModel.prototype.initialize.apply(this);this._updateCounters();this.set({shareInfo:this.getShareInfo(),})},getPhotosArray:function(){var a=null;var b=this.get("largeImage");if(b){a=[{title:this.get("name"),photoTime:this.get("createdTime")/1000,largeImage:b,photoModel:null}]}return a},like:function(){var a=function(d){this.trigger("likeSuccess",this);if(d){if(this.get("likesCountStatus")===FacebookCountStatus.ok){var e=this.get("likesCount")+1;this.set({likesCount:e});this.set({likesCountText:e+""})}this.set({wasLike:true})}}.hitch(this);var b=function(d){console.log(d);this.trigger("likeFail",this)}.hitch(this);var c=this.get("id");if(DEVICE===deviceTypeEnum.iphone&&PLATFORM===platformEnum.nativeApp){navigator.appManager.fb_addLike(a,b,c)}else{FacebookLib.likeItem(c,a,b)}},unlike:function(){var a=function(d){this.trigger("unlikeSuccess",this);if(d){if(this.get("likesCountStatus")===FacebookCountStatus.ok){var e=this.get("likesCount")-1;this.set({likesCount:e});this.set({likesCountText:e+""})}this.set({wasLike:false})}}.hitch(this);var b=function(d){this.trigger("unlikeSuccess",this)}.hitch(this);var c=this.get("id");if(DEVICE===deviceTypeEnum.iphone&&PLATFORM===platformEnum.nativeApp){navigator.appManager.fb_removeLike(a,b,c)}else{FacebookLib.unlikeItem(c,a,b)}},createItemsCollection:function(){var a=new CommentsCollection();a.commentsCount=this.get("commentsCount");a.id=this.get("id");a.bind("getItemsSuccess",this._onCommentCollectionParsed.hitch(this));return a},generateVideoModel:function(){var e=true;var b=this.get("picture");var d=this.get("videoUrl");var a=this.get("videoUrl");var c=new VideoPlayerModel({isYoutube:e,picture:b,videoUrl:d,rtspUrl:a});return c},getShareInfo:function(){var b={url:this.get("link")};if(!b.url||b.url===""){b.url="http://www.facebook.com/"+this.get("id")}var a=this.get("fromName");var c=this.get("message");a=Utils.String.sanitizeText(a,true);c=Utils.String.sanitizeText(c,true);b.title=a.replace("<br />",": ");b.shortDesc=c.replace(/<br \/>/g,"\n");b.emailTitle=_T("SFacebookShareEmailSubject",{user:this.get("fromName")});b.emailDesc=a+"\n\n"+b.fbDesc;b.twitterFrom=_T("SFacebookShareTwitterFrom",{user:this.get("fromName")});b.userImageUrl=this.get("fromPicture");return b},addComment:function(e){var c=this;var a=function(f){c.trigger("addCommentSuccess",c);var g=c.get("items");g.addComment(f.id);g.EOF=true;g.trigger("eof");c.set({commentsCount:c.get("commentsCount")+1})};var b=function(f){c.trigger("addCommentFail",c)};var d=this.get("id");if(DEVICE===deviceTypeEnum.iphone&&PLATFORM===platformEnum.nativeApp){navigator.appManager.fb_addComment(a,b,d)}else{FacebookLib.commentItem(d,e,a,b)}},_getCountInfo:function(d){if(d&&typeof d.count!=="undefined"){return{count:d.count,status:FacebookCountStatus.ok,text:d.count+""}}var b=d&&d.data;if(_.isArray(b)){var a=b.length,c=a>=25?"25+":a;return{count:a,status:FacebookCountStatus.deprecatedCount,text:c}}return{count:0,status:FacebookCountStatus.error}},_updateCounters:function(){_.each(["likes","comments"],function(b){var a=this._getCountInfo(this.get(b));this.set(b+"Count",a.count);this.set(b+"CountStatus",a.status);this.set(b+"CountText",a.text)}.hitch(this));this.set("commentable",this.get("commentsCountStatus")!==FacebookCountStatus.error);this.set("likable",this.get("likesCountStatus")!==FacebookCountStatus.error)},_onCommentCollectionParsed:function(b,a){if(b&&_.isFinite(b.commentsCount)){this.set("commentsCount",b.commentsCount);this.set("commentsCountStatus",FacebookCountStatus.ok);this.set("commentsCountText",b.commentsCount+"")}},fetchLikesSummary:function(){FacebookLib.getItem(this.get("id")+"/likes",function(a){var b=a&&a.summary&&_.isFinite(a.summary.total_count)&&a.summary.total_count;if(b){this.set("likesCount",b);this.set("likesCountStatus",FacebookCountStatus.ok);this.set("likesCountText",b+"")}}.hitch(this),null,{summary:true})}}); var FanPageModel=ItemsModel.extend({defaults:{items:null,loadingType:loadingTypeEnum.NORMAL,isLoading:false,eof:false,hasData:false,user:0,link:"",category:"",picture:"",likesCount:0,title:"",posts:null},getPageData:function(b){var a=this.get("user");if(a){FacebookLib.getPageData(a,this._cbGetPageDataSuccess.hitch(this),this._cbGetPageDataFail.hitch(this),{},b)}},_cbGetPageDataSuccess:function(a,b){this.set({pageId:a.id,hasData:true,link:a.link,title:a.name,picture:FacebookLib.getPictureFromId(a.id),likesCount:a.likes||0,category:a.category||""});this.trigger("getPageDataSuccess",this,b)},_cbGetPageDataFail:function(a){this.trigger("getPageDataFail",this)},createItemsCollection:function(){return new PostsCollection(null,{user:this.get("user"),postsSource:this.get("postsSource"),layoutId:this.get("layoutId")})}}); var CommentsCollection=ItemsCollection.extend({model:CommentModel,COMMENTS_TAKE_COUNT:15,id:null,parse:function(a){var c={};if(a&&a.summary&&_.isFinite(a.summary.total_count)){this.commentsCount=a.summary.total_count}var d=[];for(var b=0;b<a.data.length;b++){d[b]=this._createCommentModel(a.data[b])}c.models=d;c.metaData={commentsCount:this.commentsCount};return c},getNextItems:function(d,c){var e=this.getExecuteOptions(d);this._alreadyGotData=false;var b=function(){this.trigger("loadingStateChanged",false);this.trigger("getItemsFail",e.executeType,false,c)};var a=function(f){this.trigger("loadingStateChanged",false);this.successCallback(f,e.executeType,c)};if(e.executeType!==executeTypeEnum.HIT_AND_RUN_SILENT){this.resetParams()}this.trigger("loadingStateChanged",true);this.trigger("getNextItems");FacebookLib.getComments(this.id,a.hitch(this),b.hitch(this),this.getParams())},getParams:function(){var a={};if(this._next){a=Utils.Url.getQueryObject(this._next)}else{a.limit=this.COMMENTS_TAKE_COUNT}a.take=a.limit;return a},_createCommentModel:function(a){return new CommentModel({id:a.id,wasLike:a.user_likes,likesCount:a.likes||0,fromName:a.from.name,fromPicture:"http://graph.facebook.com/"+a.from.id+"/picture",createdTime:FacebookLib.facebookToUnixTime(a.created_time),message:a.message})},isEOF:function(a,b){if(a.paging){if(a.paging.next&&b.models.length<this.commentsCount){return false}else{return true}}else{if(b.models.length<this.getParams().take){return true}}return false},_cbGetCommentSuccess:function(a){this.trigger("getCommentSuccess",this);var b=this._createCommentModel(a);this.add(b)},_cbGetCommentFail:function(a){this.trigger("getCommentFail",this)},addComment:function(a){FacebookLib.getItem(a,this._cbGetCommentSuccess.hitch(this),this._cbGetCommentFail.hitch(this))}}); var PostsCollection=ItemsCollection.extend({model:PostModel,POSTS_TAKE_COUNT:10,initialize:function(b,a){this.postsSource=a.postsSource;this.user=a.user;this.layoutId=a.layoutId;ItemsCollection.prototype.initialize.apply(this)},parse:function(d){var a={};var m=[];for(var f=0;f<d.data.length;f++){var b=d.data[f];var k=null;if(b.object_id){k="http://graph.facebook.com/"+b.object_id+"/picture"}var h=!d.authenticatedUserId;var g=!d.authenticatedUserId;if(d.authenticatedUserId&&b.actions){for(var e=0;e<b.actions.length;e++){var c=b.actions[e].name;if(c==="Like"){h=true}else{if(c==="Comment"){g=true}}}}var l=new PostModel({id:b.id,picture:b.picture,videoUrl:b.source,likes:b.likes,comments:b.comments,fromName:b.from.name,fromPicture:FacebookLib.getPictureFromId(b.from.id),createdTime:FacebookLib.facebookToUnixTime(b.created_time),message:b.message||b.story,name:b.name,link:b.link,icon:b.icon,type:b.type,wasLike:b.wasLike,largeImage:k,likeable:h,commentable:g,layoutId:this.layoutId});m.push(l)}a.models=m;return a},getNextItems:function(d,c){var e=this.getExecuteOptions(d);this._alreadyGotData=false;var b=function(){this.trigger("loadingStateChanged",false);this.trigger("getItemsFail",e.executeType,false,c)};var a=function(f){this.trigger("loadingStateChanged",false);this.successCallback(f,d,c)}.hitch(this);this.trigger("loadingStateChanged",true);this.trigger("getNextItems");FacebookLib.getPosts(this.user,a.hitch(this),b.hitch(this),this.getParams(e.executeType),this.postsSource)},getParams:function(a){var b={};if(this._next&&a!==executeTypeEnum.FORCE_NETWORK){b=Utils.Url.getQueryObject(this._next)}else{b.limit=this.POSTS_TAKE_COUNT}return b},}); var FacebookTemplateView=TemplateView.extend({render:function(e){var f=this.model.get("meta");if(f[this.options.tabsName][e]){var d=f[this.options.tabsName][e].user;var c=f[this.options.tabsName][e].postsSource}else{var d=null;var c=null}var a=new FanPageModel({user:d,postsSource:c,layoutId:f.pageLayout});a.getPageData();a.getItems(executeTypeEnum.HIT_AND_RUN);var b=new FanPageView({model:a,id:"home_"+Utils.Helpers.generateGUID()});a.bind("itemSelected",this.onItemSelected,this);this.$el.append(b.render().el);this._homePagesViews[e]=b;TemplateView.prototype.render.apply(this,[e]);return this},onItemSelected:function(a,b){if(this.detailsPage){this.detailsPage.remove();this.detailsPage=null}this.detailsPage=new FullPostView({model:a});this.$el.append(this.detailsPage.render().el);$.mobile.changePage("#"+this.detailsPage.id,{transition:"slide",reverse:IS_RTL})}}); var FacebookWideTemplateView=TemplateView.extend({initialize:function(b,a){TemplateView.prototype.initialize.apply(this);this.dividedScreenView=[];this.detailsPage=[]},render:function(e){var f=this.model.get("meta");if(f[this.options.tabsName][e]){var d=f[this.options.tabsName][e].user;var c=f[this.options.tabsName][e].postsSource}else{var d=null;var c=null}var b=new FanPageModel({user:d,postsSource:c});b.getPageData();b.getItems(executeTypeEnum.HIT_AND_RUN);b.set({layoutId:f.pageLayout});this.listView=new FanPageView({model:b,id:"home_"+Utils.Helpers.generateGUID()});this.dividedScreenView[e]=new DividedScreenView({id:"divided_screen_"+Utils.Helpers.generateGUID()});var a=function(g,h){this.onItemSelected(g,h,e)};b.bind("itemSelected",a,this);b.get("items").onItemsReady(this.onItemsReady.hitch(this));this.dividedScreenView[e].setView1(this.listView.render());this.$el.append(this.dividedScreenView[e].render().addRefreshButton(true).el);this._homePagesViews[e]=this.dividedScreenView[e];TemplateView.prototype.render.apply(this,[e]);return this},onItemSelected:function(b,c,a){if(!c){if(this.detailsPage[a]){this.detailsPage[a].remove();this.detailsPage[a]=null}this.detailsPage[a]=new FullPostView({model:b});this.dividedScreenView[a].setView2(this.detailsPage[a].render())}},onItemsReady:function(b){if(b.length>0){var a=b.at(0);a.trigger("itemClicked",a)}}}); var CommentView=Backbone.View.extend({tagName:"li",className:"comment_item box_classic_padding clr_contTypeB_bg clr_contTypeB_brdr",initialize:function(){this.model.bind("change:wasLike",this._renderLikeUnlike,this)},render:function(){var a=this.model.toJSON();a.timeAgo=Utils.TimeDate.timeAsText(a.createdTime/1000);this.$el.html(faceBookTemplates.comment(a));this.$likeButtton=this.$el.find(".like");this.$likeButtton.tap(this._onLikeTap.hitch(this));this._renderLikeUnlike();return this},_onLikeTap:function(){if(this.model.get("wasLike")){this.model.unlike()}else{this.model.like()}},_renderLikeUnlike:function(){if(this.model.get("wasLike")){this.$likeButtton.html(_T("HtmlTextFacebookUnikeComment"))}else{this.$likeButtton.html(_T("HtmlTextFacebookLikeComment"))}}}); var FullPostView=Backbone.View.extend({className:"facebook_page t3d",initialize:function(){this.id="details_"+Utils.Helpers.generateGUID();this.$el.attr({"data-role":"page","data-buttons":"back refresh",id:this.id});this.$el.bind("refresh",this.handleRefreshClick.hitch(this))},handleRefreshClick:function(){this.postCommentsListView.handleRefreshClick()},render:function(){this.$el.html(faceBookTemplates.detailedPost());var c=this.$el.find(".scroller");var b=new DetailedPostView({model:this.model});c.append(b.render().el);var a=new PostLikesView({model:this.model});c.append(a.render().el);this.postCommentsListView=new PostCommentsListView({model:this.model,failStr:_T("ToastMessageFacebookFailedGetComments")});c.append(this.postCommentsListView.render().el);var d=this.$el.find(".scroll_wrapper");Scrolling.init(d);if(this.model.get("commentsCount")>0){this.model.get("items").reset();this.model.getItems(executeTypeEnum.HIT_AND_RUN)}else{this.model.get("items").EOF=true;this.model.get("items").trigger("eof")}this.model.fetchLikesSummary();return this}}); var ShortPostView=Backbone.View.extend({tagName:"li",events:{tap:"itemClicked"},initialize:function(){this.$el.attr("data-role","button").addClass("t3d");this.model.bind("change:commentsCountText",this.renderCommentsCount,this);this.model.bind("change:likesCountText",this.renderLikesCount,this);this.model.bind("change:wasLike",this._renderLikeUnlike,this);this.model.bind("change:selected",this.onSelectedChange,this)},render:function(){if(this.model.get("layoutId")==1){var o="clr_contTypeA_lnkTxt";var l="clr_contTypeA_hdlTxt";var a="clr_contTypeA_txt";var e="clr_contTypeA_subTxt";var b="clr_contTypeA_subIcn";var k='<div class="slide_arrow_image mask_sprite sprite-arrow clr_contTypeA_icn"></div>';var m="clr_contTypeA_bg clr_contTypeA_brdr feed_classic_item"}else{var o="clr_contTypeB_lnkTxt";var l="clr_contTypeB_hdlTxt";var a="clr_contTypeB_txt";var e="clr_contTypeB_subTxt";var b="clr_contTypeB_subIcn";var k="";var m="clr_contTypeB_bubbleItem_bg clr_contTypeB_bubbleItem_brdr feed_bubble_item"}if(LAYOUT===layoutFormat.wide){a+=" max_3_lines"}var f=Utils.TimeDate.timeAsText(this.model.get("createdTime")/1000);var c=this.model.get("type");var i=this.model.get("picture");var s="";if(i){if(c==="video"){s='<div class="short_video_container"></div>'}else{s='<img class="post_list_img photo_img" src="'+i+'"></img>'}}var g=this.model.get("link");var t=this.model.get("name");var r="";if(t&&g){r='<div class="size_1 post_link '+o+'">'+t+"</div>"}var p=_T("HtmlTextFacebookAddCommentButton");var h=this.model.get("likeable");var d=this.model.get("commentable");var n="";if(h&&d){n='<div class="post_social_bubble clr_facebook_bubble_bg clr_facebook_bubble_brdr clr_facebook_txt"><div class="fb_triangle_border clr_facebook_bubble_triangleBrdr"></div><div class="fb_triangle clr_facebook_bubble_triangle"></div><div data-role="button" class="fb_post_button like clr_facebook_btn_bg clr_facebook_btn_brdr clr_facebook_btn_hdlTxt"></div><span class="dot">&#8226;</span><div data-role="button" class="fb_post_button add_comment clr_facebook_btn_bg clr_facebook_btn_brdr clr_facebook_btn_hdlTxt">'+p+'</div><span class="right comments_count count_text"></span><div class="right comment-icon sprite sprite-FB_comment"></div><span class="right likes_count count_text"></span><div class="right like-icon sprite sprite-FB_like"></div></div>'}var j='<img class="post_from_img user_icon_image_size" src="'+this.model.get("fromPicture")+'"></img><div class="post_data_container"><div class="size_title_1 post_from_name '+l+'">'+this.model.get("fromName")+'</div><p class="size_1 post_list_message '+a+'">'+Utils.String.trailString(this.model.get("message"),300)+"</p>"+s+r+'<span class="time_ago size_0 post_list_time_ago '+e+'">'+f+'</span><span class="post_list_facebook_icon mask_sprite sprite-facebook-icon '+b+'"></span>'+n+"</div>"+k;this.$el.addClass("post_list_item item_padding "+m).html(j);var q=this.$el.find(".post_list_img");q.load(function(){this.$myScrollWrapper=this.$myScrollWrapper||Scrolling.getMyScrollerWrapper(this.$el);Scrolling.onContentChanged(this.$myScrollWrapper)}.hitch(this));q.error(function(){$(this).remove()});this.$commentsCount=this.$el.find(".comments_count");this.renderCommentsCount();this.$likesCount=this.$el.find(".likes_count");this.renderLikesCount();this.$commentButtton=this.$el.find(".add_comment");this.$commentButtton.tap(this._onAddCommentTap.hitch(this));this.$likeButtton=this.$el.find(".like");this.$likeButtton.tap(this._onLikeTap.hitch(this));this._renderLikeUnlike();if(c==="video"){this._renderVideoPlayer(this.$el.find(".short_video_container"))}return this},_onLikeTap:function(a){a.preventDefault();if(PLATFORM===platformEnum.simulator){ShareControlHelper.showSimulatorMessage();return false}if(this.model.get("wasLike")){this.model.unlike()}else{this.model.like()}return false},_renderLikeUnlike:function(){if(this.model.get("wasLike")){this.$likeButtton.html(_T("HtmlTextFacebookUnikePostButton"))}else{this.$likeButtton.html(_T("HtmlTextFacebookLikePostButton"))}},_onAddCommentTap:function(a){a.preventDefault();if(PLATFORM===platformEnum.simulator){ShareControlHelper.showSimulatorMessage();return false}CommentDialog.execute(function(b){this.model.addComment(b)}.hitch(this));return false},renderCommentsCount:function(){this._renderCount(this.$commentsCount,"commentsCountText","commentsCountStatus")},renderLikesCount:function(){this._renderCount(this.$likesCount,"likesCountText","likesCountStatus")},itemClicked:function(d){d.preventDefault();var a=$(d.target);if(a.hasClass("post_link")&&false){var b=this.model.get("link");if(conduitApi.app.isSupported()){conduitApi.app.openLink(null,null,{url:b,title:b})}}else{if(a.hasClass("post_list_img")&&this.model.getPhotosArray()){var c=this.model.getPhotosArray();if(c){new PhotoGalleryManager().pressedImage(c,0)}}else{if(a.parents().hasClass("short_video_container")||(a.hasClass("short_video_container"))){return}else{this.model.trigger("itemClicked",this.model)}}}},onSelectedChange:function(){if(LAYOUT===layoutFormat.wide){if(this.model.get("selected")){this.$el.addClass("selected")}else{this.$el.removeClass("selected")}}},_renderVideoPlayer:function(c){var b=this.model.generateVideoModel();var a=new VideoPlayerView({model:b});c.html(a.render().el)},_renderCount:function(c,b,a){var d=this.model.get(b),e=this.model.get(a);if(e===FacebookCountStatus.error){return}countText=localization.formatNumber(d);c.html(countText)},}); var PostsListView=ItemsView.extend({createItemView:function(a){var b=new ShortPostView({model:a});return b},getRootView:function(){return this.$el}}); var FanPageHeaderView=Backbone.View.extend({className:"fan_page_header clr_contTypeB_headerItem_bg clr_contTypeB_headerItem_brdr invisible t3d",initialize:function(){this.model.bind("getPageDataSuccess",this.render,this);this.model.bind("change:likesCount",this._renderLikesCount,this)},render:function(){var a=this.model.toJSON();a.likesCountStr=_T("HtmlTextFacebookPageLikesCount");this.$el.html(faceBookTemplates.fanPageHeader(a));if(this.model.get("hasData")){this.$el.removeClass("invisible")}this._renderLikesCount();this.renderLikeButton();return this},_renderLikesCount:function(){this.$el.find(".fan_page_likes_count").html(localization.formatNumber(this.model.get("likesCount")))},_cbLikeClick:function(){var a=this.model.get("likesCount");this.model.set({likesCount:a+1})},renderLikeButton:function(){if((DEVICE===deviceTypeEnum.iphone||DEVICE===deviceTypeEnum.android)&&PLATFORM===platformEnum.nativeApp){return this}var b=this.model.get("link");if(!b){return this}b=encodeURIComponent(b);var a={};a.cbClick=this._cbLikeClick.hitch(this);FacebookLib.addLikeButton(b,this.$el.find(".like_page_container"),a);return this},handleRefreshClick:function(){this.model.getPageData()}}); var FanPageView=Backbone.View.extend({className:"facebook_page",initialize:function(){this.id="home_"+Utils.Helpers.generateGUID();this.$el.attr({"data-role":"page","data-buttons":"navigation refresh",id:this.id});this.$el.bind("refresh",this.handleRefreshClick.hitch(this));this.$el.bind("silentRefresh",this.handleSilentRefresh.hitch(this))},handleRefreshClick:function(){if(this.postsListView){this.postsListView.handleRefreshClick();this.fanPageHeaderView.handleRefreshClick()}},handleSilentRefresh:function(){if(this.postsListView){this.postsListView.handleSilentRefresh()}},render:function(){this.$el.html('<div class="scroll_wrapper"><div class="scroller"></div></div>');this.$scroller=this.$el.find(".scroller");if(!this.model.get("user")){return this}this.fanPageHeaderView=new FanPageHeaderView({model:this.model});this.postsListView=new PostsListView({model:this.model,showMoreStr:_T("HtmlTextFacebookShowMorePosts"),loadingStr:_T("HtmlTextFacebookLoadingPosts")});this.postsListView.bind("itemSelected",this._onItemSelected,this);this.$scroller.html(this.fanPageHeaderView.el).append(this.postsListView.render().el);var a=this.$el.find(".scroll_wrapper");Scrolling.init(a);return this},addTabsView:function(a){this.$scroller.prepend(a)},_onItemSelected:function(a){this.trigger("itemSelected",a)}}); var PostCommentsListView=ItemsView.extend({className:"post_comments",createItemView:function(a){return new CommentView({model:a})},getRootView:function(){return this.$el}}); var DetailedPostView=Backbone.View.extend({className:"post_full_item box_padding clr_contTypeA_bg clr_contTypeA_brdr",events:{"tap .post_link":"_linkClick","tap .post_list_img":"_photoClick"},initialize:function(){this.model.bind("change:commentsCountText",this._renderCommentsCount,this);this.model.bind("change:wasLike",this._renderLikeUnlike,this)},render:function(){this.model.set({timeAgo:Utils.TimeDate.timeAsText(this.model.get("createdTime")/1000)});this.$el.html(faceBookTemplates.detailedPostHeader(this.model.toJSON()));this._renderCommentsCount();var b=this.$el.find("IMG");b.load(function(){this.$myScrollWrapper=this.$myScrollWrapper||Scrolling.getMyScrollerWrapper(this.$el);Scrolling.onContentChanged(this.$myScrollWrapper)}.hitch(this));b.error(function(){$(this).remove()});if(this.model.get("type")==="video"){this._renderVideoPlayer(this.$el.find(".full_video_container"))}var c=this.$el.find(".control_buttons_container");if(this.model.get("commentable")){var a=new FlatButtonView({text:_T("HtmlTextFacebookAddCommentButton"),icon:"comment_icon"});a.bind("onButtonClicked",this._onAddCommentTap,this);c.append(a.render().el)}if(this.model.get("likeable")){this.likeButtton=new FlatButtonView({text:_T("HtmlTextFacebookLikePostButton"),icon:"like_icon"});this.likeButtton.bind("onButtonClicked",this._onLikeTap,this);c.append(this.likeButtton.render().el);this.unlikeButtton=new FlatButtonView({text:_T("HtmlTextFacebookUnikePostButton"),icon:"unlike_icon"});this.unlikeButtton.bind("onButtonClicked",this._onUnlikeTap,this);c.append(this.unlikeButtton.render().el);this._renderLikeUnlike()}ShareControlHelper.addShareControlButton(c,this.model);return this},_onAddCommentTap:function(){if(PLATFORM===platformEnum.simulator){ShareControlHelper.showSimulatorMessage()}else{if(DEVICE===deviceTypeEnum.iphone&&PLATFORM===platformEnum.nativeApp){this.model.addComment("")}else{CommentDialog.execute(function(a){this.model.addComment(a)}.hitch(this))}}},_onLikeTap:function(){if(PLATFORM===platformEnum.simulator){ShareControlHelper.showSimulatorMessage()}else{this.model.like()}},_onUnlikeTap:function(){this.model.unlike()},_renderCommentsCount:function(){if(this.model.get("commentsCountStatus")===FacebookCountStatus.ok){var a=localization.formatNumber(this.model.get("commentsCount"));this.$el.find(".comments_count").html(_T("HtmlTextFacebookPostCommentsCount",{number:a}))}},_renderLikeUnlike:function(){if(this.model.get("wasLike")){this.likeButtton.$el.hide();this.unlikeButtton.$el.show()}else{this.unlikeButtton.$el.hide();this.likeButtton.$el.show()}},_renderVideoPlayer:function(c){var b=this.model.generateVideoModel();var a=new VideoPlayerView({model:b});c.html(a.render().el)},_photoClick:function(b){b.preventDefault();var a=this.model.getPhotosArray();if(a){new PhotoGalleryManager().pressedImage(a,0)}},_linkClick:function(b){b.preventDefault();var a=this.model.get("link");if(conduitApi.app.isSupported()){conduitApi.app.openLink(null,null,{url:a,title:a})}}}); var PostLikesView=Backbone.View.extend({className:"box_classic_padding clr_contTypeB_bg clr_contTypeB_brdr",initialize:function(){this.model.bind("change:likesCountText change:wasLike",this.render,this)},render:function(){if(this.model.get("likesCountStatus")===FacebookCountStatus.error){return this}var a=this.model.get("likesCount");var c="HtmlTextFacebookPostLikesCount";if(this.model.get("wasLike")){a--;if(a){c="HtmlTextFacebookPostLikesCountIncludeYou"}else{c="HtmlTextFacebookPostLikesOnlyYou"}}if(this.model.get("likesCountStatus")===FacebookCountStatus.deprecatedCount){a=this.model.get("likesCountText")}var b=localization.formatNumber(a);var d={likesText:_T(c,{number:b})};this.$el.html(faceBookTemplates.postLikesPanel(d));return this}}); var faceBookTemplates={};faceBookTemplates.fanPageHeader=_.template('<img class="fan_page_picture post_from_img responsive user_icon_image_size" src="<%= picture %>" alt="" /><div class="post_data_container"><div class="like_page_container"></div><div class="responsive size_title_3 fan_page_title clr_contTypeB_hdlTxt"><%= title %></div><% if (category) { %><div class="responsive size_title_0 fan_page_category clr_contTypeB_subTxt"><%= category %></div><% } %><div class="responsive size_title_2 fan_page_likes_count clr_contTypeB_hdlTxt"></div><div class="responsive size_title_0 fan_page_likes_static_text clr_contTypeB_subTxt"><%= likesCountStr %></div></div>');faceBookTemplates.detailedPost=_.template('<div class="scroll_wrapper"><div class="scroller"></div></div>');faceBookTemplates.detailedPostHeader=_.template('<img class="post_from_img responsive user_icon_image_size" src="<%= fromPicture %>"></img><div class="post_data_container"><div class="responsive size_title_1 post_from_name clr_contTypeA_hdlTxt"><%= fromName %></div><p class="responsive size_1 post_list_message clr_contTypeA_txt"><%= message %></p><% if (type === "video") { %><div class="full_video_container"></div><% } else { %><img class="post_list_img photo_img" src="<%= picture %>" /><% } %><% if (name && link) { %><div class="responsive size_1 post_link clr_contTypeA_lnkTxt"><%= name %></div><% } %><div class="responsive size_0 post_details_extra_info clr_contTypeA_subTxt"><span class="comments_count"></span><span class="facebook_icon mask_sprite sprite-facebook-icon clr_contTypeA_subIcn"></span><span class="time_ago"><%= timeAgo %></span></div></div><div class="control_buttons_container center"></div>');faceBookTemplates.comment=_.template('<img class="responsive post_from_img user_icon_image_size" src="<%= fromPicture %>"></img><div class="post_data_container"><div class="responsive size_title_1 post_from_name clr_contTypeB_hdlTxt"><%= fromName %></div><div class="responsive size_1 comment_message clr_contTypeB_txt"><%= message %></div><span class="responsive size_0 clr_contTypeB_subTxt"><%= timeAgo %></span><span class="responsive size_0 dot clr_contTypeB_subTxt">&#8226;</span><span class="responsive size_0 buttonText like clr_facebook_txt"></span></div>');faceBookTemplates.likeButton=_.template('<div class="like_wrapper" ><iframe src="//www.facebook.com/plugins/like.php?locale=en_US&href=<%= link %>&amp;colorscheme=<%= colorscheme %>&amp;width=45&amp;height=65&amp;layout=button_count&amp;action=like&amp;show_faces=false&amp;send=false" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:45px; height:65px;" allowTransparency="true"></iframe></div>');faceBookTemplates.postLikesPanel=_.template('<div class="like-icon sprite sprite-FB_like"></div><span class="responsive size_0 like_text clr_contTypeB_txt"><%= likesText %></span>'); var livePersonTemplates={page:_.template('<div class="scroll_wrapper"><div class="scroller"><div class="header item clr_contTypeB_headerItem_bg clr_contTypeB_headerItem_brdr"><div class="table"><div class="tablecell"><div class="texts_container"><div class="status big_title clr_contTypeB_hdlTxt"></div><div class="loading_icon mask_sprite sprite-ajax-loader_small clr_contTypeB_subIcn spin"></div><div class="additional_status small_title clr_contTypeB_subTxt"></div></div></div><div class="tablecell button_tablecell"><a class="button start_button clr_contTypeB_btn_bg clr_contTypeB_btn_brdr clr_contTypeB_btn_hdlTxt"><%= startButtonText %></a><a class="button end_button clr_appGeneral_dialog_btn2_bg clr_appGeneral_dialog_btn2_brdr clr_appGeneral_dialog_btn2_hdlTxt"><%= endButtonText %></a></div></div></div><ul class="chat_list"></ul><div class="footer item clr_contTypeA_bg"><div class="table"><div class="tablecell"><div class="input_container"><input type="email" placeholder="<%= inputPlaceholder %>" class="text_input clr_form_input_bg clr_form_input_brdr clr_form_input_txt" /></div></div><div class="tablecell button_tablecell"><a class="button send_button clr_livePerson_btn_bg clr_livePerson_btn_brdr clr_livePerson_btn_hdlTxt clr_livePerson_btn_icn"><%= sendButtonText %></a></div></div></div></div></div>'),agentMessage:_.template('<div class="triangle left clr_livePerson_msgAgentTriangle"></div><div class="bubble_item item agent_message clr_livePerson_msgAgentBg"><div class="content_container medium_text clr_contTypeA_txt"></div><div class="message_time small_text clr_contTypeA_subTxt"><%= time %></div></div>'),userMessage:_.template('<div class="bubble_item item user_message clr_livePerson_msgUserBg"><div class="content_container medium_text clr_contTypeB_txt"><%= content %></div><div class="message_time small_text clr_contTypeB_subTxt"><%= time %></div></div><div class="triangle right clr_livePerson_msgUserTriangle"></div>')}; var lpChatConfig={apiKey:"",lpServer:"",lpNumber:"",onLoad:function(){window.lpc=new lpChat()},onStop:null,onStart:null,onLine:null,onError:null,onAvailability:null,onAgentTyping:null};lpChatConfig.lpAddScript=function(b,e){var d=lpChatConfig;if(typeof(d.lpProtocol)=="undefined"){d.lpProtocol=(document.location.toString().indexOf("https:")==0)?"https":"http"}if(typeof(b)=="undefined"||typeof(b)=="object"){b=d.lpChatSrc?d.lpChatSrc:"/hcp/html/lpChatAPI.js"}if(b.indexOf("http")!=0){b=d.lpProtocol+"://"+d.lpServer+b+"?site="+d.lpNumber}else{if(b.indexOf("site=")<0){if(b.indexOf("?")<0){b=b+"?"}else{b=b+"&"}b=b+"site="+d.lpNumber}}var a=document.createElement("script");a.setAttribute("type","text/javascript");a.setAttribute("charset","iso-8859-1");a.setAttribute("src",b);document.getElementsByTagName("head").item(0).appendChild(a)}; var LivePersonModel=Backbone.Model.extend({defaults:{apiKey:"",lpServer:"",lpNumber:"",agentName:"",stateEnum:{notInSession:0,loading:1,inSession:2,closing:3},sessionState:null}}); var LivePersonMessageModel=Backbone.Model.extend({defaults:{name:"",content:"",time:"",isAgent:false}}); var LivePersonView=Backbone.View.extend({tagName:"div",id:"home_"+Utils.Helpers.generateGUID(),events:{"tap .start_button.active":"_startChat","tap .end_button.active":"_endChat","tap .send_button.active":"_sendText"},_stateEnum:{},_$scroll_wrapper:null,_$chatList:null,_$startButton:null,_$endButton:null,_$sendButton:null,_$status:null,_$secondaryStatus:null,_$loadingImage:null,_$textArea:null,_timerHandle:null,initialize:function(){this.$el.attr({"data-role":"page","data-buttons":"navigation"});this._stateEnum=this.model.get("stateEnum");lpChatConfig.apiKey=this.model.get("apiKey");lpChatConfig.lpServer=this.model.get("lpServer");lpChatConfig.lpNumber=this.model.get("lpNumber");lpChatConfig.onAvailability=this._onAvailability.hitch(this);lpChatConfig.onStart=this._onStart.hitch(this);lpChatConfig.onStop=this._onStop.hitch(this);lpChatConfig.onLine=this._onLine.hitch(this);lpChatConfig.onAgentTyping=this._onAgentTyping.hitch(this);lpChatConfig.onError=this._onError.hitch(this)},render:function(){this.$el.html(livePersonTemplates.page({startButtonText:_T("HtmlTextLivePersonStart"),endButtonText:_T("HtmlTextLivePersonEnd"),sendButtonText:_T("HtmlTextLivePersonSend"),inputPlaceholder:_T("HtmlTextLivePersonInputPlaceholder")}));this._$scroll_wrapper=this.$el.find(".scroll_wrapper");this._$chatList=this.$el.find(".chat_list");this._$startButton=this.$el.find(".start_button");this._$endButton=this.$el.find(".end_button");this._$sendButton=this.$el.find(".send_button");this._$status=this.$el.find(".status");this._$secondaryStatus=this.$el.find(".additional_status");this._$loadingImage=this.$el.find(".loading_icon");this._$textArea=this.$el.find(".text_input");Scrolling.init(this._$scroll_wrapper);this._changeState(this._stateEnum.notInSession);lpChatConfig.lpAddScript();this.$el.bind("pageshow",this.onPageShow.hitch(this));this.$el.bind("pagehide",this.onPageHide.hitch(this));$(window).bind("throttledresize",this.onResize.hitch(this));return this},_changeState:function(a){this.model.set({sessionState:a});if((a===this._stateEnum.notInSession)||(a===this._stateEnum.inSession)){this._clearTimer();this._$loadingImage.hide()}else{this._$loadingImage.show()}if(a===this._stateEnum.notInSession){this._$status.html(_T("HtmlTextLivePersonStatusInit"));this._$secondaryStatus.hide();this._$startButton.show();this._$startButton.removeClass("disabled").addClass("active");this._$endButton.hide();this._$sendButton.addClass("disabled").removeClass("active");this._$textArea.val("");this._$textArea.addClass("disabled").removeClass("active");this._$textArea.attr("disabled","disabled")}else{if(a===this._stateEnum.inSession){this._$status.html(_T("HtmlTextLivePersonStatusChatting",{agentName:this.model.get("agentName")}));this._$secondaryStatus.hide();this._$startButton.hide();this._$endButton.show();this._$endButton.removeClass("disabled").addClass("active");this._$sendButton.removeClass("disabled").addClass("active");this._$textArea.removeClass("disabled").addClass("active");this._$textArea.removeAttr("disabled");this._$chatList.html("");Scrolling.onContentChanged(this._$scroll_wrapper)}else{if(a===this._stateEnum.loading){this._$status.html(_T("HtmlTextLivePersonStatusCheckingAvailability"));this._$secondaryStatus.html(_T("HtmlTextLivePersonStatusCheckingAvailabilityMinorText")).show();this._$startButton.addClass("disabled").removeClass("active")}else{if(a===this._stateEnum.closing){this._$status.html(_T("HtmlTextLivePersonStatusClosingChat"));this._$secondaryStatus.hide();this._$sendButton.addClass("disabled").removeClass("active");this._$endButton.addClass("disabled").removeClass("active");this._$textArea.addClass("disabled").removeClass("active");this._$textArea.attr("disabled","disabled")}}}}Scrolling.onContentChanged(this._$scroll_wrapper)},_clearInputText:function(){this._$textArea.val("");this._inputExit()},_onAvailability:function(a){if(this.model.get("sessionState")!==this._stateEnum.loading){return}if(a.availability===true){this._$status.html(_T("HtmlTextLivePersonStatusWaitingAgent"));this._$secondaryStatus.html(_T("HtmlTextLivePersonStatusWaitingAgentMinorText")).show();Scrolling.onContentChanged(this._$scroll_wrapper);lpc.requestChat()}else{var b=[{text:_T("ButtonClose")}];conduitApi.UI.showDialogBox(null,null,{title:_T("DialogCaptionLivePersonNoAvailability"),message:_T("DialogMessageLivePersonNoAvailability"),buttons:b});this._changeState(this._stateEnum.notInSession)}},_onStart:function(a,b){if(this.model.get("sessionState")!==this._stateEnum.loading){return}this.model.set({agentName:this._fixAgentName(b)});this._changeState(this._stateEnum.inSession)},_onAgentTyping:function(a){if(this.model.get("sessionState")!==this._stateEnum.inSession){return}if(a){this._$secondaryStatus.html(_T("HtmlTextLivePersonStatusAgentTyping",{agentName:this.model.get("agentName")})).show();Scrolling.onContentChanged(this._$scroll_wrapper)}else{this._$secondaryStatus.hide();Scrolling.onContentChanged(this._$scroll_wrapper)}},_onStop:function(c,a){if(this.model.get("sessionState")===this._stateEnum.notInSession){return}this._clearTimer();if((c<3)||(c>12)){var b=[{text:_T("ButtonClose")}];conduitApi.UI.showDialogBox(null,null,{title:_T("DialogCaptionLivePersonChatEnded"),message:a,buttons:b})}this._changeState(this._stateEnum.notInSession)},_onError:function(a){if(this.model.get("sessionState")===this._stateEnum.notInSession){return}var b=[{text:_T("ButtonClose")}];conduitApi.UI.showDialogBox(null,null,{title:_T("DialogCaptionError"),message:a.text,buttons:b})},_onLine:function(a){if(this.model.get("sessionState")!==this._stateEnum.inSession){return}if(a.type==4){this._addChatMessage(true,a.text,this._fixAgentName(a.by))}},_addChatMessage:function(e,c,b){var f=new LivePersonMessageModel({isAgent:e,name:b,time:new Date().format("hh:MM"),content:c});if(e){var a=new AgentMessageView({model:f})}else{var a=new UserMessageView({model:f})}this._$chatList.append(a.render().el);if(e){a.renderContent()}Scrolling.onContentChanged(this._$scroll_wrapper);var d=this._$scroll_wrapper.height();var g=this._$scroll_wrapper.find(".scroller").height();var h=g-d;h+=50;if(h>0){Scrolling.scrollTo(this._$scroll_wrapper,h,500)}},_fixAgentName:function(a){var b="(DEV Only)";return a.replace(b,"")},_clearTimer:function(){if(this._timerHandle!==null){clearTimeout(this._timerHandle);this._timerHandle=null}},_startChat:function(a){a.preventDefault();this._changeState(this._stateEnum.loading);lpc.chatAvailability();this._timerHandle=setTimeout(function(){var b=[{text:_T("ButtonClose")}];conduitApi.UI.showDialogBox(null,null,{title:_T("DialogCaptionLivePersonTimeOut"),message:_T("DialogMessageLivePersonNoAnswer"),buttons:b});this._changeState(this._stateEnum.notInSession);lpc.endChat()}.hitch(this),15000)},_endChat:function(a){a.preventDefault();this._changeState(this._stateEnum.closing);lpc.endChat();this._timerHandle=setTimeout(function(){var b=[{text:_T("ButtonClose")}];conduitApi.UI.showDialogBox(null,null,{title:_T("DialogCaptionLivePersonTimeOut"),message:_T("DialogMessageLivePersonErrorClosing"),buttons:b});this._changeState(this._stateEnum.notInSession)}.hitch(this),5000)},_sendText:function(c){c.preventDefault();var b=this._$textArea.val();if(b!==""){this._$textArea.blur();var a=Utils.String.sanitizeText(b,true);b=b.replace(/\n/g," ");lpc.addLine(b);this._addChatMessage(false,a,_T("SLivePersonUserName"));this._$textArea.val("")}},onResize:function(){if(this.isPageShow){this.updateListHeight()}},onPageShow:function(){this.isPageShow=true;this.updateListHeight()},onPageHide:function(){this.isPageShow=false},updateListHeight:function(){var d=Utils.Html.getInnerHeight();var a=this.$el.find(".header").outerHeight();var c=this.$el.find(".footer").outerHeight();var b=d-a-c;this.$el.find(".chat_list").css({"min-height":b+"px"});Scrolling.onContentChanged(this._$scroll_wrapper)},getChangePageParams:function(){var a={pageId:this.id,changeHash:true};return a}}); var UserMessageView=Backbone.View.extend({tagName:"li",render:function(){this.$el.html(livePersonTemplates.userMessage({content:this.model.get("content"),time:this.model.get("time")}));return this}}); var AgentMessageView=Backbone.View.extend({tagName:"li",render:function(){this.$el.html(livePersonTemplates.agentMessage({time:this.model.get("time")}));return this},renderContent:function(){var b=this.model.get("content");if(b){var a=new HtmlContainerControl();a.renderHtml(this.$el.find(".content_container"),b,{changeColors:true})}return this}}); var LivePersonTemplateView=TemplateView.extend({render:function(a){var c=this.model.get("meta");var b=new LivePersonModel(c[this.options.tabsName][a]);var d=new LivePersonView({model:b});this._changePageParams.homePageId=d.id;this.$el.append(d.render().el);this._homePagesViews[a]=d;TemplateView.prototype.render.apply(this,[a]);return this}}); var loyaltyCardsEnums={verificationState:{NORMAL:"NORMAL",SUCCESS:"SUCCESS",VERIFYING:"LOADING",SERVER_FAIL:"SERVER_FAIL",INVALID_CODE:"INVALID_CODE"},slotType:{NORMAL:"punch",MID_FREEBIE:"mid-freebie",FREEBIE:"freebie"},slotColorType:{NORMAL:"normal",WATERMARK:"watermark"},stampLayoutType:{NORMAL:"punch",GET_FREE:"get-a-free",CONGRATS:"punch-congrats"},afterPunchType:{CLOSE:"close",CONGRATS:"congrats"},slotTextType:{NUMBERING:"$auto"}};var loyaltyCardsMaps={slotColorType:{},stampLayoutType:{},afterPunchType:{}};loyaltyCardsMaps.slotColorType[loyaltyCardsEnums.slotType.NORMAL]=loyaltyCardsEnums.slotColorType.WATERMARK;loyaltyCardsMaps.slotColorType[loyaltyCardsEnums.slotType.MID_FREEBIE]=loyaltyCardsEnums.slotColorType.WATERMARK;loyaltyCardsMaps.slotColorType[loyaltyCardsEnums.slotType.FREEBIE]=loyaltyCardsEnums.slotColorType.NORMAL;loyaltyCardsMaps.stampLayoutType[loyaltyCardsEnums.slotType.NORMAL]=loyaltyCardsEnums.stampLayoutType.NORMAL;loyaltyCardsMaps.stampLayoutType[loyaltyCardsEnums.slotType.MID_FREEBIE]=loyaltyCardsEnums.stampLayoutType.GET_FREE;loyaltyCardsMaps.stampLayoutType[loyaltyCardsEnums.slotType.FREEBIE]=loyaltyCardsEnums.stampLayoutType.CONGRATS;loyaltyCardsMaps.afterPunchType[loyaltyCardsEnums.slotType.NORMAL]=loyaltyCardsEnums.afterPunchType.CLOSE;loyaltyCardsMaps.afterPunchType[loyaltyCardsEnums.slotType.MID_FREEBIE]=loyaltyCardsEnums.afterPunchType.CLOSE;loyaltyCardsMaps.afterPunchType[loyaltyCardsEnums.slotType.FREEBIE]=loyaltyCardsEnums.afterPunchType.CONGRATS; var LoyaltyCardsModel=ItemsModel.extend({createItemsCollection:function(){var b=this.get("params");var a=new LoyaltyCardsCollection(null,b);return a}}); var LoyaltyCardModel=ItemModel.extend({initialize:function(){var d={id:null,title:"",offerTitle:"",upperTitle:"{$HtmlTextLoyaltyCardsTitleOffer}",isHidden:false,isExpired:false,isComingSoon:false,icons:{"default":{whole:null,punched:null}},images:{header:null,background:null},disclaimer:"",description:"",validity:{validFrom:null,validUntil:null},totalSlots:0,limits:{punchesPerDay:3,codeAttempts:5,codeAttemptsCoolDown:86400000},defaults:{icon:"default",freebieName:_T("HtmlTextLoyaltyCardsDefaultFreebieName"),punchLayout:null,afterPunchLayout:null,style:null,slotType:loyaltyCardsEnums.slotType.NORMAL,punchText:loyaltyCardsEnums.slotTextType.NUMBERING,afterPunchText:loyaltyCardsEnums.slotTextType.NUMBERING},defaultOverrides:{},overrides:[],userData:{currentPunches:0,lastPunchDate:null,punchesToday:0,currentCodeAttempts:0,blockUntil:0},verificationState:loyaltyCardsEnums.verificationState.NORMAL,slots:[]};var c=this.toJSON();$.extend(true,d,c);this.set(d);this._updateUserDataFromStorage();var a=this.get("validity");if(a){var b=(new Date().getTime()/1000);var f=(a.validUntil&&a.validUntil<b);var e=(a.validFrom&&a.validFrom>b);this.set({isExpired:f,isComingSoon:e})}this._updateSlots()},_updateSlots:function(){var e=this.get("defaultOverrides");var b=this.get("defaults");$.extend(b,e);var f=[];var l=this.get("userData").currentPunches;var g=this.get("totalSlots");var o=this.get("icons");var n=this.get("overrides");var h=n.length;for(var d=0;d<g;d++){var m=$.extend({},b);for(var c=0;c<h;c++){var a=n[c];if($.inArray(d+1,a.at)>-1){$.extend(m,a)}}var k=o[m.icon];m.punched=d<l;if(m.punched){m.icon=k.punched;if(m.afterPunchText===loyaltyCardsEnums.slotTextType.NUMBERING){m.text=""+(d+1)}else{m.text=m.afterPunchText}}else{m.icon=k.whole;if(m.punchText===loyaltyCardsEnums.slotTextType.NUMBERING){m.text=""+(d+1)}else{m.text=m.punchText}}f[d]=m}this.set({slots:f})},getLastSlot:function(){var b=this.get("totalSlots"),a=this.get("slots");return a[b-1]},getActiveSlot:function(){var a=this.get("userData").currentPunches;if(this.get("verificationState")===loyaltyCardsEnums.verificationState.SUCCESS){a--}return this.get("slots")[a]},_updateUserDataFromStorage:function(){if(PLATFORM===platformEnum.simulator){return}var b=conduitApi.platform.storage.getItem(null,null,this.get("id"),true);if(b){var a=JSON.parse(b);this.set({userData:a});if(a.currentPunches>=this.get("totalSlots")){a.currentPunches=0;this._updateStorageFromUserData()}}},_updateStorageFromUserData:function(){if(PLATFORM===platformEnum.simulator){return}var a=JSON.stringify(this.get("userData"));conduitApi.platform.storage.setItem(null,null,this.get("id"),a,true)},closeStampDialog:function(){var a=this.get("userData");if(a.currentPunches>=this.get("totalSlots")){a.currentPunches=0;this._updateSlots();this._updateStorageFromUserData()}this.set({verificationState:loyaltyCardsEnums.verificationState.NORMAL});this.trigger("onDialogClose",this)},punch:function(a){if(this.get("verificationState")===loyaltyCardsEnums.verificationState.VERIFYING){console.log("in progress...");return}this.set({verificationState:loyaltyCardsEnums.verificationState.VERIFYING});this._executeService(a)},_executeService:function(b){var c={cardId:this.get("id")},a={executeType:executeTypeEnum.FORCE_NETWORK,postParams:{code:b}};Services.executeService("CONTENTHOST_LOYALTYCARDS_VALIDATE_POST",c,this._onServiceSuccess.hitch(this),this._onServiceFail.hitch(this),a)},_onServiceFail:function(a){if(this.get("verificationState")!==loyaltyCardsEnums.verificationState.VERIFYING){return}this.set({verificationState:loyaltyCardsEnums.verificationState.SERVER_FAIL})},_onServiceSuccess:function(b){if(this.get("verificationState")!==loyaltyCardsEnums.verificationState.VERIFYING){return}var a=this.get("userData");if(b){a.currentCodeAttempts=0;this.getPunchesToday(true);var e=this.getActiveSlot();conduitApi.analytics.addEvent(null,null,conduitApi.analytics.usageEventTypeEnum.CardPunched,{slotType:e.slotType,cardId:this.get("id"),slotIndex:a.currentPunches,slotsCount:this.get("totalSlots")});a.currentPunches++;this.set({verificationState:loyaltyCardsEnums.verificationState.SUCCESS});this._updateSlots()}else{a.currentCodeAttempts++;var d=this.get("limits");if(d&&(a.currentCodeAttempts%d.codeAttempts)===0){var c=new Date().getTime();a.blockUntil=c+d.codeAttemptsCoolDown}this.set({verificationState:loyaltyCardsEnums.verificationState.INVALID_CODE})}this._updateStorageFromUserData()},getPunchesToday:function(c){var a=this.get("userData");var b=new Date().format("dd-mm-yyyy");if(a.lastPunchDate!==b){a.punchesToday=0}if(c){a.punchesToday++;a.lastPunchDate=b}return a.punchesToday},getShareInfo:function(){var c=$.extend({},this.get("socialInfo"));if(typeof(c.url)==="undefined"||c.url==="$APP_LINK"){var b=AppManager.app().get("appLink");c.url=(b)?b:""}var a=AppManager.app().get("appLabel");var e=this.getLastSlot();var d={appName:a,cardName:this.get("title"),freebieName:e.freebieName};if(this.get("verificationState")===loyaltyCardsEnums.verificationState.SUCCESS){c.title=c.title||_T("HtmlTextLoyaltyCardsShareWinTitle",d);c.twitterTitle=c.twitterTitle||_T("HtmlTextLoyaltyCardsShareWinTwitterTitle",d);c.emailTitle=c.emailTitle||_T("HtmlTextLoyaltyCardsShareWinEmailTitle",d);c.emailDesc=c.emailDesc||_T("HtmlTextLoyaltyCardsShareWinEmailText",d)}else{c.title=c.title||_T("HtmlTextLoyaltyCardsShareTitle",d);c.twitterTitle=c.twitterTitle||_T("HtmlTextLoyaltyCardsShareTwitterTitle",d);c.emailTitle=c.emailTitle||_T("HtmlTextLoyaltyCardsShareEmailTitle",d);c.emailDesc=c.emailDesc||_T("HtmlTextLoyaltyCardsShareEmailText",d)}return c}}); var LoyaltyCardsCollection=ItemsCollection.extend({model:LoyaltyCardModel,initialize:function(b,a){ItemsCollection.prototype.initialize.apply(this);if(!a.listId||!a.type){this.invalid=true}this.params=a},getServiceName:function(){return"CMS_LOYALTYCARDS_GET"},parse:function(a){var b=$.map(a.items,function(e,d){if(!e.id){return null}var c=new LoyaltyCardModel(e);if(TEST_LOYALTY){return c}if(!c.get("userData").currentPunches&&(c.get("isExpired")||c.get("isComingSoon")||c.get("isHidden"))){return null}return c});return{models:b}},getParams:function(){return this.params}}); var LoyaltyCardsTemplateView=TemplateView.extend({defaultExecuteOptions:{executeType:executeTypeEnum.HIT_AND_RUN},render:function(b){var g=this.model.get("meta");var d=true;if(TEST_LOYALTY){d=false}var a=(typeof(g.onlyForNative)==="undefined")?d:g.onlyForNative;if(PLATFORM==platformEnum.webApp&&a){var f=new BlockWebView({id:"home_"+Utils.Helpers.generateGUID()});this.$el.append(f.render().el);this._homePagesViews[b]=f;TemplateView.prototype.render.apply(this,[b]);return this}if(PLATFORM==platformEnum.simulator){$.extend(this.defaultExecuteOptions,{executeType:executeTypeEnum.FORCE_NETWORK,forceServerNoCache:true})}var e=g.items[b]||{params:{}};var h=new LoyaltyCardsModel({params:e.params});h.set({layoutId:g.pageLayout});if(LAYOUT!==layoutFormat.wide){h.bind("itemSelected",this.onLoyaltyCardSelected,this)}var c=new LoyaltyCardsHomeView({model:h,id:"home_"+Utils.Helpers.generateGUID()});this.$el.append(c.render().el);h.getItems(this.defaultExecuteOptions);this._homePagesViews[b]=c;TemplateView.prototype.render.apply(this,[b]);return this},onLoyaltyCardSelected:function(a,b){if(this.detailsPage){this.detailsPage.remove()}this.detailsPage=new LoyaltyCardDetailsPageView({model:a,id:"details_"+Utils.Helpers.generateGUID()});this.$el.append(this.detailsPage.render().el);$.mobile.changePage("#"+this.detailsPage.id,{transition:"slide",reverse:IS_RTL})}}); var LoyaltyCardsHomeView=Backbone.View.extend({initialize:function(){this.$el.attr({"data-role":"page","data-buttons":"navigation refresh"});this.$el.bind("refresh",this.handleRefreshClick.hitch(this));this.$el.bind("silentRefresh",this.handleSilentRefresh.hitch(this));if(LAYOUT===layoutFormat.wide){this.model.bind("itemSelected",this.onWideItemSelected,this)}var a=this.model.get("items");if(a){a.bind("getItemsSuccess",this.onGetItemsSuccess,this);a.bind("getItemsFail",this.onGetItemsFail,this)}this.model.bind("change:isLoading",this._onLoadingStateChanged,this);this._onLoadingStateChanged()},onWideItemSelected:function(b,c){if(!c&&this.dividedScreenView){var a=new LoyaltyCardDetailsPageView({model:b});this.dividedScreenView.setView2(a.render())}},_onLoadingStateChanged:function(){var b=this.model.get("loadingType");if(b!==loadingTypeEnum.NORMAL&&b!==loadingTypeEnum.REFRESH){return}if(this.model.get("isLoading")){var a=true;cqm.showLoading(_T("HtmlTextPaginationRefreshItems"),this.$el,a)}else{cqm.hideLoading(this.$el)}},_setInnerView:function(a){a.$el.attr({"data-role":""});this.$el.html(a.el)},showNoItemsView:function(){this._setInnerView(new BlockWebView({isNoItems:true}).render())},onGetItemsSuccess:function(){var c=this.model.get("items");if(c.length===0){this.showNoItemsView()}else{if(LAYOUT===layoutFormat.wide){this.dividedScreenView=new DividedScreenView({minWidth:"320px"});var a=new LoyaltyCardsListView({model:this.model});this.dividedScreenView.setView1(a.render());this._setInnerView(this.dividedScreenView.render());var b=c.models[0];b.trigger("itemClicked",b)}else{if(c.length===1){this._setInnerView(new LoyaltyCardDetailsPageView({model:c.models[0]}).render())}else{this._setInnerView(new LoyaltyCardsListView({model:this.model}).render())}}}},onGetItemsFail:function(){this.showNoItemsView()},handleRefreshClick:function(){this.model.set("loadingType",loadingTypeEnum.REFRESH);this.model.getItems(executeTypeEnum.FORCE_NETWORK)},handleSilentRefresh:function(){if(this.model.isExpiredCache()){this.model.set("loadingType",loadingTypeEnum.SILENT_REFRESH);this.model.getItems(executeTypeEnum.FORCE_NETWORK)}}}); var LoyaltyCardsListView=ItemsView.extend({initialize:function(){this.$el.attr({"data-role":"page","data-buttons":"navigation refresh"});this.$el.html(loyaltyCardsTemplates.scroller_tpl());Scrolling.init(this.$(".scroll_wrapper"));this.$scroller=this.$(".scroller");this.$el.bind("refresh",this.handleRefreshClick.hitch(this));this.$el.bind("silentRefresh",this.handleSilentRefresh.hitch(this));ItemsView.prototype.initialize.apply(this)},_onLoadingStateChanged:function(){},getRootView:function(){return this.$scroller},createItemView:function(a){return new LoyaltyCardItemView({model:a,layoutType:this.model.get("layoutId")})}}); var LoyaltyCardItemView=Backbone.View.extend({className:"LoyaltyCardItemView feed_bubble_item",tagName:"li",events:{tap:"itemClicked"},initialize:function(){this.model.bind("change:selected",this.onSelectedChange,this)},render:function(){var c=this.model.toJSON();this.$el.html(loyaltyCardsTemplates.list_item_tpl(c));var i=this.$(".item_container");var b=this.model.get("isExpired");var e=this.model.get("isComingSoon");if(b||e){var c={loyaltyCardExpired:_T(b?"HtmlTextLoyaltyCardsExpired":"HtmlTextLoyaltyCardsComingSoon")};this.$el.append(loyaltyCardsTemplates.loyaltyCardExpired(c));i.addClass("expired")}var f=this.model.get("description");if(f){var a=this.$(".description");var h=new HtmlContainerControl();h.renderHtml(a,f,{changeColors:false})}var g=this.model.get("validity").validFrom;var d=this.model.get("validity").validUntil;if(g||d){var c={startStr:"",endStr:"",formattedValidFrom:"",formattedValidUntil:""};if(g){c.formattedValidFrom=new Date(g*1000).format("shortDate");c.startStr=_T("HtmlTextLoyaltyCardsValidFrom")}if(d){c.formattedValidUntil=new Date(d*1000).format("shortDate");c.endStr=_T("HtmlTextLoyaltyCardsValidUntil")}i.append(loyaltyCardsTemplates.listItemDates(c))}return this},onSelectedChange:function(){if(LAYOUT===layoutFormat.wide){if(this.model.get("selected")){this.$el.children().addClass("selected")}else{this.$el.children().removeClass("selected")}}},itemClicked:function(a){a.preventDefault();this.model.trigger("itemClicked",this.model)}}); var LoyaltyCardDetailsPageView=Backbone.View.extend({className:"LoyaltyCardDetailsPageView",initialize:function(){this.$el.attr({"data-role":"page","data-buttons":"back"});this.model.bind("onDialogClose",this.backFlip,this);this.model.bind("onInfoClose",this.backFlip,this);this.model.bind("onInfoOpen",this.changeToInfoView,this);this.model.bind("onDialogOpen",this.changeToDialogView,this)},render:function(){var b=this.model.toJSON();var a=loyaltyCardsTemplates.pageCardContainer;this.$el.html(a(b));this.$scroll_wrapper=this.$(".scroll_wrapper");Scrolling.init(this.$scroll_wrapper);this.showCardView();return this},flip:function(){this.animate({transition:"flip",reverse:IS_RTL})},backFlip:function(){this.animate({transition:"flip",reverse:!IS_RTL})},animate:function(k){var e={transition:"none",reverse:false};var d=$.extend({},e,k);var c=d.transition;var f=d.reverse?" reverse":"";var i=this.$(".active.animationContainer");var h=this.$(".inactive.animationContainer");i.removeClass("active");h.removeClass("inactive");var g=this;var j=function(){i.addClass("inactive");h.addClass("active");Scrolling.onContentChanged(g.$scroll_wrapper)};var b=function(){h.add(i).removeClass("animation out in reverse "+c);j()};var a=((c!=="none")&&($.support.cssTransitions));if(a){h.one("webkitAnimationEnd",b);h.add(i).addClass(c+" animation"+f);i.addClass("out");h.addClass("in")}else{j()}},showCardView:function(){var b=new LoyaltyCardsCardView({model:this.model});var a=this.$(".active .cardContainer");a.html(b.render().el);Scrolling.onContentChanged(this.$scroll_wrapper)},changeToDialogView:function(){var b=new LoyaltyCardsStampView({model:this.model});var a=this.$(".inactive .cardContainer");a.html(b.render().el);this.flip()},changeToInfoView:function(){var b=new LoyaltyCardInfoView({model:this.model});var a=this.$(".inactive .cardContainer");a.html(b.render().el);this.flip()}}); var LoyaltyCardInfoView=Backbone.View.extend({className:"LoyaltyCardInfoView",render:function(){var b=this.model.toJSON();b.infoTitle=_T("HtmlTextLoyaltyCardsInfoTitle");b.validFrom=null;b.validUntil=null;var a=this.model.get("validity");if(a.validFrom||a.validUntil){b.validityTitle=_T("HtmlTextLoyaltyCardsValidityTitle");if(a.validFrom){b.validFrom=new Date(a.validFrom*1000).format("shortDate");b.validFromTitle=_T("HtmlTextLoyaltyCardsValidFrom")}if(a.validUntil){b.validUntil=new Date(a.validUntil*1000).format("shortDate");b.validUntilTitle=_T("HtmlTextLoyaltyCardsValidUntil")}}b.cancel=_T("HtmlTextLoyaltyCardsInfoButtonCancel");this.$el.append(loyaltyCardsTemplates.info_tpl(b));this.$cancelButton=this.$(".cancelButton");this.$cancelButton.tap(this.cancelButtonClick.hitch(this));this.$("IMG").load(function(){this.$scrollWrapper=this.$scrollWrapper||Scrolling.getMyScrollerWrapper(this.$el);Scrolling.onContentChanged(this.$scrollWrapper)}.hitch(this)).error(function(){$(this).remove()});return this},cancelButtonClick:function(a){a.preventDefault();this.model.trigger("onInfoClose",this.model);return false}}); var LoyaltyCardsCardView=Backbone.View.extend({className:"LoyaltyCardsCardView",render:function(){var g=this.model.toJSON();this.$el.append(loyaltyCardsTemplates.loyaltyCard(g));var f=this.model.get("isExpired");var e=this.model.get("isComingSoon");if(f||e){var g={loyaltyCardExpired:_T(f?"HtmlTextLoyaltyCardsExpired":"HtmlTextLoyaltyCardsComingSoon")};this.$el.append(loyaltyCardsTemplates.loyaltyCardExpired(g));var d=this.$(".item_container");d.addClass("expired")}var c=this.model.get("description");if(c){var a=this.$(".description");var b=new HtmlContainerControl();b.renderHtml(a,c,{changeColors:false})}this.$cardContainer=this.$(".card_container");this.$cardContainer.tap(this.punchCardClick.hitch(this));this.model.bind("change:slots",this.renderCard,this);this.addButtons();this.renderCard();this.$("IMG").load(function(){this.$scrollWrapper=this.$scrollWrapper||Scrolling.getMyScrollerWrapper(this.$el);Scrolling.onContentChanged(this.$scrollWrapper)}.hitch(this)).error(function(){$(this).remove()});return this},punchCardClick:function(a){a.preventDefault();var c=this.model.get("isExpired");var b=this.model.get("isComingSoon");if(!c&&!b){this.model.trigger("onDialogOpen",this.model)}return false},renderCard:function(){this.$cardContainer.html("");var g=this.model.get("slots"),a=$('<div class="fallback circle">'),l=$('<div class="fallback star">');for(var e=0;e<g.length;e++){var j=g[e],h=j.icon||{},d=$("<div>").addClass("slot");d.appendTo(this.$cardContainer);var b=j.punched?"punch":"whole",c={bg:"clr_punch_slot_"+b+"_bg",overlay:"clr_punch_slot_"+b+"_overlay",text:"clr_punch_slot_"+b+"_txt"};var k=_.bind(function(o,n,i){if(o.text){var m=$("<div>").addClass("slot_text "+i.text).text(o.text);m.appendTo(n)}},this,j,d,c);var f=a.clone().addClass(c.bg+"_fallback");Utils.Html.appendLayeredImage(d,h.bg,c.bg,f,k,k);if(h.overlay){var f=l.clone().addClass(c.overlay+"_fallback_text");Utils.Html.appendLayeredImage(d,h.overlay,c.overlay,f)}}},addButtons:function(){var c=this.$(".buttons_container");ShareControlHelper.addShareControlButton(c,this.model);var a=this.model.get("validity");var d=(this.model.get("disclaimer")||a.validFrom||a.validUntil);if(d){var b=new FlatButtonView({text:_T("HtmlTextLoyaltyCardsShowMoreButton"),icon:"info22"});b.bind("onButtonClicked",this._showMore,this);c.append(b.render().el)}},_showMore:function(){this.model.trigger("onInfoOpen",this.model)}}); var LoyaltyCardsStampView=Backbone.View.extend({className:"LoyaltyCardsStampView narrow_box",render:function(){var a={ok:_T("HtmlTextLoyaltyCardsDialogButtonOk"),cancel:_T("HtmlTextLoyaltyCardsDialogButtonCancel")};this.$el.append(loyaltyCardsTemplates.stamp_tpl(a));this.$header=this.$(".header");this.$okButton=this.$(".okButton");this.$cancelButton=this.$(".cancelButton");this.$status=this.$(".status");this.$input=this.$("INPUT");this.$okButton.tap(this.okButtonClick.hitch(this));this.$cancelButton.tap(this.cancelButtonClick.hitch(this));this.model.bind("change:verificationState",this.updateState,this);this.$input.focus(this.onInputEnter.hitch(this));this.renderHeader();this.updateState();this.$("IMG").load(function(){this.$scrollWrapper=this.$scrollWrapper||Scrolling.getMyScrollerWrapper(this.$el);Scrolling.onContentChanged(this.$scrollWrapper)}.hitch(this)).error(function(){$(this).remove()});return this},close:function(){this.model.unbind("change:verificationState");this.$input.blur();this.model.closeStampDialog()},onInputEnter:function(a){this.$input.val("").attr({placeholder:_T("HtmlTextLoyaltyCardsDialogPlaceholder")});this.$input.removeClass("mandatory");this.$status.html("")},okButtonClick:function(b){b.preventDefault();if(!$(b.target).hasClass("disabled")){var a=this.$input.val();this.model.punch(a)}return false},cancelButtonClick:function(a){a.preventDefault();this.close();return false},renderHeader:function(){var f=this.model.getActiveSlot();var e=f.punchLayout||loyaltyCardsMaps.stampLayoutType[f.slotType];if(e===loyaltyCardsEnums.stampLayoutType.CONGRATS){var d=f;var b=loyaltyCardsTemplates.stampFreebieHeader_tpl}else{if(e===loyaltyCardsEnums.stampLayoutType.GET_FREE){var d=f;var b=loyaltyCardsTemplates.stampMidFreebieHeader_tpl}else{var d=this.model.toJSON();var b=loyaltyCardsTemplates.stampNormalHeader_tpl}}this.$header.html(b(d));var c=this.$(".slot_icon_header");if(c&&c.length===1){var a="clr_punch_slot_punch_bg";Utils.Html.appendLayeredImage(c,f.icon.overlay,a)}},updateState:function(){var b=this.model.get("userData");var a=this.model.get("limits");var j=new Date().getTime();var k=this.model.get("verificationState");if(b.blockUntil&&b.blockUntil>j){this._disableStamp();this.$input.val("").attr({placeholder:_T("HtmlTextLoyaltyCardsDialogPlaceholderLocked")});this.$input.addClass("mandatory");var i=b.blockUntil-j;var g=""+Math.ceil(i/1000/60/60);var m=_T("HtmlTextLoyaltyCardsDialogServiceCoolDownText",{hours:g});this.$status.html(m).removeClass("clr_contTypeB_txt").addClass("clr_punch_errTxt");return}else{if(k===loyaltyCardsEnums.verificationState.VERIFYING){this.$input.removeClass("mandatory");this._disableStamp();var m=_T("HtmlTextLoyaltyCardsDialogLoading");this.$status.html(m).removeClass("clr_punch_errTxt").addClass("clr_contTypeB_txt")}else{if(k===loyaltyCardsEnums.verificationState.SERVER_FAIL){this._enableStamp();var m=_T("HtmlTextLoyaltyCardsDialogServiceFailText");this.$status.html(m).removeClass("clr_contTypeB_txt").addClass("clr_punch_errTxt")}else{if(k===loyaltyCardsEnums.verificationState.INVALID_CODE){this.$input.addClass("mandatory");this._enableStamp();var m=_T("HtmlTextLoyaltyCardsDialogWrongCodeText");this.$status.html(m).removeClass("clr_contTypeB_txt").addClass("clr_punch_errTxt")}else{if(k===loyaltyCardsEnums.verificationState.SUCCESS){var h=this.model.getActiveSlot();var f=h.afterPunchType||loyaltyCardsMaps.afterPunchType[h.slotType];if(f===loyaltyCardsEnums.afterPunchType.CONGRATS){var l=this.$el.height();this.$el.css({height:"1px","min-height":l+"px"});this.$input.remove();this.$status.remove();this.$okButton.remove();this.$header.html(loyaltyCardsTemplates.successHeader_tpl(h));var d=this.$(".slot_icon_header");if(d&&d.length===1){var c="clr_punch_slot_punch_bg";Utils.Html.appendLayeredImage(d,h.icon.overlay,c)}var e=this.$(".buttonsContainer");ShareControlHelper.addShareControlButton(e,this.model,null,{big:true})}else{this.close()}}else{this.$input.val("");this.$input.focus();if(PLATFORM!==platformEnum.simulator&&a.punchesPerDay&&this.model.getPunchesToday()>=a.punchesPerDay){this._disableStamp();var m=_T("HtmlTextLoyaltyCardsDialogLimitPerDayText",{punchesPerDay:a.punchesPerDay});this.$status.html(m).removeClass("clr_contTypeB_txt").addClass("clr_punch_errTxt")}else{this._enableStamp();this.$status.html("")}}}}}}this.$scrollWrapper=this.$scrollWrapper||Scrolling.getMyScrollerWrapper(this.$el);Scrolling.onContentChanged(this.$scrollWrapper)},_disableStamp:function(){this.$input.addClass("disabled");this.$input.attr({disabled:"disabled"});this.$okButton.addClass("disabled")},_enableStamp:function(){this.$input.removeClass("disabled");this.$input.removeAttr("disabled");this.$input.attr({placeholder:_T("HtmlTextLoyaltyCardsDialogPlaceholder")});this.$okButton.removeClass("disabled")}}); var BlockWebView=Backbone.View.extend({className:"blockWebView clr_contTypeB_fullPage_bg",events:{"tap .button":"onButtonClick"},initialize:function(){this.$el.attr({"data-role":"page","data-buttons":"navigation"})},render:function(){var a=Utils.Helpers.getStoreLink();if(TEST_LOYALTY){a="http://www.cnn.com"}if(this.options.isNoItems){var b={title:_T("HtmlTextLoyaltyCardsNoItemsTitle"),text:_T("HtmlTextLoyaltyCardsNoItemsText"),buttonTitle:null,downloadButton:null}}else{var b={title:_T("HtmlTextLoyaltyCardsOnlyNativeTitle"),text:_T("HtmlTextLoyaltyCardsOnlyNativeText"),buttonTitle:_T("HtmlTextLoyaltyCardsOnlyNativeDownloadButton"),downloadButton:a}}this.$el.html(loyaltyCardsTemplates.blockWebView(b));this.$scroll_wrapper=this.$(".scroll_wrapper");Scrolling.init(this.$scroll_wrapper);return this},onButtonClick:function(b){var a=Utils.Helpers.getStoreLink();if(TEST_LOYALTY){a="http://www.cnn.com"}if(conduitApi.app.isSupported()){conduitApi.app.openLink(null,null,{url:a,title:a})}}}); var loyaltyCardsTemplates={pageCardContainer:_.template('<div class="black_bg clr_punch_wideBg"></div><div class="scroll_wrapper"><div class="scroller"><div class="active animationContainer"><div class="fullCardContainer sliced_image" style="background-image:url(\'<%= images.background %>\')"><div class="clr_punch_bgImage_overlayBg cardContainer"></div></div></div><div class="inactive animationContainer"><div class="fullCardContainer sliced_image" style="background-image:url(\'<%= images.background %>\')"><div class="clr_punch_bgImage_overlayBg cardContainer"></div></div></div><div class="clearfix"></div></div></div>'),scroller_tpl:_.template('<div class="scroll_wrapper"><div class="scroller"></div></div>'),info_tpl:_.template('<div class="box2"><% if (images.header) { %><img class="header_image" src="<%= images.header %>" /><% } %><div class="not_responsive card_info_title size_title_3 _1_line clr_contTypeB_hdlTxt ellipsis"><%= infoTitle %></div><% if (disclaimer) { %><div class="disclaimer size_1 clr_contTypeB_txt"><%= disclaimer %></div><% } %><% if (validFrom || validUntil) { %> <div class="new_box validityTitle clr_contTypeB_brdr not_responsive size_title_1 clr_contTypeB_hdlTxt"><%= validityTitle %></div><div class="validity_box box clr_contTypeB_brdr"><div class="val_icon mask_sprite sprite-cal clr_contTypeB_icn"></div><div class="val_texts_container"><% if (validFrom) { %> <div class="val_text clr_contTypeB_txt not_responsive size_1"><span class="val_mini_title not_responsive size_title_1 clr_contTypeB_hdlTxt"><%= validFromTitle %></span><%= validFrom %></div><% } %> <% if (validUntil) { %> <div class="val_text clr_contTypeB_txt not_responsive size_1"><span class="val_mini_title not_responsive size_title_1 clr_contTypeB_hdlTxt"><%= validUntilTitle %></span><%= validUntil %></div><% } %> </div></div><% } %> <div class="cancelButton button clr_appGeneral_dialog_btn2_bg clr_appGeneral_dialog_btn2_brdr clr_appGeneral_dialog_btn2_hdlTxt" data-role="button"><%= cancel %></div></div>'),stamp_tpl:_.template('<div class="table"><div class="header"></div><input type="tel" maxlength="4" class="input clr_form_input_bg clr_form_input_brdr clr_form_input_txt" /><div class="status size_1"></div><div class="space"></div><div class="buttonsContainer"><div class="okButton button clr_contTypeB_btn_bg clr_contTypeB_btn_brdr clr_contTypeB_btn_hdlTxt" data-role="button"><%= ok %></div><div class="cancelButton button clr_appGeneral_dialog_btn2_bg clr_appGeneral_dialog_btn2_brdr clr_appGeneral_dialog_btn2_hdlTxt" data-role="button"><%= cancel %></div></div></div>'),stampFreebieHeader_tpl:_.template('<div class="box1"><% if (typeof(icon) !== undefined && icon.overlay) { %><div class="slot_icon_header"></div><% } %><div class="not_responsive title size_title_3 _1_line clr_contTypeB_hdlTxt ellipsis"><%= _T("HtmlTextLoyaltyCardsDialogCongratsCaption") %></div><div class="text1 size_1 clr_contTypeB_txt"><%= _T("HtmlTextLoyaltyCardsDialogFreebieText", {freebie: \'<div class="freebie size_title_4 clr_contTypeB_hdlTxt">\' + freebieName + \'</div>\'}) %></div></div>'),successHeader_tpl:_.template('<div class="box1"><% if (typeof(icon) !== undefined && icon.overlay) { %><div class="slot_icon_header"></div><% } %><div class="not_responsive title size_title_3 _1_line clr_contTypeB_hdlTxt ellipsis"><%= _T("HtmlTextLoyaltyCardsDialogCongratsSuccessCaption") %></div><div class="text1 size_1 clr_contTypeB_txt"><%= _T("HtmlTextLoyaltyCardsDialogFreebieSuccessText", {freebie: \'<div class="freebie size_title_4 clr_contTypeB_hdlTxt">\' + freebieName + \'</div>\'}) %></div></div>'),stampMidFreebieHeader_tpl:_.template('<div class="box1"><% if (typeof(icon) !== undefined && icon.overlay) { %><div class="slot_icon_header"></div><% } %><div class="not_responsive title size_title_3 _1_line clr_contTypeB_hdlTxt ellipsis"><%= _T("HtmlTextLoyaltyCardsDialogStampCaption") %></div><div class="text1 size_1 clr_contTypeB_txt"><%= _T("HtmlTextLoyaltyCardsDialogMidFreebieText", {freebie: \'<span class="mid_freebie clr_contTypeB_hdlTxt">\' + freebieName + \'</span>\'}) %></div></div>'),stampNormalHeader_tpl:_.template('<div class="box1"><% if (images.header) { %><img class="header_image" src="<%= images.header %>" /><% } %><div class="not_responsive title size_title_3 _1_line clr_contTypeB_hdlTxt ellipsis"><%= _T("HtmlTextLoyaltyCardsDialogStampCaption") %></div><div class="text1 size_1 clr_contTypeB_txt"><%= _T("HtmlTextLoyaltyCardsDialogNormalText") %></div></div>'),list_item_tpl:_.template('<div class="item_container clr_contTypeB_bubbleItem_bg clr_contTypeB_bubbleItem_brdr box" data-role="button"><% if (title) { %><div class="not_responsive list_title size_title_3 _1_line clr_contTypeB_hdlTxt ellipsis"><%= title %></div><% } %><% if (description) { %><div class="description clr_contTypeB_txt"></div><% } %><div class="main_banner clr_contTypeB_subBg"><% if (images.header) { %><div class="image top_sliced_image" style="background-image:url(\'<%= images.background %>\')"><div class="clr_punch_bgImage_overlayBg image"><div class="small_header_image contain_image" style="background-image:url(\'<%= images.header %>\')"></div></div></div><div class="offer_container"><% } else { %><div class="offer_container_no_image"><% } %><div class="vertical_center"><div><% if (upperTitle) { %><div class="not_responsive size_0 upperTitle clr_contTypeB_subTxt"><%=Utils.String.translateIfNeed(upperTitle)%></div><% } %><div class="mainOfferTitle clr_contTypeB_hdlTxt"><%=offerTitle%></div></div></div></div></div>'),listItemDates:_.template('<div class="dates_container not_responsive size_0 _1_line">             <% if (startStr) { %>                 <div class="left startStr clr_contTypeB_subTxt"><%= startStr %></div>                <div class="left formattedValidFrom clr_contTypeB_hdlTxt"><%= formattedValidFrom %></div>            <% } %>             <% if (endStr) { %>                 <div class="right formattedValidUntil clr_contTypeB_hdlTxt"><%= formattedValidUntil %></div>                <div class="right endStr clr_contTypeB_subTxt"><%= endStr %></div>            <% } %>         </div>'),loyaltyCard:_.template('<div class="box2 item_container"><% if (images.header) { %><img class="header_image" src="<%= images.header %>" /><% } if (title) { %><div class="not_responsive title size_title_3 _1_line clr_contTypeB_hdlTxt ellipsis"><%= title %></div><% } %><% if (description) { %><div class="description clr_contTypeB_txt"></div><% } %><div class="card_container"></div><div class="buttons_container"></div></div>'),loyaltyCardExpired:_.template('<div class="expired-wrapper"><div class="expired-ribbon-wrapper"><div class="expired-ribbon clr_appGeneral_ribbon_bg clr_appGeneral_ribbon_brdr clr_appGeneral_ribbon_txt"><%= loyaltyCardExpired %></div></div></div>'),blockWebView:_.template('<div class="scroll_wrapper"><div class="scroller"><div class="scrollerBug"><div class="icon no-events-icon mask_sprite sprite-card_icon clr_contTypeB_subIcn" ></div><div class="size_title_4 text clr_contTypeB_hdlTxt" ><%= title %></div><div class="size_title_1 text clr_contTypeB_subTxt" ><%= text %></div><% if (downloadButton) { %><div class="buttonContainer"><div class="downloadButton button clr_contTypeB_btn_bg clr_contTypeB_btn_brdr clr_contTypeB_btn_hdlTxt" data-role="button"><%= buttonTitle %></div></div><% } %></div></div></div>')}; var ReviewsCollection=ItemsCollection.extend({initialize:function(b,a){ItemsCollection.prototype.initialize.apply(this);if(a&&a.type&&a.query){this.params=a}else{this.invalid=true}},parse:function(b){var e={metaData:b};if(b&&b.items){var d=this.params.type;var f=[];for(var c=0;c<b.items.length;c++){var a=b.items[c];a.providerType=d;f[c]=new ReviewModel(a)}e.models=f}return e},getServiceName:function(){return"CMS_REVIEW_GET"},getParams:function(){return this.params}}); var ProviderModel=ItemsModel.extend({defaults:{hasData:false,title:"",businessName:"",image:"",providerName:"",reviewsCount:0,rating:0,params:{}},initialize:function(){ItemsModel.prototype.initialize.apply(this,arguments);this.get("items").bind("getItemsSuccess",this._onGetItemsSuccess,this);var b=this.get("params");if(b){var a=Services.generateUrl("IMAGES_REVIEWS_PROVIDER_GET",b);if(a&&a!==""){this.set({image:a})}}},createItemsCollection:function(){var a=this.get("params");return new ReviewsCollection(null,a)},_onGetItemsSuccess:function(a){this.set({hasData:true,rating:a.rating,reviewsCount:a.totalItems,providerName:a.providerName,businessName:a.name});this.trigger("getItemsSuccess",this)}}); var ReviewModel=ItemModel.extend({defaults:{time:0,description:"",fullDescription:"",id:"",rating:0,reviewer:{id:"",imageUrl:"",name:""},socialInfo:null,title:"",link:"",providerType:0}}); var ReviewsTemplateView=TemplateView.extend({reviewsTypes:{OPEN_TABLE:3},render:function(b){var e=this.model.get("meta");this.layoutId=e.pageLayout;if(this.layoutId!==1){this.layoutId=0}var d=null;if(e.items.length>1||(e.items[0]&&e.items[0].params&&e.items[0].params.type==this.reviewsTypes.OPEN_TABLE)){d=new ProvidersListView({model:this.model,layoutId:this.layoutId,id:"home_"+Utils.Helpers.generateGUID()});d.bind("providerSelected",this.onProviderSelected,this)}else{var a=new ProviderModel(e.items[0]);a.getItems(executeTypeEnum.HIT_AND_RUN);d=this.createProviderDetailsPage(a)}var c=$(d.render().el);c.attr({"data-role":"page","data-buttons":"navigation refresh"});this._homePagesViews[b]=d;this.$el.html(c);this.$el.bind("refresh",function(){d.handleRefreshClick()});return this},_addPage:function(b){var a=$(b.render().el);this.$el.append(a);a.attr({"data-role":"page","data-buttons":"back refresh"});var c="#"+b.id;a.bind("refresh",function(){b.handleRefreshClick()});$.mobile.changePage(c,{transition:"slide",reverse:IS_RTL})},createProviderDetailsPage:function(a){if(this.providerPage){this.providerPage.remove()}this.providerPage=new ProviderDetailsView({model:a,layoutId:this.layoutId,id:"provider_page_details_"+Utils.Helpers.generateGUID()});return this.providerPage},onProviderSelected:function(a,d){if(a.get("params").type==this.reviewsTypes.OPEN_TABLE){var b=a.get("params").query;if(b){var c={url:b};conduitApi.app.openLink(null,null,c)}}else{var e=this.createProviderDetailsPage(a);this._addPage(e)}}}); var ReviewsWideTemplateView=TemplateView.extend({render:function(a){var c=this.model.get("meta");this.layoutId=c.pageLayout;if(this.layoutId!==1){this.layoutId=0}var b=new ProvidersListView({model:this.model,layoutId:this.layoutId,id:"home_"+Utils.Helpers.generateGUID()});b.bind("providerSelected",this.onProviderSelected.hitch(this),this);this.dividedScreenView=new DividedScreenView({id:"divided_screen_"+Utils.Helpers.generateGUID()});this.dividedScreenView.setView1(b.render());this._homePagesViews[a]=this.dividedScreenView;this.$el.html(this.dividedScreenView.render().addRefreshButton(false,true).el);this._selectFirstProvider(b);return this},onProviderSelected:function(a,b){if(!b){if(this.detailsPage){this.detailsPage.remove();this.detailsPage=null}this.detailsPage=new ProviderDetailsView({model:a,layoutId:this.layoutId,id:"provider_page_details_"+Utils.Helpers.generateGUID()});this.dividedScreenView.setView2(this.detailsPage.render());var c=Scrolling.getMyScrollerWrapper(this.detailsPage.getRootView());Scrolling.onContentChanged(c)}},_selectFirstProvider:function(a){if(a.providerViewsArray.length>0){var b=a.providerViewsArray[0];b.trigger("providerClicked",b.model)}}}); var ProvidersListView=Backbone.View.extend({providerViewsArray:[],render:function(){this.$el.html('<div class="scroll_wrapper"><div class="scroller"></div></div>');var e=this.$el.find(".scroller");var f=this.$el.find(".scroll_wrapper");var b=reviewsTemplates.providers_list_tpl;e.html(b());var a=e.find(".providers_list");var d=this.model.get("meta").items;var c=this;_.each(d,function(h,g){c._renderOneProvider(a,h)});Scrolling.init(f);return this},_renderOneProvider:function(c,b){if(b){var a=new ProviderModel(b);var d=new ProviderView({model:a,layoutId:this.options.layoutId});d.bind("providerClicked",this.onProviderSelected,this);this.providerViewsArray[this.providerViewsArray.length]=d;c.append(d.render().el)}},onProviderSelected:function(a){var b=!!(this._selectedProvider&&this._selectedProvider.cid===a.cid);if(this._selectedProvider&&!b){this._selectedProvider.set({selected:false})}if(!b){this._selectedProvider=a;this._selectedProvider.set({selected:true})}this.trigger("providerSelected",a,b)},handleRefreshClick:function(){this.render()}}); var ProviderView=Backbone.View.extend({className:"provider_list_item item box_classic_padding",tagName:"li",events:{tap:"itemClicked"},initialize:function(){this.$el.attr("data-role","button").addClass("t3d");this.model.bind("change:selected",this.onSelectedChange,this);var a=this.model.get("items");if(!a||a.invalid){this.$el.css({display:"none"})}},render:function(){var a=reviewsTemplates.provider_loading_tpl;var c={image:this.model.get("image")||"",title:this.model.get("title")||"",loadingString:_T("HtmlTextReviewsLoadingProvider"),type:this.model.get("params").type};if(this.options.layoutId===0){this.$el.addClass("clr_contTypeA_classicItem_bg clr_contTypeA_classicItem_brdr feed_classic_item");c.colorClassType="A"}else{this.$el.addClass("clr_contTypeB_bubbleItem_bg clr_contTypeB_bubbleItem_brdr feed_bubble_item");c.colorClassType="B"}var b=a(c);this.$el.html(b);this.model.bind("getItemsSuccess",this.onGetItemsSuccess.hitch(this));this.model.getItems(executeTypeEnum.HIT_AND_RUN);return this},onSelectedChange:function(){if(LAYOUT===layoutFormat.wide){if(this.model.get("selected")){this.$el.addClass("selected")}else{this.$el.removeClass("selected")}}},onGetItemsSuccess:function(){var i=reviewsTemplates.provider_full_tpl;var c=this.model.get("reviewsCount")||0;var a=localization.formatNumber(c);var h=this.model.get("providerName");var e=_T("HtmlTextReviewsReviewsCount",{number:a,provider:h});var d=this.model.get("params").type;var b=ReviewsUtils.ratingToHtml(this.model.get("rating"),d,"clr_contTypeB_icn");var g={image:this.model.get("image"),title:this.model.get("title"),reviewsCount:e,rating:b};if(this.options.layoutId===0){g.colorClassType="A"}else{g.colorClassType="B"}var f=i(g);this.$el.html(f)},itemClicked:function(a){a.preventDefault();conduitApi.analytics.addEvent(null,null,conduitApi.analytics.usageEventTypeEnum.ViewChanged,{viewId:this.model.get("id")});this.trigger("albumClicked",this.model);this.trigger("providerClicked",this.model)}}); var ProviderDetailsView=ItemsView.extend({initialize:function(){this.$el.html('<div class="provider_details_page scroll_wrapper"><div class="scroller"></div></div>');var b=this.$el.find(".scroll_wrapper");this.$scroller=this.$el.find(".scroller");Scrolling.init(b);this._createHeader();ItemsView.prototype.initialize.apply(this,arguments);var a=this.model.get("items");if(!a||a.invalid){this.$el.css({display:"none"})}},createItemView:function(a){var b=new ReviewView({model:a,layoutId:this.options.layoutId});return b},getRootView:function(){return this.$scroller},_createHeader:function(){if(this.header){return}this.header=new ProviderDetailsHeaderView({model:this.model,layoutId:this.options.layoutId});this.$scroller.prepend(this.header.render().el)}}); var ProviderDetailsHeaderView=Backbone.View.extend({className:"provider_header item box_classic_padding clr_contTypeB_headerItem_bg clr_contTypeB_headerItem_brdr",tagName:"div",render:function(){var a=reviewsTemplates.provider_loading_tpl;var c={image:this.model.get("image")||"",title:this.model.get("title")||"",loadingString:_T("HtmlTextReviewsLoadingProvider"),type:this.model.get("params").type};var b=a(c);this.$el.html(b);if(this.model.get("hasData")){this._renderFull()}else{this.model.bind("getItemsSuccess",this._renderFull.hitch(this))}return this},_renderFull:function(){var i=reviewsTemplates.provider_full_tpl;var c=this.model.get("reviewsCount")||0;var a=localization.formatNumber(c);var h=this.model.get("providerName");var e=_T("HtmlTextReviewsReviewsCount",{number:a,provider:h});var d=this.model.get("params").type;var b=ReviewsUtils.ratingToHtml(this.model.get("rating"),d,"clr_contTypeB_icn");var g={image:this.model.get("image"),title:this.model.get("title"),reviewsCount:e,rating:b,colorClassType:"B"};var f=i(g);this.$el.html(f);return this}}); var ReviewView=Backbone.View.extend({className:"review_list_item item box_classic_padding clr_contTypeA_bg",render:function(){var k=reviewsTemplates.review_item_tpl;var b=this.model.get("reviewer").imageUrl;var i=this.model.get("title");var d=this.model.get("providerType");var c=ReviewsUtils.ratingToHtml(this.model.get("rating"),d,"clr_contTypeA_icn");var l=this.model.get("description")||"";var a=_T("HtmlTextReviewsByAuthor",{name:this.model.get("reviewer").name});var j=Utils.TimeDate.timeAsText(this.model.get("time"));var g={image:b,title:i,text:l,rating:c,reviewerName:a,timeAgo:j};this.$el.html(k(g)).attr("data-role","button").addClass("t3d");var f=this.model.get("link");if(f){var e=$('<span class="clr_contTypeA_lnkTxt review_link">'+_T("HtmlTextReviewsReadMoreLink")+"</span>");var h=this.$el.find(".review_text");h.append(e);e.tap(function(m){m.preventDefault();if(conduitApi.app.isSupported()){conduitApi.app.openLink(null,null,{url:f,title:f})}})}if(this.options.layoutId===0){this.$el.addClass("clr_contTypeA_brdr feed_classic_item")}else{this.$el.addClass("clr_contTypeA_brdrBubble feed_bubble_item")}return this}}); var reviewsTemplates={providers_list_tpl:_.template('<ul class="providers_list"></ul>'),provider_loading_tpl:_.template('<% if (typeof(image) != "undefined" && image) { %><img class="image" src="<%= image %>" /><% } %><div class="container"><div class="responsive size_title_3 clr_contTypeB_hdlTxt"><%= title %></div><% if (type !== 3) { %><div class="responsive size_title_0 loading_provider clr_contTypeB_subTxt"><div class="loading_icon mask_sprite sprite-ajax-loader_small clr_contTypeA_subIcn spin"></div><div class="loading_string"><%= loadingString %></div></div><% } %></div>'),provider_full_tpl:_.template('<% if (typeof(image) != "undefined" && image) { %><div class="image uploader_image"><img class="" src="<%= image %>" /></div><% } %><div class="container"><div class="responsive size_title_3 clr_contType<%= colorClassType %>_hdlTxt"><%= title %></div><div class="responsive size_title_0 clr_contType<%= colorClassType %>_subTxt"><%= reviewsCount %></div><div class="rating_container"><%= rating %></div></div>'),review_item_tpl:_.template('<% if (typeof(image) != "undefined" && image) { %><img class="image uploader_image" src="<%= image %>" /><% } %><div class="container"><div class="responsive size_title_1 clr_contTypeA_hdlTxt"><%= title %></div><div class="rating_container"><%= rating %></div><div class="responsive size_1 review_text clr_contTypeA_txt"><%= text %></div><div class="responsive size_0 extra_info clr_contTypeA_subTxt"><div class="reviewer"><%= reviewerName %></div><div class="time_ago"><%= timeAgo %></div></div></div>')}; var ReviewsUtils=(function(){var a={};a.ratingToHtml=function(b,d,c){if(d===1){return a.ratingToHtmlYelp(b)}else{return a.ratingToHtmlDefault(b,c)}};a.ratingToHtmlDefault=function(e,f){if(e===null){return""}f=f||"clr_contTypeB_icn";var d=5;var c="";for(var b=0;b<d;b++){if(e>=1){c+='<div class="mask_sprite star_image sprite-fullStar '+f+'"></div>'}else{if(e>0){c+='<div class="mask_sprite star_image sprite-halfStar '+f+'"></div>'}else{c+='<div class="mask_sprite star_image sprite-emptyStar '+f+'"></div>'}}e--}return c};a.ratingToHtmlYelp=function(c){if(c===null){return""}var d="rating5";if(c<=0){d="rating0"}else{if(c<=1){d="rating1"}else{if(c<2){d="rating1p5"}else{if(c==2){d="rating2"}else{if(c<3){d="rating2p5"}else{if(c==3){d="rating3"}else{if(c<4){d="rating3p5"}else{if(c==4){d="rating4"}else{if(c<5){d="rating4p5"}}}}}}}}}var b='<div class="reviewsSprite yelp_stars '+d+'"></div>';return b};return a}()); var RestaurantModel=ItemsModel.extend({defaults:{title:"",location:"",type:"",params:null},initialize:function(){ItemsModel.prototype.initialize.apply(this,arguments)}}); var MenuModel=ItemModel.extend({defaults:{desc:"",disclamer:"",entries:"",name:"",state:"",title:""},initialize:function(){ItemModel.prototype.initialize.apply(this,arguments)}}); var MenuCollection=ItemsCollection.extend({model:MenuModel,initialize:function(b,a){ItemsCollection.prototype.initialize.apply(this);this.params={provider:a.provider,restid:a.restid}},getServiceName:function(){return"CMS_MENU_GET"},parse:function(a){return{models:a.menus}},getParams:function(){return this.params}}); var MenuListModel=ItemsModel.extend({defaults:{params:null},initialize:function(){ItemsModel.prototype.initialize.apply(this,arguments)},createItemsCollection:function(){var a=new MenuCollection(null,this.get("params"));a.bind("menuSelected",this._onMenuSelected,this);return a},_onMenuSelected:function(a){this.trigger("menuSelected",a)}}); var MenuItemModel=ItemModel.extend({defaults:{desc:"",name:"",title:"",type:1}}); var ContainerView=Backbone.View.extend({attributes:{"data-role":"page"},initialize:function(){this.$el.html(menuTemplates.scroller_tpl());this.$scroller=this.$el.find(".scroller");this.$scrollWrapper=this.$el.find(".scroll_wrapper");Scrolling.init(this.$scrollWrapper);return this},getRootView:function(){return this.$el},renderView:function(a){this.$scroller.append(a.render().el);Scrolling.onContentChanged(this.$scrollWrapper)}}); var RestaurantListView=Backbone.View.extend({attributes:{"data-role":"page","data-buttons":"navigation"},render:function(){this.$el.html(menuTemplates.scroller_tpl());var e=this.$el.find(".scroller");var f=this.$el.find(".scroll_wrapper");var b=menuTemplates.restaurants_list_tpl;e.html(b());var a=e.find(".rest_list");var d=this.model.get("meta").items;var c=this;_.each(d,function(h,g){c._renderOneRestaurant(a,h)});Scrolling.init(f);return this},_renderOneRestaurant:function(b,d){if(d){var c=new RestaurantModel(d);var a=new RestaurantView({model:c,layoutId:this.options.layoutId});a.bind("restaurantClicked",this.onRestaurantSelected,this);b.append(a.render().el)}},onRestaurantSelected:function(a){var b=!!(this._selectedRestaurant&&this._selectedRestaurant.cid===a.cid);if(this._selectedRestaurant&&!b){this._selectedRestaurant.set({selected:false})}if(!b){this._selectedRestaurant=a;this._selectedRestaurant.set({selected:true})}this.trigger("restaurantSelected",a,b)}}); var MenuListView=Backbone.View.extend({className:"clr_contTypeB_bg menu_list",initialize:function(){this.$itemsList=$('<ul class="menu_items_list"></ul>');this.$el.append(this.$itemsList)},render:function(){var a=this.model.get("items");if(a){a.each(this.renderOneItem.hitch(this))}return this},renderOneItem:function(a){this.$itemsList.append(new MenuView({model:a,layoutType:this.model.get("layoutId"),layoutParams:this.model.get("layoutParams"),id:"menu_view_"+Utils.Helpers.generateGUID()}).render().el)}}); var MenuItemListView=Backbone.View.extend({TYPE_CATEGORY:2,TYPE_ITEM:1,className:"clr_contTypeB_bg menu_items_list",render:function(){this.$el.html(menuTemplates.menu_items_list_tpl());var b=this.$(".menu_items_list");var a=this.model.get("entries");var c=this;_.each(a,function(e,d){c._renderOneMenuItem(b,e)});return this},_renderOneMenuItem:function(b,f){var e;var a=this.model.get("currency")||"";switch(f.type){case this.TYPE_CATEGORY:e=menuTemplates.menu_single_item_type_tpl;break;case this.TYPE_ITEM:e=menuTemplates.menu_single_item_tpl;break}var d=new Backbone.View();var c=d.make("li");f.currency=a;$(c).html(e(f));b.append(c)}}); var RestaurantView=Backbone.View.extend({className:"restaurant_list_item item",tagName:"li",events:{tap:"itemClicked"},initialize:function(){this.$el.attr({"data-buttons":"back"});this.$el.attr("data-role","button").addClass("t3d");this.model.bind("change:selected",this.onSelectedChange,this)},render:function(){var a=menuTemplates.restaurants_item_tpl;var c={title:this.model.get("title")||"",location:this.model.get("location")||"",imageUrl:this.model.get("imageUrl")||""};var b=a(c);this.$el.html(b);this.$el.addClass("clr_contTypeB_bubbleItem_bg feed_bubble_item");if(this.model.has("imageUrl")){this.$el.addClass("with-image")}else{this.$el.addClass("no-image")}return this},onSelectedChange:function(){if(LAYOUT===layoutFormat.wide){if(this.model.get("selected")){this.$el.addClass("ipad_selected")}else{this.$el.removeClass("ipad_selected")}}},itemClicked:function(a){a.preventDefault();conduitApi.analytics.addEvent(null,null,conduitApi.analytics.usageEventTypeEnum.ViewChanged,{viewId:this.model.get("id")});this.trigger("restaurantClicked",this.model)}}); var MenuView=Backbone.View.extend({tagName:"li",className:"clr_contTypeC_bg t3d feed_bubble_item",events:{tap:"itemClicked"},initialize:function(){this.model.bind("change:selected",this.onSelectedChange,this)},render:function(){var b=menuTemplates.menus_list_item_tpl;this.$el.attr("data-role","button");var a={title:this.model.get("title")||""};var c=b(a);this.$el.html(c);return this},onSelectedChange:function(){if(LAYOUT===layoutFormat.wide){if(this.model.get("selected")){this.$el.addClass("ipad_selected")}else{this.$el.removeClass("ipad_selected")}}},itemClicked:function(a){a.preventDefault();this.model.trigger("menuSelected",this.model)},}); var MenuItemView=Backbone.View.extend({className:"menu_single_item item",render:function(){var c=this.model.get("entries.title");var a=this.model.get("entries.type");var d=this.model.get("entries.desc")||"";var b=this.model.get("entries.prices")||"";if(this.options.layoutId===0){this.$el.addClass("color_clickable_classic_item1 feed_classic_item")}else{this.$el.addClass("color_clickable_bubble_item1 feed_bubble_item")}return this}}); var MenuTemplateView=TemplateView.extend({render:function(b){var e=this.model.get("meta");var f=this.model.get("meta");var d=null;this.layoutId=f.pageLayout;if(PLATFORM!=platformEnum.webApp&&f.items[0]&&f.items[0].type=="menulink"){var a=new Backbone.Model(e[this.options.tabsName][b]);d=new WebModuleView({model:a,id:"page_"+Utils.Helpers.generateGUID()})}else{if(f.items.length>1){d=new RestaurantListView({model:this.model,layoutId:this.layoutId,id:"home_"+Utils.Helpers.generateGUID()});d.bind("restaurantSelected",this.onRestaurantSelected,this)}else{var c=new RestaurantModel(f.items[0]);d=this.createContainer(c,true)}}this.$el.append(d.render().el);this._homePagesViews[b]=d;return this},_addPage:function(a){this.$el.append(a.render().el);$.mobile.changePage("#"+a.id,{transition:"slide",reverse:IS_RTL})},createContainer:function(c,a){if(this.restaurantPage){this.restaurantPage.remove()}var d=c.toJSON();this.menuListModel=new MenuListModel(d);this.menuListModel.bind("menuSelected",this.onMenuSelected,this);this.restaurantPage=new ContainerView({attributes:{"data-role":"page","data-buttons":a?"navigation":"back"},model:c,layoutId:this.layoutId,id:"menu_page_container"+Utils.Helpers.generateGUID(),});var b=this.menuListModel.get("items");b.bind("getItemsSuccess",this.onGetMenusSuccess,this);cqm.showLoading();this.menuListModel.getItems(executeTypeEnum.HIT_AND_RUN);return this.restaurantPage},createMenuListView:function(a){if(this.menuList){this.menuList.remove()}this.menuList=new MenuListView({model:a,layoutId:this.layoutId,id:"menu_list_details_"+Utils.Helpers.generateGUID()});return this.menuList},createMenuItemListView:function(a){return new MenuItemListView({model:a,layoutId:this.layoutId})},onRestaurantSelected:function(a){this.createContainer(a,false);this._addPage(this.restaurantPage)},onGetMenusSuccess:function(){cqm.hideLoading();var b=null;var a=this.menuListModel.get("items");if(a.length==1){var c=a.at(0);b=this.createMenuItemListView(c)}else{if(a.length>1){b=this.createMenuListView(this.menuListModel)}}this.restaurantPage.renderView(b)},onMenuSelected:function(a){var b=this.createMenuItemListView(a);if(this.menuPageContainer){this.menuPageContainer.remove()}this.menuPageContainer=new ContainerView({attributes:{"data-role":"page","data-buttons":"back"},model:a,layoutId:this.layoutId,id:"menu_page_container"+Utils.Helpers.generateGUID(),});this.menuPageContainer.renderView(b);this._addPage(this.menuPageContainer)}}); var menuTemplates={scroller_tpl:_.template('<div class="scroll_wrapper"><div class="scroller"></div></div>'),restaurants_list_tpl:_.template('<ul class="rest_list">         </ul>'),restaurants_item_tpl:_.template('<div class="rest_container"> 		<% if (typeof(title) != "undefined" && title) { %> 			<div class="title clr_contTypeB_hdlTxt"><%= title %></div><% } %> 		<% if (typeof(location) != "undefined" && location) { %> 			<div class="location clr_contTypeB_txt"><%= location.address %>, <%= location.city %></div><% } %> 		</div> 		<% if (typeof(imageUrl) != "undefined" && imageUrl) { %> 			<div class="image sliced_image" style="background-image:url(\'<%= imageUrl %>\')"></div> 		<% } %>'),menu_list_tpl:_.template('<ul class="menu_list color_m2_background"></ul>'),menus_list_item_tpl:_.template('<div class="menu_list_item clr_contTypeC_hdlTxt"><%= title %></div>'),menu_items_list_tpl:_.template('<ul class="menu_items_list color_m2_background"></ul>'),menu_single_item_tpl:_.template('<div class="menu_single_item clr_contTypeB_brdr"> 			<div class="menu_single_item_content"> 				<% if (typeof(prices) != "undefined" && prices != "" && prices.length >= 0 && prices[0].price && prices[0].title == null) { %>				<div class="menu_single_item_name clr_contTypeB_txt"><%= title %></div>	            <% } else { %>	            <div class="menu_single_item_name_priceless clr_contTypeB_txt"><%= title %></div><% } %>				<% if (typeof(prices) != "undefined" && prices != "" && prices.length >= 0 && prices[0].title == null && prices[0].price) { %> 				<div class="menu_single_item_price clr_contTypeB_txt"><%= currency %><%= prices[0].price %></div><% } %> 			</div> 			<% if (typeof(desc) != "undefined" && desc) { %> 			<div class="menu_single_item_desc clr_contTypeB_subTxt"> 				<div class="desc_txt"><%= desc %></div>			</div> <% } %> 				<% if (typeof(prices) != "undefined" && prices != "" && prices.length > 1 && prices[0].price && prices[0].title != null) { %> 				<div class="menu_single_item_desc clr_contTypeB_subTxt"> 					<div class="desc_txt"><%= prices[0].title %></div>					<div class="menu_single_item_price sub_price clr_contTypeB_txt"><%= currency %><%= prices[0].price %></div> 				</div><% } %>				<% if (typeof(prices) != "undefined" && prices != "" && prices.length > 1 && prices[1].price) { %> 				<div class="menu_single_item_desc clr_contTypeB_subTxt"> 					<div class="desc_txt"><%= prices[1].title %></div>					<div class="menu_single_item_price sub_price clr_contTypeB_txt"><%= currency %><%= prices[1].price %></div></div><% } %></div>'),menu_single_item_type_tpl:_.template('<div class="menu_type_item clr_contTypeB_brdr"> 			<div class="menu_type_item_name clr_contTypeB_hdlTxt"><%= title %></div> 			<div class="menu_type_item_desc clr_contTypeB_txt"><%= desc %></div> 		</div>'),}; var couponsEnums={couponType:{UNKNOWN:0,DISCOUNT:1,CUSTOM:2,BUY_AND_GET:3},discountType:{PERCENT:0,MONEY:1},offerType:{NO_OFFER:0,DISCOUNT:1,FINAL_PRICE:2,CUSTOM_TEXT:3,CUSTOM_ICON:4}}; var CouponsListModel=ItemsModel.extend({createItemsCollection:function(){var a=this.get("params");return new CouponsCollection(null,a)}}); var CouponModel=ItemModel.extend({defaults:{id:"",couponType:couponsEnums.couponType.UNKNOWN,claim:false,title:"",description:"",imageUrl:"",largeImageUrl:"",dealDetails:"",overrideHtmlColors:true,disclaimer:"",productDiscount:{discountType:couponsEnums.discountType.PERCENT,offerType:couponsEnums.offerType.DISCOUNT,price:0,discount:0,imageUrl:"",upperTitle:null,lowerTitle:null,offerTitle:"",currency:"USD",currencySymbol:"$"},validity:{validFrom:0,validUntil:0,hours:null},linkCaption:"",linkUrl:"",socialInfo:{title:"",imageUrl:"",url:""}},initialize:function(){if(!this.get("linkCaption")){this.set({linkCaption:"{$HtmlTextCouponsTermsTitle}"})}var a=this.get("productDiscount");if(a.upperTitle===null){a.upperTitle="{$HtmlTextCouponsTitleOffer}"}if(a.lowerTitle===null){if(a.offerType===couponsEnums.offerType.DISCOUNT){a.lowerTitle="{$HtmlTextCouponsPriceOff}"}else{a.lowerTitle=""}}},getShareInfo:function(){var e=$.extend({},this.get("socialInfo"));var d=e.title||_T("HtmlTextCouponsShareDefaultOfferTitle");var c=_T("HtmlTextCouponsShareTitle");var a=AppManager.app().get("appLabel");var f=_T("HtmlTextCouponsShareDescription",{offerTitle:d,appName:a});e.title=c;e.shortDesc=f;if(e.url==="$APP_LINK"){var b=AppManager.app().get("appLink");e.url=(b)?b:""}return e}}); var CouponsCollection=ItemsCollection.extend({model:CouponModel,initialize:function(b,a){ItemsCollection.prototype.initialize.apply(this);if(!a.listId||!a.type){this.invalid=true}this.params=a},getServiceName:function(){return"CMS_COUPONS_GET"},parse:function(a){var b=$.map(a.items,function(d,c){if(d.couponType===couponsEnums.couponType.BUY_AND_GET||d.couponType===couponsEnums.couponType.CUSTOM||d.couponType===couponsEnums.couponType.DISCOUNT){return d}});return{models:b}},getParams:function(){return this.params}}); var CouponsTemplateView=TemplateView.extend({defaultExecuteOptions:{executeType:executeTypeEnum.HIT_AND_RUN},render:function(c){if(PLATFORM==platformEnum.simulator){$.extend(this.defaultExecuteOptions,{executeType:executeTypeEnum.FORCE_NETWORK,forceServerNoCache:true})}var e=this.model.get("meta"),d=e.items[c]||{params:{}};var a=new CouponsListModel({params:d.params});a.set({layoutId:e.pageLayout,layoutParams:e.items});a.bind("itemSelected",this.onCouponSelected,this);var b=new CouponsHomeView({model:a,id:"home_"+Utils.Helpers.generateGUID()});this.$el.append(b.render().el);a.getItems(this.defaultExecuteOptions);this._homePagesViews[c]=b;TemplateView.prototype.render.apply(this,[c]);return this},onCouponSelected:function(a,b){if(this.detailsPage){this.detailsPage.remove()}this.detailsPage=new CouponDetailsPageView({model:a,id:"details_"+Utils.Helpers.generateGUID()});this._addPage(this.detailsPage)},_addPage:function(a){this.$el.append(a.render().el);a.$el.attr({"data-role":"page","data-buttons":"back"});$.mobile.changePage("#"+a.id,{transition:"slide",reverse:IS_RTL})}}); var CouponsListView=ItemsView.extend({initialize:function(){this.isGrid=(LAYOUT===layoutFormat.wide);this.$el.html(couponsTemplates.scroller_tpl());this.$scroll_wrapper=this.$(".scroll_wrapper");Scrolling.init(this.$scroll_wrapper);this.$scroller=this.$(".scroller");if(this.isGrid){$(window).bind("throttledresize",this.onResize.hitch(this));var a=this.model.get("items");if(a){a.bind("getItemsSuccess",this.onResize,this);this.onPageHide()}}ItemsView.prototype.initialize.apply(this)},updateThumbnailsMargin:function(){Utils.Html.setGridMargin(this.$itemsList,{minMargin:1})},onResize:function(){if(this.isGrid&&this.isPageShow){this.updateThumbnailsMargin();Scrolling.triggerWrapperResize()}},onPageShow:function(){if(this.isGrid){this.isPageShow=true;this.updateThumbnailsMargin()}},onPageHide:function(){if(this.isGrid){this.isPageShow=false}},getRootView:function(){return this.$scroller},createItemView:function(a){return new CouponsItemView({model:a,layoutType:this.model.get("layoutId"),layoutParams:this.model.get("layoutParams"),isGrid:this.isGrid})}}); var CouponsItemView=Backbone.View.extend({className:"t3d couponsItemView",tagName:"li",events:{tap:"itemClicked"},initialize:function(){this.model.bind("change:selected",this.onSelectedChange,this)},render:function(){if(this.options.isGrid){this.$el.addClass("gridItem")}else{this.$el.addClass("feed_bubble_item")}this.$el.html(couponsTemplates.list_item_tpl());var d=this.$(".item_container");var c=new CouponPrimaryView({model:this.model,isListItem:true,isGrid:this.options.isGrid});d.html(c.render().el);var f=this.model.get("validity").validFrom;var b=this.model.get("validity").validUntil;var a=(new Date().getTime()/1000);if(b&&b<a){var e={couponExpired:_T("HtmlTextCouponsExpired")};this.$el.append(couponsTemplates.couponExpired(e));d.addClass("expired")}if(this.options.isGrid||f||b){var e={startStr:"",endStr:"",formattedValidFrom:"",formattedValidUntil:""};if(f){e.formattedValidFrom=new Date(f*1000).format("shortDate");e.startStr=_T("HtmlTextCouponsValidFrom")}if(b){e.formattedValidUntil=new Date(b*1000).format("shortDate");e.endStr=_T("HtmlTextCouponsValidUntil")}d.append(couponsTemplates.listItemDates(e))}return this},onSelectedChange:function(){if(LAYOUT===layoutFormat.wide){if(this.model.get("selected")){this.$el.addClass("selected")}else{this.$el.removeClass("selected")}}},itemClicked:function(a){a.preventDefault();this.model.trigger("itemClicked",this.model)}}); var CouponPrimaryView=Backbone.View.extend({className:"coupon_box",events:{"tap .open_gallery":"_photoClick"},_photoClick:function(b){b.preventDefault();var c=this.model.get("largeImageUrl");if(c){var a=[{title:this.model.get("title"),largeImage:c,photoModel:null}];new PhotoGalleryManager().pressedImage(a,0);return false}},render:function(){var a=this.model.get("productDiscount");if(!a){return this}var e={useDividedScreen:this.options.useDividedScreen,title:this.model.get("title"),description:this.model.get("description"),imageUrl:this.model.get("imageUrl"),isListItem:this.options.isListItem,classPrefix:this.options.isListItem?"clr_contTypeB":"clr_contTypeA",discountImage:"",useBigImage:false,isGrid:this.options.isGrid};if(a.offerType===couponsEnums.offerType.CUSTOM_ICON&&a.imageUrl&&this.options.isListItem){e.discountImage=a.imageUrl}if(a.offerType===couponsEnums.offerType.FINAL_PRICE||a.offerType===couponsEnums.offerType.DISCOUNT||a.offerType===couponsEnums.offerType.CUSTOM_TEXT||e.discountImage){e.upperTitle=Utils.String.translateIfNeed(a.upperTitle);e.lowerTitle=Utils.String.translateIfNeed(a.lowerTitle);e.currencySymbol="";e.percentSymbol="";e.offerTitle=a.offerTitle;if(a.offerType!==couponsEnums.offerType.CUSTOM_TEXT){if(a.offerType===couponsEnums.offerType.FINAL_PRICE){var b=a.price;if(a.discount){if(a.discountType===couponsEnums.discountType.MONEY){b=b-a.discount}else{if(a.discountType===couponsEnums.discountType.PERCENT){b=Math.floor(b*(100-a.discount)/100)}}}e.offerTitle=b;e.currencySymbol=a.currencySymbol||""}else{if(a.offerType===couponsEnums.offerType.DISCOUNT){e.offerTitle=a.discount;if(a.discountType===couponsEnums.discountType.MONEY){e.currencySymbol=a.currencySymbol||""}else{if(a.discountType===couponsEnums.discountType.PERCENT){e.percentSymbol="%"}}}}}var d=""+e.offerTitle;var c=d.length+e.percentSymbol.length/1.7+e.currencySymbol.length/1.7;e.numberFontSize=45;if(c>4){e.numberFontSize=Math.floor(160/c)}else{if(c>3){e.numberFontSize=41}}if(this.options.isListItem){e.numberFontSize=e.numberFontSize-4}if(LAYOUT===layoutFormat.wide){e.numberFontSize*=1.2}e.symbolFontSize=e.numberFontSize/1.7;e.symbolFontSize=Math.floor(e.symbolFontSize);e.numberFontSize=Math.floor(e.numberFontSize)}else{e.useBigImage=true}this.$el.html(couponsTemplates.couponPrimaryTemplate(e));return this}}); var CouponDetailsPageView=Backbone.View.extend({render:function(){var a=new CouponFullView({model:this.model});this.$el.html(a.render().el);return this}}); var CouponFullView=Backbone.View.extend({className:"CouponFullView",render:function(){var d=(LAYOUT===layoutFormat.wide);var b=new CouponDataView({model:this.model,useDividedScreen:d});if(d){var c=new CouponData2View({model:this.model});var a=new DividedScreenView({id:"divided_screen_"+Utils.Helpers.generateGUID()});a.setView1(b.render());a.$el.removeAttr("data-role");this.$el.html(a.render().el);a.setView2(c.render())}else{this.$el.html(b.render().el)}return this}}); var CouponDataView=Backbone.View.extend({className:"data1",render:function(){var x={};this.$el.html(couponsTemplates.scroller_tpl(x));var c=this.$(".scroller");var n=this.model.get("dealDetails");var t=this.model.get("linkUrl");var x={useDividedScreen:this.options.useDividedScreen,pricesBanner:false,disclaimer:this.model.get("disclaimer"),validFrom:0,validUntil:0,hours:null,validityTitle:_T("HtmlTextCouponsTitleValidity"),dealDetails:n,detailsTitle:_T("HtmlTextCouponsTitleDealDetails"),linkUrl:t,linkCaption:Utils.String.translateIfNeed(this.model.get("linkCaption"))};var h=this.model.get("productDiscount");if(h.price&&h.discount){x.pricesBanner={titleA:_T("HtmlTextCouponsTitleOriginalPrice"),numberA:h.price,symbolA:h.currencySymbol,symbolB:"",symbolC:"",titleC:_T("HtmlTextCouponsTitleSaving")};if(h.offerType===couponsEnums.offerType.FINAL_PRICE){x.pricesBanner.titleB=_T("HtmlTextCouponsTitleDiscount");x.pricesBanner.numberB=h.discount;if(h.discountType===couponsEnums.discountType.MONEY){x.pricesBanner.symbolB=h.currencySymbol;x.pricesBanner.numberC=Math.floor(100*h.discount/h.price)}else{if(h.discountType===couponsEnums.discountType.PERCENT){x.pricesBanner.symbolC=h.currencySymbol;x.pricesBanner.numberC=Math.floor(h.price*h.discount/100)}}}else{x.pricesBanner.titleB=_T("HtmlTextCouponsTitleNewPrice");x.pricesBanner.symbolB=h.currencySymbol;if(h.discountType===couponsEnums.discountType.MONEY){x.pricesBanner.numberB=Math.floor(h.price-h.discount);x.pricesBanner.numberC=Math.floor(100*h.discount/h.price)}else{if(h.discountType===couponsEnums.discountType.PERCENT){x.pricesBanner.numberB=Math.floor(h.price*(100-h.discount)/100);x.pricesBanner.symbolC=h.currencySymbol;x.pricesBanner.numberC=Math.floor(h.price*h.discount/100)}}}}var m=this.model.get("validity");if(m.validFrom||m.validUntil){if(m.validFrom){x.validFrom=new Date(m.validFrom*1000).format("shortDate");x.validFromTitle=_T("HtmlTextCouponsValidFrom")}if(m.validUntil){x.validUntil=new Date(m.validUntil*1000).format("shortDate");x.validUntilTitle=_T("HtmlTextCouponsValidUntil")}}if(m.hours){var l=m.hours;if(l&&l.length){var p=[_T("_day1s"),_T("_day2s"),_T("_day3s"),_T("_day4s"),_T("_day5s"),_T("_day6s"),_T("_day7s")];var o=_T("_firstDayOfWeek");for(var v=0;v<l.length;v++){var e=$.map(l[v].days,function(k,j){k=(k%7);if(k<o){k+=7}return k});e=e.sort();var s="";for(var u=0;u<e.length;u++){s+=p[(e[u]%7)];for(var f=u+1;(f<e.length)&&(e[f-1]+1===e[f]);f++){}if(f>u+2){s+="-";u=f-2}else{if(u+1<e.length){s+=", "}}}l[v].daysStr=s;l[v].hoursStr=l[v].startHour+" - "+l[v].endHour}x.hours=l}else{x.hours=_T("HtmlTextCouponsNoHours")}}var g=$(couponsTemplates.fullCoupon(x));c.html(g);var b=(new Date().getTime()/1000);if(m.validUntil&&m.validUntil<b){x.couponExpired=_T("HtmlTextCouponsExpired");c.prepend(couponsTemplates.couponExpired(x));g.addClass("expired")}else{if(this.model.get("claim")){var r=new CouponClaimView({model:this.model});c.prepend(r.render().el)}}if(n){var q=this.$(".deal_details");var a=new HtmlContainerControl();a.renderHtml(q,n,{changeColors:this.model.get("overrideHtmlColors")})}this.$(".view_original_button").tap(function(j){if(conduitApi.app.isSupported()){conduitApi.app.openLink(null,null,{url:t})}});var d=new CouponPrimaryView({model:this.model,isListItem:false,useDividedScreen:this.options.useDividedScreen});this.$(".primary_container").html(d.render().el);var w=this.$(".share_container");ShareControlHelper.addShareControlButton(w,this.model);var i=this.$(".scroll_wrapper");Scrolling.init(i);Scrolling.onContentChanged(i);return this}}); var CouponData2View=Backbone.View.extend({className:"data2 clr_contTypeB_bg",render:function(){var d={};this.$el.html(couponsTemplates.scroller_tpl(d));var b=this.$(".scroller");var e=this.$(".scroll_wrapper");var f=this.model.get("dealDetails");var d={title:this.model.get("title"),description:this.model.get("description"),largeImage:this.model.get("largeImageUrl"),dealDetails:f,detailsTitle:_T("HtmlTextCouponsTitleDealDetails")};var h=$(couponsTemplates.data2(d));b.html(h);b.find("IMG").load(function(){Scrolling.onContentChanged(e)}.hitch(this)).error(function(){$(this).remove()});var a=(new Date().getTime()/1000);var g=this.model.get("validity");if(g.validUntil&&g.validUntil<a){this.$el.addClass("expired")}if(f){var c=this.$(".deal_details");var i=new HtmlContainerControl();i.renderHtml(c,f,{changeColors:this.model.get("overrideHtmlColors")})}Scrolling.init(e);return this}}); var CouponClaimView=Backbone.View.extend({className:"CouponClaimView box",events:{"tap .button":"claimCoupon"},_key:"CouponClaim",render:function(){if(this.isClaimed()){this.renderClaimed()}else{this.renderNotClaimed()}return this},renderNotClaimed:function(){var a={txt:_T("HtmlTextCouponsClaimButton")};this.$el.html(couponsTemplates.claimCoupon(a));this.$el.addClass("clr_coupons_notClaimed_bg clr_coupons_notClaimed_brdr")},renderClaimed:function(){var a={txt:_T("HtmlTextCouponsCouponClaimed")};this.$el.html(couponsTemplates.couponClaimed(a));this.$el.addClass("clr_coupons_claimed_bg clr_coupons_claimed_brdr clr_coupons_claimed_txt").removeClass("clr_coupons_notClaimed_bg clr_coupons_notClaimed_brdr")},isClaimed:function(){var c=this.model.get("id");if(!c){return false}var a=this._key+c;var b=conduitApi.platform.storage.getItem(null,null,a,true);if(b){return true}return false},setClaimed:function(){var b=this.model.get("id");if(!b){return}var a=this._key+b;conduitApi.platform.storage.setItem(null,null,a,"1",true)},addClaimUsage:function(){conduitApi.analytics.addEvent(null,null,conduitApi.analytics.usageEventTypeEnum.CouponClaimed,{couponId:this.model.get("id")})},claimCoupon:function(){conduitApi.UI.showToastMessage(null,null,_T("ToastMessageCouponsClaimSuccess"),this.$el);this.setClaimed();this.addClaimUsage();this.renderClaimed()}}); var NoCouponsView=Backbone.View.extend({className:"no_results_container",render:function(){this.$el.html(couponsTemplates.noCoupons({}));var a=this.$(".scroll_wrapper");Scrolling.init(a);return this}}); var CouponsHomeView=Backbone.View.extend({initialize:function(){this.$el.attr({"data-role":"page","data-buttons":"navigation refresh"});this.$el.bind("refresh",this.handleRefreshClick.hitch(this));this.$el.bind("silentRefresh",this.handleSilentRefresh.hitch(this));this.$el.bind("pageshow",this.onPageShow.hitch(this));this.$el.bind("pagehide",this.onPageHide.hitch(this));var a=this.model.get("items");if(a){a.bind("getItemsSuccess",this.onGetItemsSuccess,this);a.bind("getItemsFail",this.onGetItemsFail,this)}this.listView=new CouponsListView({model:this.model})},showNoCouponsView:function(){if(!this.noCouponsView){this.noCouponsView=new NoCouponsView({}).render()}this.$el.html(this.noCouponsView.el).addClass("clr_contTypeB_bg")},onGetItemsSuccess:function(){var b=this.model.get("items");this.listView.$el.detach();if(b.length===1){var a=new CouponFullView({model:b.models[0]});this.$el.html(a.render().el).removeClass("clr_contTypeB_bg")}else{if(b.length===0){this.showNoCouponsView()}else{this.$el.html(this.listView.$el).removeClass("clr_contTypeB_bg")}}},onGetItemsFail:function(){this.showNoCouponsView()},handleRefreshClick:function(){this.listView.handleRefreshClick()},handleSilentRefresh:function(){this.listView.handleSilentRefresh()},onPageShow:function(){this.listView.onPageShow()},onPageHide:function(){this.listView.onPageHide()},addTabsView:function(a){this.getRootView().prepend(a)}}); var couponsTemplates={scroller_tpl:_.template('<div class="scroll_wrapper"><div class="scroller"></div></div>'),list_item_tpl:_.template('<div class="item_container clr_contTypeB_bubbleItem_bg clr_contTypeB_bubbleItem_brdr box" data-role="button"></div>'),couponExpired:_.template('<div class="expired-wrapper">   <div class="expired-ribbon-wrapper"><div class="expired-ribbon clr_appGeneral_ribbon_bg clr_appGeneral_ribbon_brdr clr_appGeneral_ribbon_txt"><%= couponExpired %></div></div></div>'),couponPrimaryTemplate:_.template('<% if (!useDividedScreen) { %>     <% if (isListItem && isGrid) { %> <div class="fixedHeightTexts"> <% } %>	<% if (title) { %> 		<div class="responsive size_title_3 max_2_lines title <%=classPrefix %>_hdlTxt"><%= title %></div>	<% } %> 	<% if (description) { %> 		<div class="responsive size_1 max_3_lines description <%=classPrefix %>_txt"><%= description %></div>	<% } %>     <% if (isListItem && isGrid) { %> </div> <% } %><% } %> <% if (!useDividedScreen || !useBigImage) { %> <div class="<% if (useDividedScreen) { %>top_banner box<% } else { %>main_banner<% } %> <%=classPrefix %>_subBg"> 	<% if (!useDividedScreen) { %> 	<div class="image sliced_image <% if (!isListItem) { %> open_gallery <% } if (useBigImage) { %> big <% } %>" style="background-image:url(\'<%= imageUrl %>\')">		<% if (!isListItem) { %> <div class="full_screen_hint sprite sprite-FullScreenIcon"></div> <% } %>	</div> 	<% } %> 	<% if (!useBigImage){ %> 		<% if (useDividedScreen) { %> 			<div class="horizontal_center">		<% } else { %> 			<div class="offer_container"><div class="vertical_center"><div> 		<% } %> 			<% if (upperTitle) { %> 				<div class="element responsive size_0 _1_line upperTitle <%=classPrefix %>_subTxt"><%=upperTitle%></div> 			<% } %> 			<% if (discountImage) { %> 				<img class="element discountImage" src="<%= discountImage %>" />			<% } else { %> 				<div class="element mainOfferTitle <%=classPrefix %>_hdlTxt" dir="ltr"> 					<span class="symbol currencySymbol" style="font-size:<%= symbolFontSize %>px"><%=currencySymbol%></span> 					<span class="offerTitle" style="font-size:<%= numberFontSize %>px"><%=offerTitle%></span> 					<span class="symbol percentSymbol" style="font-size:<%= symbolFontSize %>px"><%=percentSymbol%></span> 				</div> 			<% } %> 			<% if (lowerTitle) { %> 				<div class="element responsive size_0 _1_line lowerTitle <%=classPrefix %>_subTxt"><%=lowerTitle%></div> 			<% } %> 		<% if (useDividedScreen) { %> 			</div> 		<% } else { %> 			</div></div></div>		<% } %> 	<% } %> </div><% } %>'),data2:_.template('<div class="box_padding"><% if (title) { %> 	<div class="responsive size_title_3 title clr_contTypeB_hdlTxt"><%= title %></div><% } %> <% if (description) { %> 	<div class="responsive size_1 description clr_contTypeB_txt"><%= description %></div><% } %> <% if (largeImage) { %> 	<img class="largeImage" src="<%= largeImage %>" /><% } %> <% if (dealDetails) { %> 	<div class="new_box">		<div class="details_title responsive size_title_1 clr_contTypeB_hdlTxt"><%= detailsTitle %></div>		<div class="deal_details size_1 clr_contTypeB_txt"></div>	</div><% } %></div>'),listItemDates:_.template('<div class="dates_container responsive size_0 _1_line"> 	<% if (startStr) { %> 		<div class="left startStr clr_contTypeB_subTxt"><%= startStr %></div>		<div class="left formattedValidFrom clr_contTypeB_hdlTxt"><%= formattedValidFrom %></div>	<% } %> 	<% if (endStr) { %> 		<div class="right formattedValidUntil clr_contTypeB_hdlTxt"><%= formattedValidUntil %></div>		<div class="right endStr clr_contTypeB_subTxt"><%= endStr %></div>	<% } %> </div>'),claimCoupon:_.template('<a class="button claim_button clr_contTypeB_btn_bg clr_contTypeB_btn_brdr clr_contTypeB_btn_hdlTxt" data-role="button"><%= txt %></a>'),couponClaimed:_.template('<div class="couponClaimed"><div class="iconV mask_sprite sprite-chk_box_v clr_coupons_claimed_icn"></div><%= txt %></div>'),fullCoupon:_.template('<div class="box clr_contTypeA_bg clr_contTypeA_brdr">	<div class="primary_container"></div>	<% if (pricesBanner) { %> 		<div class="banner box clr_contTypeA_subBg clr_contTypeA_hdlTxt responsive size_0"><div class="boxA prices_box" dir="ltr"><span class="boxSymbol currencySymbol"><%=pricesBanner.symbolA%></span><span class="boxNumber responsive size_title_3"><%=pricesBanner.numberA%></span><div class="boxTitle clr_contTypeA_subTxt"><%=pricesBanner.titleA%></div></div><div class="boxB prices_box" dir="ltr"><% if (pricesBanner.symbolB) { %><span class="boxSymbol currencySymbol"><%=pricesBanner.symbolB%></span><% } %><span class="boxNumber responsive size_title_3"><%=pricesBanner.numberB%></span><% if (!pricesBanner.symbolB) { %><span class="boxSymbol percentSymbol">%</span><% } %><div class="boxTitle clr_contTypeA_subTxt"><%=pricesBanner.titleB%></div></div><div class="boxC prices_box" dir="ltr"><% if (pricesBanner.symbolC) { %><span class="boxSymbol currencySymbol"><%=pricesBanner.symbolC%></span><% } %><span class="boxNumber responsive size_title_3"><%=pricesBanner.numberC%></span><% if (!pricesBanner.symbolC) { %><span class="boxSymbol percentSymbol">%</span><% } %><div class="boxTitle clr_contTypeA_subTxt"><%=pricesBanner.titleC%></div></div></div><% } %><% if (disclaimer) { %> <div class="responsive size_1 disclaimer banner box clr_contTypeA_subBg clr_contTypeA_txt"><%= disclaimer %></div><% } %> <div class="share_container"></div></div><% if (hours || validFrom || validUntil || dealDetails || linkUrl) { %> <div class="clr_contTypeB_bg validity"><% if (hours || validFrom || validUntil) { %> <div class="new_box clr_contTypeB_brdr responsive size_title_1 clr_contTypeB_hdlTxt"><%= validityTitle %></div><% } %> <% if (validFrom || validUntil) { %> <div class="validity_box box clr_contTypeB_brdr"><div class="val_icon mask_sprite sprite-cal clr_contTypeB_icn"></div><div class="val_texts_container"><% if (validFrom) { %> <div class="val_text clr_contTypeB_txt responsive size_1"><span class="val_mini_title responsive size_title_1 clr_contTypeB_hdlTxt"><%= validFromTitle %></span><%= validFrom %></div><% } %> <% if (validUntil) { %> <div class="val_text clr_contTypeB_txt responsive size_1"><span class="val_mini_title responsive size_title_1 clr_contTypeB_hdlTxt"><%= validUntilTitle %></span><%= validUntil %></div><% } %> </div></div><% } if (hours) { %> <div class="validity_box box clr_contTypeB_brdr"><div class="val_icon mask_sprite sprite-clock clr_contTypeB_icn"></div><div class="val_texts_container"><% for(var hour in hours) { %><div class="val_text clr_contTypeB_txt responsive size_1"><span class="val_mini_title responsive size_title_1 clr_contTypeB_hdlTxt"><%= hours[hour].daysStr %></span><%= hours[hour].hoursStr %></div><% } %></div></div><% } %> <% if (!useDividedScreen && dealDetails) { %> <div class="new_box"><div class="details_title responsive size_title_1 clr_contTypeA_hdlTxt"><%= detailsTitle %></div><div class="deal_details responsive size_1 clr_contTypeA_txt"></div></div><% } %> <% if (linkUrl) { %> <div class="urlBtn box"><a class="view_original_button clr_contTypeA_actBtn_bg clr_contTypeA_actBtn_brdr clr_contTypeA_actBtn_hdlTxt"href="javascript:void(0)"><%= linkCaption %></a></div><% } %> </div><% } %>'),noCoupons:_.template('<div class="scroll_wrapper"><div class="scroller"><div class="icon mask_sprite sprite-noCoupons clr_contTypeB_subIcn"></div><div class="title responsive size_title_4 clr_contTypeB_hdlTxt"><%= _T("CouponsNoResultsFound") %></div><div class="subtitle responsive size_title_1 clr_contTypeB_subTxt"><%= _T("CouponsNoResultsFoundSubtitle") %></div></div></div>')}; var subscribeTemplates={page:_.template('<div class="scroll_wrapper"><div class="scroller"><div class="content_container"></div></div></div>'),buttonsSection:_.template('<div class="size_title_3 buttons_title big_title clr_contTypeB_hdlTxt"><%= followBlogTitle %></div><div class="size_title_0 buttons_title2 clr_contTypeB_subTxt"><%= discoverStaticString %></div><div class="buttons_container2"><div class="buttons_container"></div></div>'),button:_.template('<div class="button_container"><a class="button_link button clr_contTypeB_btn_bg clr_contTypeB_btn_brdr clr_contTypeB_btn_hdlTxt" data-role="button" href="<%= url %>"><div><img class="button_image" src="<%= image %>" /></div><%= title %></a></div>'),pageContent:_.template('<div id="subscribe-title" class="size_title_3 buttons_title big_title clr_contTypeB_hdlTxt"><%= subscribeTitle %></div><div class="subscribe_container"><div class="input_container"><input type="email" placeholder="<%= placeholder %>" class="email_input clr_form_input_bg clr_form_input_brdr clr_form_input_txt" /></div><div class="subscribe_button_container"><a class="subscribe_button button clr_contTypeB_btn_bg clr_contTypeB_btn_brdr clr_contTypeB_btn_hdlTxt" data-role="button"><%= subscribeText %></a></div></div>')}; var SubscribeModel=Backbone.Model.extend({defaults:{buttons:[],token:"",blogTitle:""},subscribe:function(c,d){var f=this;var a=function(g){f.trigger("subscribeSuccess",f)};var e=function(g){f.trigger("subscribeFail",f)};var b={dataType:"jsonp"};Services.executeService("WIBIYA_SUBSCRIBE_GET",{email:c,token:d},a,e,b)}}); var SubscribeView=Backbone.View.extend({tagName:"div",className:"clr_contTypeB_bg",id:"home_"+Utils.Helpers.generateGUID(),events:{"tap .subscribe_button.active":"_subscribeButtonClick"},initialize:function(){this.$el.attr({"data-role":"page","data-buttons":"navigation"});this.model.bind("subscribeSuccess",this.onSubscribeSuccess,this);this.model.bind("subscribeFail",this.onSubscribeFail,this)},render:function(){this.$el.html(subscribeTemplates.page({})).addClass("subscribe_page");var a=this.$el.find(".content_container");var g=this.model.get("buttons");var e=this.model.get("blogTitle");if(g&&g.length>0){var c=_T("HtmlTextSubscribeFollowBlogTitle",{blogTitle:e});var f=_T("HtmlTextSubscribeDiscoverString");a.html(subscribeTemplates.buttonsSection({followBlogTitle:c,discoverStaticString:f}));var i=a.find(".buttons_container");var d=96;var j=4;var b=(d*g.length)+(j*(g.length-1));i.css({marginLeft:"-"+Math.floor(b/2)+"px",width:b+"px"});var h=function(l){l.preventDefault();var k=$(this).attr("href");if(conduitApi.app.isSupported()){conduitApi.app.openLink(null,null,{url:k,title:k})}return false};$.each(g,function(l,k){var p=_T("HtmlTextSubscribeUnknownButton");var o="";if(k.type==="facebook"){p=_T("HtmlTextSubscribeFacebookButton");o="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAhCAYAAAC4JqlRAAAACXBIWXMAAAsTAAALEwEAmpwYAAAKT2lDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVNnVFPpFj333vRCS4iAlEtvUhUIIFJCi4AUkSYqIQkQSoghodkVUcERRUUEG8igiAOOjoCMFVEsDIoK2AfkIaKOg6OIisr74Xuja9a89+bN/rXXPues852zzwfACAyWSDNRNYAMqUIeEeCDx8TG4eQuQIEKJHAAEAizZCFz/SMBAPh+PDwrIsAHvgABeNMLCADATZvAMByH/w/qQplcAYCEAcB0kThLCIAUAEB6jkKmAEBGAYCdmCZTAKAEAGDLY2LjAFAtAGAnf+bTAICd+Jl7AQBblCEVAaCRACATZYhEAGg7AKzPVopFAFgwABRmS8Q5ANgtADBJV2ZIALC3AMDOEAuyAAgMADBRiIUpAAR7AGDIIyN4AISZABRG8lc88SuuEOcqAAB4mbI8uSQ5RYFbCC1xB1dXLh4ozkkXKxQ2YQJhmkAuwnmZGTKBNA/g88wAAKCRFRHgg/P9eM4Ors7ONo62Dl8t6r8G/yJiYuP+5c+rcEAAAOF0ftH+LC+zGoA7BoBt/qIl7gRoXgugdfeLZrIPQLUAoOnaV/Nw+H48PEWhkLnZ2eXk5NhKxEJbYcpXff5nwl/AV/1s+X48/Pf14L7iJIEyXYFHBPjgwsz0TKUcz5IJhGLc5o9H/LcL//wd0yLESWK5WCoU41EScY5EmozzMqUiiUKSKcUl0v9k4t8s+wM+3zUAsGo+AXuRLahdYwP2SycQWHTA4vcAAPK7b8HUKAgDgGiD4c93/+8//UegJQCAZkmScQAAXkQkLlTKsz/HCAAARKCBKrBBG/TBGCzABhzBBdzBC/xgNoRCJMTCQhBCCmSAHHJgKayCQiiGzbAdKmAv1EAdNMBRaIaTcA4uwlW4Dj1wD/phCJ7BKLyBCQRByAgTYSHaiAFiilgjjggXmYX4IcFIBBKLJCDJiBRRIkuRNUgxUopUIFVIHfI9cgI5h1xGupE7yAAygvyGvEcxlIGyUT3UDLVDuag3GoRGogvQZHQxmo8WoJvQcrQaPYw2oefQq2gP2o8+Q8cwwOgYBzPEbDAuxsNCsTgsCZNjy7EirAyrxhqwVqwDu4n1Y8+xdwQSgUXACTYEd0IgYR5BSFhMWE7YSKggHCQ0EdoJNwkDhFHCJyKTqEu0JroR+cQYYjIxh1hILCPWEo8TLxB7iEPENyQSiUMyJ7mQAkmxpFTSEtJG0m5SI+ksqZs0SBojk8naZGuyBzmULCAryIXkneTD5DPkG+Qh8lsKnWJAcaT4U+IoUspqShnlEOU05QZlmDJBVaOaUt2ooVQRNY9aQq2htlKvUYeoEzR1mjnNgxZJS6WtopXTGmgXaPdpr+h0uhHdlR5Ol9BX0svpR+iX6AP0dwwNhhWDx4hnKBmbGAcYZxl3GK+YTKYZ04sZx1QwNzHrmOeZD5lvVVgqtip8FZHKCpVKlSaVGyovVKmqpqreqgtV81XLVI+pXlN9rkZVM1PjqQnUlqtVqp1Q61MbU2epO6iHqmeob1Q/pH5Z/YkGWcNMw09DpFGgsV/jvMYgC2MZs3gsIWsNq4Z1gTXEJrHN2Xx2KruY/R27iz2qqaE5QzNKM1ezUvOUZj8H45hx+Jx0TgnnKKeX836K3hTvKeIpG6Y0TLkxZVxrqpaXllirSKtRq0frvTau7aedpr1Fu1n7gQ5Bx0onXCdHZ4/OBZ3nU9lT3acKpxZNPTr1ri6qa6UbobtEd79up+6Ynr5egJ5Mb6feeb3n+hx9L/1U/W36p/VHDFgGswwkBtsMzhg8xTVxbzwdL8fb8VFDXcNAQ6VhlWGX4YSRudE8o9VGjUYPjGnGXOMk423GbcajJgYmISZLTepN7ppSTbmmKaY7TDtMx83MzaLN1pk1mz0x1zLnm+eb15vft2BaeFostqi2uGVJsuRaplnutrxuhVo5WaVYVVpds0atna0l1rutu6cRp7lOk06rntZnw7Dxtsm2qbcZsOXYBtuutm22fWFnYhdnt8Wuw+6TvZN9un2N/T0HDYfZDqsdWh1+c7RyFDpWOt6azpzuP33F9JbpL2dYzxDP2DPjthPLKcRpnVOb00dnF2e5c4PziIuJS4LLLpc+Lpsbxt3IveRKdPVxXeF60vWdm7Obwu2o26/uNu5p7ofcn8w0nymeWTNz0MPIQ+BR5dE/C5+VMGvfrH5PQ0+BZ7XnIy9jL5FXrdewt6V3qvdh7xc+9j5yn+M+4zw33jLeWV/MN8C3yLfLT8Nvnl+F30N/I/9k/3r/0QCngCUBZwOJgUGBWwL7+Hp8Ib+OPzrbZfay2e1BjKC5QRVBj4KtguXBrSFoyOyQrSH355jOkc5pDoVQfujW0Adh5mGLw34MJ4WHhVeGP45wiFga0TGXNXfR3ENz30T6RJZE3ptnMU85ry1KNSo+qi5qPNo3ujS6P8YuZlnM1VidWElsSxw5LiquNm5svt/87fOH4p3iC+N7F5gvyF1weaHOwvSFpxapLhIsOpZATIhOOJTwQRAqqBaMJfITdyWOCnnCHcJnIi/RNtGI2ENcKh5O8kgqTXqS7JG8NXkkxTOlLOW5hCepkLxMDUzdmzqeFpp2IG0yPTq9MYOSkZBxQqohTZO2Z+pn5mZ2y6xlhbL+xW6Lty8elQfJa7OQrAVZLQq2QqboVFoo1yoHsmdlV2a/zYnKOZarnivN7cyzytuQN5zvn//tEsIS4ZK2pYZLVy0dWOa9rGo5sjxxedsK4xUFK4ZWBqw8uIq2Km3VT6vtV5eufr0mek1rgV7ByoLBtQFr6wtVCuWFfevc1+1dT1gvWd+1YfqGnRs+FYmKrhTbF5cVf9go3HjlG4dvyr+Z3JS0qavEuWTPZtJm6ebeLZ5bDpaql+aXDm4N2dq0Dd9WtO319kXbL5fNKNu7g7ZDuaO/PLi8ZafJzs07P1SkVPRU+lQ27tLdtWHX+G7R7ht7vPY07NXbW7z3/T7JvttVAVVN1WbVZftJ+7P3P66Jqun4lvttXa1ObXHtxwPSA/0HIw6217nU1R3SPVRSj9Yr60cOxx++/p3vdy0NNg1VjZzG4iNwRHnk6fcJ3/ceDTradox7rOEH0x92HWcdL2pCmvKaRptTmvtbYlu6T8w+0dbq3nr8R9sfD5w0PFl5SvNUyWna6YLTk2fyz4ydlZ19fi753GDborZ752PO32oPb++6EHTh0kX/i+c7vDvOXPK4dPKy2+UTV7hXmq86X23qdOo8/pPTT8e7nLuarrlca7nuer21e2b36RueN87d9L158Rb/1tWeOT3dvfN6b/fF9/XfFt1+cif9zsu72Xcn7q28T7xf9EDtQdlD3YfVP1v+3Njv3H9qwHeg89HcR/cGhYPP/pH1jw9DBY+Zj8uGDYbrnjg+OTniP3L96fynQ89kzyaeF/6i/suuFxYvfvjV69fO0ZjRoZfyl5O/bXyl/erA6xmv28bCxh6+yXgzMV70VvvtwXfcdx3vo98PT+R8IH8o/2j5sfVT0Kf7kxmTk/8EA5jz/GMzLdsAAAAgY0hSTQAAeiUAAICDAAD5/wAAgOkAAHUwAADqYAAAOpgAABdvkl/FRgAAAo9JREFUeNrsl7trFFEUxn/33pmd3U2iMRIxISrGdOkUREElAbFKK4JVChW1EtJo4x8gKGlEJJWCCmphYQS7FGoKBS18NCJCgq+Y5252nde9FskmbmaHLLsTt8kHA8Pcwz3f5Xz3O2eEMYZGwiq9HD49/F+ZjN+/JABkI5L/m1MCBKFOdHNjwBhT9qxFKacFoLUGJetO7Achnh9iKYlSEiHEypoS5bFa63IN1Is/rs/eru0c3d/Nns422lqz2JZCAPmCy/U7Y8wuFFFSVBZhvckH+noZGuyntSUTWXe9gJsPXmJMAUiYgOeH7NvdzuUzx2nKpGIJxl33ugsfhCH9B3tikwM4KQsh1vGBerCrozXy7evkDM9efCIMNa4XkCu4SCk2hoAkuvHtR694+PwdTZkUQkDGsZFigwiYGG00Z1Nk06nqrLgWs/GDENcL0DpKQWuD6wVYSiIQ2LZKjkAQatq3NXP1wgm2NKfp3LE1EjM02MfZk4eQQjCXK3JleJRC0YvowKrt9AbbUvT2dNDS5FSM6dq5Ksyf0zk8P6h4E2TtJTD4flhV7Pephdh+U5cPBFpjlvVQiaBeXvj2a54w1BEXrLkEllLMLhQYuvaEUGvOnzrCsQPdZTE37o7x5v0E2XSK37P5JTGKhEQoBPiB5sPnHywWXWbmFyMxXyameftxkkzaxlISy1LJXkMhliw21Bolo5VM2Yq0Y5N27HVMrMHYJLBJYJNAIgQqTToibgZLeiARQKHoky+4Kz1hySlDRLUEKg0U1SLt2Iw8Hufe09dlTWkuV8Rx4s9XymmVxicpBVLWVpHpuTxTaw6x+mcUMy0tt3JRmtcHLo4Y1wsq1jNJaG1I2YrRW+dEGYFG4e8AGSYNLAl5NQkAAAAASUVORK5CYII="}else{if(k.type==="twitter"){p=_T("HtmlTextSubscribeTwitterButton");o="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAhCAYAAAC4JqlRAAAACXBIWXMAAAsTAAALEwEAmpwYAAAKT2lDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVNnVFPpFj333vRCS4iAlEtvUhUIIFJCi4AUkSYqIQkQSoghodkVUcERRUUEG8igiAOOjoCMFVEsDIoK2AfkIaKOg6OIisr74Xuja9a89+bN/rXXPues852zzwfACAyWSDNRNYAMqUIeEeCDx8TG4eQuQIEKJHAAEAizZCFz/SMBAPh+PDwrIsAHvgABeNMLCADATZvAMByH/w/qQplcAYCEAcB0kThLCIAUAEB6jkKmAEBGAYCdmCZTAKAEAGDLY2LjAFAtAGAnf+bTAICd+Jl7AQBblCEVAaCRACATZYhEAGg7AKzPVopFAFgwABRmS8Q5ANgtADBJV2ZIALC3AMDOEAuyAAgMADBRiIUpAAR7AGDIIyN4AISZABRG8lc88SuuEOcqAAB4mbI8uSQ5RYFbCC1xB1dXLh4ozkkXKxQ2YQJhmkAuwnmZGTKBNA/g88wAAKCRFRHgg/P9eM4Ors7ONo62Dl8t6r8G/yJiYuP+5c+rcEAAAOF0ftH+LC+zGoA7BoBt/qIl7gRoXgugdfeLZrIPQLUAoOnaV/Nw+H48PEWhkLnZ2eXk5NhKxEJbYcpXff5nwl/AV/1s+X48/Pf14L7iJIEyXYFHBPjgwsz0TKUcz5IJhGLc5o9H/LcL//wd0yLESWK5WCoU41EScY5EmozzMqUiiUKSKcUl0v9k4t8s+wM+3zUAsGo+AXuRLahdYwP2SycQWHTA4vcAAPK7b8HUKAgDgGiD4c93/+8//UegJQCAZkmScQAAXkQkLlTKsz/HCAAARKCBKrBBG/TBGCzABhzBBdzBC/xgNoRCJMTCQhBCCmSAHHJgKayCQiiGzbAdKmAv1EAdNMBRaIaTcA4uwlW4Dj1wD/phCJ7BKLyBCQRByAgTYSHaiAFiilgjjggXmYX4IcFIBBKLJCDJiBRRIkuRNUgxUopUIFVIHfI9cgI5h1xGupE7yAAygvyGvEcxlIGyUT3UDLVDuag3GoRGogvQZHQxmo8WoJvQcrQaPYw2oefQq2gP2o8+Q8cwwOgYBzPEbDAuxsNCsTgsCZNjy7EirAyrxhqwVqwDu4n1Y8+xdwQSgUXACTYEd0IgYR5BSFhMWE7YSKggHCQ0EdoJNwkDhFHCJyKTqEu0JroR+cQYYjIxh1hILCPWEo8TLxB7iEPENyQSiUMyJ7mQAkmxpFTSEtJG0m5SI+ksqZs0SBojk8naZGuyBzmULCAryIXkneTD5DPkG+Qh8lsKnWJAcaT4U+IoUspqShnlEOU05QZlmDJBVaOaUt2ooVQRNY9aQq2htlKvUYeoEzR1mjnNgxZJS6WtopXTGmgXaPdpr+h0uhHdlR5Ol9BX0svpR+iX6AP0dwwNhhWDx4hnKBmbGAcYZxl3GK+YTKYZ04sZx1QwNzHrmOeZD5lvVVgqtip8FZHKCpVKlSaVGyovVKmqpqreqgtV81XLVI+pXlN9rkZVM1PjqQnUlqtVqp1Q61MbU2epO6iHqmeob1Q/pH5Z/YkGWcNMw09DpFGgsV/jvMYgC2MZs3gsIWsNq4Z1gTXEJrHN2Xx2KruY/R27iz2qqaE5QzNKM1ezUvOUZj8H45hx+Jx0TgnnKKeX836K3hTvKeIpG6Y0TLkxZVxrqpaXllirSKtRq0frvTau7aedpr1Fu1n7gQ5Bx0onXCdHZ4/OBZ3nU9lT3acKpxZNPTr1ri6qa6UbobtEd79up+6Ynr5egJ5Mb6feeb3n+hx9L/1U/W36p/VHDFgGswwkBtsMzhg8xTVxbzwdL8fb8VFDXcNAQ6VhlWGX4YSRudE8o9VGjUYPjGnGXOMk423GbcajJgYmISZLTepN7ppSTbmmKaY7TDtMx83MzaLN1pk1mz0x1zLnm+eb15vft2BaeFostqi2uGVJsuRaplnutrxuhVo5WaVYVVpds0atna0l1rutu6cRp7lOk06rntZnw7Dxtsm2qbcZsOXYBtuutm22fWFnYhdnt8Wuw+6TvZN9un2N/T0HDYfZDqsdWh1+c7RyFDpWOt6azpzuP33F9JbpL2dYzxDP2DPjthPLKcRpnVOb00dnF2e5c4PziIuJS4LLLpc+Lpsbxt3IveRKdPVxXeF60vWdm7Obwu2o26/uNu5p7ofcn8w0nymeWTNz0MPIQ+BR5dE/C5+VMGvfrH5PQ0+BZ7XnIy9jL5FXrdewt6V3qvdh7xc+9j5yn+M+4zw33jLeWV/MN8C3yLfLT8Nvnl+F30N/I/9k/3r/0QCngCUBZwOJgUGBWwL7+Hp8Ib+OPzrbZfay2e1BjKC5QRVBj4KtguXBrSFoyOyQrSH355jOkc5pDoVQfujW0Adh5mGLw34MJ4WHhVeGP45wiFga0TGXNXfR3ENz30T6RJZE3ptnMU85ry1KNSo+qi5qPNo3ujS6P8YuZlnM1VidWElsSxw5LiquNm5svt/87fOH4p3iC+N7F5gvyF1weaHOwvSFpxapLhIsOpZATIhOOJTwQRAqqBaMJfITdyWOCnnCHcJnIi/RNtGI2ENcKh5O8kgqTXqS7JG8NXkkxTOlLOW5hCepkLxMDUzdmzqeFpp2IG0yPTq9MYOSkZBxQqohTZO2Z+pn5mZ2y6xlhbL+xW6Lty8elQfJa7OQrAVZLQq2QqboVFoo1yoHsmdlV2a/zYnKOZarnivN7cyzytuQN5zvn//tEsIS4ZK2pYZLVy0dWOa9rGo5sjxxedsK4xUFK4ZWBqw8uIq2Km3VT6vtV5eufr0mek1rgV7ByoLBtQFr6wtVCuWFfevc1+1dT1gvWd+1YfqGnRs+FYmKrhTbF5cVf9go3HjlG4dvyr+Z3JS0qavEuWTPZtJm6ebeLZ5bDpaql+aXDm4N2dq0Dd9WtO319kXbL5fNKNu7g7ZDuaO/PLi8ZafJzs07P1SkVPRU+lQ27tLdtWHX+G7R7ht7vPY07NXbW7z3/T7JvttVAVVN1WbVZftJ+7P3P66Jqun4lvttXa1ObXHtxwPSA/0HIw6217nU1R3SPVRSj9Yr60cOxx++/p3vdy0NNg1VjZzG4iNwRHnk6fcJ3/ceDTradox7rOEH0x92HWcdL2pCmvKaRptTmvtbYlu6T8w+0dbq3nr8R9sfD5w0PFl5SvNUyWna6YLTk2fyz4ydlZ19fi753GDborZ752PO32oPb++6EHTh0kX/i+c7vDvOXPK4dPKy2+UTV7hXmq86X23qdOo8/pPTT8e7nLuarrlca7nuer21e2b36RueN87d9L158Rb/1tWeOT3dvfN6b/fF9/XfFt1+cif9zsu72Xcn7q28T7xf9EDtQdlD3YfVP1v+3Njv3H9qwHeg89HcR/cGhYPP/pH1jw9DBY+Zj8uGDYbrnjg+OTniP3L96fynQ89kzyaeF/6i/suuFxYvfvjV69fO0ZjRoZfyl5O/bXyl/erA6xmv28bCxh6+yXgzMV70VvvtwXfcdx3vo98PT+R8IH8o/2j5sfVT0Kf7kxmTk/8EA5jz/GMzLdsAAAAgY0hSTQAAeiUAAICDAAD5/wAAgOkAAHUwAADqYAAAOpgAABdvkl/FRgAAAoJJREFUeNrEmL9v00AUxz/vbDeUlkJbyo9KZWFAQqJ7WbqWBYkF8S+wMvEvMDP0j0BIrToyMSB2BqQKqAQqFTShKS2EJL67x2C7jZrECYlDTjrJss/3Pn733vfdWVSVcbYwu3i83fivJOu3SgJgxmG81aYBcH284DXpRbXMpskm72oYiBUmg6THBYFkc4R5gxQIBB4sBKzMBAC8PXJslh0+oy8qCDu12MO9+ZC1ueDk3tpcyB8HWxVHqQAC0+vrl6fbhyxPGwJJxowMAECAUDq/FEgxwdjTidrnvZHEQB5Uw596qePE0p+XBgKYNMKdNDa62dhvevabMGFGALBYEp4sRbljjqzysmx5c+iJzBAxMGibCYVHV0OulQSrYwDIlmohEty4AA5iZbehHVN5qBiwCoepX6VLllQtbJQtVatERQPsNjzPd21HAEkBjq3iINf44B7w8NMqkpOGRiAaVogUsKptZiYDYUKSpRhWkk1eHfDAgW1/dr0k3L0YUPNQ94kqdupOh/SAU/hY86zMmDbqh1dClkrCl4a21QYjiRB9rClHboggjAy8++U4tAGXzuTShIHV2SD36/YayvrXmG/N7qmYqwMB8COGrYodaH0XS8L9y2FuBe0pRBMGXlc9r6puIIgb5yRXiHoCSLr5ePHdslG2xP+4GfhQ88Q+p2z3lSrp9mur4nj/W1mdNdyeMkwZITKn4tMKbRW2a57NisMUoYSSLsdO3bOz57kQwnwknDdyAtjq1rpXPteVWCm2FkSp/NUcHDul29lSJDEc9iPFg+zxjKQBNKASaitA7EHMiGvz2dNWtqfMXPj0U0ObntyAKcS4JgL37GZyOpZx/x/4OwArqPhLz9HUqQAAAABJRU5ErkJggg=="}else{if(k.type==="linkedin"){p=_T("HtmlTextSubscribeLinkedInButton");o="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAhCAYAAAC4JqlRAAAACXBIWXMAAAsTAAALEwEAmpwYAAAKT2lDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVNnVFPpFj333vRCS4iAlEtvUhUIIFJCi4AUkSYqIQkQSoghodkVUcERRUUEG8igiAOOjoCMFVEsDIoK2AfkIaKOg6OIisr74Xuja9a89+bN/rXXPues852zzwfACAyWSDNRNYAMqUIeEeCDx8TG4eQuQIEKJHAAEAizZCFz/SMBAPh+PDwrIsAHvgABeNMLCADATZvAMByH/w/qQplcAYCEAcB0kThLCIAUAEB6jkKmAEBGAYCdmCZTAKAEAGDLY2LjAFAtAGAnf+bTAICd+Jl7AQBblCEVAaCRACATZYhEAGg7AKzPVopFAFgwABRmS8Q5ANgtADBJV2ZIALC3AMDOEAuyAAgMADBRiIUpAAR7AGDIIyN4AISZABRG8lc88SuuEOcqAAB4mbI8uSQ5RYFbCC1xB1dXLh4ozkkXKxQ2YQJhmkAuwnmZGTKBNA/g88wAAKCRFRHgg/P9eM4Ors7ONo62Dl8t6r8G/yJiYuP+5c+rcEAAAOF0ftH+LC+zGoA7BoBt/qIl7gRoXgugdfeLZrIPQLUAoOnaV/Nw+H48PEWhkLnZ2eXk5NhKxEJbYcpXff5nwl/AV/1s+X48/Pf14L7iJIEyXYFHBPjgwsz0TKUcz5IJhGLc5o9H/LcL//wd0yLESWK5WCoU41EScY5EmozzMqUiiUKSKcUl0v9k4t8s+wM+3zUAsGo+AXuRLahdYwP2SycQWHTA4vcAAPK7b8HUKAgDgGiD4c93/+8//UegJQCAZkmScQAAXkQkLlTKsz/HCAAARKCBKrBBG/TBGCzABhzBBdzBC/xgNoRCJMTCQhBCCmSAHHJgKayCQiiGzbAdKmAv1EAdNMBRaIaTcA4uwlW4Dj1wD/phCJ7BKLyBCQRByAgTYSHaiAFiilgjjggXmYX4IcFIBBKLJCDJiBRRIkuRNUgxUopUIFVIHfI9cgI5h1xGupE7yAAygvyGvEcxlIGyUT3UDLVDuag3GoRGogvQZHQxmo8WoJvQcrQaPYw2oefQq2gP2o8+Q8cwwOgYBzPEbDAuxsNCsTgsCZNjy7EirAyrxhqwVqwDu4n1Y8+xdwQSgUXACTYEd0IgYR5BSFhMWE7YSKggHCQ0EdoJNwkDhFHCJyKTqEu0JroR+cQYYjIxh1hILCPWEo8TLxB7iEPENyQSiUMyJ7mQAkmxpFTSEtJG0m5SI+ksqZs0SBojk8naZGuyBzmULCAryIXkneTD5DPkG+Qh8lsKnWJAcaT4U+IoUspqShnlEOU05QZlmDJBVaOaUt2ooVQRNY9aQq2htlKvUYeoEzR1mjnNgxZJS6WtopXTGmgXaPdpr+h0uhHdlR5Ol9BX0svpR+iX6AP0dwwNhhWDx4hnKBmbGAcYZxl3GK+YTKYZ04sZx1QwNzHrmOeZD5lvVVgqtip8FZHKCpVKlSaVGyovVKmqpqreqgtV81XLVI+pXlN9rkZVM1PjqQnUlqtVqp1Q61MbU2epO6iHqmeob1Q/pH5Z/YkGWcNMw09DpFGgsV/jvMYgC2MZs3gsIWsNq4Z1gTXEJrHN2Xx2KruY/R27iz2qqaE5QzNKM1ezUvOUZj8H45hx+Jx0TgnnKKeX836K3hTvKeIpG6Y0TLkxZVxrqpaXllirSKtRq0frvTau7aedpr1Fu1n7gQ5Bx0onXCdHZ4/OBZ3nU9lT3acKpxZNPTr1ri6qa6UbobtEd79up+6Ynr5egJ5Mb6feeb3n+hx9L/1U/W36p/VHDFgGswwkBtsMzhg8xTVxbzwdL8fb8VFDXcNAQ6VhlWGX4YSRudE8o9VGjUYPjGnGXOMk423GbcajJgYmISZLTepN7ppSTbmmKaY7TDtMx83MzaLN1pk1mz0x1zLnm+eb15vft2BaeFostqi2uGVJsuRaplnutrxuhVo5WaVYVVpds0atna0l1rutu6cRp7lOk06rntZnw7Dxtsm2qbcZsOXYBtuutm22fWFnYhdnt8Wuw+6TvZN9un2N/T0HDYfZDqsdWh1+c7RyFDpWOt6azpzuP33F9JbpL2dYzxDP2DPjthPLKcRpnVOb00dnF2e5c4PziIuJS4LLLpc+Lpsbxt3IveRKdPVxXeF60vWdm7Obwu2o26/uNu5p7ofcn8w0nymeWTNz0MPIQ+BR5dE/C5+VMGvfrH5PQ0+BZ7XnIy9jL5FXrdewt6V3qvdh7xc+9j5yn+M+4zw33jLeWV/MN8C3yLfLT8Nvnl+F30N/I/9k/3r/0QCngCUBZwOJgUGBWwL7+Hp8Ib+OPzrbZfay2e1BjKC5QRVBj4KtguXBrSFoyOyQrSH355jOkc5pDoVQfujW0Adh5mGLw34MJ4WHhVeGP45wiFga0TGXNXfR3ENz30T6RJZE3ptnMU85ry1KNSo+qi5qPNo3ujS6P8YuZlnM1VidWElsSxw5LiquNm5svt/87fOH4p3iC+N7F5gvyF1weaHOwvSFpxapLhIsOpZATIhOOJTwQRAqqBaMJfITdyWOCnnCHcJnIi/RNtGI2ENcKh5O8kgqTXqS7JG8NXkkxTOlLOW5hCepkLxMDUzdmzqeFpp2IG0yPTq9MYOSkZBxQqohTZO2Z+pn5mZ2y6xlhbL+xW6Lty8elQfJa7OQrAVZLQq2QqboVFoo1yoHsmdlV2a/zYnKOZarnivN7cyzytuQN5zvn//tEsIS4ZK2pYZLVy0dWOa9rGo5sjxxedsK4xUFK4ZWBqw8uIq2Km3VT6vtV5eufr0mek1rgV7ByoLBtQFr6wtVCuWFfevc1+1dT1gvWd+1YfqGnRs+FYmKrhTbF5cVf9go3HjlG4dvyr+Z3JS0qavEuWTPZtJm6ebeLZ5bDpaql+aXDm4N2dq0Dd9WtO319kXbL5fNKNu7g7ZDuaO/PLi8ZafJzs07P1SkVPRU+lQ27tLdtWHX+G7R7ht7vPY07NXbW7z3/T7JvttVAVVN1WbVZftJ+7P3P66Jqun4lvttXa1ObXHtxwPSA/0HIw6217nU1R3SPVRSj9Yr60cOxx++/p3vdy0NNg1VjZzG4iNwRHnk6fcJ3/ceDTradox7rOEH0x92HWcdL2pCmvKaRptTmvtbYlu6T8w+0dbq3nr8R9sfD5w0PFl5SvNUyWna6YLTk2fyz4ydlZ19fi753GDborZ752PO32oPb++6EHTh0kX/i+c7vDvOXPK4dPKy2+UTV7hXmq86X23qdOo8/pPTT8e7nLuarrlca7nuer21e2b36RueN87d9L158Rb/1tWeOT3dvfN6b/fF9/XfFt1+cif9zsu72Xcn7q28T7xf9EDtQdlD3YfVP1v+3Njv3H9qwHeg89HcR/cGhYPP/pH1jw9DBY+Zj8uGDYbrnjg+OTniP3L96fynQ89kzyaeF/6i/suuFxYvfvjV69fO0ZjRoZfyl5O/bXyl/erA6xmv28bCxh6+yXgzMV70VvvtwXfcdx3vo98PT+R8IH8o/2j5sfVT0Kf7kxmTk/8EA5jz/GMzLdsAAAAgY0hSTQAAeiUAAICDAAD5/wAAgOkAAHUwAADqYAAAOpgAABdvkl/FRgAAAzZJREFUeNrsl89vVFUUxz/nvjdvpkNbZrCNo21Bk6aYFEVqTJTEGCDgwoUJicaFeyPGpTsTN+xYsSBxY/gDjGEDCxIgMZTERAOKkoCNpKVULDgdO7bz8717XEyn8Dp3oEOdduNZTCZvztz7fed93/f7vaKqbGX5zS+HTlzcVCQXPz8kAGYrNgd44/h5XQWwldUWQGSVamgJrW4+gFpoGehNMrEzS64/RS203Sfho5sfGc/xycExsumAUi3k68u/8+2PswS+6e4EIqsM9CX57PBuBnqTeEboSyU4dmCMkR1pwki7C8Cq0pdKkOkJYk2Bb+hLJfA86S4A3xjyS1WuTD2INV27U+BuoYR0mwMiUKlHHD/7K0cnRhjL9TP91xJnrt6lUo82h4QAxXKd05O3H47JQNL3EKAW2RYuJBONQVZDixFBAFXFAknfYEQ6A3Bk/Dky6QSqjakUyyGXp+5TqUfsGcqwO9dP00M8I1y6OU+xXOfdV4aY2JUluy1gfrHCT7MFrkw9oFKPSHjmyQBUwQh8/PYouUzP6vX5YoXvbs1TCy0HXnqW91/fGSPuTL7E0deG2T86GFv8vX3D3PhjkS/PXOf+PxUnCDestSNTsCt3a9b8ZET46M0X2D86iMtYx5/fzokP9hH4HtbR0EZZ4o2FUo3Uigi5lGDvSBZVqIaRU7pfHOzl8HjOqSP+epjqGVnd2JUfrConL9zi6vQCvSmfTw+O8fJwJtbz6kiW87/cW78ZtSvXBE5P3ubcz3PcWyxz888ipy791uIfue0pXC+D6Vy5Wle5dmchRuS5QplozaNIB75TyDp3F8cqjz4VAUJrWarWN5YHOsIkrjzB5gHoSiL6H8CGF5YNAEglvJZA0qyewG+R1LVuJ0KL7reLc75L9a7P/s1QNk01jPCMMJNfxioYI8wtlLgxt4hvBJGGQi5Xw9jmnjH8MJ1n1zPbGv8TmMkvu98gVW05mERWEcHp47ryIU8YsWpDFNq1LVdDvv/iHXF6gTHy2Pglsj7BkqflgHQmhE/V16SR/zBKNUbe7UOiANbqqldI014//GpSS7XosfntvyhVJfAN3xx7S2IAtqr+HQC96jU6kYMfUAAAAABJRU5ErkJggg=="}}}var n=$(subscribeTemplates.button({url:k.url,image:o,title:p}));var m=j;if((!IS_RTL&&(l===0))||(IS_RTL&&(l===(g.length-1)))){m=0}n.css({marginLeft:m+"px",width:d+"px"}).find("a").tap(h);i.append(n)})}a.append(subscribeTemplates.pageContent({subscribeTitle:_T("HtmlTextSubscribeSubscribeString",{blogTitle:e}),placeholder:_T("HtmlTextSubscribeInsetYourEmail"),subscribeText:_T("HtmlTextSubscribeSubscribeButton")}));this.$subscribeButton=a.find(".subscribe_button");this._setSubscribeButtonActive();Scrolling.init(this.$el.find(".scroll_wrapper"));return this},_isEmailValid:function(a){return Utils.Helpers.isValidEmail(a)},_subscribeButtonClick:function(b){b.preventDefault();this.$emailInput.blur();var c=this.$emailInput.val();if(c===""){conduitApi.UI.showToastMessage(null,null,_T("ToastMessageSubscribeInsetEmail"),this.$el);return}if(!this._isEmailValid(c)){conduitApi.UI.showToastMessage(null,null,_T("ToastMessageSubscribeInvalidEmail"),this.$el);return}this._setSubscribeButtonLoading();var a=this.model.get("token")||"";this.model.subscribe(c,a)},onSubscribeSuccess:function(){var a=[{text:_T("ButtonClose")}];conduitApi.UI.showDialogBox(null,null,{title:_T("DialogCaptionSubscribeSuccess"),message:_T("DialogMessageSubscribeSubscribeSuccess"),buttons:a});this._setSubscribeButtonActive()},onSubscribeFail:function(){var a=[{text:_T("ButtonClose")}];conduitApi.UI.showDialogBox(null,null,{title:_T("DialogCaptionSubscribeFail"),message:_T("DialogMessageSubscribeFailed"),buttons:a});this._setSubscribeButtonActive()},_setSubscribeButtonActive:function(){conduitApi.UI.dismissActivityIndicator(null,null,this.$el);if(!this.$subscribeButton){return}this.$subscribeButton.html("Subscribe").addClass("active")},_setSubscribeButtonLoading:function(){conduitApi.UI.startActivityIndicator(function(){if(!this.$subscribeButton){return}this.$subscribeButton.html(_T("HtmlTextSubscribeLoading")).removeClass("active")}.hitch(this),null,_T("IndicatorLoading"),this.$el)},getChangePageParams:function(){var a={pageId:this.id,changeHash:true};return a}}); var SubscribeTemplateView=TemplateView.extend({render:function(a){var c=this.model.get("meta");var d=new SubscribeModel(c);var b=new SubscribeView({model:d});this._changePageParams.homePageId=b.id;this.$el.append(b.render().el);this._homePagesViews[a]=b;return this}}); var videoTemplates={scroller:_.template('<div class="scroll_wrapper"><div class="scroller"></div></div>'),fullItem:_.template('<div class="item_header box_padding clr_contTypeB_headerItem_bg clr_contTypeB_headerItem_brdr"><div class="responsive size_title_3 item_full_title clr_contTypeB_hdlTxt"><%= title %></div><%= authorHtml %><div class="control_buttons_container padding_top"></div></div><div class="box_padding clr_contTypeA_bg full_details_container"><div class="horizontal_center"><div class="full_video_container"></div><div class="responsive size_0 _1_line additional_info clr_contTypeA_subTxt"><%= durationHtml %><%= viewsHtml %><%= timeHtml %></div><div class="size_1 item_full_description clr_contTypeA_txt"></div></div></div>'),gridItem:_.template('<div class="preview_video_container" style="height:<%= imageWidth %>px; width:<%= imageWidth %>px;"></div><div class="_2_lines size_title_1 item_title clr_contTypeA_hdlTxt" style="width:<%= imageWidth %>px;"><%= title %></div>'),listItem:_.template('<div class="preview_video_container"></div><div class="item_data"><div class="_1_line size_title_1 ellipsis list_item_title clr_contTypeA_hdlTxt"><%= title %></div><div class="size_1 _2_lines item_short_description clr_contTypeA_txt"><%= description %></div><div class="size_0 _1_line additional_info clr_contTypeA_subTxt"><%= viewsHtml %><%= timeHtml %></div></div>')}; var VideoItemModel=ItemModel.extend({idAttribute:"_id",defaults:{title:"",author:"",description:"",largeThumbnail:"",mediumThumbnail:"",smallThumbnail:"",stream:null,duration:0,time:0,info:null},initialize:function(){this.set({shareInfo:this.getShareInfo()})},_videoTypeEnum:{rtspVideo:"application/x-rtsp",youtube:"application/x-shockwave-flash"},generateVideoModel:function(){var b=this.get("largeThumbnail")||this.get("mediumThumbnail")||this.get("smallThumbnail");var e="";var f=this.get("stream");if(f&&f.url){e=f.url}var a=e;var d=(f&&f.type&&(f.type===this._videoTypeEnum.youtube));var c=new VideoPlayerModel({isYoutube:d,picture:b,videoUrl:e,rtspUrl:a});return c},getShareInfo:function(){var a=this.get("socialInfo")||{};a.title=_T("SYoutubeShareTitle",{title:a.title});return a}}); var VideoModel=ItemsModel.extend({createItemsCollection:function(){var a=this.get("tabData")||{params:{}};return new VideoItemsCollection(null,a)}}); var VideoItemsCollection=ItemsCollection.extend({model:VideoItemModel,TAKE_COUNT:15,initialize:function(d,b){ItemsCollection.prototype.initialize.apply(this);var a=(b&&typeof(b.feed)!="undefined");if(a){if(b.type==="playlist"&&(!b.params||!b.params.user)){this.invalid=true}var c=this.buildYoutubeUrl(b);this.params={url:c,params:{isOpenSearch:true}}}else{b=b.params;if(!b.url){this.invalid=true}this.params=b}this.params.take=this.TAKE_COUNT},parse:function(a){var d={models:[]};for(var b=0;b<a.items.length;b++){var c=ItemsTransformer.transformItem(a.items[b]);if(c){d.models[b]=new VideoItemModel(c)}}return d},buildYoutubeUrl:function(a){var b="";if(a.params&&typeof(a.params.sort)==="string"){b=a.params.sort}switch(a.type){case"search":return"http://gdata.youtube.com/feeds/api/videos/?q="+encodeURIComponent(a.feed)+"&v=2&format=1&orderby="+(b||"relevance");break;case"playlist":if(a.feed.substring(0,2)=="PL"){a.feed=a.feed.substring(2)}return["http://gdata.youtube.com/feeds/api/playlists",a.feed,"?v=2&format=1&orderby="+(b||"position")].join("/");break;default:return["http://gdata.youtube.com/feeds/api/users",a.feed,a.type,"?v=2&format=1&orderby="+(b||"published")].join("/");break}},getServiceName:function(){return"CMS_MEDIA_VIDEO_GET"},getParams:function(){return this.params}}); var FullVideoItemView=Backbone.View.extend({className:"t3d",id:"details_"+Utils.Helpers.generateGUID(),initialize:function(){this.$el.attr({"data-role":"page","data-buttons":"back"})},render:function(){this.$el.html(videoTemplates.scroller({}));var b=this.$el.find(".scroller");var g=this.$el.find(".scroll_wrapper");var l=Utils.String.sanitizeText(this.model.get("title"),true);var h=this.model.get("author");var a="";if(h){h=_T("HtmlTextYoutubeByAuthor",{author:Utils.String.sanitizeText(h,true)});a='<div class="responsive size_title_0 little_padding_top item_author clr_contTypeB_subTxt">'+h+"</div>"}var e="";var f=this.model.get("duration");if(f){f=Utils.TimeDate.durationDisplayTime(f);e='<div class="duration left">'+f+"</div>"}var i="";var c=this.model.get("info");if(c&&c.stats.view>0){var q=_T("HtmlTextYoutubeViews",{views:localization.formatNumber(c.stats.view)});i='<div class="views center">'+q+"</div>"}var k="";var d=this.model.get("time");if(d){var m=Utils.TimeDate.timeAsText(d);k='<div class="time_ago right">'+m+"</div>"}var j=videoTemplates.fullItem({title:l,authorHtml:a,durationHtml:e,viewsHtml:i,timeHtml:k});b.html(j);var p=new HtmlContainerControl();var n=this.model.get("description");p.renderHtml(b.find(".item_full_description"),n,{changeColors:true});this._renderVideoPlayer(b.find(".full_video_container"));Scrolling.init(g);var o=this.$el.find("IMG");o.load(function(){Scrolling.onContentChanged(g)});ShareControlHelper.addShareControlButton(this.$el.find(".control_buttons_container"),this.model);return this},_renderVideoPlayer:function(c){var b=this.model.generateVideoModel();var a=new VideoPlayerView({model:b,useBigIcon:true});c.html(a.render().el)}}); var VideoListItemView=Backbone.View.extend({tagName:"li",events:{tap:"itemClicked"},initialize:function(){this.$el.attr("data-role","button").addClass("t3d");this.model.bind("change:selected",this.onSelectedChange,this)},render:function(){var g=Utils.String.sanitizeText(this.model.get("title"),true);var i=Utils.String.sanitizeText(this.model.get("description"),true);var d="";var a=this.model.get("info");if(a&&a.stats.view>0){var j=_T("HtmlTextYoutubeViews",{views:localization.formatNumber(a.stats.view)});d='<div class="views left">'+j+"</div>"}else{var c=this.model.get("duration");if(c){c=Utils.TimeDate.durationDisplayTime(c);d='<div class="duration left">'+c+"</div>"}}var f="";var b=this.model.get("time");if(b){var h=Utils.TimeDate.timeAsText(b);f='<div class="time_ago right">'+h+"</div>"}var e=videoTemplates.listItem({title:g,description:i,viewsHtml:d,timeHtml:f});this.$el.addClass("list_item list_padding clr_contTypeA_bg clr_contTypeA_brdr").html(e);this._renderVideoPlayer(this.$el.find(".preview_video_container"));return this},_renderVideoPlayer:function(c){var b=this.model.generateVideoModel();var a=new VideoPlayerView({model:b,isSliced:true});c.html(a.render().el)},onSelectedChange:function(){if(LAYOUT===layoutFormat.wide){if(this.model.get("selected")){this.$el.addClass("selected")}else{this.$el.removeClass("selected")}}},itemClicked:function(b){b.preventDefault();var a=$(b.target);if(a.parents().hasClass("preview_video_container")||a.hasClass("preview_video_container")){return}this.model.trigger("itemClicked",this.model)}}); var VideoGridItemView=Backbone.View.extend({tagName:"li",IMAGE_WIDTH_NARROW:93,IMAGE_WIDTH_WIDE:180,events:{tap:"itemClicked"},initialize:function(){this.$el.attr("data-role","button").addClass("t3d")},render:function(){var c=Utils.String.sanitizeText(this.model.get("title"),true);if(LAYOUT===layoutFormat.wide){var a=this.IMAGE_WIDTH_WIDE}else{var a=this.IMAGE_WIDTH_NARROW}var b=videoTemplates.gridItem({imageWidth:a,title:c});this.$el.addClass("grid_item").html(b);this._renderVideoPlayer(this.$el.find(".preview_video_container"));return this},_renderVideoPlayer:function(c){var b=this.model.generateVideoModel();var a=new VideoPlayerView({model:b,isSliced:true});c.html(a.render().el)},itemClicked:function(b){b.preventDefault();var a=$(b.target);if(a.parents().hasClass("preview_video_container")||a.hasClass("preview_video_container")){return}this.model.trigger("itemClicked",this.model)}}); var VideoMainView=ItemsView.extend({initialize:function(){this.id="home_"+Utils.Helpers.generateGUID();this.$el.attr({"data-role":"page","data-buttons":"navigation refresh",id:this.id});this.$el.html(videoTemplates.scroller({}));this.$scroller=this.$el.find(".scroller");var b=this.$el.find(".scroll_wrapper");Scrolling.init(b);ItemsView.prototype.initialize.apply(this);if(this.model.get("layoutId")===2){$(window).bind("throttledresize",this.onResize.hitch(this));var a=this.model.get("items");if(a){a.bind("getItemsSuccess",this.onResize,this)}this.$el.bind("pageshow",this.onPageShow.hitch(this));this.$el.bind("pagehide",this.onPageHide.hitch(this));this.$itemsList.addClass("clr_contTypeA_bg");this.onPageHide()}this.$el.bind("refresh",this.handleRefreshClick.hitch(this));this.$el.bind("silentRefresh",this.handleSilentRefresh.hitch(this))},getRootView:function(){return this.$scroller},createItemView:function(b){if(this.model.get("layoutId")===2){var a=new VideoGridItemView({model:b})}else{var a=new VideoListItemView({model:b})}return a},updateThumbnailsMargin:function(){Utils.Html.setGridMargin(this.$itemsList)},onResize:function(){if(this.isPageShow){this.updateThumbnailsMargin()}},onPageShow:function(){this.isPageShow=true;this.updateThumbnailsMargin();this.$itemsList.css({visibility:"visible"})},onPageHide:function(){this.isPageShow=false;this.$itemsList.css({visibility:"hidden"})},addTabsView:function(a){this.$scroller.prepend(a)}}); var VideoTemplateView=TemplateView.extend({render:function(b){var c=this.model.get("meta");var d=new VideoModel({tabData:c[this.options.tabsName][b]});d.set({layoutId:c.pageLayout});var a=new VideoMainView({model:d,failStr:_T("ToastMessagePaginationFailedGetItems"),id:"video_main_view_"+Utils.Helpers.generateGUID()});d.bind("itemSelected",this.onItemSelected,this);this.$el.append(a.render().el);this._homePagesViews[b]=a;TemplateView.prototype.render.apply(this,[b]);d.getItems(executeTypeEnum.HIT_AND_RUN);return this},onItemSelected:function(a,b){if(this.detailsPage){this.detailsPage.remove();this.detailsPage=null}this.detailsPage=new FullVideoItemView({model:a,id:"full_video_item_view_"+Utils.Helpers.generateGUID()});this.$el.append(this.detailsPage.render().el);this._moveToSecondaryPage(this.detailsPage.id)},_moveToSecondaryPage:function(a){var b="#"+a;$.mobile.changePage(b,{transition:"slide",reverse:IS_RTL})}}); var VideoWideTemplateView=TemplateView.extend({initialize:function(b,a){TemplateView.prototype.initialize.apply(this);this.dividedScreenView=[];this.detailsPage=[]},render:function(b){var c=this.model.get("meta");var d=new VideoModel({tabData:c[this.options.tabsName][b]});d.set({layoutId:c.pageLayout});this.listView=new VideoMainView({model:d,failStr:_T("ToastMessagePaginationFailedGetItems"),id:"video_main_view_"+Utils.Helpers.generateGUID()});this.dividedScreenView[b]=new DividedScreenView({id:"divided_screen_"+Utils.Helpers.generateGUID()});var a=function(e,f){this.onItemSelected(e,f,b)};d.bind("itemSelected",a,this);d.get("items").onItemsReady(this.onItemsReady.hitch(this));this.dividedScreenView[b].setView1(this.listView.render());this.$el.append(this.dividedScreenView[b].render().addRefreshButton(true).el);this._homePagesViews[b]=this.dividedScreenView[b];TemplateView.prototype.render.apply(this,[b]);d.getItems(executeTypeEnum.HIT_AND_RUN);return this},onItemSelected:function(b,c,a){if(!c){if(this.detailsPage[a]){this.detailsPage[a].remove();this.detailsPage[a]=null}this.detailsPage[a]=new FullVideoItemView({model:b});this.dividedScreenView[a].setView2(this.detailsPage[a].render())}},onItemsReady:function(b){if(b.length>0){var a=b.at(0);a.trigger("itemClicked",a)}}}); var MapTemplateView=TemplateView.extend({initialize:function(){TemplateView.prototype.initialize.apply(this);var b=this.model.get("meta");var a;if(b&&b.items&&b.items[0]){a=b.items[0]}else{this.mapPageModel=null;return}this.mapPageModel=new Backbone.Model({callback:function(){Scrolling.onContentChanged()},markers:b.items,googleOptions:{zoom:14}})},render:function(a){if(this.mapPageModel==null){this._homePagesViews[a]=new Backbone.View;return this}this._mapPageView=new MapPageView({model:this.mapPageModel,id:"map_page_view_"+Utils.Helpers.generateGUID()});this.$el.html(this._mapPageView.render().el);this._mapPageView.$el.attr("data-buttons","navigation");this._homePagesViews[a]=this._mapPageView;return this}}); var AboutUsModel=Backbone.Model.extend({initialize:function(){var d=this.get("buttons")||{};d.info=true;this.set({buttons:d});var b=this.get("about")||"";this.set({about:b});var e=this.get("title")||"";this.set({title:e});var c=this.get("description")||"";this.set({description:c});var a=this.get("name")||"";this.set({aboutUsName:a});this.set({descriptionTitle:_T("HtmlTextAboutUsDescriptionTitle")});this.set({readMoreTitle:_T("HtmlTextAboutUsReadMore")});this._handleDataList()},_handleDataList:function(){var n=this.get("list")||[];for(var h=0;h<n.length;h++){var e=n[h];if(e.title){e.title=Utils.String.translateIfNeed(e.title)}e.data=e.data||{};if(e.dataType==="text"){e.text=e.data.text}else{if(e.dataType==="html"){e.description=e.data.html}else{if(e.dataType==="hours"){var a=e.data.hours;if(e.data.alwaysOpen){e.text=_T("HtmlTextAboutUsItemHoursAlwaysOpen")}else{if(a&&a.length){var f=[_T("_day1s"),_T("_day2s"),_T("_day3s"),_T("_day4s"),_T("_day5s"),_T("_day6s"),_T("_day7s")];var b=_T("_firstDayOfWeek");for(var g=0;g<a.length;g++){var o=$.map(a[g].days,function(k,j){k=(k%7);if(k<b){k+=7}return k});o=o.sort();var c="";for(var d=0;d<o.length;d++){c+=f[(o[d]%7)];for(var m=d+1;(m<o.length)&&(o[m-1]+1===o[m]);m++){}if(m>d+2){c+="-";d=m-2}else{if(d+1<o.length){c+=", "}}}a[g].daysStr=c;a[g].hoursStr=a[g].startHour+" - "+a[g].endHour}}else{e.text=_T("HtmlTextAboutUsItemHoursNoHours")}}}else{if(e.dataType==="list"){var l=e.data.list;if(l&&l.length){e.text=l[0];for(var g=1;g<l.length;g++){e.text=e.text+"\n"+l[g]}}}}}}}this.set({list:n})}}); var aboutUsTemplates={};aboutUsTemplates.aboutUsTemplate=_.template('<div class="scroll_wrapper"><div class="scroller"><div class="ipad_screen_center"><% if (typeof(imgUrl) != "undefined" && imgUrl) { %><img class="aboutUs-img" src="<%= imgUrl %>" /><% } %><div class="header"><div class="header-text"><% if (aboutUsName) { %><div class="size_title_4 name clr_contTypeB_hdlTxt"><%= aboutUsName %></div><% } %><% if (title) { %><div class="size_title_1 title clr_contTypeB_subTxt"><%= title %></div><% } %></div></div><% if (about) { %><div class="size_1 about descriptionText clr_contTypeB_txt"></div><% } %><% if (description) { %><div class="size_title_1 descriptionTitle clr_contTypeB_subTxt"><%= descriptionTitle %></div><div class="size_1 description descriptionText clr_contTypeB_txt"></div><% } %><div class="size_title_1 read_more_button clr_contTypeB_lnkTxt"><%= readMoreTitle %></div><div class="share-icons-container"></div><ul class="dataList"></ul></div></div></div>');aboutUsTemplates.aboutUsMoreTemplate=_.template('<div class="scroll_wrapper"><div class="scroller"><div class="ipad_screen_center"><% if (typeof(imgUrl) != "undefined" && imgUrl) { %><img class="aboutUs-img" src="<%= imgUrl %>" /><% } %><div class="header"><div class="header-text"><% if (aboutUsName) { %><div class="size_title_4 name clr_contTypeA_hdlTxt"><%= aboutUsName %></div><% } %><% if (title) { %><div class="size_title_1 title clr_contTypeA_subTxt"><%= title %></div><% } %></div></div><% if (about) { %><div class="size_1 about descriptionText clr_contTypeA_txt"></div><% } %><% if (description) { %><div class="size_title_1 descriptionTitle clr_contTypeA_subTxt"><%= descriptionTitle %></div><div class="size_1 description descriptionText clr_contTypeA_txt"></div><% } %></div></div></div>');aboutUsTemplates.aboutUsItemMoreTemplate=_.template('<div class="scroll_wrapper"><div class="scroller"><div class="ipad_screen_center"><div class="header"><% if (typeof(icon) != "undefined" && icon && typeof(iconBlack) != "undefined" && iconBlack) { %><div class="dataItemImage sliced_image clr_contTypeB_hdlIcn_black_icon" style="background-image:url(\'<%= iconBlack %>\')"></div><div class="dataItemImage sliced_image clr_contTypeB_hdlIcn_white_icon" style="background-image:url(\'<%= icon %>\')"></div><div class="dataItemImage sliced_mask clr_contTypeB_hdlIcn_mask_icon" style="-webkit-mask-image:url(\'<%= icon %>\')"></div><% } %><div class="header-text"><% if (title) { %><div class="size_title_1 title clr_contTypeA_subTxt"><%= title %></div><% } %></div></div><% if (text) { %><div class="size_1 description descriptionText clr_contTypeA_txt"></div><% } %></div></div></div>');aboutUsTemplates.listItemTemplate=_.template('<li class="dataItem clr_contTypeB_sep_brdr clearfix"><div class="titleContainer"><% if (typeof(icon) != "undefined" && icon && typeof(iconBlack) != "undefined" && iconBlack) { %><div class="dataItemImage inList sliced_image clr_contTypeB_hdlIcn_black_icon" style="background-image:url(\'<%= iconBlack %>\')"></div><div class="dataItemImage inList sliced_image clr_contTypeB_hdlIcn_white_icon" style="background-image:url(\'<%= icon %>\')"></div><div class="dataItemImage inList sliced_mask clr_contTypeB_hdlIcn_mask_icon" style="-webkit-mask-image:url(\'<%= icon %>\')"></div><% } %><% if (typeof(title) != "undefined" && title) { %><div class="size_title_0 dataItemTitle clr_contTypeB_hdlTxt"><%= title %></div><% } %></div><% if (typeof(description) != "undefined" && description) { %><div class="size_1 dataItemText descrContainer"></div><% } %><% if (typeof(text) != "undefined" && text) { %><div class="size_1 dataItemText listTextContainer clr_contTypeB_txt" data-text="<%= text %>"<% if (typeof(title) != "undefined" && title) { %> data-title="<%= title %>"<% } %><% if (typeof(iconBlack) != "undefined" && iconBlack) { %> data-iconBlack="<%= iconBlack %>"<% } %><% if (typeof(icon) != "undefined" && icon) { %> data-icon="<%= icon %>"<% } %>></div><% } %></li>');aboutUsTemplates.readMoreTemplate=_.template('<span class="size_title_1 read_more_text clr_contTypeB_lnkTxt"><%= staticTitle %></span>');aboutUsTemplates.hoursTemplate=_.template('<div class="hours_block"><div class="days_section"><%= days %></div><div class="hours_section" dir="ltr"><%= hours %></div></div>');aboutUsTemplates.infoPageTemplate=_.template('<div class="scroll_wrapper"><div class="scroller"><div class="info-page-place-holder"><div class="info-bar-header clr_contTypeB_headerItem_bg clr_contTypeB_headerItem_brdr"><img class="applogoimg" src="<%= appLogoImgUrl %>" /><div class="header"><div class="size_title_4 _1_line ellipsis app-label clr_contTypeB_hdlTxt"><%= appLabel %></div><div class="size_title_1 app-version clr_contTypeB_subTxt"><%= appVersion %></div></div></div><div class="clr_contTypeA_bg"><div class="share-button-container"></div><% if (typeof(appDescription) != "undefined" && appDescription) { %><div class="size_1 appdescription clr_contTypeA_txt clr_contTypeB_brdr"><%= appDescription %></div><% } %></div><div class="clearfix"></div></div></div></div>'); var AboutUsTemplateView=TemplateView.extend({render:function(a){var e=this.model.get("meta");var d=e[this.options.tabsName][a];if(d){var c=new AboutUsModel(d)}else{var c=new AboutUsModel()}var b=new AboutUsView({model:c,id:"home_"+Utils.Helpers.generateGUID()});c.bind("infoClicked",this._onInfoClicked,this);c.bind("moreClicked",this._onMoreClicked,this);c.bind("itemMoreClicked",this._onItemMoreClicked,this);this.$el.append(b.render().el);this._homePagesViews[a]=b;TemplateView.prototype.render.apply(this,[a]);return this},_onInfoClicked:function(a){if(this._aboutUsInfoView){this._aboutUsInfoView.remove()}this._aboutUsInfoView=new AboutUsInfoView({model:a,id:"details_"+Utils.Helpers.generateGUID()});this.$el.append(this._aboutUsInfoView.render().el);$.mobile.changePage("#"+this._aboutUsInfoView.id,{transition:"slide",reverse:IS_RTL})},_onMoreClicked:function(a){if(this._aboutUsMoreView){this._aboutUsMoreView.remove()}this._aboutUsMoreView=new AboutUsMoreView({model:a,id:"more_"+Utils.Helpers.generateGUID()});this.$el.append(this._aboutUsMoreView.render().el);$.mobile.changePage("#"+this._aboutUsMoreView.id,{transition:"slide",reverse:IS_RTL})},_onItemMoreClicked:function(a){if(this._aboutUsMoreView){this._aboutUsMoreView.remove()}this._aboutUsMoreView=new AboutUsItemMoreView({model:a,id:"more_"+Utils.Helpers.generateGUID()});this.$el.append(this._aboutUsMoreView.render().el);$.mobile.changePage("#"+this._aboutUsMoreView.id,{transition:"slide",reverse:IS_RTL})}}); var AboutUsInfoView=Backbone.View.extend({className:"info_page clr_contTypeB_fullPage2_bg",attributes:{"data-role":"page","data-buttons":"back"},initialize:function(){var a=AppManager.app().get("navigationType");if(a==navigationLayoutTypes.bottomBar||a==navigationLayoutTypes.topBar){this.$el.bind("pageshow",function(){conduitApi.app.hideNavigationBar()}.hitch(this));this.$el.bind("pagebeforehide",function(){conduitApi.app.showNavigationBar()}.hitch(this))}},render:function(){var a=this.model.toJSON();a.appLabel=AppManager.app().get("appLabel");a.appLogoImgUrl=AppManager.app().get("appIcon");a.appVersion=_T("HtmlTextAboutUsInfoVersion",{versionName:APP_VERSION});this.$el.html(aboutUsTemplates.infoPageTemplate(a));if(DEVICE===deviceTypeEnum.android){this.$(".info-page-place-holder").css("min-height","520px")}var c=this.$(".scroll_wrapper");var b=this.$(".share-button-container");this.model.set({getShareInfo:this._getShareInfo});this.model.getShareInfo=this._getShareInfo;ShareControlHelper.addShareControlButton(b,this.model);this.$el.find("IMG").load(function(){Scrolling.onContentChanged(c)}).error(function(){$(this).remove()});Scrolling.init(c);return this},_getShareInfo:function(){var a=Utils.ShareInfo.shareAppInfo();if(PLATFORM==platformEnum.simulator){return a}a.shareButtonText=_T("HtmlTextShareAppButtonText");return a}}); var AboutUsView=Backbone.View.extend({className:"main-page clr_contTypeB_bg t3d",attributes:{"data-role":"page","data-buttons":"navigation"},initialize:function(){$(window).bind("throttledresize",this.onResize.hitch(this));this.$el.bind("pageshow",this.onPageShow.hitch(this));this.$el.bind("pagehide",this.onPageHide.hitch(this))},_createItemView:function(e){var g=e.data.hours;if(g&&g.length){e.description="";for(var b=0;b<g.length;b++){var d={days:g[b].daysStr,hours:g[b].hoursStr};var f=aboutUsTemplates.hoursTemplate(d);e.description=e.description+f}}var c=$(aboutUsTemplates.listItemTemplate(e));if(e.description){e.text=Utils.String.sanitizeText(e.text,true);var a=new HtmlContainerControl();a.renderHtml(c.find(".descrContainer"),e.description,{changeColors:true})}return c},render:function(){var f=this.model.toJSON();this.$el.html(aboutUsTemplates.aboutUsTemplate(f));var g=this.$(".scroll_wrapper");this.$("IMG").load(function(){Scrolling.onContentChanged(g)}).error(function(){$(this).remove()});var e=this.model.get("list");if(e.length){var a=this.$(".dataList");for(var d=0;d<e.length;d++){var f=e[d];var c=this._createItemView(f);a.append(c)}}var b=new ShareIconsView({model:this.model});this.$(".share-icons-container").append(b.render().el);this.$(".read_more_button").tap(this._onReadMoreClick.hitch(this));Scrolling.init(g);return this},_onReadMoreClick:function(a){a.preventDefault();this.model.trigger("moreClicked",this.model)},onPageShow:function(){this.isPageShow=true;this.updateDescriptions()},onPageHide:function(){this.isPageShow=false},onResize:function(){if(this.isPageShow){this.updateDescriptions()}},updateDescriptions:function(){var h=Math.max(300,this.$el.width());var e=this;var c=false;var b={staticTitle:_T("HtmlTextAboutUsListItemReadMore")};var a=aboutUsTemplates.readMoreTemplate(b);var i=this.model.get("description");if(i){var g=Math.floor(h/1.5);var k=this.$(".description");if(g<i.length){i=Utils.String.trailString(i,g,{charStop:[{charStop:".",threshold:"50"}]});c=true}k.html(Utils.String.sanitizeText(i))}var d=this.model.get("about");if(d){var j=Math.floor(h/1.5);var k=this.$(".about");if(j<d.length){d=Utils.String.trailString(d,j,{charStop:[{charStop:".",threshold:"50"}]});c=true}k.html(Utils.String.sanitizeText(d))}if(c){this.$(".read_more_button").show()}else{this.$(".read_more_button").hide()}var f=Math.floor((h-40)/2);this.$(".listTextContainer").each(function(n){var s=$(this);var r=s.attr("data-text");var q=s.attr("data-title")||"";var o=s.attr("data-icon")||"";var p=s.attr("data-iconBlack")||"";if(f<r.length){var l=Utils.String.trailString(r,f);l=Utils.String.sanitizeText(l,true);s.html(l+"<br >");var t=$(a);s.append(t);var m=new Backbone.Model({title:q,text:r,icon:o,iconBlack:p});t.tap(function(u){u.preventDefault();e.model.trigger("itemMoreClicked",m)})}else{var l=Utils.String.sanitizeText(r,true);s.html(l)}})},addTabsView:function(a){this.$el.find(".scroller").prepend(a)}}); var AboutUsMoreView=Backbone.View.extend({className:"main-page clr_contTypeA_bg",attributes:{"data-role":"page","data-buttons":"back"},render:function(){var b=this.model.toJSON();this.$el.html(aboutUsTemplates.aboutUsMoreTemplate(b));var c=this.$(".scroll_wrapper");if(b.about){var a=new LinksTextControl();a.renderText(this.$(".about"),b.about)}if(b.description){var a=new LinksTextControl();a.renderText(this.$(".description"),b.description)}this.$("IMG").load(function(){Scrolling.onContentChanged(c)}).error(function(){$(this).remove()});Scrolling.init(c);return this}}); var AboutUsItemMoreView=Backbone.View.extend({className:"main-page clr_contTypeA_bg",attributes:{"data-role":"page","data-buttons":"back"},render:function(){var b=this.model.toJSON();this.$el.html(aboutUsTemplates.aboutUsItemMoreTemplate(b));var a=new LinksTextControl();a.renderText(this.$(".description"),b.text);var c=this.$(".scroll_wrapper");Scrolling.init(c);return this}}); var StaticHtmlTemplateView=TemplateView.extend({DEFAULT_PADDING:10,render:function(b){var e=this.model.get("meta");var d="";var f=this.DEFAULT_PADDING;if(e.notes[0]&&e.notes[0].html){d=e.notes[0].html;if(typeof(e.notes[0].padding)!="undefined"){f=e.notes[0].padding}}var a=new Backbone.Model({html:d,padding:f,purchaseItemModel:this.model});this._changePageParams.homePageId="home_"+Utils.Helpers.generateGUID();var c=new StaticHtmlView({model:a,id:this._changePageParams.homePageId});this.$el.append(c.render().el);this._homePagesViews[b]=c;return this}}); var StaticHtmlView=Backbone.View.extend({attributes:{"data-role":"page","data-buttons":"navigation"},render:function(){this.$el.html('<div class="scroll_wrapper"><div class="scroller"></div></div>');this.$scroller=this.$el.find(".scroller");this.$scrollerWrapper=this.$el.find(".scroll_wrapper");Scrolling.init(this.$scrollerWrapper);var b=this.model.get("html");if(b){var a=new HtmlContainerControl();a.renderHtml(this.$scroller,b,{changeColors:false,purchaseItemModel:this.model.get("purchaseItemModel")});this.$scroller.children().css({padding:this.model.get("padding")+"px"})}return this},appendToView:function(a){this.$scroller.append(a)}}); var FavoritesTemplateView=TemplateView.extend({initialize:function(){TemplateView.prototype.initialize.apply(this);FavoritesManager.init()},render:function(b){this._favoritesModel=FavoritesManager.getModel();this._favoritesModel.bind("onTrackTap",this.onTrackTap,this);this._favoritesModel.set({isEdit:false});var a=new FavoritesView({model:this._favoritesModel,id:"home_"+Utils.Helpers.generateGUID()});this._homePagesViews[b]=a;this.$el.html(a.render().el);return this},onTrackTap:function(b){if(this.trackPage){this.trackPage.remove()}this.trackPage=new TrackDetailsView({model:b,template:audioTemplates[0],id:"track_page_details_"+Utils.Helpers.generateGUID(),isFavoritePage:true});var a=$(this.trackPage.el);a.attr({"data-role":"page","data-buttons":"back"});a.bind("pageshow",function(){if(!conduitApi.platform.media.isSupported()){conduitApi.UI.showToastMessage(null,null,_T("DialogMessageMediaNotSupported"),a)}else{var d=$(this.trackPage.el);var f=d.find(".audio_media_player_container");if(f.length>0){d=f}function e(){var i=b.get("index");function h(){conduitApi.platform.media.play(null,null,i)}var g=this._favoritesModel.get("items").toJSON();conduitApi.platform.media.setTracks(h,null,g);$(this.trackPage.el).bind("pagehide",function(){d.trigger("hide")})}function c(){cqm.showToastMessage(_T("ToastMessageAudioInitFail"),a)}conduitApi.platform.media.init(e.hitch(this),c,d)}}.hitch(this));this.$el.append(this.trackPage.render().el);$.mobile.changePage("#"+this.trackPage.id,{transition:"slide",reverse:IS_RTL})}}); var FavoritesListView=Backbone.View.extend({tagName:"ul",className:"tracks_list",initialize:function(){this.model.bind("change:isEdit",this.onEditStateChanged,this);var a=this.model.get("items");a.bind("add",this.addOneTrack,this);a.bind("remove",this.removeOneTrack,this);a.bind("reset",this.onReset,this)},render:function(){var a=this.model.get("items");a.each(function(b){this.addOneTrack(b)}.hitch(this));return this},onEditStateChanged:function(a,c){if(c){this.$el.addClass("edit_mode")}else{this.$el.removeClass("edit_mode")}var b=this.model.get("items");b.each(function(d){d.set({isEdit:c})})},addOneTrack:function(b){var a=new FavoritesTrackView({model:b});a.bind("onTrackTap",this.onTrackTap,this);a.bind("onMoveTap",this.onMoveTap,this);this.$el.append(a.render().el)},removeOneTrack:function(a){a.trigger("remove")},onReset:function(){this.$el.html("")},onTrackTap:function(a){this.model.trigger("onTrackTap",a)},onMoveTap:function(c,d){if(this.inMove){return}this.inMove=true;var b=c.index();var h=1.5;if(d){h=-h}FavoritesManager.moveItem(b,h);var f=this;var g=function(){if(d){c.prev().before(c)}else{c.next().after(c)}f.inMove=false};if($.support.cssTransitions){var e="48px";if(d){var j="translate(0, -"+e+")";var i="translate(0, "+e+")";var a=c.prev()}else{var j="translate(0, "+e+")";var i="translate(0, -"+e+")";var a=c.next()}c.css({"-webkit-transition-property":"all","-webkit-transition-duration":"0.25s","-webkit-transition-timing-function":"ease-out","-webkit-transform":"scale(1.04) "+j,opacity:"0.7"});a.css({"-webkit-transition-property":"all","-webkit-transition-duration":"0.35s","-webkit-transition-timing-function":"ease-out","-webkit-transform":i});setTimeout(function(){c.css({"-webkit-transition-duration":"0.1s","-webkit-transform":"scale(1) "+j,"-webkit-transition-timing-function":"ease-out",opacity:"1"});setTimeout(function(){c.css({"-webkit-transform":"","-webkit-transition-duration":"0s"});a.css({"-webkit-transform":"","-webkit-transition-duration":"0s"});g()},100)},250)}else{g()}}}); var FavoritesView=TemplateView.extend({className:"album_details_page",initialize:function(){this.$el.attr({"data-role":"page","data-buttons":"navigation"});this.itemsCollection=this.model.get("items");this.itemsCollection.bind("add",this._updateNoFavsMode,this);this.model.bind("editDone",this._updateNoFavsMode,this)},render:function(){this.$el.html('<div class="scroll_wrapper"><div class="scroller"></div></div>');this.$scrollWrapper=this.$el.find(".scroll_wrapper");this.$scroller=this.$el.find(".scroller");Scrolling.init(this.$scrollWrapper);var a={text1:_T("HtmlTextFavoritesNoFavsStr1"),text2:_T("HtmlTextFavoritesNoFavsStr2")};this.$noFavs=$(favoritesTemplates.noFavs(a));this.$scroller.append(this.$noFavs);this.headerView=new FavoritesHeaderView({model:this.model});this.$scroller.append(this.headerView.render().el);this.favoritesListView=new FavoritesListView({model:this.model});this.favoritesListView.bind("onTrackSelected",this.onTrackSelected,this);this.$scroller.append(this.favoritesListView.render().el);this._updateNoFavsMode();return this},_updateNoFavsMode:function(){var a=(this.itemsCollection.length===0);if(a===this.isNoFavs){return}this.isNoFavs=a;if(a){this.$noFavs.show();this.headerView.$el.hide();this.favoritesListView.$el.hide();this.$el.addClass("clr_contTypeB_fullPage_bg")}else{this.$noFavs.hide();this.headerView.$el.show();this.favoritesListView.$el.show();this.$el.removeClass("clr_contTypeB_fullPage_bg")}Scrolling.onContentChanged(this.$scrollWrapper)}}); var FavoritesHeaderView=Backbone.View.extend({className:"header clr_contTypeB_headerItem_bg clr_contTypeB_headerItem_brdr",initialize:function(){this.model.bind("change:isEdit",this.onIsEditChanged,this)},render:function(){var b={shareBtnTxt:_T("HtmlTextFavoritesShareButton"),editBtnTxt:_T("HtmlTextFavoritesEditButton"),doneBtnTxt:_T("HtmlTextFavoritesDoneButton"),cancelBtnTxt:_T("HtmlTextFavoritesCancelButton")};this.$el.html(favoritesTemplates.header(b));var c=this.$el;var a=this.$el.find(".share-button");ShareControlHelper.addShareControlButton(c,this.model,a);this.$editButton=this.$el.find(".edit-button").tap(this.onEditTap.hitch(this));this.$doneButton=this.$el.find(".done-button").tap(this.onDoneTap.hitch(this));this.$cancelButton=this.$el.find(".cancel-button").tap(this.onCancelTap.hitch(this));this.$editButton.show();this.$doneButton.hide();this.$cancelButton.hide();return this},onEditTap:function(){this.model.set({isEdit:true})},onDoneTap:function(){FavoritesManager.save();this.model.set({isEdit:false});this.model.trigger("editDone")},onCancelTap:function(){FavoritesManager.reset();this.model.set({isEdit:false})},onIsEditChanged:function(a,b){if(b){this.$editButton.hide();this.$doneButton.show();this.$cancelButton.show()}else{this.$editButton.show();this.$doneButton.hide();this.$cancelButton.hide()}}}); var FavoritesTrackView=Backbone.View.extend({tagName:"li",className:"tracks_list_item clr_contTypeB_trackItem_bg clr_contTypeB_trackItem_brdr",initialize:function(){this.$el.attr("data-role","button");this.model.set({isEdit:false});this.model.bind("change:isEdit",this.onIsEditChanged,this);this.model.bind("remove",this.onRemove,this)},render:function(){var a=this.model.toJSON();a.buyBtnStr=_T("HtmlTextFavoritesBuyButton");this.$el.tap(this.onTrackTap.hitch(this));this.$el.html(favoritesTemplates.track(a));this.$playButton=this.$el.find(".track_play_button");this.$deleteButton=this.$el.find(".delete-button").hide();this.$buyButton=this.$el.find(".buy-button");this.$moveButton=this.$el.find(".move-button").hide();this.$deleteButton.tap(this.onDeleteButtonTap.hitch(this));this.$moveButton.tap(this.onMoveButtonTap.hitch(this));return this},onIsEditChanged:function(a,b){if(b){this.$playButton.hide();this.$deleteButton.show();this.$buyButton.hide();this.$moveButton.show();this.$el.unbind("tap")}else{this.$playButton.show();this.$deleteButton.hide();this.$buyButton.show();this.$moveButton.hide();this.$el.tap(this.onTrackTap.hitch(this))}},onDeleteButtonTap:function(a){a.preventDefault();FavoritesManager.removeTrack(this.model);this.remove()},onMoveButtonTap:function(c){c.preventDefault();var a=$(c.target);if(!a.is(".tracks_list LI:first-child .move-button.up")&&!a.is(".tracks_list LI:last-child .move-button.down")){var b=a.hasClass("up");this.trigger("onMoveTap",this.$el,b)}},onTrackTap:function(a){a.preventDefault();this.trigger("onTrackTap",this.model)},onRemove:function(){this.remove()}}); var favoritesTemplates={header:_.template('<div class="share-button button right clr_contTypeB_btn_bg clr_contTypeB_btn_brdr clr_contTypeB_btn_hdlTxt" data-role="button" ><%= shareBtnTxt %></div><div class="edit-button button left clr_contTypeB_btn_bg clr_contTypeB_btn_brdr clr_contTypeB_btn_hdlTxt" data-role="button" ><%= editBtnTxt %></div><div class="cancel-button button left clr_appGeneral_dialog_btn2_bg clr_appGeneral_dialog_btn2_brdr clr_appGeneral_dialog_btn2_hdlTxt" data-role="button" ><%= cancelBtnTxt %></div><div class="done-button button left clr_contTypeB_btn_bg clr_contTypeB_btn_brdr clr_contTypeB_btn_hdlTxt" data-role="button" ><%= doneBtnTxt %></div>'),track:_.template('<div class="track_play_button sprite sprite-play_circle" ></div><div class="delete-button mask_sprite sprite-la-cancel clr_contTypeB_subIcn" ></div><div class="size_title_0 _1_line track_title clr_contTypeB_hdlTxt ellipsis" ><%= title %></div><% if (false) { %><div class="buy-button" ><%= buyBtnStr %></div><% } %><div class="move-button mask_sprite sprite-arrowDown down clr_contTypeB_subIcn" ></div><div class="move-button mask_sprite sprite-arrowUp up clr_contTypeB_subIcn" ></div>'),noFavs:_.template('<div class="size_title_3 no-favs-text text1 clr_contTypeB_hdlTxt" ><%= text1 %></div><div class="size_title_0 no-favs-text text2 clr_contTypeB_subTxt" ><%= text2 %></div><div class="no-favs-icon mask_sprite sprite-noFav clr_contTypeB_subIcn" ></div>')}; var EventsTemplates={};EventsTemplates.eventsList=[_.template('<div class="scroll_wrapper"><div class="scroller"><div class="tabs_container"></div><div class="no_events_container"></div><div class="events_container"></div></div></div>'),_.template('<div class="scroll_wrapper"><div class="scroller"><div class="tabs_container"></div><div class="no_events_container"></div><div class="events_container"></div></div></div>'),_.template('<div class="scroll_wrapper"><div class="scroller"><div class="tabs_container"></div><% if (typeof(logoImgUrl) != "undefined" && logoImgUrl) { %><div class="logo sliced_image" style="background-image:url(\'<%= logoImgUrl %>\')"></div><% } %><div class="no_events_container"></div><div class="events_container"></div></div></div>')];EventsTemplates.event=[_.template(['<div class="clendar clr_contTypeB_actBtn_bg clr_contTypeB_actBtn_brdr clr_contTypeB_actBtn_hdlTxt" >','<div class="hole clr_contTypeA_bg" ></div>','<div class="text-area clr_events_calPict_bg" >','<div class="month clr_contTypeB_hdlTxt"><%= month %></div>','<div class="day clr_contTypeB_hdlTxt"><%= day %></div>','<div class="year clr_contTypeB_subTxt"><%= year %></div>',"</div>","</div>",'<div class="responsive size_0 _1_line ellipsis time clr_contTypeB_txt" ><%= formattedTime %></div>','<% if (typeof(title) != "undefined" && title) { %>','<div class="responsive size_title_1 _1_line ellipsis title clr_contTypeB_hdlTxt" ><%= title %></div>',"<% } %>",'<% if (typeof(location) != "undefined") { %>','<div class="size_1 max_2_lines description clr_contTypeB_txt','<% if ((typeof(venue) != "undefined" && venue && venue.lat && venue.long) || (typeof(meta) != "undefined" && meta && meta.ticketUrl)) { %>',' with-icons" ><%= location %></div>',"<% } else { %>",'" ><%= location %></div>',"<% } %>","<% } %>",'<% if ((typeof(venue) != "undefined" && venue && venue.lat && venue.long) || (typeof(meta) != "undefined" && meta && meta.ticketUrl)) { %>','<div class="images-warpper">','<% if (typeof(venue) != "undefined" && venue && venue.lat && venue.long) { %>','<div class="show-on-map mask_sprite sprite-events-map clr_contTypeB_icn"></div>',"<% } %>",'<% if (typeof(meta) != "undefined" && meta && meta.ticketUrl) { %>','<div class="ticket mask_sprite sprite-events-ticket-big clr_contTypeB_icn"></div>',"<% } %>","</div>","<% } %>"].join("")),_.template(['<div class="clendar clr_contTypeB_actBtn_bg clr_contTypeB_actBtn_brdr clr_contTypeB_actBtn_hdlTxt" >','<div class="hole clr_contTypeA_bg" ></div>','<div class="text-area clr_events_calPict_bg" >','<div class="month clr_contTypeB_hdlTxt"><%= month %></div>','<div class="day clr_contTypeB_hdlTxt"><%= day %></div>','<div class="year clr_contTypeB_subTxt"><%= year %></div>',"</div>","</div>",'<div class="size_0 time clr_contTypeB_txt" ><%= formattedTime %></div>','<% if (typeof(title) != "undefined" && title) { %>','<div class="size_title_1 _1_line ellipsis title clr_contTypeB_hdlTxt" ><%= title %></div>',"<% } %>",'<% if (typeof(location) != "undefined") { %>','<div class="description clr_contTypeB_txt','<% if ((typeof(venue) != "undefined" && venue && venue.lat && venue.long) || (typeof(meta) != "undefined" && meta && meta.ticketUrl)) { %>',' with-icons" ><%= location %></div>',"<% } else { %>",'" ><%= location %></div>',"<% } %>","<% } %>",'<% if ((typeof(venue) != "undefined" && venue && venue.lat && venue.long) || (typeof(meta) != "undefined" && meta && meta.ticketUrl)) { %>','<div class="images-warpper">','<% if (typeof(venue) != "undefined" && venue && venue.lat && venue.long) { %>','<div class="show-on-map mask_sprite sprite-events-map clr_contTypeB_icn"></div>',"<% } %>",'<% if (typeof(meta) != "undefined" && meta && meta.ticketUrl) { %>','<div class="ticket mask_sprite sprite-events-ticket-big clr_contTypeB_icn"></div>',"<% } %>","</div>","<% } %>"].join("")),_.template(['<div class="clendar clr_contTypeB_actBtn_bg clr_contTypeB_actBtn_brdr clr_contTypeB_actBtn_hdlTxt" >','<div class="month"><%= month %></div>','<div class="day clr_events_calPict_bg clr_contTypeB_hdlTxt"><%= day %></div>',"</div>",'<div class="text-area" >','<% if (typeof(title) != "undefined" && title) { %>','<div class="size_title_1 title clr_contTypeB_hdlTxt" ><%= title %></div>',"<% } %>",'<div class="size_1 time clr_contTypeB_txt" ><%= formattedTime %></div>',"</div>",'<div class="arrow mask_sprite sprite-arrow clr_contTypeA_icn"></div>'].join(""))];EventsTemplates.eventDetailed=_.template(['<div class="scroll_wrapper"><div class="scroller">','<div class="header-wrapper">','<div class="image sliced_image" style="background-image:url(\'<%= imageUrl %>\')"></div>','<div class="header box_padding clr_contTypeC_bg">','<div class="responsive size_0 date clr_contTypeC_subTxt"><%= formattedDate %></div>','<div class="responsive size_0 time clr_contTypeC_subTxt"><%= formattedTime %></div>','<% if (typeof(title) != "undefined" && title) { %>','<div class="responsive size_title_3 title clr_contTypeC_hdlTxt"><%= title %></div>',"<% } %>","</div>","</div>",'<div class="clr_contTypeB_headerItem_bg clr_contTypeB_headerItem_brdr box_padding">','<div class="control_buttons_container t3d"></div>','<% if (typeof(description) != "undefined" && description) { %>','<div class="responsive size_1 description clr_contTypeB_txt"><%= description %></div>',"<% } %>","</div>",'<% if ((typeof(venue) != "undefined" && venue && venue.location) ||','(typeof(location) != "undefined" && location) ||','(typeof(phoneNumber) != "undefined" && phoneNumber)) { %>','<div class="details box_padding clr_contTypeA_bg">','<% if (typeof(location) != "undefined" && location) { %>','<div class="responsive size_title_1 venue-str clr_contTypeA_hdlTxt"><%= locationStr %></div>','<div class="responsive size_1 venue text clr_contTypeA_txt"><%= location %></div>',"<% } %>",'<% if (typeof(venue) != "undefined" && venue && venue.location) { %>','<div class="responsive size_title_1 venue-str clr_contTypeA_hdlTxt"><%= venueStr %></div>','<div class="responsive size_1 venue text clr_contTypeA_txt"><%= venue.location %></div>',"<% } %>",'<% if (typeof(phoneNumber) != "undefined" && phoneNumber) { %>','<div class="responsive size_title_1 phone-number-str clr_contTypeA_hdlTxt"><%= phoneNumberStr %></div>','<div class="responsive size_1 phone-number text clr_contTypeA_txt"><%= phoneNumber %></div>',"<% } %>","</div>","<% } %>","</div></div>"].join(""));EventsTemplates.noEvents=_.template('<div class="size_title_3 no-events-text clr_contTypeB_hdlTxt" ><%= text %></div><div class="no-events-icon mask_sprite sprite-no-events clr_contTypeB_subIcn" ></div>'); var EventsCollection=ItemsCollection.extend({initialize:function(b,a){if(a&&a.id){this.params=a}else{this.invalid=true}ItemsCollection.prototype.initialize.apply(this)},parse:function(a){var c={models:[]};if(a.items){for(var b=0;b<a.items.length;b++){a.items[b].layoutId=this.params.layoutId;c.models[b]=new EventModel(a.items[b])}}return c},getServiceName:function(){return"CMS_CALENDAR_GET"},getParams:function(){return this.params}}); var EventModel=Backbone.Model.extend({initialize:function(){var c=this.get("venue");var f=null;if(c&&c.lat&&c["long"]){f={lat:c.lat,lon:c["long"]}}var a=this.get("times")[0];var j=a.start.timeZoneOffset||0;var l=j*3600;a.startTime=a.start.localTime-l;var b=new Date(a.start.localTime*1000);var g=null;if(a.end){var g=new Date(a.end.localTime*1000);a.endTime=a.end.localTime-l}else{a.endTime=a.startTime}if(this.get("layoutId")===2){var h=b.format("mmm",true).toUpperCase()}else{var h=b.format("mmmm",true).toUpperCase()}var k=""+b.getUTCDate();var i=""+b.getUTCFullYear();var e=b.format("fullDate",true);if(this.get("isAllDayEvent")){var d=""}else{var d=EventsTemplateHelper.formatTime(b,g,j)}this.set({shareInfo:this.getShareInfo(),geo:f,day:k,month:h,year:i,formattedDate:e,formattedTime:d})},getShareInfo:function(){var a=this.get("socialInfo");return a}}); var EventsModel=ItemsModel.extend({createItemsCollection:function(){return new EventsCollection(null,this.toJSON())}}); var EventsTemplateHelper={getTemplateItems:function(e){var g=[];var c=e.get("meta").items;var b=0;for(var f=0;f<c.length;f++){var a=c[f].views;if(a){for(var d=0;d<a.length;d++){g[b]=a[d];$.extend(true,g[b],c[f].params,g[b]);g[b].title=Utils.String.translateIfNeed(g[b].title);g[b].layoutId=e.get("meta").pageLayout||0;b++}}}return g},formatTime:function(b,d,c){var a=b.format("shortTime",true);if(d&&(d.getTime()!=b.getTime())){if(d.format("d/m/yyyy",true)===b.format("d/m/yyyy",true)){a+=" - "+d.format("shortTime",true)}else{a=b.format("shortDate",true)+" "+a+" - "+d.format("shortDate",true)+" "+d.format("shortTime",true)}}a+=" (GMT";if(c){a+=(c>0?"+":"")+c}a+=")";return a},formatVenueString:function(a){return[a.street?a.street+"</br>":"",a.city?a.city+",":"",a.state?a.state+"</br>":"",a.country?a.country+"</br>":""].join("")}}; var EventsTemplateView=TemplateView.extend({render:function(b){var c=new EventsModel(this.getTemplateItems()[b]);var a=new EventsView({model:c});c.bind("itemSelected",this.onEventSelected,this);this.$el.append(a.render().el);c.getItems(executeTypeEnum.HIT_AND_RUN);this._homePagesViews[b]=a;TemplateView.prototype.render.apply(this,[b]);return this},getTemplateItems:function(){if(!this.items){this.items=EventsTemplateHelper.getTemplateItems(this.model)}return this.items},onEventSelected:function(a){if(this.eventDetailedView){this.eventDetailedView.remove()}this.eventDetailedView=new EventDetailedView({model:a});this.eventDetailedView.bind("onShowOnMapTap",this._onShowOnMapTap,this);this.eventDetailedView.bind("onTicketTap",this._onTicketTap,this);this.$el.append(this.eventDetailedView.render().el);$.mobile.changePage("#"+this.eventDetailedView.id,{transition:"slide",reverse:IS_RTL})},_onShowOnMapTap:function(c){var e=c.get("venue");var d=e.lat;var b=e["long"];if(d&&b){var a={location:{lat:d,lng:b},header:c.get("title"),address:e.location};var c=new Backbone.Model({markers:[a]});MapManager.show_on_map(this.$el,c)}},_onTicketTap:function(a){var b=a.get("meta").ticketUrl;conduitApi.app.openLink(null,null,{url:b})}}); var EventsWideTemplateView=TemplateView.extend({initialize:function(){TemplateView.prototype.initialize.apply(this);this.dividedScreenView=[];this.detailsPage=[]},render:function(c){var d=new EventsModel(this.getTemplateItems()[c]);var a=function(e,f){this.onEventSelected(e,f,c)};d.bind("itemSelected",a,this);d.get("items").onItemsReady(this.onItemsReady.hitch(this));var b=new EventsView({model:d});this.dividedScreenView[c]=new DividedScreenView({id:"divided_screen_"+Utils.Helpers.generateGUID()});this.dividedScreenView[c].setView1(b.render());this.$el.append(this.dividedScreenView[c].render().addRefreshButton(true).el);d.getItems(executeTypeEnum.HIT_AND_RUN);this._homePagesViews[c]=this.dividedScreenView[c];TemplateView.prototype.render.apply(this,[c]);return this},getTemplateItems:function(){if(!this.items){this.items=EventsTemplateHelper.getTemplateItems(this.model)}return this.items},onEventSelected:function(b,c,a){if(!c){if(this.detailsPage[a]){this.detailsPage[a].remove();this.detailsPage[a]=null}this.detailsPage[a]=new EventDetailedView({model:b});this.detailsPage[a].bind("onShowOnMapTap",this._onShowOnMapTap,this);this.detailsPage[a].bind("onTicketTap",this._onTicketTap,this);this.dividedScreenView[a].setView2(this.detailsPage[a].render())}},onItemsReady:function(b){if(b.length>0){var a=b.at(0);a.trigger("itemClicked",a)}},_onShowOnMapTap:function(c){var e=c.get("venue");var d=e.lat;var b=e["long"];if(d&&b){var a={location:{lat:d,lng:b},header:c.get("title"),address:e.location};var c=new Backbone.Model({markers:[a]});MapManager.show_on_map(this.$el,c)}},_onTicketTap:function(a){var b=a.get("meta").ticketUrl;conduitApi.app.openLink(null,null,{url:b})}}); var EventsView=ItemsView.extend({className:"events-view",initialize:function(){var c="home_"+Utils.Helpers.generateGUID();this.$el.attr({"data-role":"page","data-buttons":"navigation refresh",id:c});this.id=c;var a=parseInt(this.model.get("layoutId"))||0;if(a<0||a>=EventsTemplates.eventsList.length){a=0}var b={logoImgUrl:this.model.get("logoImgUrl")};this.$el.html(EventsTemplates.eventsList[a](b));Scrolling.init(this.$el.find(".scroll_wrapper"));this.$scroller=this.$el.find(".scroller");this.$el.bind("refresh",this.handleRefreshClick.hitch(this));this.$el.bind("silentRefresh",this.handleSilentRefresh.hitch(this));ItemsView.prototype.initialize.apply(this)},createItemView:function(a){return new EventView({model:a})},getRootView:function(){return this.$scroller.find(".events_container")},addTabsView:function(a){this.$scroller.find(".tabs_container").html(a)},_onGetItemsSuccess:function(){var a=this.model.get("items").length;var c=this.$scroller.find(".no_events_container");if(a===0&&!this.model.get("logoImgUrl")){this.$el.addClass("clr_contTypeB_fullPage_bg");var b={text:_T("HtmlTextEventsNoEventsStr")};c.html(EventsTemplates.noEvents(b))}else{c.html("");this.$el.removeClass("clr_contTypeB_fullPage_bg")}BaseItemsView.prototype._onGetItemsSuccess.apply(this)}}); var EventView=Backbone.View.extend({tagName:"li",className:"event-view t3d",events:{tap:"onTap"},initialize:function(){this.$el.attr("data-role","button");this.model.bind("change:selected",this.onSelectedChange,this);var a=this.model.get("layoutId")||0;switch(a){case 0:this.$el.addClass("layout-large-cal clr_contTypeB_bubbleItem_bg clr_contTypeB_bubbleItem_brdr feed_bubble_item");break;case 1:this.$el.addClass("layout-large-cal clr_contTypeB_headerItem_bg clr_contTypeB_headerItem_brdr feed_classic_item");break;case 2:this.$el.addClass("layout-small-cal clr_contTypeB_bubbleItem_bg clr_contTypeB_bubbleItem_brdr");break;default:this.$el.addClass("layout-large-cal clr_contTypeB_bubbleItem_bg clr_contTypeB_bubbleItem_brdr feed_bubble_item");break}},render:function(){var b=this.model.toJSON();var a=parseInt(this.model.get("layoutId"))||0;if(a<0||a>=EventsTemplates.event.length){a=0}this.$el.html(EventsTemplates.event[a](b));return this},onTap:function(a){a.preventDefault();this.model.trigger("itemClicked",this.model)},onSelectedChange:function(){if(LAYOUT===layoutFormat.wide){if(this.model.get("selected")){this.$el.addClass("selected")}else{this.$el.removeClass("selected")}}}}); var EventDetailedView=Backbone.View.extend({className:"event-detailed-view",initialize:function(){var a="home_"+Utils.Helpers.generateGUID();this.$el.attr({"data-role":"page","data-buttons":"back",id:a});this.id=a},render:function(){var b=this.model.toJSON();b.venueStr=_T("HtmlTextEventsVenueStr");b.locationStr=_T("HtmlTextEventsLocationStr");b.phoneNumberStr=_T("HtmlTextEventsPhoneNumberStr");if(b.venue){b.venue.location=EventsTemplateHelper.formatVenueString(b.venue)}if(b.descriptionPlainText){b.description=Utils.String.sanitizeText(b.descriptionPlainText,true)}this.$el.html(EventsTemplates.eventDetailed(b));if(b.description&&!b.descriptionPlainText){var c=Utils.Html.replaceURLWithHTMLLinks(b.description);var a=new HtmlContainerControl();a.renderHtml(this.$el.find(".description"),c,{changeColors:true})}this.addButtons(b);Scrolling.init(this.$el.find(".scroll_wrapper"));return this},addButtons:function(a){var e=this.$el.find(".control_buttons_container");ShareControlHelper.addShareControlButton(e,this.model);if(a.venue&&a.venue.lat&&a.venue["long"]){var d=new FlatButtonView({text:_T("HtmlTextShowOnMapButtonStr"),icon:"show-on-map"});d.bind("onButtonClicked",this._showOnMap,this);e.append(d.render().el)}if(a.meta&&a.meta.ticketUrl){var g=new FlatButtonView({text:_T("HtmlTextEventsTicketStr"),icon:"events-ticket-small"});g.bind("onButtonClicked",this._ticket,this);e.append(g.render().el)}if(false&&a.rsvp&&a.rsvp.length){var c=a.rsvp[0];if(c.providerId===3){var b=new FlatButtonView({text:_T("HtmlTextEventsRsvpButton"),icon:"events-ticket-small",dropDown:[{value:"attending",caption:_T("HtmlTextEventsRsvpAttending"),newCaption:_T("HtmlTextEventsRsvpAttending")},{value:"maybe",caption:_T("HtmlTextEventsRsvpMaybe"),newCaption:_T("HtmlTextEventsRsvpMaybe")},{value:"decline",caption:_T("HtmlTextEventsRsvpDecline"),newCaption:_T("HtmlTextEventsRsvpDecline")},{value:"",caption:"Cancel",selected:true}]});b.bind("onButtonClicked",this._rsvpClick,this);e.append(b.render().el)}}if(PLATFORM==platformEnum.nativeApp&&navigator&&navigator.events){var f=new FlatButtonView({text:_T("HtmlTextEventsAdd2CalStr"),icon:"events-add2cal"});f.bind("onButtonClicked",this._add2Calendar,this);e.append(f.render().el)}},_add2Calendar:function(){var d=this.model.get("times")[0];var b=d.startTime;var a=d.endTime;var c={startTime:b,endTime:a,title:this.model.get("title"),description:this.model.get("descrition"),eventLocation:this.model.get("location"),allDayEvent:this.model.get("isAllDayEvent")};navigator.events.addToCalendar(c)},_showOnMap:function(){this.trigger("onShowOnMapTap",this.model)},_rsvpClick:function(c){if(c){if(PLATFORM===platformEnum.simulator){cqm.showToastMessage("This action is not supported in simulator mode.");return}var a=function(e){if(e===true){}};var b=function(e){};var d=this.model.get("rsvp")[0].eventId;FacebookLib.rsvpEvent(d,c,a,b)}},_ticket:function(){this.trigger("onTicketTap",this.model)}}); var linksTemplates={};linksTemplates.pageTemplate=_.template('<div class="scroll_wrapper"><div class="scroller"><% if(typeof(logoImgUrl)!= "undefined" && logoImgUrl){ %><div class="header" style="background-image:url(<%= logoImgUrl %>);"><% if(typeof(text)!= "undefined" && text){ %><div class="header_box clr_contTypeC_bg"><div class="size_title_3 max_3_lines links_title clr_contTypeC_hdlTxt"><%= text %></div></div><% } %></div><% } %><div class="linksContainer"></div></div></div>');linksTemplates.linkTemplate=_.template('<div class="link" data-role="button"><% if(typeof(imageUrl)!= "undefined" && imageUrl){ %><div class="link_image contain_image" style="background-image:url(<%= imageUrl %>);"></div><% } else if(typeof(title)!= "undefined" && title){ %><span class="link_title ellipsis"><%= title %></span><% } %></div>');linksTemplates.linkDetailsTemplate=_.template('<div class="scroll_wrapper"><div class="scroller"><% if (imageUrl) { %><img class="img clr_contTypeA_brdr" src="<%= imageUrl %>" /><% } %><% if (linkTitle ) { %><a class="linkItem clr_contTypeA_bg clr_contTypeA_brdr" href="javascript:void(0)" data-role="button" ><div class="icon mask_sprite sprite-link clr_contTypeA_icn" alt="" /><div class="size_title_1 linkTitle clr_contTypeA_hdlTxt"><%= linkTitle %></div></a><% } %><% if (title) { %><div class="size_title_4 title clr_contTypeA_hdlTxt"><%= title %></div><% } %><% if (description) { %><div class="size_title_1 descriptionTitle clr_contTypeA_subTxt"><%= descriptionTitle %></div><div class="size_0 description clr_contTypeA_txt"></div><% } %></div></div>'); var LinksView=Backbone.View.extend({className:"links_page",initialize:function(){this.$el.attr({"data-role":"page","data-buttons":"navigation"});var a=this.model.get("layoutId");if(a===0||a===1||a===3){$(window).bind("throttledresize",this.onResize.hitch(this));this.$el.bind("pageshow",function(){setTimeout(function(){this.onPageShow()}.hitch(this),10)}.hitch(this));this.$el.bind("pagehide",this.onPageHide.hitch(this))}},render:function(){var e=linksTemplates.pageTemplate;var b=this.model.get("layoutId");this.$el.html(e(this.model.toJSON())).addClass("layout-"+b);if(LAYOUT===layoutFormat.wide){this.$el.addClass("wide")}var d=linksTemplates.linkTemplate;var a=this.$(".linksContainer");var c=this.model.get("links");if(c){$.each(c,function(h,i){var g=$(d(i));a.append(g);g.tap(function(j){if(i.details){this.trigger("openLinkDetails",i)}else{if(conduitApi.app.isSupported()){conduitApi.app.openLink(null,null,{url:i.url,title:i.title})}}return false}.hitch(this))}.hitch(this))}a.find("IMG").error(function(){$(this).remove()});this.$itemsList=a;var f=this.$(".scroll_wrapper");Scrolling.init(f);return this},onResize:function(){if(this.isPageShow){this.updateGrid()}},onPageShow:function(){this.isPageShow=true;this.updateGrid();this.$itemsList.css({visibility:"visible"})},onPageHide:function(){this.isPageShow=false;this.$itemsList.css({visibility:"hidden"})},updateGrid:function(){var b={minWidth:150,maxWidth:99999,margin:0,setAlsoMargin:false,setAlsoHeight:false};var a=this.model.get("layoutId");if(a===1){b.setAlsoHeight=true;b.minWidth=100}else{if(a===3){b.margin=10;b.minWidth=120}}if(LAYOUT===layoutFormat.wide){b.minWidth=b.minWidth*2}Utils.Html.setGridSizes(this.$itemsList,b)},addTabsView:function(a){this.$(".scroller").prepend(a)}}); var LinksTemplateView=TemplateView.extend({initialize:function(){TemplateView.prototype.initialize.apply(this);var a=this.model.get("meta");if(!a.pageLayout||a.pageLayout<0||a.pageLayout>3){a.pageLayout=0}this.model.set({meta:a})},render:function(b){var d=this.model.get("meta");var c=d[this.options.tabsName][b]||{};c.layoutId=d.pageLayout;var e=new Backbone.Model(c);this._changePageParams.homePageId="home_"+Utils.Helpers.generateGUID();var a=new LinksView({model:e,id:this._changePageParams.homePageId});a.bind("openLinkDetails",this.onLinkSelected,this);this.$el.append(a.render().el);this._homePagesViews[b]=a;TemplateView.prototype.render.apply(this,[b]);return this},onLinkSelected:function(a){if(this.detailsPage){this.detailsPage.remove()}this.detailsPage=new LinkDetailsView({model:new Backbone.Model(a),id:"details_"+Utils.Helpers.generateGUID()});this.$el.append(this.detailsPage.render().el);$.mobile.changePage("#"+this.detailsPage.id,{transition:"slide",reverse:IS_RTL})}}); var LinkDetailsView=Backbone.View.extend({className:"link_details_page clr_contTypeA_bg",initialize:function(){this.$el.attr({"data-role":"page","data-buttons":"back"})},render:function(){var b=this.model.get("details")||{};var c={descriptionTitle:_T("HtmlTextLinksDescriptionTitle"),linkTitle:b.linkTitle||"",title:b.title||"",imageUrl:b.imageUrl||"",description:b.description||""};this.$el.html(linksTemplates.linkDetailsTemplate(c));if(c.description){var a=new HtmlContainerControl();a.renderHtml(this.$(".description"),c.description,{changeColors:false})}this.$(".linkItem").tap(function(g){if(conduitApi.app.isSupported()){var f=this.model.toJSON();conduitApi.app.openLink(null,null,{url:f.url,title:f.title})}return false}.hitch(this));var d=this.$(".scroll_wrapper");Scrolling.init(d);this.$("IMG").load(function(){Scrolling.onContentChanged(d)}).error(function(){$(this).remove()});return this}}); var formTemplates={};formTemplates.dateEdit=_.template('<div class="control_container"><% if(typeof(caption)!= "undefined" && caption){ %><div class="control_caption clr_contTypeB_hdlTxt"><%= caption %></div><% } %><div class="form_dropdown_list rounded_corners_all clr_form_element_bg clr_form_element_brdr clr_form_element_txt"><div class="dropdown_button rounded_corners_right clr_form_dropdown_bg clr_form_dropdown_brdr"><div class="combo-arrow mask_sprite clr_form_dropdown_icn sprite-arrowDown"></div></div><div class="combo-text ellipsis"></div><input class="hidden_input" control-id="<%= id %>" type="<%= subType %>" /></div></div>');formTemplates.comboSelection=_.template('<div class="control_container"><% if(typeof(caption)!= "undefined" && caption){ %><div class="control_caption clr_contTypeB_hdlTxt"><%= caption %></div><% } %><div class="form_dropdown_list rounded_corners_all clr_form_element_bg clr_form_element_brdr clr_form_element_txt"><div class="dropdown_button rounded_corners_right clr_form_dropdown_bg clr_form_dropdown_brdr"><div class="combo-arrow mask_sprite clr_form_dropdown_icn sprite-arrowDown"></div></div><div class="combo-text ellipsis"></div><select class="hidden_input multichoices-option" control-id="<%= id %>"><%= options_html %></select></div></div>');formTemplates.comboSelectionOption=_.template('<option value="<%= value %>"<% if(typeof(selected)!= "undefined" && selected){ %> selected="selected %>"<% } %>><%= caption %></option>');formTemplates.inputText=_.template('<div class="control_container"><% if(typeof(caption)!= "undefined" && caption){ %><div class="control_caption clr_contTypeB_hdlTxt"><%= caption %></div><% } %><div class="text_input_container"><input control-id="<%= id %>" type="<%= subType %>" class="text_input rounded_corners_all clr_form_input_bg clr_form_input_brdr clr_form_input_txt"<% if(typeof(placeholder)!= "undefined" && placeholder){ %> placeholder="<%= placeholder %>"<% } %> /></div></div>');formTemplates.inputMemoText=_.template('<div class="control_container"><% if(typeof(caption)!= "undefined" && caption){ %><div class="control_caption clr_contTypeB_hdlTxt"><%= caption %></div><% } %><div class="text_input_container"><textarea rows="<%= rows %>" control-id="<%= id %>" class="text_input ui-corner-all clr_form_input_bg clr_form_input_brdr clr_form_input_txt"<% if(typeof(placeholder)!= "undefined" && placeholder){ %> placeholder="<%= placeholder %>"<% } %> /></div></div>');formTemplates.checkBoxSelection=_.template('<div class="control_container"><% if(typeof(caption)!= "undefined" && caption){ %><div class="control_caption clr_contTypeB_hdlTxt"><%= caption %></div><% } %><div control-id="<%= id %>" class="radio"><%= options_html %></div></div>');formTemplates.checkBox=_.template('<div class="multichoices-option clr_form_element_bg clr_form_element_brdr clr_form_element_txt checkbox-option <% if (first) { %>ui-corner-top<% } %><% if (last) { %>ui-corner-bottom<% } %>"><input control-id="<%= id %>" type="checkbox" class="check_box multichoices-option-input"/><span class="multichoices-option-caption clr_form_element_txt"><%= caption %></span></div>');formTemplates.radioSelection=_.template('<div class="control_container"><% if(typeof(caption)!= "undefined" && caption){ %><div class="control_caption clr_contTypeB_hdlTxt"><%= caption %></div><% } %><div control-id="<%= id %>" class="radio"><%= options_html %></div></div>');formTemplates.radioSelectionOption=_.template('<div class="multichoices-option clr_form_element_bg clr_form_element_brdr clr_form_element_txt radio-option <% if (first) { %>ui-corner-top<% } %><% if (last) { %>ui-corner-bottom<% } %>"><input class="multichoices-option-input" type="radio" name="<%= id %>" value="<%= value %>" <% if (selected) { %>checked="true"<% } %>/><span class="multichoices-option-caption clr_form_element_txt"><%= caption %></span></div>');formTemplates.pageTemplate=_.template('<div class="scroll_wrapper"><div class="scroller"><% if(typeof(logoImgUrl)!= "undefined" && logoImgUrl){ %><div class="header" style="background-image:url(<%= logoImgUrl %>);"><% if(typeof(text)!= "undefined" && text){ %><div class="header_box clr_contTypeC_bg"><div class="links_title clr_contTypeC_hdlTxt"><%= text %></div></div><% } %></div><% } %><div class="form"><div class="descrContainer"></div><div class="controlsContainer"></div><div class="send_button ui-corner-all clr_contTypeA_btn_bg clr_contTypeA_btn_brdr clr_contTypeA_btn_hdlTxt clr_contTypeA_btn_icn" data-role="button"><%= send_button_caption %></div></div></div></div>'); var FormTemplateHelper={addItems:function(a){if(a.subType==="country"){this._addCountryItems(a)}else{if(a.subType==="state"){this._addStateItems(a)}}},_addStateItems:function(a){a.items=[{caption:"Non US",value:"-"},{caption:"Alabama",value:"AL"},{caption:"Alaska",value:"AK"},{caption:"Arizona",value:"AZ"},{caption:"Arkansas",value:"AR"},{caption:"California",value:"CA"},{caption:"Colorado",value:"CO"},{caption:"Connecticut",value:"CT"},{caption:"Delaware",value:"DE"},{caption:"Florida",value:"FL"},{caption:"Georgia",value:"GA"},{caption:"Hawaii",value:"HI"},{caption:"Idaho",value:"ID"},{caption:"Illinois",value:"IL"},{caption:"Indiana",value:"IN"},{caption:"Iowa",value:"IA"},{caption:"Kansas",value:"KS"},{caption:"Kentucky",value:"KY"},{caption:"Louisiana",value:"LA"},{caption:"Maine",value:"ME"},{caption:"Maryland",value:"MD"},{caption:"Massachusetts",value:"MA"},{caption:"Michigan",value:"MI"},{caption:"Minnesota",value:"MN"},{caption:"Mississippi",value:"MS"},{caption:"Missouri",value:"MO"},{caption:"Montana",value:"MT"},{caption:"Nebraska",value:"NE"},{caption:"Nevada",value:"NV"},{caption:"New Hampshire",value:"NH"},{caption:"New Jersey",value:"NJ"},{caption:"New Mexico",value:"NM"},{caption:"New York",value:"NY"},{caption:"North Carolina",value:"NC"},{caption:"North Dakota",value:"ND"},{caption:"Ohio",value:"OH"},{caption:"Oklahoma",value:"OK"},{caption:"Oregon",value:"OR"},{caption:"Pennsylvania",value:"PA"},{caption:"Rhode Island",value:"RI"},{caption:"South Carolina",value:"SC"},{caption:"South Dakota",value:"SD"},{caption:"Tennessee",value:"TN"},{caption:"Texas",value:"TX"},{caption:"Utah",value:"UT"},{caption:"Vermont",value:"VT"},{caption:"Virginia",value:"VA"},{caption:"Washington",value:"WA"},{caption:"West Virginia",value:"WV"},{caption:"Wisconsin",value:"WI"},{caption:"Wyoming",value:"WY"}]},_addCountryItems:function(a){if(typeof(a.selectedIndex)!="number"){a.selectedIndex=184}a.items=[{caption:"Afghanistan",value:"AF"},{caption:"Albania",value:"AL"},{caption:"Algeria",value:"DZ"},{caption:"Andorra",value:"AD"},{caption:"Angola",value:"AO"},{caption:"Antigua and Barbuda",value:"AG"},{caption:"Argentina",value:"AR"},{caption:"Armenia",value:"AM"},{caption:"Australia",value:"AU"},{caption:"Austria",value:"AT"},{caption:"Azerbaijan",value:"AZ"},{caption:"Bahamas",value:"BS"},{caption:"Bahrain",value:"BH"},{caption:"Bangladesh",value:"BD"},{caption:"Barbados",value:"BB"},{caption:"Belarus",value:"BY"},{caption:"Belgium",value:"BE"},{caption:"Belize",value:"BZ"},{caption:"Benin",value:"BJ"},{caption:"Bhutan",value:"BT"},{caption:"Bolivia",value:"BO"},{caption:"Bosnia Herzegovina",value:"BA"},{caption:"Botswana",value:"BW"},{caption:"Brazil",value:"BR"},{caption:"Brunei",value:"BN"},{caption:"Bulgaria",value:"BG"},{caption:"Burkina",value:"BF"},{caption:"Burundi",value:"BI"},{caption:"Cambodia",value:"KH"},{caption:"Cameroon",value:"CM"},{caption:"Canada",value:"CA"},{caption:"Cape Verde",value:"CV"},{caption:"Central African Rep",value:"CF"},{caption:"Chad",value:"TD"},{caption:"Chile",value:"CL"},{caption:"China",value:"CN"},{caption:"Colombia",value:"CO"},{caption:"Comoros",value:"KM"},{caption:"Congo",value:"CD"},{caption:"Costa Rica",value:"CR"},{caption:"Croatia",value:"HR"},{caption:"Cuba",value:"CU"},{caption:"Cyprus",value:"CY"},{caption:"Czech Republic",value:"CZ"},{caption:"Denmark",value:"DK"},{caption:"Djibouti",value:"DJ"},{caption:"Dominica",value:"DM"},{caption:"Dominican Republic",value:"DO"},{caption:"East Timor",value:"East Timor"},{caption:"Ecuador",value:"EC"},{caption:"Egypt",value:"EG"},{caption:"El Salvador",value:"SV"},{caption:"Equatorial Guinea",value:"GQ"},{caption:"Eritrea",value:"ER"},{caption:"Estonia",value:"EE"},{caption:"Ethiopia",value:"ET"},{caption:"Fiji",value:"FJ"},{caption:"Finland",value:"FI"},{caption:"France",value:"FR"},{caption:"Gabon",value:"GA"},{caption:"Gambia",value:"GM"},{caption:"Georgia",value:"GE"},{caption:"Germany",value:"DE"},{caption:"Ghana",value:"GH"},{caption:"Greece",value:"GR"},{caption:"Grenada",value:"GD"},{caption:"Guatemala",value:"GT"},{caption:"Guinea",value:"GN"},{caption:"Guyana",value:"GY"},{caption:"Haiti",value:"HT"},{caption:"Honduras",value:"HN"},{caption:"Hungary",value:"HU"},{caption:"Iceland",value:"IS"},{caption:"India",value:"IN"},{caption:"Indonesia",value:"ID"},{caption:"Iran",value:"IR"},{caption:"Iraq",value:"IQ"},{caption:"Ireland",value:"IE"},{caption:"Israel",value:"IL"},{caption:"Italy",value:"IT"},{caption:"Ivory Coast",value:"CI"},{caption:"Jamaica",value:"JM"},{caption:"Japan",value:"JP"},{caption:"Jordan",value:"JO"},{caption:"Kazakhstan",value:"KZ"},{caption:"Kenya",value:"KE"},{caption:"Kiribati",value:"KI"},{caption:"Korea North",value:"KP"},{caption:"Korea South",value:"KR"},{caption:"Kosovo",value:"Kosovo"},{caption:"Kuwait",value:"KW"},{caption:"Kyrgyzstan",value:"KG"},{caption:"Laos",value:"LA"},{caption:"Latvia",value:"LV"},{caption:"Lebanon",value:"LB"},{caption:"Lesotho",value:"LS"},{caption:"Liberia",value:"LR"},{caption:"Libya",value:"LY"},{caption:"Liechtenstein",value:"LI"},{caption:"Lithuania",value:"LT"},{caption:"Luxembourg",value:"LU"},{caption:"Macedonia",value:"MK"},{caption:"Madagascar",value:"MG"},{caption:"Malawi",value:"MW"},{caption:"Malaysia",value:"MY"},{caption:"Maldives",value:"MV"},{caption:"Mali",value:"ML"},{caption:"Malta",value:"MT"},{caption:"Marshall Islands",value:"MH"},{caption:"Mauritania",value:"MR"},{caption:"Mauritius",value:"MU"},{caption:"Mexico",value:"MX"},{caption:"Micronesia",value:"FM"},{caption:"Moldova",value:"MD"},{caption:"Monaco",value:"MC"},{caption:"Mongolia",value:"MN"},{caption:"Montenegro",value:"ME"},{caption:"Morocco",value:"MA"},{caption:"Mozambique",value:"MZ"},{caption:"Myanmar",value:"MM"},{caption:"Namibia",value:"NA"},{caption:"Nauru",value:"NR"},{caption:"Nepal",value:"NP"},{caption:"Netherlands",value:"NL"},{caption:"New Zealand",value:"NZ"},{caption:"Nicaragua",value:"NI"},{caption:"Niger",value:"NE"},{caption:"Nigeria",value:"NG"},{caption:"Norway",value:"NO"},{caption:"Oman",value:"OM"},{caption:"Pakistan",value:"PK"},{caption:"Palau",value:"PW"},{caption:"Panama",value:"PA"},{caption:"Papua New Guinea",value:"PG"},{caption:"Paraguay",value:"PY"},{caption:"Peru",value:"PE"},{caption:"Philippines",value:"PH"},{caption:"Poland",value:"PL"},{caption:"Portugal",value:"PT"},{caption:"Qatar",value:"QA"},{caption:"Romania",value:"RO"},{caption:"Russian Federation",value:"RU"},{caption:"Rwanda",value:"RW"},{caption:"St Kitts & Nevis",value:"KN"},{caption:"St Lucia",value:"LC"},{caption:"Saint Vincent",value:"VC"},{caption:"Samoa",value:"WS"},{caption:"San Marino",value:"SM"},{caption:"Sao Tome",value:"ST"},{caption:"Saudi Arabia",value:"SA"},{caption:"Senegal",value:"SN"},{caption:"Serbia",value:"RS"},{caption:"Seychelles",value:"SC"},{caption:"Sierra Leone",value:"SL"},{caption:"Singapore",value:"SG"},{caption:"Slovakia",value:"SK"},{caption:"Slovenia",value:"SI"},{caption:"Solomon Islands",value:"SB"},{caption:"Somalia",value:"SO"},{caption:"South Africa",value:"ZA"},{caption:"South Sudan",value:"South Sudan"},{caption:"Spain",value:"ES"},{caption:"Sri Lanka",value:"LK"},{caption:"Sudan",value:"SD"},{caption:"Suriname",value:"SR"},{caption:"Swaziland",value:"SZ"},{caption:"Sweden",value:"SZ"},{caption:"Switzerland",value:"CH"},{caption:"Syria",value:"SY"},{caption:"Taiwan",value:"TW"},{caption:"Tajikistan",value:"TJ"},{caption:"Tanzania",value:"TZ"},{caption:"Thailand",value:"TH"},{caption:"Togo",value:"TG"},{caption:"Tonga",value:"TO"},{caption:"Trinidad & Tobago",value:"TT"},{caption:"Tunisia",value:"TN"},{caption:"Turkey",value:"TR"},{caption:"Turkmenistan",value:"TM"},{caption:"Tuvalu",value:"TV"},{caption:"Uganda",value:"UG"},{caption:"Ukraine",value:"UA"},{caption:"United Arab Emirates",value:"AE"},{caption:"United Kingdom",value:"GB"},{caption:"United States",value:"US"},{caption:"Uruguay",value:"UY"},{caption:"Uzbekistan",value:"UZ"},{caption:"Vanuatu",value:"VU"},{caption:"Vatican City",value:"VA"},{caption:"Venezuela",value:"VE"},{caption:"Vietnam",value:"VN"},{caption:"Yemen",value:"YE"},{caption:"Zambia",value:"ZM"},{caption:"Zimbabwe",value:"ZW"}]}}; var FormView=Backbone.View.extend({className:"clr_contTypeB_bg",initialize:function(){this.$el.attr({"data-role":"page","data-buttons":"navigation"});var a=this.model.get("controls");a=$.map(a,function(b){return b.isActive?b:null});this.model.set({controls:a})},_manageTextAreas:function(){var a=this.$("TEXTAREA");a.bind("touchstart mousedown",function(b){b.stopPropagation()})},render:function(){var d=formTemplates.pageTemplate;var b=this.model.toJSON();b.send_button_caption=this.model.get("sendButton").caption||_T("HtmlTextFormSendButton");this.$el.html(d(b));var a=new HtmlContainerControl();var c=this.model.get("description");a.renderHtml(this.$(".descrContainer"),c,{changeColors:true});this._addFormContent();this.$el.find("*").bind("focus",function(){$(this).parent().removeClass("mandatory")});this.$(".send_button").tap(this._onSendButtonTap.hitch(this));this._manageTextAreas();var e=this.$(".scroll_wrapper");Scrolling.init(e);return this},_createDateEdit:function(h){if(!h.subType){h.subType="date"}if(!h.dateFormat){if(h.subType==="date"){h.dateFormat="longDate"}else{if(h.subType==="datetime"){h.dateFormat="dateTime"}}}var g=$(formTemplates.dateEdit(h));var f=g.find("INPUT");var e=g.find(".combo-text");var a=function(j){if(j){e.removeClass("watermark");if(h.dateFormat){try{j=new Date(j).format(h.dateFormat)}catch(i){}}e.text(j)}else{e.addClass("watermark");e.text(h.placeholder||"")}};var b=(DEVICE===deviceTypeEnum.iphone&&PLATFORM!==platformEnum.simulator);if(b){var d=function(j){var i=f.val();a(i)};f.blur(d).change(d)}else{var c=function(j){j.preventDefault();var i={initialDate:f.val()};DatePickerDialog.execute(function(k){f.val(k);a(k)},null,i)};f.tap(c)}a();return g},_createCombobox:function(f){FormTemplateHelper.addItems(f);if(f.items&&!f.dontAddEmpty){f.items.unshift({caption:"--",value:""});if(typeof(f.selectedIndex)==="number"){f.selectedIndex++}}var a="";var e=f.selectedIndex||0;_.each(f.items,function(h,g){h.caption=h.caption||"";h.value=h.value||"";h.id=f.id;h.selected=(g===e);h.first=(g==0);h.last=(g==f.items.length-1);a+=formTemplates.comboSelectionOption(h)});f.options_html=a;var d=$(formTemplates.comboSelection(f));var c=d.find("SELECT");var b=d.find(".combo-text");c.bind("touchstart mousedown",function(g){g.stopPropagation()});c.change(function(i){i.preventDefault();var h=null;var g=null;c.find("option:selected").each(function(){h=$(this).val();g=$(this).text()});if(h){b.removeClass("watermark");b.text(g)}else{b.addClass("watermark");b.text(f.placeholder||"")}});c.change();return d},_createTextEdit:function(b){if(!b.subType){b.subType="text"}var a=$(formTemplates.inputText(b));return a},_createTextArea:function(b){if(!b.rows){b.rows="3"}var a=$(formTemplates.inputMemoText(b));return a},_addFormContent:function(){var b=this;var c=this.$(".controlsContainer");var a=this.model.toJSON();_.each(a.controls,function(e,d){if(e.type==="combobox"){c.append(b._createCombobox(e))}else{if(e.type==="inputtext"){c.append(b._createTextEdit(e))}else{if(e.type==="textarea"){c.append(b._createTextArea(e))}else{if(e.type==="dateedit"){c.append(b._createDateEdit(e))}}}}})},_getControlsValues:function(){var b={};var a=this.model.toJSON();for(var d in a.controls){d=a.controls[d];var c=$('[control-id="'+d.id+'"]');var e="";if(d.type==="checkbox"){e=c.prop("checked")}else{if(d.type==="radio"){e=$("[name="+d.id+"]:checked").val()}else{e=c.val()}}if(d.isMandatory&&e===""){conduitApi.UI.showToastMessage(null,null,_T("ToastMessageFormFieldMandatory",{fieldName:d.caption}),this.$el,3000);c.parent().addClass("mandatory");return null}c.parent().removeClass("mandatory");b[d.id]=e}return b},_onSendButtonTap:function(i){$("input").blur();var d=this.model.get("successMessage")||_T("DialogMessageFormSendSuccess");var c=this.model.get("failMessage")||_T("DialogMessageFormSendFail");var a=function(){var e=[{text:_T("ButtonOk"),cb:function(){}},];conduitApi.UI.showDialogBox(null,null,{title:"Success",message:d,buttons:e});conduitApi.UI.dismissActivityIndicator()};var g=function(j){var e=[{text:_T("ButtonOk"),cb:function(){}},];conduitApi.UI.showDialogBox(null,null,{title:_T("DialogCaptionError"),message:c,buttons:e});conduitApi.UI.dismissActivityIndicator()};var b=this._getControlsValues();if(!b){return}var f={postParams:b};conduitApi.UI.startActivityIndicator(null,null,_T("IndicatorLoading"));var h=this.model.toJSON();Services.executeService("CONTACT_CONTENT_PUT",h,a.hitch(this),g,f)},addTabsView:function(a){this.$(".scroller").prepend(a)}}); var FormTemplateView=TemplateView.extend({render:function(c){var e=this.model.get("meta");var d=e[this.options.tabsName][c];var b=new Backbone.Model(d);this._changePageParams.homePageId="home_"+Utils.Helpers.generateGUID();var a=new FormView({model:b,id:this._changePageParams.homePageId});this.$el.append(a.render().el);this._homePagesViews[c]=a;TemplateView.prototype.render.apply(this,[c]);return this}}); var webModuleTemplates={};webModuleTemplates.pageIframeTemplate=_.template('<iframe frameborder="0" marginheight="0" marginwidth="0" scrolling="no" src="<%= link %>"></iframe>');webModuleTemplates.pageStaticTemplate=_.template('<div class="scroll_wrapper"><div class="scroller"><div class="size_title_4 text clr_contTypeB_hdlTxt"><%= text %></div></div></div>'); var WebModuleTemplateView=TemplateView.extend({initialize:function(){TemplateView.prototype.initialize.apply(this);var a=Utils.Helpers.inverseDict(platformEnum);this.platformString=a[PLATFORM]},render:function(e){var g=this.model.get("meta"),f=g[this.options.tabsName][e],c=f&&f.staticPages,h=(c)?c[this.platformString]:null,d=new Backbone.Model(f),a=WebModuleView;if(h){a=StaticPageView}var b=new a({model:d,id:"page_"+Utils.Helpers.generateGUID()});this.$el.append(b.render().el);this._homePagesViews[e]=b}}); var WebModuleView=Backbone.View.extend({className:"clr_contTypeB_bg",attributes:{"data-role":"page","data-buttons":"navigation"},render:function(){if(PLATFORM===platformEnum.webApp&&this.model.get("staticMessage")){var a={text:Utils.String.translateIfNeed(this.model.get("staticMessage"))};this.$el.html(webModuleTemplates.pageStaticTemplate(a))}else{if(PLATFORM===platformEnum.simulator&&this.model.get("staticMessageCP")){var a={text:Utils.String.translateIfNeed(this.model.get("staticMessageCP"))};this.$el.html(webModuleTemplates.pageStaticTemplate(a))}else{var a={link:this.model.get("link")};this.$el.html(webModuleTemplates.pageIframeTemplate(a));this.$el.css({height:"100%"})}}var b=this.$(".scroll_wrapper");if(b.length>0){Scrolling.init(b)}return this},addTabsView:function(a){this.$el.find(".scroller").prepend(a)}}); var collectionsEnums={PagesLayouts:{0:"default"}};collectionsEnums.nodeType={CATEGORY:"3ffdbd0e-3a28-41e8-b446-c3008edebe04",ITEM:"83a5a90b-6950-49c3-a0c9-594f82df3e6a"};var collectionsNodesTypes={"3ffdbd0e-3a28-41e8-b446-c3008edebe04":"node","83a5a90b-6950-49c3-a0c9-594f82df3e6a":"item"}; (function(){var a={collectionsWrapper:_.template('<div class="scroll_wrapper"><div class="scroller"></div></div>'),layouts:{"default":{node_view:_.template('<div class="header"><div class="search_container_container"></div><% if (headerImage && !isSearch) { %><div class="image-container clr_contTypeA_bg clr_contTypeA_brdr"><div class="header_image sliced_image" style="background-image: url(\'<%= headerImage %>\');"><% if (name || description) { %><div class="text_container clr_contTypeC_bg"><div class="collection_title title size_title_3 max_2_lines clr_contTypeC_hdlTxt"><% if (name) { %><%= name %><% } %></div><% if (description) { %><div class="collection_subtitle size_0 time clr_contTypeC_txt"><%= description %></div><% } %></div><% } %></div></div><% } %></div><div class="descendants_container"></div>'),search_view:_.template('<div class="search_container clr_contTypeB_bg clr_contTypeB_brdr"><form class="search_form" action="javascript:void(0)"><input type="text" class="search_input rounded_corners_all clr_form_input_bg clr_form_input_brdr clr_form_input_txt" placeholder="<%= _T("CollectionsSearchPlaceholder", {"category": name}) %>" /><a class="search_button clr_contTypeB_btn_bg clr_contTypeB_btn_brdr clr_contTypeB_btn_hdlTxt rounded_corners_all" data-role="button"><div class="mask_sprite sprite-search clr_contTypeB_btn_icn"></div></a><input type="submit" style="display: none"></form></div>'),item_view:_.template('<div class="item_view_content_container clr_contTypeA_classicItem_bg"><div class="item_name clr_contTypeA_hdlTxt"><%= name %></div><% if (images.length > 0) { %><div class="images_container images_amount_<%= images.length %>  clr_contTypeA_subBg"><div class="main_image sliced_image" style="background-image: url(\'<%= images[0] %>\');"><div class="full_screen_hint sprite sprite-FullScreenIcon"></div></div><% if (images.length > 1) { %><div class="thumbnails_container"><table class="thumbnails_table" data-role="controlgroup"><tr><td width="*"><div class="sliced_image item_thumbnail images_imgBtn_bg images_imgBtn_brdr" style="background-image: url(\'<%= images[0] %>\');" data-role="button"></div></td><td width="*"><div class="sliced_image item_thumbnail" style="background-image: url(\'<%= images[1] %>\');" data-role="button"></div></td><% if (images.length > 2) { %><td width="*"><div class="sliced_image item_thumbnail" style="background-image: url(\'<%= images[2] %>\');" data-role="button"></div></td><% } %><tr></table></div><% } %></div><% } %><% if (price && _.isFinite(priceInt)) { %><div class="price_container clr_contTypeA_subBg"><% if (contact_store) { %><div data-role="button" class="buy_now clr_contTypeB_actBtn_bg clr_contTypeB_actBtn_brdr clr_contTypeB_actBtn_hdlTxt order ui-btn-up" href="<%= contact_store %>"><span class="text"><%= _T("CollectionsBuyNow") %></span></div><% } %><div class="info_container"><span class="current_price clr_contTypeC_subTxt"><%= _T("CollectionsCurrentPrice") %>:</span><br /><span class="price clr_contTypeA_hdlTxt"><%= price %></span></div></div><% } %></div><!-- /clr_contTypeA_hdlTxt --><div class="clr_contTypeB_bg clr_contTypeB_txt"><% if (details) { %><div class="details_container"><div class="details_header clr_contTypeB_hdlTxt"><%= _T("CollectionsItemDetails") %>:</div></div><% } %><div class="contact_details_container"><% if (contact_email) { %><%= collectionsTemplates.layouts[layout]["contact_link_template"]({type: "email", icon_caption: _T("CollectionsContactItem-Email") + ":<br />" + contact_email, href: "mailto:" + contact_email, sprite_name: "aboutus_email"}) %><% } %><% if (contact_facebook) { %><%= collectionsTemplates.layouts[layout]["contact_item_template"]({type: "facebook", icon_caption: _T("CollectionsContactItem-Facebook"), href: contact_facebook, sprite_name: "aboutus_facebook", message: "Facebook page"}) %><% } %><% if (contact_linkedin) { %><%= collectionsTemplates.layouts[layout]["contact_item_template"]({type: "linkedin", icon_caption: _T("CollectionsContactItem-Linkedin"), href: contact_linkedin, sprite_name: "aboutus_linkedin", message: "Linkedin page"}) %><% } %><% if (contact_twitter) { %><%= collectionsTemplates.layouts[layout]["contact_item_template"]({type: "twitter", icon_caption: _T("CollectionsContactItem-Twitter"), href: contact_twitter, sprite_name: "aboutus_twitter", message: "Twitter Page"}) %><% } %><% if (contact_web) { %><%= collectionsTemplates.layouts[layout]["contact_item_template"]({type: "web", icon_caption: _T("CollectionsContactItem-Website"), href: contact_web, sprite_name: "aboutus_link", message: "Visit Site"}) %><% } %><% if (contact_web2) { %><%= collectionsTemplates.layouts[layout]["contact_item_template"]({type: "web", icon_caption: _T("CollectionsContactItem-Website"), href: contact_web2, sprite_name: "aboutus_link", message: "Visit Site"}) %><% } %><div style="clear: both;"></div></div></div></div>'),contact_link_template:_.template('<a href="<%= href %>" data-role="button" class="ui-btn-up contact_icon sprite sprite-<%= sprite_name %>"></a>'),contact_item_template:_.template('<span data-href="<%= href %>" data-role="button" class="ui-btn-up contact_icon sprite sprite-<%= sprite_name %>"></span>'),node_descendant_summary:_.template('<% if (typeof thumbnail !== "undefined") { %><div class="thumbnail sliced_image" style="background-image:url(\'<%= thumbnail %>\');"></div><% } %><div class="descendant_summary_content_container"><div class="descendant_summary_content_table_emulation"><div class="descendant_summary_content_tr_emulation"><div class="descendant_summary_content"><div class="descendant_summary_title clr_contTypeA_hdlTxt"><%= title %></div><div class="descendant_summary_subtitle clr_contTypeA_subTxt"><%= subtitle %></div><% if (_.isFinite(price)) { %><div class="descendant_summary_price clr_contTypeA_Txt"><%= price %></div><% } %></div></div></div></div><div class="slide_arrow_image mask_sprite sprite-arrow clr_contTypeA_icn"></div>')}}};a.layouts["default"].item_descendant_summary=a.layouts["default"].node_descendant_summary;a.no_items_results=_.template('<div class="no_results_container no_items_results_container clr_contTypeB_bg clr_contTypeB_brdr"><div class="title size_title_4 clr_contTypeB_hdlTxt"><%= _T("CollectionsSearchNoItemsFound") %></div><div class="subtitle size_title_1 clr_contTypeB_subTxt"><%= _T("CollectionsSearchNoItemsFoundSubtitle", {node_name: node_name}) %></div></div>');a.no_search_results=_.template('<div class="no_results_container no_search_results_container clr_contTypeB_bg clr_contTypeB_brdr"><div class="watermark mask_sprite sprite-noSearchItemsIcn clr_contTypeB_subIcn"></div><div class="title size_title_4 clr_contTypeB_hdlTxt"><%= _T("CollectionsSearchNoResultsFound") %></div><div class="subtitle size_title_1 clr_contTypeB_subTxt"><%= _T("CollectionsSearchNoResultsFoundSubtitle", {node_name: node_name, query_string: query_string}) %></div></div>');a.CollectionsCategoryLeftView=_.template('<div class="scroll_wrapper"><div class="scroller"><% if (headerImage) { %><div class="headerImage sliced_image" style="background-image:url(\'<%= headerImage %>\');"><div class="catImage clr_images_catImage_bg"></div></div><% } %><% if (name) { %><div class="name size_title_4 clr_contTypeA_hdlTxt"><%= name %></div><% } %><% if (description) { %><div class="description size_1 clr_contTypeA_subTxt"><%= description %></div><% } %></div></div>');a.CollectionsItemRightView=_.template('<div class="scroll_wrapper"><div class="scroller"><div class="data_content"><% if (headerImage) { %><div class="headerImage sliced_image" style="background-image:url(\'<%= headerImage %>\');"><div class="catImage clr_images_catImage_bg"></div><div class="full_screen_hint sprite sprite-FullScreenIcon"></div></div><% } %><% if (meta.images.length > 1) { %><div class="images_container clr_contTypeB_subBg"><div class="item_thumbnail sliced_image" style="background-image:url(\'<%= meta.images[0] %>\');"><div data-role="button" class="catImage clr_images_catImage_bg selected" data-index="0"></div></div><div class="item_thumbnail sliced_image" style="background-image:url(\'<%= meta.images[1] %>\');"><div data-role="button" class="catImage clr_images_catImage_bg" data-index="1"></div></div><% if (meta.images.length > 2) { %><div class="item_thumbnail sliced_image" style="background-image:url(\'<%= meta.images[2] %>\');"><div data-role="button" class="catImage clr_images_catImage_bg" data-index="2"></div></div><% } %></div><% } %><% if (name) { %><div class="name size_title_4 clr_contTypeB_hdlTxt"><%= name %></div><% } %><% if (description) { %><div class="description size_1 clr_contTypeB_subTxt"><%= description %></div><% } %><% if ((meta.price && _.isArray(meta.priceArr)) || (meta.links && meta.links.store)) { %><div class="price_container clr_contTypeB_subBg"><% if (meta.price && _.isArray(meta.priceArr)) { %><div class="price clr_contTypeB_hdlTxt" dir="ltr"><% if (meta.currencySign) { %><span class="currency"><%= meta.currencySign %></span><% } %><span class="dollars"><%= meta.priceArr[0] %></span><span class="cents"><%= meta.priceArr[1] %></span></div><% } %><% if (meta.links && meta.links.store) { %><div data-role="button" class="buy_now clr_contTypeB_actBtn_bg clr_contTypeB_actBtn_brdr clr_contTypeB_actBtn_hdlTxt"><span class="text"><%= _T("CollectionsBuyNow") %></span></div><% } %></div><% } %><% if (meta.details) { %><div class="details size_1 clr_contTypeB_txt"><%= meta.details %></div><% } %></div><div class="scrollingBug"></div></div></div>');a.CollectionsCategoryRightView=_.template('<div class="scroll_wrapper"><div class="scroller"><div class="bread_wrapper"></div><div class="no_result_wrapper"></div><div class="grid_wrapper"></div></div></div>');a.CollectionsItemLeftView=_.template('<div class="scroll_wrapper"><div class="scroller"></div></div>');a.CollectionsGridItemView={category:_.template('<% if (headerImage) { %><div class="headerImage sliced_image" style="background-image:url(\'<%= headerImage %>\');"><div class="header_box clr_contTypeC_bg"><% if(name){ %><div class="size_title_3 _1_line name clr_contTypeC_hdlTxt ellipsis"><%= name %></div><% } %><% if(itemsCountStr){ %><div class="size_title_0 _1_line itemsCountStr clr_contTypeC_subTxt"><%= itemsCountStr %></div><% } %></div><div data-role="button" class="catImage clr_images_catImage_bg"></div></div><% } %>'),item:_.template('<% if (headerImage) { %><div class="headerImage sliced_image" style="background-image:url(\'<%= headerImage %>\');"><% if (meta.price) { %><div data-role="button" class="catImage clr_images_catImage_bgGrad"></div><div class="price clr_images_catImage_txt" dir="ltr"><% if (meta.currencySign && _.isArray(meta.priceArr)) { %><span class="currency"><%= meta.currencySign %></span><% } %><% if (_.isArray(meta.priceArr) && meta.priceArr.length > 0) { %><span class="dollars"><%= meta.priceArr[0] %></span><% } %><% if (_.isArray(meta.priceArr) && meta.priceArr.length > 1) { %><span class="cents"><%= meta.priceArr[1] %></span><% } %></div><% } else { %><div data-role="button" class="catImage clr_images_catImage_bg"></div><% } %></div><% } %><% if (name) { %><div class="name_container size_1 _2_lines clr_contTypeB_hdlTxt"><div class="name"><%= name %></div></div><% } %>')};a.CollectionsListItemView=_.template('<% if (headerImage) { %><div class="headerImage sliced_image" style="background-image:url(\'<%= headerImage %>\');"><div class="catImage clr_images_catImage_bg"></div></div><% } %><div class="vertical_center"><div><% if (name) { %><div class="name size_1 <% if (meta.price) { %>max_2_lines<% } else { %>max_3_lines<% } %> clr_contTypeA_hdlTxt"><%= name %></div><% } %><% if (meta.price && _.isArray(meta.priceArr)) { %><div class="price clr_contTypeA_subTxt" dir="ltr"><% if (meta.currencySign) { %><span class="currency"><%= meta.currencySign %></span><% } %><% if (meta.priceArr.length > 0) { %><span class="dollars"><%= meta.priceArr[0] %></span><% } %><% if (meta.priceArr.length > 1) { %><span class="cents"><%= meta.priceArr[1] %></span><% } %></div><% } %></div></div>');a.BreadCrumb=_.template('<span class="BreadCrumb size_1 clr_contTypeA_subTxt"><%= name %></span><div class="BreadCrumbArrow mask_sprite sprite-breadArrow clr_contTypeA_subIcn"></div>');a.lastBreadCrumb=_.template('<span class="BreadCrumb size_1 clr_contTypeA_hdlTxt"><%= name %></span>');a.Search=_.template('<span class="search_container clr_form_input_bg clr_form_input_brdr"><div class="right mainButtonContainer clr_form_input_brdr"  data-role="button"><div class="clearButton mask_sprite sprite-la-cancel clr_form_input_icn selected"></div><div class="searchButton mask_sprite sprite-search clr_form_input_icn"></div></div><div class="left searchIndicator mask_sprite sprite-catSearchSmall clr_form_input_icn"></div><div class="right clearEditButton"><div class="mask_sprite sprite-catXSmall clr_form_input_icn" data-role="button"></div></div><div class="textContainer clr_form_input_txt"><form class="search_form" action="javascript:void(0)"><input type="text" class="searchInput" placeholder="<%= placeholder %>" /></form></div></span><div class="clearfix"></div>');a.BreadBarView=_.template('<div class="breadContainer ellipsis"></div>');window.collectionsTemplates=a})(); var CollectionsItemModel=ItemModel.extend({}); var CollectionsNodeModel=ItemsModel.extend({defaults:{id:null,collectionId:null,nodeId:null,meta:{},description:"",name:"",headerImage:"",isCategory:true,itemsCount:null,defaultImage:"http://storage.conduit.com/Mobile/66/e4/663a9521-49e4-4c44-80b4-826b9ff4405f/Images/fd4fa8cc-4253-4959-9f8b-4b05f54d4e09.png",breadCrumbs:[]},initialize:function(){ItemsModel.prototype.initialize.apply(this,arguments);var c=this.get("meta");var a=c.images||{};this.set({headerImage:a.header||a[0]||a.main1||this.get("defaultImage")});if(this.get("type")==="item"){this.set({isCategory:false})}if(c.priceInt){var b=(""+c.priceInt).split(".");b[0]=localization.formatNumber(b[0]);if(!b[1]){b[1]="00"}if(b[1].length===1){b[1]=b[1]+"0"}c.priceArr=b}if(c.links&&(c.links.email||c.links.web||c.links.linkedin)){var e={buttons:{twitter:null,facebook:null,linkedin:c.links.linkedin,webSite:c.links.web,mySpace:null,email:c.links.email}};var d=new Backbone.Model(e);c.shareIconsModel=d}this.set({name:this.get("name"),description:this.get("description"),})},createItemsCollection:function(){var b={id:this.get("collectionId"),parentId:this.get("nodeId"),defaultImage:this.get("defaultImage")};var a=new CollectionsCollection(null,b);a.breadCrumbs=_.extend([],this.get("breadCrumbs"));a.breadCrumbs.push(this);a.term=this.get("term");a.type=this.get("type");return a},setSearch:function(a,b){var d=this.get("items");d.term=a;d.type=b;d.reset();var c=executeTypeEnum.HIT_AND_RUN;d.getNextItems(c)},getSearchTerm:function(){var a=this.get("items");return a.term},clearSearch:function(){this.setSearch(null,null)}}); var CollectionsCollection=ItemsCollection.extend({model:CollectionsNodeModel,initialize:function(b,a){ItemsCollection.prototype.initialize.apply(this,arguments);this.defaultImage=a.defaultImage;this.layoutId=a.layoutId;this.parentId=a.parentId;if(!a||!a.id){this.invalid=true}this.params={id:a.id,extraInfo:{parentId:a.parentId},collectionId:a.id,type:null,searchParams:{term:null,parentId:a.parentId,sortOrder:0}}},parse:function(b){b=b||{};var e=this.params.id;var a=this.layoutId;var d=b.defaultImage||this.defaultImage;var c=this.breadCrumbs;_.each(b.items,function(h){h.collectionId=e;h.layoutId=a;h.defaultImage=d;h.breadCrumbs=c;h.nodeId=h.id;h.type=collectionsNodesTypes[h.type];if(h.type==="item"){var j=h.meta.images,f=[];if(typeof j!=="undefined"){for(var g=0;g<10;g++){if(typeof j["main"+g]!=="undefined"){f.push(j["main"+g])}}h.meta.images=f}}});return{models:b.items,metaData:b}},getParams:function(){this.params.skip=this.skip;this.params.type=this.type;this.params.searchParams.term=this.term;return this.params},getServiceName:function(){if(this.term){return"CMS_CONTENT_ITEMS_SEARCH"}else{if(this.parentId){return"CMS_CONTENT_ITEMS"}else{return"CMS_CONTENT_COLLECTION"}}}}); var CollectionsDescendantSummaryView=ItemsView.extend({tagName:"li",className:"descendant_summary clr_contTypeA_classicItem_bg clr_contTypeA_classicItem_brdr",events:{},initialize:function(){this.$el.data("model",this.model)},render:function(){this.$el.attr("data-role","button");var b=this.model.get("type");var c=this.model.get("meta");var a=collectionsTemplates.layouts[this.options.layout][b+"_descendant_summary"];var d=undefined;this.$el.addClass("no_thumbnail");if(b==="node"){if(typeof c!=="undefined"&&typeof c.images!=="undefined"&&typeof c.images.main!=="undefined"&&c.images.main.length>0){d=c.images.main;this.$el.removeClass("no_thumbnail")}}else{if(b==="item"){if(typeof c.images[0]!=="undefined"&&c.images[0].length>0){d=c.images[0];this.$el.removeClass("no_thumbnail")}}}this.$el.append(a({title:this.model.get("name"),subtitle:this.model.get("description"),price:this.model.get("meta").price,thumbnail:d}));return this}}); var CollectionsItemView=Backbone.View.extend({events:{"tap .item_thumbnail":"collectionItemThumbnailClicked"},initialize:function(){this.$el.attr({"data-role":"page","data-buttons":"back refresh"});this.$el.html(collectionsTemplates.collectionsWrapper());this.$el.data("model",this.model).data("view",this);this.$el.addClass("item_view");this.$el.attr("parent",this.model.get("parentId"));Scrolling.init(this.$el.find(".scroll_wrapper"));this.$scroller=this.$el.find(".scroller");var d=collectionsTemplates.layouts[this.model.get("layout")]["item_view"];this.$scroller.append(d({name:this.model.get("name"),description:this.model.get("description"),images:this.model.get("images"),price:this.model.get("price"),priceInt:this.model.get("priceInt"),details:this.model.get("details"),layout:this.model.get("layout"),contact_email:this.model.get("links").email,contact_facebook:this.model.get("links").facebook,contact_linkedin:this.model.get("links").linkedIn,contact_store:this.model.get("links").store,contact_twitter:this.model.get("links").twitter,contact_web:this.model.get("links").web,contact_web2:this.model.get("links").web2}));var b=this.model.get("details");if(b){var a=new HtmlContainerControl();a.renderHtml(this.$scroller.find(".details_container"),b,{changeColors:false})}var c=this.$scroller.find(".contact_details_container span.contact_icon");c.tap(function(){var f=$(this);var e=f.attr("data-href");if(conduitApi.app.isSupported()){conduitApi.app.openLink(null,null,{url:e,title:f.text()})}})},collectionItemThumbnailClicked:function(a){var b=$(a.target).closest(".images_container");$(".main_image",b).css("background-image",$(a.target).css("background-image"))},getRootView:function(){return this.$scroller}}); var CollectionsNodeView=ItemsView.extend({onPageShow:function(){$(".search_input").val("")},initialize:function(){this.events=_.extend({},this.events,{pageshow:"onPageShow"});var c="back refresh";if(this.model.get("root")===true){c="navigation refresh"}this.$el.attr({"data-role":"page","data-buttons":c});this.$el.html(collectionsTemplates.collectionsWrapper());this.$el.data("model",this.model).data("view",this);this.$el.addClass("collection_view");this.$el.attr("parent",this.model.get("parentId"));Scrolling.init(this.$el.find(".scroll_wrapper"));this.$scroller=this.$el.find(".scroller");var d=collectionsTemplates.layouts[this.model.get("layout")]["node_view"],b=collectionsTemplates.layouts[this.model.get("layout")]["search_view"];var a=!!this.model.get("term");this.$scroller.append(d({name:Utils.String.sanitizeText(this.model.get("name"),true),description:Utils.String.sanitizeText(this.model.get("description"),true),headerImage:this.model.get("headerImage"),isSearch:a}));if(!a){this.$scroller.find(".search_container_container").append(b({name:this.model.get("name")}))}this.$el.bind("refresh",this.handleRefreshClick.hitch(this));this.$el.bind("silentRefresh",this.handleSilentRefresh.hitch(this));ItemsView.prototype.initialize.apply(this)},getRootView:function(){return this.$scroller.find(".descendants_container")},createItemView:function(a){return new CollectionsDescendantSummaryView({model:a,layout:this.model.get("layout"),id:"descendant_"+a.get("id")})},onNoResults:function(){this.$scroller.css({height:"100%"});if(typeof this.model.get("term")!=="undefined"){this.$scroller.html(collectionsTemplates.no_search_results({query_string:this.model.get("term"),node_name:this.model.get("name")}))}else{this.$scroller.html(collectionsTemplates.no_items_results({node_name:this.model.get("name")}))}}}); (function(){var b=function(c){return c.charAt(0).toUpperCase()+c.slice(1)};var a=TemplateView.extend({defaultPagesOptions:{layout:"default"},defaultExecuteOptions:{executeType:executeTypeEnum.HIT_AND_RUN},events:{"tap .descendant_summary":"collectionDescendantClicked","tap [href]":"openLink","tap .search_button":"onCollectionSearchButtonClicked","submit .search_form":"onCollectionSearchButtonClicked","tap .main_image":"onCollectionMainImageClicked"},dom_maps:{node_page_id:_.template("collection_<%= id %>"),item_page_id:_.template("item_<%= id %>"),search_page_id:_.template("search_<%= collection_id %>-<%= nodeId %>")},initialize:function(){if(PLATFORM==platformEnum.simulator){$.extend(this.defaultExecuteOptions,{executeType:executeTypeEnum.FORCE_NETWORK,forceServerNoCache:true})}TemplateView.prototype.initialize.apply(this,arguments)},getElementDbId:function(d){var c=$(d).closest('[data-role="page"]').data("model");if(c.get("nodeId")===null){return c.get("collectionId")}else{return c.get("nodeId")}},collectionDescendantClicked:function(g){g.preventDefault();var l=this.getElementDbId(g.currentTarget),i=$('[parent="'+l+'"]');i.remove();var f=$(g.currentTarget),c=f.data("model");var k=c.get("type"),d=c.id;if(k==="node"){var j=c.toJSON()}else{if(k==="item"){var m=c.get("meta");var j={name:c.get("name"),description:c.get("description"),images:m.images,links:m.links,price:m.price,priceInt:m.priceInt,details:m.details,parentId:this.getElementDbId(g.currentTarget)}}}var h=this["new"+b(k)+"Page"](this.collection_id,d,j);$.mobile.changePage("#"+h.view.id,{transition:"slide",reverse:IS_RTL})},openLink:function(f){var d=$(f.currentTarget).attr("href"),c=/^\s*(mailto|tel)/i.test(d);if(PLATFORM===platformEnum.simulator&&c){cqm.showToastMessage("This functionality doesn't work in simulator mode.");f.preventDefault();return}if(!c){conduitApi.app.openLink(null,null,{url:d});f.preventDefault()}},onCollectionSearchButtonClicked:function(h){var d=$(h.target).closest("[data-role=page]"),f=d.data("model"),i=f.get("nodeId"),c=d.find(".search_input").val();if($.trim(c)===""){return}var g=this.newSearchResultsPage(this.collection_id,i,f.get("name"),c);$.mobile.changePage("#"+g.view.id,{transition:"slide",reverse:IS_RTL})},onCollectionMainImageClicked:function(h){var g=$(h.target).closest("[data-role=page]"),f=g.data("model"),i=f.get("nodeId");var c=f.get("images"),d=$(h.currentTarget).css("background-image").replace(/url\(/i,"").replace(/\)\s*$/,"");images_array_for_gallery_manager=_.map(c,function(e){return{largeImage:e}});new PhotoGalleryManager().pressedImage(images_array_for_gallery_manager,c.indexOf(d))},newNodePage:function(f,g,e){if(typeof e==="undefined"){e={}}e=$.extend({layout:this.layout},{nodeId:g,collectionId:f},e);var d=new CollectionsNodeModel(e);var c=new CollectionsNodeView({id:Utils.Helpers.generateGUID(),model:d});d.getItems(this.defaultExecuteOptions);this.$el.append(c.render().el);return{model:d,view:c}},newItemPage:function(f,g,e){if(typeof e==="undefined"){e={}}e=$.extend({layout:this.layout},{nodeId:g,collectionId:f},e);var d=new CollectionsItemModel(e);var c=new CollectionsItemView({id:Utils.Helpers.generateGUID(),model:d});this.$el.append(c.render().el);return{model:d,view:c}},newSearchResultsPage:function(h,i,d,g,f){if(typeof f==="undefined"){f={}}if(typeof g==="undefined"||$.trim(g)===""){console.log("You have to specify term");return}if(this.searchPage!=null){this.searchPage.remove()}f=$.extend({layout:this.layout,type:"contenthost"},{collectionId:h,nodeId:i,term:g,name:d},f);var e=new CollectionsNodeModel(f);var c=new CollectionsNodeView({id:Utils.Helpers.generateGUID(),model:e});e.getItems(this.defaultExecuteOptions);this.searchPage=c;this.$el.append(c.render().el);return{model:e,view:c}},render:function(e){var f=this.model.get("meta"),d=f.items[e]||{params:{id:null}};this.collection_id=d.params.id;this.layout=typeof f.pageLayout!=="undefined"&&f.pageLayout!==-1?collectionsEnums.PagesLayouts[parseInt(f.pageLayout,10)]:this.defaultPagesOptions.layout;this.$el.addClass(this.layout+"_layout");d.root=true;var c=this.newNodePage(this.collection_id,null,d);this._homePagesViews[e]=c.view;TemplateView.prototype.render.apply(this,[e]);return this}});window.CollectionsTemplateView=a})(); var CollectionsGridItemView=Backbone.View.extend({tagName:"li",className:"CollectionsGridItemView",events:{tap:"itemClicked"},render:function(){var c=this.model.toJSON();if(this.model.get("isCategory")){var b="category";var a=collectionsTemplates.CollectionsGridItemView.category;if(c.itemsCount===null){c.itemsCountStr=_T("CollectionsCategoryUnknownItemsCount")}else{c.itemsCountStr=_T("CollectionsCategoryItemsCount",{count:c.itemsCount})}}else{var b="item";var a=collectionsTemplates.CollectionsGridItemView.item}this.$el.html(a(c)).addClass(b);return this},itemClicked:function(a){a.preventDefault();this.model.trigger("collectionItemClicked",this.model)}}); var CollectionsCategoryLeftView=Backbone.View.extend({className:"CollectionsCategoryLeftView clr_contTypeA_bg",render:function(){this.$el.html(collectionsTemplates.CollectionsCategoryLeftView(this.model.toJSON()));var a=this.$(".scroll_wrapper");Scrolling.init(a);return this}}); var BreadBarView=Backbone.View.extend({className:"BreadBarView clr_contTypeB_bg",events:{"tap .mainButtonContainer":"mainButtonClicked","tap .clearEditButton":"clearEditClicked","blur .searchInput":"inputExit","focus .searchInput":"inputEnter","input .searchInput":"inputChanged","submit .search_form":"searchClicked"},mainButtonClicked:function(){if(this.$searchButton.is(":visible")){this.searchClicked()}else{this.clearSearchClicked()}},searchClicked:function(){this.doSearch();this.$input.blur()},clearSearchClicked:function(){this.clearSearch();this.$input.blur()},clearEditClicked:function(){this.$input.val("")},inputEnter:function(){this.$searchIndicator.hide();this.$clearButton.hide();this.$searchButton.show();this.$clearEditButton.show()},inputExit:function(){this.cancelEdit()},inputChanged:function(){var a=this.$input.val();if(a){this.$searchButton.addClass("selected")}else{this.$searchButton.removeClass("selected")}},cancelEdit:function(){this.$clearEditButton.hide();var a=this.model.getSearchTerm();if(a){this.$searchButton.addClass("selected");this.$searchIndicator.show();this.$clearButton.show();this.$searchButton.hide()}else{this.$searchButton.removeClass("selected");this.$searchIndicator.hide();this.$clearButton.hide();this.$searchButton.show()}this.$input.val(a)},doSearch:function(){var a=this.$input.val();var b="contenthost";this.model.setSearch(a,b);this.$searchIndicator.show();this.$clearButton.show();this.$searchButton.hide()},clearSearch:function(){this.model.clearSearch();this.$searchIndicator.hide();this.$clearButton.hide();this.$searchButton.show()},initialize:function(){this.$el.html(collectionsTemplates.BreadBarView());var d=this.$(".breadContainer");var a=this.model.get("breadCrumbs");for(var c=0;c<a.length;c++){var b=a[c];d.append(collectionsTemplates.BreadCrumb(b.toJSON()))}var e={name:this.model.get("name")};d.append(collectionsTemplates.lastBreadCrumb(e));e={placeholder:_T("CollectionsSearchPlaceholder2")};this.$el.append(collectionsTemplates.Search(e));this.$input=this.$(".searchInput");this.$clearButton=this.$(".clearButton");this.$searchButton=this.$(".searchButton");this.$searchIndicator=this.$(".searchIndicator");this.$clearEditButton=this.$(".clearEditButton");this.cancelEdit()},render:function(){return this}}); var CollectionsCategoryRightView=ItemsView.extend({className:"CollectionsCategoryRightView clr_contTypeB_bg",initialize:function(){this.$el.html(collectionsTemplates.CollectionsCategoryRightView({}));this.$scroller=this.$(".scroller");this.$list=this.$(".grid_wrapper");this.$noResults=this.$(".no_result_wrapper");var c=new BreadBarView({model:this.model});var a=this.$(".bread_wrapper");a.html(c.render().el);var d=this.$(".scroll_wrapper");Scrolling.init(d);ItemsView.prototype.initialize.apply(this);$(window).bind("throttledresize",this.onResize.hitch(this));var b=this.model.get("items");if(b){b.bind("getItemsSuccess",this.onResize,this)}this.bind("pageshow",this.onPageShow.hitch(this));this.bind("pagehide",this.onPageHide.hitch(this));this.onPageHide();this.$el.bind("refresh",this.handleRefreshClick.hitch(this));this.$el.bind("silentRefresh",this.handleSilentRefresh.hitch(this))},getRootView:function(){return this.$list},createItemView:function(b){var a=new CollectionsGridItemView({model:b});return a},_reset:function(){this.$scroller.removeClass("noResults");this.$noResults.html("").removeClass("noResults");ItemsView.prototype._reset.apply(this,arguments)},onNoResults:function(){var a=this.model.get("name");var c=this.model.get("items").term;if(c){var b=collectionsTemplates.no_search_results({query_string:c,node_name:a})}else{var b=collectionsTemplates.no_items_results({node_name:a})}this.$scroller.addClass("noResults");this.$noResults.html(b).addClass("noResults")},updateThumbnailsMargin:function(){Utils.Html.setGridMargin(this.$itemsList)},onResize:function(){if(this.isPageShow){this.updateThumbnailsMargin();this.isGridUpdated=true}else{this.isGridUpdated=false;this.$itemsList.css({visibility:"hidden"})}},onPageShow:function(){this.isPageShow=true;if(!this.isGridUpdated){this.onResize();this.$itemsList.css({visibility:"visible"})}},onPageHide:function(){this.isPageShow=false;if(!this.isGridUpdated){this.$itemsList.css({visibility:"hidden"})}}}); var CollectionsWideCategoryView=DividedScreenView.extend({setCollectionModel:function(a){var b=new CollectionsCategoryLeftView({model:a});var c=new CollectionsCategoryRightView({model:a});this.setView1(b.render());this.setView2(c.render())}}); var CollectionsListItemView=Backbone.View.extend({tagName:"li",className:"CollectionsListItemView clr_contTypeA_bg clr_contTypeA_brdr",events:{tap:"itemClicked"},initialize:function(){this.$el.attr("data-role","button").addClass("t3d");this.model.bind("change:selected",this.onSelectedChange,this)},render:function(){this.$el.html(collectionsTemplates.CollectionsListItemView(this.model.toJSON()));return this},onSelectedChange:function(){if(this.model.get("selected")){this.$el.addClass("selected")}else{this.$el.removeClass("selected")}},itemClicked:function(a){a.preventDefault();this.model.trigger("itemClicked",this.model)}}); var CollectionsItemLeftView=ItemsView.extend({className:"CollectionsItemLeftView clr_contTypeA_bg",initialize:function(){this.$el.html(collectionsTemplates.CollectionsItemLeftView({}));this.$scroller=this.$(".scroller");this.$scrollWrapper=this.$(".scroll_wrapper");Scrolling.init(this.$scrollWrapper);ItemsView.prototype.initialize.apply(this);this.$el.bind("refresh",this.handleRefreshClick.hitch(this));this.$el.bind("silentRefresh",this.handleSilentRefresh.hitch(this));this.bind("pageshow",this.onPageShow.hitch(this))},onPageShow:function(){this.scrollToSelected()},scrollToSelected:function(){var d=this.$(".CollectionsListItemView.selected").offset();if(d){var a=this.$itemsList.offset();var c=d.top-a.top;var b=this.$scrollWrapper.height();if(c>b){Scrolling.scrollTo(this.$scrollWrapper,c,500)}}},getRootView:function(){return this.$scroller},createItemView:function(b){if(b.get("isCategory")){return null}var a=new CollectionsListItemView({model:b});return a},onNoResults:function(){this.$scroller.css({height:"100%"});if(typeof this.model.get("term")!=="undefined"){this.$scroller.html(collectionsTemplates.no_search_results({query_string:this.model.get("term"),node_name:this.model.get("name")}))}else{this.$scroller.html(collectionsTemplates.no_items_results({node_name:this.model.get("name")}))}}}); var CollectionsItemRightView=Backbone.View.extend({className:"CollectionsItemRightView clr_contTypeB_bg",events:{"tap .item_thumbnail":"thumbnailClicked","tap .headerImage":"headerImageClicked","tap .buy_now":"buyClicked"},initialize:function(){this.$el.html(collectionsTemplates.CollectionsItemRightView(this.model.toJSON()));var e=this.model.get("meta");var d=e.details;if(d){var a=this.$(".details");var b=new HtmlContainerControl();b.renderHtml(a,d,{changeColors:true})}var f=e.shareIconsModel;if(f){var c=new ShareIconsView({model:f});this.$(".data_content").append(c.render().el)}this.$mainImage=this.$(".headerImage");this.$colorOnImage=this.$(".catImage");this.$thumbnails=this.$(".item_thumbnail");this.$images_container=this.$(".images_container");this.$data_content=this.$(".data_content");this.$scrollWrapper=this.$(".scroll_wrapper");Scrolling.init(this.$scrollWrapper);$(window).bind("throttledresize",this.onResize.hitch(this));this.bind("pageshow",this.onPageShow.hitch(this));this.bind("pagehide",this.onPageHide.hitch(this));this.onPageHide()},render:function(){return this},buyClicked:function(b){var a=this.model.get("meta").links.store;if(conduitApi.app.isSupported()){conduitApi.app.openLink(null,null,{url:a,title:a})}},thumbnailClicked:function(c){var a=$(c.target);this.imageIndex=parseInt(a.attr("data-index"));var b=this.model.get("meta").images[this.imageIndex];this.$mainImage.css("background-image","url("+b+")");this.$colorOnImage.removeClass("selected");a.addClass("selected")},headerImageClicked:function(b){var a=_.map(this.model.get("meta").images,function(c){return{largeImage:c}});new PhotoGalleryManager().pressedImage(a,this.imageIndex||0)},updateViewSizes:function(){var f=500;var g=20;var h=this.$el.width();var b=h*0.7;b=Math.min(f,b);b=4*Math.floor(b/4);var i=3*b/4;var c=Math.floor((i-40)/3);var e=Math.floor(c*4/3);var d=b+10+10+e+10;var a=Math.floor((h-d)/2);a=Math.min(g,a);this.$mainImage.css({width:b,height:i});this.$thumbnails.css({width:e,height:c});this.$images_container.css({height:i});this.$data_content.css({width:d,marginTop:a});Scrolling.onContentChanged(this.$scrollWrapper)},onResize:function(){if(this.isPageShow){this.updateViewSizes()}},onPageShow:function(){this.isPageShow=(this.$el.width()>0);if(this.isPageShow){this.onResize();this.$data_content.css({visibility:"visible"})}},onPageHide:function(){this.isPageShow=false;this.$data_content.css({visibility:"hidden"})}}); var CollectionsWideItemView=DividedScreenView.extend({setCollectionModel:function(a){var b=new CollectionsItemLeftView({model:a});this.setView1(b.render());a.bind("itemSelected",this._onItemSelected,this)},setSelectedItem:function(a){a.trigger("itemClicked",a)},_updateView2:function(a){var b=new CollectionsItemRightView({model:a});this.setView2(b.render());b.trigger("pageshow")},_onItemSelected:function(a,b){this._updateView2(a)}}); var CollectionsWideTemplateView=TemplateView.extend({initialize:function(b,a){TemplateView.prototype.initialize.apply(this);this.categoryViewPages=[];this.itemViewPages=[]},render:function(c){var d=this.model.get("meta");var b=d[this.options.tabsName][c]||{};var e=b.params&&b.params.id;b.layoutId=d.pageLayout;b.collectionId=e;var a=new CollectionsNodeModel(b);this._homePagesViews[c]=this._createCollectionView(a);TemplateView.prototype.render.apply(this,[c]);return this},_createCollectionView:function(b){var d=b.get("id");if(this.categoryViewPages[d]){return this.categoryViewPages[d]}var c=new CollectionsWideCategoryView({id:"category_"+Utils.Helpers.generateGUID(),bubblePageEvents:true,leftWidth:"280px"});var a=function(g){if(g.get("isCategory")){var e=this._createCollectionView(g)}else{var e=this._createItemView(b,g)}var f=e.$el.attr("data-buttons");f=f.replace("navigation","back");e.$el.attr({"data-buttons":f});$.mobile.changePage("#"+e.id,{transition:"slide",reverse:IS_RTL})};b.get("items").bind("collectionItemClicked",a,this);c.setCollectionModel(b);this.$el.append(c.render().addRefreshButton(false,true).el);b.getItems(executeTypeEnum.HIT_AND_RUN);this.categoryViewPages[d]=c;return c},_createItemView:function(a,c){var d=a.get("id");if(this.itemViewPages[d]){this.itemViewPages[d].remove();this.itemViewPages[d]=null}var b=new CollectionsWideItemView({id:"item_"+Utils.Helpers.generateGUID(),bubblePageEvents:true,leftWidth:"34%"});b.setCollectionModel(a);b.setSelectedItem(c);this.$el.append(b.render().el);this.itemViewPages[d]=b;return b}}); (function(){var a={geo_errors:{1:"PERMISSION_DENIED",2:"POSITION_UNAVAILABLE",3:"TIMEOUT"}};this.reportsEnums=a})(); var ReportsTemplateHelper={addItems:function(a){var b=a.get("subType");if(b==="country"){this._addCountryItems(a)}else{if(b==="state"){this._addStateItems(a)}else{if(b==="gender"){this._addGenderItems(a)}}}},_addGenderItems:function(a){a.set({items:[{caption:"{$GenderMale}",value:"M"},{caption:"{$GenderFemale}",value:"F"}]})},_addStateItems:function(a){a.set({items:[{caption:"{$StateNonUS}",value:"-"},{caption:"{$StateAlabama}",value:"AL"},{caption:"{$StateAlaska}",value:"AK"},{caption:"{$StateArizona}",value:"AZ"},{caption:"{$StateArkansas}",value:"AR"},{caption:"{$StateCalifornia}",value:"CA"},{caption:"{$StateColorado}",value:"CO"},{caption:"{$StateConnecticut}",value:"CT"},{caption:"{$StateDelaware}",value:"DE"},{caption:"{$StateFlorida}",value:"FL"},{caption:"{$StateGeorgia}",value:"GA"},{caption:"{$StateHawaii}",value:"HI"},{caption:"{$StateIdaho}",value:"ID"},{caption:"{$StateIllinois}",value:"IL"},{caption:"{$StateIndiana}",value:"IN"},{caption:"{$StateIowa}",value:"IA"},{caption:"{$StateKansas}",value:"KS"},{caption:"{$StateKentucky}",value:"KY"},{caption:"{$StateLouisiana}",value:"LA"},{caption:"{$StateMaine}",value:"ME"},{caption:"{$StateMaryland}",value:"MD"},{caption:"{$StateMassachusetts}",value:"MA"},{caption:"{$StateMichigan}",value:"MI"},{caption:"{$StateMinnesota}",value:"MN"},{caption:"{$StateMississippi}",value:"MS"},{caption:"{$StateMissouri}",value:"MO"},{caption:"{$StateMontana}",value:"MT"},{caption:"{$StateNebraska}",value:"NE"},{caption:"{$StateNevada}",value:"NV"},{caption:"{$StateNewHampshire}",value:"NH"},{caption:"{$StateNewJersey}",value:"NJ"},{caption:"{$StateNewMexico}",value:"NM"},{caption:"{$StateNewYork}",value:"NY"},{caption:"{$StateNorthCarolina}",value:"NC"},{caption:"{$StateNorthDakota}",value:"ND"},{caption:"{$StateOhio}",value:"OH"},{caption:"{$StateOklahoma}",value:"OK"},{caption:"{$StateOregon}",value:"OR"},{caption:"{$StatePennsylvania}",value:"PA"},{caption:"{$StateRhodeIsland}",value:"RI"},{caption:"{$StateSouthCarolina}",value:"SC"},{caption:"{$StateSouthDakota}",value:"SD"},{caption:"{$StateTennessee}",value:"TN"},{caption:"{$StateTexas}",value:"TX"},{caption:"{$StateUtah}",value:"UT"},{caption:"{$StateVermont}",value:"VT"},{caption:"{$StateVirginia}",value:"VA"},{caption:"{$StateWashington}",value:"WA"},{caption:"{$StateWestVirginia}",value:"WV"},{caption:"{$StateWisconsin}",value:"WI"},{caption:"{$StateWyoming}",value:"WY"}]})},_addCountryItems:function(a){a.set({items:[{caption:"{$CountryAfghanistan}",value:"AF"},{caption:"{$CountryAlbania}",value:"AL"},{caption:"{$CountryAlgeria}",value:"DZ"},{caption:"{$CountryAndorra}",value:"AD"},{caption:"{$CountryAngola}",value:"AO"},{caption:"{$CountryAntiguaandBarbuda}",value:"AG"},{caption:"{$CountryArgentina}",value:"AR"},{caption:"{$CountryArmenia}",value:"AM"},{caption:"{$CountryAustralia}",value:"AU"},{caption:"{$CountryAustria}",value:"AT"},{caption:"{$CountryAzerbaijan}",value:"AZ"},{caption:"{$CountryBahamas}",value:"BS"},{caption:"{$CountryBahrain}",value:"BH"},{caption:"{$CountryBangladesh}",value:"BD"},{caption:"{$CountryBarbados}",value:"BB"},{caption:"{$CountryBelarus}",value:"BY"},{caption:"{$CountryBelgium}",value:"BE"},{caption:"{$CountryBelize}",value:"BZ"},{caption:"{$CountryBenin}",value:"BJ"},{caption:"{$CountryBhutan}",value:"BT"},{caption:"{$CountryBolivia}",value:"BO"},{caption:"{$CountryBosniaHerzegovina}",value:"BA"},{caption:"{$CountryBotswana}",value:"BW"},{caption:"{$CountryBrazil}",value:"BR"},{caption:"{$CountryBrunei}",value:"BN"},{caption:"{$CountryBulgaria}",value:"BG"},{caption:"{$CountryBurkina}",value:"BF"},{caption:"{$CountryBurundi}",value:"BI"},{caption:"{$CountryCambodia}",value:"KH"},{caption:"{$CountryCameroon}",value:"CM"},{caption:"{$CountryCanada}",value:"CA"},{caption:"{$CountryCapeVerde}",value:"CV"},{caption:"{$CountryCentralAfricanRep}",value:"CF"},{caption:"{$CountryChad}",value:"TD"},{caption:"{$CountryChile}",value:"CL"},{caption:"{$CountryChina}",value:"CN"},{caption:"{$CountryColombia}",value:"CO"},{caption:"{$CountryComoros}",value:"KM"},{caption:"{$CountryCongo}",value:"CD"},{caption:"{$CountryCostaRica}",value:"CR"},{caption:"{$CountryCroatia}",value:"HR"},{caption:"{$CountryCuba}",value:"CU"},{caption:"{$CountryCyprus}",value:"CY"},{caption:"{$CountryCzechRepublic}",value:"CZ"},{caption:"{$CountryDenmark}",value:"DK"},{caption:"{$CountryDjibouti}",value:"DJ"},{caption:"{$CountryDominica}",value:"DM"},{caption:"{$CountryDominicanRepublic}",value:"DO"},{caption:"{$CountryEastTimor}",value:"East Timor"},{caption:"{$CountryEcuador}",value:"EC"},{caption:"{$CountryEgypt}",value:"EG"},{caption:"{$CountryElSalvador}",value:"SV"},{caption:"{$CountryEquatorialGuinea}",value:"GQ"},{caption:"{$CountryEritrea}",value:"ER"},{caption:"{$CountryEstonia}",value:"EE"},{caption:"{$CountryEthiopia}",value:"ET"},{caption:"{$CountryFiji}",value:"FJ"},{caption:"{$CountryFinland}",value:"FI"},{caption:"{$CountryFrance}",value:"FR"},{caption:"{$CountryGabon}",value:"GA"},{caption:"{$CountryGambia}",value:"GM"},{caption:"{$CountryGeorgia}",value:"GE"},{caption:"{$CountryGermany}",value:"DE"},{caption:"{$CountryGhana}",value:"GH"},{caption:"{$CountryGreece}",value:"GR"},{caption:"{$CountryGrenada}",value:"GD"},{caption:"{$CountryGuatemala}",value:"GT"},{caption:"{$CountryGuinea}",value:"GN"},{caption:"{$CountryGuyana}",value:"GY"},{caption:"{$CountryHaiti}",value:"HT"},{caption:"{$CountryHonduras}",value:"HN"},{caption:"{$CountryHungary}",value:"HU"},{caption:"{$CountryIceland}",value:"IS"},{caption:"{$CountryIndia}",value:"IN"},{caption:"{$CountryIndonesia}",value:"ID"},{caption:"{$CountryIran}",value:"IR"},{caption:"{$CountryIraq}",value:"IQ"},{caption:"{$CountryIreland}",value:"IE"},{caption:"{$CountryIsrael}",value:"IL"},{caption:"{$CountryItaly}",value:"IT"},{caption:"{$CountryIvoryCoast}",value:"CI"},{caption:"{$CountryJamaica}",value:"JM"},{caption:"{$CountryJapan}",value:"JP"},{caption:"{$CountryJordan}",value:"JO"},{caption:"{$CountryKazakhstan}",value:"KZ"},{caption:"{$CountryKenya}",value:"KE"},{caption:"{$CountryKiribati}",value:"KI"},{caption:"{$CountryKoreaNorth}",value:"KP"},{caption:"{$CountryKoreaSouth}",value:"KR"},{caption:"{$CountryKosovo}",value:"Kosovo"},{caption:"{$CountryKuwait}",value:"KW"},{caption:"{$CountryKyrgyzstan}",value:"KG"},{caption:"{$CountryLaos}",value:"LA"},{caption:"{$CountryLatvia}",value:"LV"},{caption:"{$CountryLebanon}",value:"LB"},{caption:"{$CountryLesotho}",value:"LS"},{caption:"{$CountryLiberia}",value:"LR"},{caption:"{$CountryLibya}",value:"LY"},{caption:"{$CountryLiechtenstein}",value:"LI"},{caption:"{$CountryLithuania}",value:"LT"},{caption:"{$CountryLuxembourg}",value:"LU"},{caption:"{$CountryMacedonia}",value:"MK"},{caption:"{$CountryMadagascar}",value:"MG"},{caption:"{$CountryMalawi}",value:"MW"},{caption:"{$CountryMalaysia}",value:"MY"},{caption:"{$CountryMaldives}",value:"MV"},{caption:"{$CountryMali}",value:"ML"},{caption:"{$CountryMalta}",value:"MT"},{caption:"{$CountryMarshallIslands}",value:"MH"},{caption:"{$CountryMauritania}",value:"MR"},{caption:"{$CountryMauritius}",value:"MU"},{caption:"{$CountryMexico}",value:"MX"},{caption:"{$CountryMicronesia}",value:"FM"},{caption:"{$CountryMoldova}",value:"MD"},{caption:"{$CountryMonaco}",value:"MC"},{caption:"{$CountryMongolia}",value:"MN"},{caption:"{$CountryMontenegro}",value:"ME"},{caption:"{$CountryMorocco}",value:"MA"},{caption:"{$CountryMozambique}",value:"MZ"},{caption:"{$CountryMyanmar}",value:"MM"},{caption:"{$CountryNamibia}",value:"NA"},{caption:"{$CountryNauru}",value:"NR"},{caption:"{$CountryNepal}",value:"NP"},{caption:"{$CountryNetherlands}",value:"NL"},{caption:"{$CountryNewZealand}",value:"NZ"},{caption:"{$CountryNicaragua}",value:"NI"},{caption:"{$CountryNiger}",value:"NE"},{caption:"{$CountryNigeria}",value:"NG"},{caption:"{$CountryNorway}",value:"NO"},{caption:"{$CountryOman}",value:"OM"},{caption:"{$CountryPakistan}",value:"PK"},{caption:"{$CountryPalau}",value:"PW"},{caption:"{$CountryPanama}",value:"PA"},{caption:"{$CountryPapuaNewGuinea}",value:"PG"},{caption:"{$CountryParaguay}",value:"PY"},{caption:"{$CountryPeru}",value:"PE"},{caption:"{$CountryPhilippines}",value:"PH"},{caption:"{$CountryPoland}",value:"PL"},{caption:"{$CountryPortugal}",value:"PT"},{caption:"{$CountryQatar}",value:"QA"},{caption:"{$CountryRomania}",value:"RO"},{caption:"{$CountryRussianFederation}",value:"RU"},{caption:"{$CountryRwanda}",value:"RW"},{caption:"{$CountryStKittsNevis}",value:"KN"},{caption:"{$CountryStLucia}",value:"LC"},{caption:"{$CountrySaintVincent}",value:"VC"},{caption:"{$CountrySamoa}",value:"WS"},{caption:"{$CountrySanMarino}",value:"SM"},{caption:"{$CountrySaoTome}",value:"ST"},{caption:"{$CountrySaudiArabia}",value:"SA"},{caption:"{$CountrySenegal}",value:"SN"},{caption:"{$CountrySerbia}",value:"RS"},{caption:"{$CountrySeychelles}",value:"SC"},{caption:"{$CountrySierraLeone}",value:"SL"},{caption:"{$CountrySingapore}",value:"SG"},{caption:"{$CountrySlovakia}",value:"SK"},{caption:"{$CountrySlovenia}",value:"SI"},{caption:"{$CountrySolomonIslands}",value:"SB"},{caption:"{$CountrySomalia}",value:"SO"},{caption:"{$CountrySouthAfrica}",value:"ZA"},{caption:"{$CountrySouthSudan}",value:"SouthSudan"},{caption:"{$CountrySpain}",value:"ES"},{caption:"{$CountrySriLanka}",value:"LK"},{caption:"{$CountrySudan}",value:"SD"},{caption:"{$CountrySuriname}",value:"SR"},{caption:"{$CountrySwaziland}",value:"SZ"},{caption:"{$CountrySweden}",value:"SZ"},{caption:"{$CountrySwitzerland}",value:"CH"},{caption:"{$CountrySyria}",value:"SY"},{caption:"{$CountryTaiwan}",value:"TW"},{caption:"{$CountryTajikistan}",value:"TJ"},{caption:"{$CountryTanzania}",value:"TZ"},{caption:"{$CountryThailand}",value:"TH"},{caption:"{$CountryTogo}",value:"TG"},{caption:"{$CountryTonga}",value:"TO"},{caption:"{$CountryTrinidadTobago}",value:"TT"},{caption:"{$CountryTunisia}",value:"TN"},{caption:"{$CountryTurkey}",value:"TR"},{caption:"{$CountryTurkmenistan}",value:"TM"},{caption:"{$CountryTuvalu}",value:"TV"},{caption:"{$CountryUganda}",value:"UG"},{caption:"{$CountryUkraine}",value:"UA"},{caption:"{$CountryUnitedArabEmirates}",value:"AE"},{caption:"{$CountryUnitedKingdom}",value:"GB"},{caption:"{$CountryUnitedStates}",value:"US"},{caption:"{$CountryUruguay}",value:"UY"},{caption:"{$CountryUzbekistan}",value:"UZ"},{caption:"{$CountryVanuatu}",value:"VU"},{caption:"{$CountryVaticanCity}",value:"VA"},{caption:"{$CountryVenezuela}",value:"VE"},{caption:"{$CountryVietnam}",value:"VN"},{caption:"{$CountryYemen}",value:"YE"},{caption:"{$CountryZambia}",value:"ZM"},{caption:"{$CountryZimbabwe}",value:"ZW"}]})}}; var reportsTemplates={menusWrapper:_.template('<div class="scroll_wrapper"><div class="scroller"></div></div>'),reports_page_structure:_.template('<% if (header_image) { %>			<div class="header">				<div class="image-container clr_contTypeA_bg clr_contTypeA_brdr">					<div class="header_image sliced_image" style="background-image: url(\'<%= header_image %>\');">						<% if (title) { %>						<div class="text_container clr_contTypeC_bg">							<div class="reports_title title size_title_3 max_2_lines clr_contTypeC_hdlTxt">								<%= title %>							</div>						</div>						<% } %>					</div>				</div>			</div>		<% } %>		<% if (description) { %>			<div class="description clr_contTypeA_bg clr_contTypeA_txt clr_contTypeA_brdr">				<% if (!header_image) { %>					<div class="size_title_3 name clr_contTypeA_hdlTxt" style="margin-bottom: 5px;"><%= title %></div>				<% } %>				<%= description %>			</div>		<% } %>		<form action="javascript:void(0);" class="controls_form">			<div class="controls_container clr_contTypeB_bg clr_contTypeB_brdr clr_contTypeB_txt"></div>			<div class="submit_container clr_contTypeA_bg clr_contTypeA_txt">				<div data-role="button" class="send_button ui-corner-all clr_contTypeA_btn_bg clr_contTypeA_btn_brdr clr_contTypeA_btn_hdlTxt ui-btn-up">					<%= submit_text %>				</div>			</div>		</form>'),text_input_view_template:_.template('<input type="<%= subType %>" id="<%= id %>" class="text_input root_input_element rounded_corners_all clr_form_input_bg clr_form_input_brdr clr_form_input_txt isMandatory" placeholder="<%= caption %>" />'),textarea_input_view_template:_.template('<textarea id="<%= id %>" rows="3" class="text_input root_input_element ui-corner-all clr_form_input_bg clr_form_input_brdr clr_form_input_txt isMandatory" placeholder="<%= caption %>"></textarea>'),radio_inputs_container_view_template:_.template('<div class="root_input_element radio_inputs_container" id="<%= id %>"> 				<% if(typeof(caption)!= "undefined" && caption){ %> 					<div class="radio_inputs_caption clr_contTypeB_hdlTxt size_title_3"><%= caption %></div> 				<% } %> 		</div>'),radio_input_view_template:_.template('<div class="radio_input_container"> 		 	<input type="radio" name="<%= id %>" id="<%= id %>-<%= option_value %>" value="<%= option_value %>" class="radio_input" /> 		 	<label for="<%= id %>-<%= option_value %>" class="radio_input_tag clr_contTypeB_txt isMandatory">			 	<div class="radioBtn_selector clr_form_radioBtn_bg clr_form_radioBtn_brdr isMandatory" id="<%= id %>-<%= option_value %>"> 			 		<div class="radioBtn_selector_inner clr_form_radioBtn_icn"></div> 			 	</div> 			 	<%= option_label %>		 	</label> 		 </div>'),checkbox_view_template:_.template('<input type="checkbox" class="checkbox root_input_element" id="<%= id %>" />		<div class="checkbox_designed_controller_container">			<div class="checkbox_designed_controller ui-corner-all clr_form_checkBox_bg clr_form_checkBox_brdr isMandatory">				<div class="checkbox_tick mask_sprite sprite-chk_box_v clr_form_checkBox_icn">				</div>			</div>		</div>		<label for="<%= id %>" class="checkbox_label clr_contTypeB_txt isMandatory"><%= caption %></label>'),combobox_view_template:_.template('<div class="control_container">			<div class="form_dropdown_list rounded_corners_all clr_form_element_bg clr_form_element_brdr clr_form_element_txt isMandatory">				<div class="dropdown_button rounded_corners_right clr_form_dropdown_bg clr_form_dropdown_brdr">					<div class="combo-arrow mask_sprite clr_form_dropdown_icn sprite-arrowDown"></div>				</div>				<div class="combo-text ellipsis watermark">					<% if(typeof(caption)!= "undefined" && caption){ %>						<%= caption %>					<% } %>				</div>				<select class="hidden_input multichoices-option root_input_element">					<%= options_html %>				</select>			</div>		</div>'),combobox_option:_.template('<option value="<%= value %>">			<%= caption %>		</option>'),date_view_template:_.template('<div class="control_container">			<div class="form_dropdown_list rounded_corners_all clr_form_element_bg clr_form_element_brdr clr_form_element_txt isMandatory">				<div class="dropdown_button rounded_corners_right clr_form_dropdown_bg clr_form_dropdown_brdr">					<div class="combo-arrow mask_sprite clr_form_dropdown_icn sprite-arrowDown"></div>				</div>				<div class="combo-text ellipsis">					<% if(typeof(caption)!= "undefined" && caption){ %>						<%= caption %>					<% } %>				</div>				<input class="hidden_input datepicker root_input_element" control-id="<%= id %>" type="date" />			</div>		</div>'),time_view_template:_.template('<div class="control_container">			<div class="form_dropdown_list rounded_corners_all clr_form_element_bg clr_form_element_brdr clr_form_element_txt isMandatory">				<div class="dropdown_button rounded_corners_right clr_form_dropdown_bg clr_form_dropdown_brdr">					<div class="combo-arrow mask_sprite clr_form_dropdown_icn sprite-arrowDown"></div>				</div>				<div class="combo-text ellipsis">					<% if(typeof(caption)!= "undefined" && caption){ %>						<%= caption %>					<% } %>				</div>				<input class="hidden_input datepicker root_input_element" control-id="<%= id %>" type="time" />			</div>		</div>')}; (function(){var a=Backbone.View.extend({className:"input_container",input_type:"general_input",root_input_element:$(),events:{"focus *":"onFocus"},onFocus:function(){this.removeInvalidIndicator()},initialize:function(){this.$el.addClass(this.input_type+"_container");this.model.on("error",this.onValidationError.hitch(this));return this},applyInvalidIndicator:function(){this.$(".isMandatory").addClass("mandatory")},removeInvalidIndicator:function(){this.$(".isMandatory").removeClass("mandatory")},onValidationError:function(b,c){this.applyInvalidIndicator()},disable:function(){this.root_input_element.attr("disabled","disabled")},enable:function(){this.root_input_element.removeAttr("disabled")},updateModel:function(){return this.model.set("value",this.getValue())},setValue:function(b){this.root_input_element.val(b)},getValue:function(){return Utils.String.trim(this.root_input_element.val())},clear:function(){this.setValue(this.model.get("default_value"))},resize:function(){this.trigger("resize")}});window.ReportsBaseInputView=a})(); (function(){var a=ReportsBaseInputView.extend({input_type:"text_input",render:function(){params=this.model.toJSON();if(!params.subType){params.subType="text"}this.$el.html(reportsTemplates.text_input_view_template(params));this.root_input_element=this.$(".root_input_element");return this}});window.ReportsTextInputView=a})(); (function(){var a=ReportsBaseInputView.extend({input_type:"textarea_input",render:function(){this.$el.html(reportsTemplates.textarea_input_view_template(this.model.toJSON()));this.root_input_element=this.$(".root_input_element");return this}});window.ReportsTextareaInputView=a})(); (function(){var a=ReportsBaseInputView.extend({input_type:"checkbox",events:{change:"throttledOnChange","tap .checkbox_designed_controller_container":"change"},change:function(){if(this.isEnabled()){this.invertValue()}},initialize:function(){ReportsBaseInputView.prototype.initialize.apply(this);this.throttledOnChange=_.debounce(this.onChange,100,true)},onChange:function(){if(this.isChecked()){this.state_holders.addClass("selected")}else{this.state_holders.removeClass("selected")}this.removeInvalidIndicator()},render:function(){this.$el.html(reportsTemplates.checkbox_view_template(this.model.toJSON()));this.state_holders=this.$(".checkbox_designed_controller, .checkbox_tick");this.root_input_element=this.$(".root_input_element");return this},isChecked:function(){return this.root_input_element.is(":checked")},isEnabled:function(){return this.root_input_element.attr("disabled")!=="disabled"},getValue:function(){return this.isChecked()},invertValue:function(){if(this.isChecked()){this.setValue(false)}else{this.setValue(true)}},setValue:function(b){if(b){this.root_input_element.attr("checked","checked")}else{this.root_input_element.removeAttr("checked")}this.root_input_element.change()},disable:function(){this.state_holders.addClass("disabled");this.root_input_element.attr("disabled","disabled")},enable:function(){this.state_holders.removeClass("disabled");this.root_input_element.removeAttr("disabled")},clear:function(){this.render()}});window.ReportsCheckboxInputView=a})(); (function(){var a=ReportsCheckboxInputView.extend({input_type:"location",location:null,geo_driver_supported:null,events:{"click .root_input_element:checked":"onCheckGeoLocation"},onCheckGeoLocation:function(){this.checkGeoLocation(true)},initialize:function(){this.events=_.extend({},ReportsCheckboxInputView.prototype.events,this.events);this.model.init=true;this.model.set("caption",_T("ReportsShowMyLocationMessage"));this.model.init=false;this.geo_driver_supported=conduitApi.platform.geo.isSupported();ReportsCheckboxInputView.prototype.initialize.apply(this,arguments)},checkGeoLocation:function(c){var b=this;if(b.geo_driver_supported&&(b.location===null||typeof b.location.latitude==="undefined")){this.location={error:"waiting_for_driver"};conduitApi.platform.geo.getLocation(function(d){b.location=d.coords},function(){b.location={error:"failed_to_determine_a_location"};b.setValue(false);if(c===true){cqm.showToastMessage(_T("ReportsFailedToDetermineLocation"),this.$el)}},{enableHighAccuracy:true,timeout:3600000,maximumAge:3600000})}},updateModel:function(){if(this.root_input_element.is(":checked")){this.model.set({value:JSON.stringify(this.location)})}else{this.model.set({value:null})}return true},render:function(){ReportsCheckboxInputView.prototype.render.apply(this,arguments);this.setValue(true&&this.geo_driver_supported);if(!this.geo_driver_supported){this.disable()}this.checkGeoLocation(false)},disable:function(){this.$el.html("")}});window.ReportsShowLocationInputView=a})(); (function(){var a=ReportsBaseInputView.extend({input_type:"radio",events:{change:"onChange","tap .radio_inputs_container":"onChange"},onChange:function(){this.$inputs_container.find(".selected").removeClass("selected");if(this.isChecked()){var b=this.$("input:radio[name="+this.model.get("id")+"]:checked").parent();this._markSelectedElements(b)}this.removeInvalidIndicator()},_markSelectedElements:function(b){this.$("input:radio[name="+this.model.get("id")+"]:checked").addClass("selected");b.find("label").addClass("selected");b.find(".radioBtn_selector_inner").addClass("selected")},_fixLabels:function(b){b.find("label[for]").click(function(){var c=$(this).attr("for");if($("#"+c+"[type=radio]").attr("selected",!$("#"+c).attr("selected"))){return}else{$("#"+c)[0].focus()}})},render:function(){var b=this;this.$el.html(reportsTemplates.radio_inputs_container_view_template(this.model.toJSON()));this.$inputs_container=this.$(".radio_inputs_container");_.each(this.model.get("items"),function(f,d){var e=$.extend(b.model.toJSON(),{option_label:f.caption,option_value:f.value});var c=reportsTemplates.radio_input_view_template(e);b.$inputs_container.append(c);b._fixLabels(b.$inputs_container)});this.root_input_element=this.$(".root_input_element");return this},isChecked:function(){return this.$("input:radio[name="+this.model.get("id")+"]:checked").is(":checked")},_iterateInputs:function(b){if(typeof b==="function"){$(".radio_input",this.$inputs_container).each(b)}},setValue:function(b){this._iterateInputs(function(){var c=$(this);c.removeAttr("checked")});this._iterateInputs(function(){var c=$(this);if(c.attr("value")===b){c.attr("checked","checked")}});this.onChange()},disable:function(){this._iterateInputs(function(){var b=$(this);b.attr("disabled","disabled")})},enable:function(){this._iterateInputs(function(){var b=$(this);b.removeAttr("disabled")})},getValue:function(){return this.$("input:radio[name="+this.model.get("id")+"]:checked").val()}});window.ReportsRadioInputView=a})(); var ReportsDatePickerView=ReportsBaseInputView.extend({input_type:"date",render:function(){var g=this.model.toJSON();var d=$(reportsTemplates.date_view_template(g));this.root_input_element=d.find("INPUT");this.$text=d.find(".combo-text");var e=this;var f=navigator.userAgent.toLowerCase().indexOf("chrome")>-1;var h=DeviceInfo.osVersion;var a=((DEVICE===deviceTypeEnum.iphone&&PLATFORM!==platformEnum.simulator)||(DEVICE===deviceTypeEnum.android&&f===true&&Utils.Helpers.compareVersions("osVersion","4.1")===0));a=window.top==window.self;if(a){var c=function(j){var i=e.root_input_element.val();e.changeValueFunction(i)};this.root_input_element.blur(c).change(c)}else{var b=function(j){j.preventDefault();var i={initialDate:e.root_input_element.val()};DatePickerDialog.execute(function(k){e.root_input_element.val(k);e.changeValueFunction(k)},null,i)};this.root_input_element.tap(b)}this.$el.html(d);return this},changeValueFunction:function(d){if(d){this.$text.removeClass("watermark");var a=this.model.get("dateFormat");if(a){try{var b=new Date(d);d=b.format(a)}catch(c){}}this.$text.text(d)}else{this.$text.addClass("watermark");this.$text.text(this.model.get("caption")||"")}},setValue:function(c){try{if(typeof(c)==="number"){c=c*1000;var a=new Date(c);c=a.format("yyyy-mm-dd")}this.root_input_element.val(c)}catch(b){}this.changeValueFunction(c)},getValue:function(){var c=this.root_input_element.val();try{var a=new Date(c);c=a.getTime()/1000}catch(b){}return c}}); var ReportsTimePickerView=ReportsBaseInputView.extend({input_type:"time",render:function(){var g=this.model.toJSON();var d=$(reportsTemplates.time_view_template(g));this.root_input_element=d.find("INPUT");this.$text=d.find(".combo-text");var e=this;var f=navigator.userAgent.toLowerCase().indexOf("chrome")>-1;var h=DeviceInfo.osVersion;var a=((DEVICE===deviceTypeEnum.iphone&&PLATFORM!==platformEnum.simulator)||(DEVICE===deviceTypeEnum.android&&f===true&&Utils.Helpers.compareVersions("osVersion","4.1")===0));a=window.top==window.self;if(a){var c=function(j){var i=e.root_input_element.val();e.changeValueFunction(i)};this.root_input_element.blur(c).change(c)}else{var b=function(j){j.preventDefault();var i={initialDate:e.root_input_element.val()};TimePickerDialog.execute(function(k){e.root_input_element.val(k);e.changeValueFunction(k)},null,i)};this.root_input_element.tap(b)}this.$el.html(d);return this},changeValueFunction:function(b){if(b){this.$text.removeClass("watermark");b=Utils.TimeDate.timeToSeconds(b);var a=new Date(Utils.TimeDate.toUTCTime(b));b=a.format("shortTime");this.$text.text(b)}else{this.$text.addClass("watermark");this.$text.text(this.model.get("caption")||"")}},setValue:function(a){if(typeof(a)==="number"){a=Utils.TimeDate.secondsToTime(a)}this.root_input_element.val(a);this.changeValueFunction(a)},getValue:function(){var a=this.root_input_element.val();return Utils.TimeDate.timeToSeconds(a)}}); (function(){var a=ReportsBaseInputView.extend({input_type:"combobox",render:function(){var f=this.model.toJSON();var b="";_.each(f.items,function(h,g){h.caption=h.caption||"";h.caption=Utils.String.translateIfNeed(h.caption);h.value=h.value||"";h.id=f.id;b+=reportsTemplates.combobox_option(h)});f.options_html=b;var d=$(reportsTemplates.combobox_view_template(f));this.root_input_element=d.find("SELECT");var c=d.find(".combo-text");var e=this;this.root_input_element.change(function(i){i.preventDefault();var h=null;var g=null;e.root_input_element.find("option:selected").each(function(){h=$(this).val();g=$(this).text()});if(h){c.removeClass("watermark");c.text(g)}else{c.addClass("watermark");c.text(f.caption||"")}});this.$el.html(d);return this},setValue:function(b){this.$("option").removeAttr("selected");this.$('option[value="'+b+'"]').attr("selected","selected");this.root_input_element.change()},getValue:function(){return this.$("option:selected").val()}});window.ReportsComboBoxView=a})(); (function(){var a=TemplateView.extend({className:"t3d",events:{"tap [href]":"onOpenLink"},dom_maps:{report_page_id:_.template("report_<%= id %>")},onOpenLink:function(d){var c=$(d.currentTarget).attr("href"),b=/^\s*(mailto|tel)/i.test(c);if(PLATFORM===platformEnum.simulator&&b){cqm.showToastMessage("This functionality doesn't work in simulator mode.");d.preventDefault();return}if(!b){conduitApi.app.openLink(null,null,{url:c});d.preventDefault()}},render:function(c){var d=this.model.get("meta").items[c];d=d||{};d.controls=d.controls||[];var b=new ReportsFormModel(d);main_page=new ReportsTemplateFormView({model:b,id:this.dom_maps.report_page_id({id:d.reportId})});this.$el.append(main_page.render().el);this._homePagesViews[c]=main_page;TemplateView.prototype.render.apply(this,[c]);return this}});window.ReportsTemplateView=a})(); (function(){var a=Backbone.View.extend({current_errors:null,input_type_view_map:{inputtext:ReportsTextInputView,textarea:ReportsTextareaInputView,checkbox:ReportsCheckboxInputView,radio:ReportsRadioInputView,location:ReportsShowLocationInputView,date:ReportsDatePickerView,time:ReportsTimePickerView,combobox:ReportsComboBoxView},events:{"tap .send_button":"onSubmit"},controls_views:null,$scroll_wrapper:null,onSubmit:function(c){this.current_errors=[];var b=_.reduce(_.map(this.controls_views,function(d){return d.updateModel()}),function(d,e){if(typeof e==="undefined"){e=false}return d&&e},true);if(b){this.model.save()}else{cqm.showToastMessage(_T("ReportsMandatoryMessage"))}},onInputError:function(b,c){this.current_errors.push([b,c])},onInputResize:function(){Scrolling.onContentChanged(this.$scroll_wrapper)},onSaving:function(){cqm.showLoading(_T("ReportsSavingMessage"),this.$el)},onSave:function(){cqm.hideLoading(this.$el);var b=_T("ReportsSavedSuccessfullySubtitleMessage");var c=this.model.get("success");if(c&&c.message){b=c.message}cqm.showToastMessage(b);this.clear()},onSaveFailed:function(){cqm.hideLoading(this.$el);cqm.showToastMessage(_T("ReportsSaveFailedSubtitleMessage"))},onReadyToSubmit:function(){this.$el.find(".send_button").prop("disabled",false)},onNotReadyToSubmit:function(){this.$el.find(".send_button").prop("disabled",true)},initialize:function(){this.$el.attr({"data-role":"page","data-buttons":"navigation"});this.$el.html(reportsTemplates.menusWrapper());this.$el.data("model",this.model).data("view",this);this.$el.addClass("reports_template_form_view");this.$scroll_wrapper=this.$el.find(".scroll_wrapper");Scrolling.init(this.$scroll_wrapper);this.main_container=this.$el.find(".scroller");this.model.on("saved",this.onSave.hitch(this));this.model.on("save_failed",this.onSaveFailed.hitch(this));this.model.on("saving",this.onSaving.hitch(this));this.model.on("ready_to_submit",this.onReadyToSubmit.hitch(this));this.model.on("not_ready_to_submit",this.onNotReadyToSubmit.hitch(this))},render:function(c){var b=this;this.model.get("controls").on("error",b.onInputError.hitch(b));this.controls_views=this.model.get("controls").map(function(g){var h=g.get("type");if(h in b.input_type_view_map){var f=new b.input_type_view_map[h]({model:g});f.render();f.on("resize",b.onInputResize.hitch(b));return f}else{return null}});this.controls_views=_.filter(this.controls_views,function(f){return f!==null});var d=reportsTemplates.reports_page_structure;this.main_container.html(d({header_image:b.model.get("logoImgUrl"),description:b.model.get("desc"),title:b.model.get("name"),submit_text:b.model.get("sendButton").caption}));var e=this.main_container.find(".controls_container");_.each(this.controls_views,function(f){e.append(f.$el)});this.clear();return this},clear:function(){_.each(this.controls_views,function(b){b.clear()})}});window.ReportsTemplateFormView=a})(); var ReportsInputModel=Backbone.Model.extend({init:true,ready_to_submit:true,defaults:{caption:"",type:null,subType:null,id:null,isMandatory:false,default_value:undefined,value:undefined},readyToSubmit:function(){this.ready_to_submit=true;this.trigger("ready_to_submit")},notReadyToSubmit:function(){this.ready_to_submit=false;this.trigger("not_ready_to_submit")},initialize:function(){var c=this.get("type");ReportsTemplateHelper.addItems(this);if(c==="date"){var d=this.get("subType");var a=this.get("dateFormat");if(!d){d="date"}if(!a){if(d==="date"){a="longDate"}else{if(d==="datetime"){a="dateTime"}}}this.set({subType:d,dateFormat:a})}if(typeof this.get("default_value")==="undefined"){if(c==="checkbox"||c==="location"){this.set("default_value",false)}else{this.set("default_value","")}}if(c==="combobox"){var b=this.get("items");if(b&&!this.get("dontAddEmpty")){b.unshift({caption:"--",value:""})}}this.init=false},validate:function(a){if(!this.init){if(this.get("isMandatory")===true&&(!a.value)){return _T("ReportsInvalidInputMessage",{name:this.get("caption")})}}if(this.get("subType")==="email"){if(!Utils.Helpers.isValidEmail(a.value)){return _T("ReportsInvalidEmail")}}}}); (function(){var a=Backbone.Model.extend({defaults:{reportId:null,reportVersion:null,name:null,desc:null,logoImgUrl:null,sendButton:null,controls:null,ready_to_submit:true},cms_save_end_point:"CONTACT_CONTENT_POST",initialize:function(b){this.set(this.parse(b))},parse:function(d){var c=this;d=$.extend({},d);if(d.controls!==null){var b=new ReportsInputsCollection();_.each(d.controls,function(e){if(typeof(e.isActive)!=="boolean"||e.isActive){b.add(new ReportsInputModel(e))}});d.controls=b}if(d.sendButton===null||!_.isObject(d.sendButton)||d.sendButton.caption===null||_.isEmpty(d.sendButton.caption)){d.sendButton={caption:_T("ReportsTemplateDefaultSubmitCaption")}}d.controls.on("ready_to_submit",function(){c.updateReadyToSubmitState(d.controls)});d.controls.on("not_ready_to_submit",function(){c.updateReadyToSubmitState(d.controls)});return d},onSaveSuccess:function(){this.trigger("saved")},onSaveFail:function(){this.trigger("save_failed")},updateReadyToSubmitState:function(b){if(typeof b==="undefined"){b=this.get("controls")}this.set("ready_to_submit",_.reduce(b.map(function(c){return c.ready_to_submit}),function(c,d){return c&&d},true));if(!this.get("ready_to_submit")){this.trigger("not_ready_to_submit")}else{this.trigger("ready_to_submit")}},generateFormData:function(){return _.reduce(this.get("controls").map(function(b){return[b.get("id"),b.get("value")===""?null:b.get("value")]}),function(b,c){b[c[0]]=c[1];return b},{})},save:function(){var c={formId:this.get("reportId"),version:this.get("reportVersion"),postUrl:null},b={executeType:executeTypeEnum.FORCE_NETWORK,postParams:{formData:this.generateFormData()}};Services.executeService(this.cms_save_end_point,c,this.onSaveSuccess.hitch(this),this.onSaveFail.hitch(this),b);this.trigger("saving")}});this.ReportsFormModel=a})(); (function(){var a=Backbone.Collection.extend({model:ReportsInputModel});this.ReportsInputsCollection=a})(); (function(){var a={pageWrapper:_.template('<div class="scroll_wrapper"><div class="scroller"></div></div>'),profile:_.template('<div class="user_profile_container"></div><div class="profile_login_state_container clr_contTypeA_bg clr_contTypeA_brdr">	<div class="profile_linkedin_logout_message clr_contTypeA_txt"><%= _T("HtmlTextMyProfileLogoutFromLinkedin") %></div>	<div class="button_logout linkedin clr_contTypeA_btn_bg clr_contTypeA_btn_brdr clr_contTypeA_btn_hdlTxt" data-role="button">		<div class="icon sprite sprite-linkedin"></div>		<span class="text"><%= _T("HtmlTextMyProfileLogoutButton") %></span>	</div>	<div style="clear: both;"></div></div>')};window.myProfileTemplates=a})(); (function(){var a=TemplateView.extend({render:function(c){var e=this.model.get("meta");var b=e[this.options.tabsName][c];var d=new MyProfileView({id:"home_"+Utils.Helpers.generateGUID(),defaultImg:b.defaultImg});this.$el.append(d.render().el);this._homePagesViews[c]=d;TemplateView.prototype.render.apply(this,[c]);return this}});window.MyProfileTemplateView=a})(); (function(){var a=Backbone.View.extend({tagName:"div",className:"t3d",initialize:function(){this.$el.attr({"data-role":"page","data-buttons":"navigation"});this.$el.html(myProfileTemplates.pageWrapper());Scrolling.init(this.$el.find(".scroll_wrapper"));this.$scroller=this.$el.find(".scroller");this.$el.bind("pageshow",this.onPageShow.hitch(this))},showUserProfile:function(){var b=this;this.$scroller.html(myProfileTemplates.profile({}));var f=ProfileManager.getUserProfile();if(this.options.defaultImg&&(!f.img||(typeof(f.img)==="object"&&!f.img.original))){f.img={original:this.options.defaultImg}}var e=new UserModel(f);var d=new UserProfileView({model:e});var c=this.$(".user_profile_container");c.html(d.render().el);this.$scroller.find(".button_logout.linkedin").click(function(){ProfileManager.logout(function(){b.$scroller.html("");LoginOverlay.execute(function(){b.showUserProfile()})},null,"linkedin")})},onPageShow:function(){var b=this;LoginOverlay.execute(function(){b.showUserProfile()})},render:function(b){return this}});window.MyProfileView=a})(); (function(){var a={menusWrapper:_.template('<div class="scroll_wrapper"><div class="scroller">	<div class="no_messages_container">	</div></div></div>'),noMessages:_.template('<div class="no_messages_icon mask_sprite sprite-noMessages clr_contTypeB_subIcn"></div><div class="size_title_3 no_messages_text clr_contTypeB_hdlTxt"><%= text %></div><div class="size_title_0 no_messages_text clr_contTypeB_subTxt"><%= text2 %></div>'),message:_.template('<div class="thumbnail sliced_image" style="background-image:url(\'<%= img %>\');"></div><div class="message_content_container"><div class="message_content"><div class="message_from clr_contTypeA_hdlTxt ellipsis"><%= name %></div><div class="message_time clr_contTypeA_subTxt"><%= date %></div><div class="message_text clr_contTypeA_txt"><%= text %></div></div></div><div class="slide_arrow_image mask_sprite sprite-arrow clr_contTypeA_icn"></div>')};window.inboxTemplates=a})(); var InboxItemModel=ItemModel.extend({}); var InboxModel=ItemsModel.extend({createItemsCollection:function(){var a=new InboxCollection(null,{});a.defaultImg=this.get("defaultImg");return a}}); var InboxCollection=ItemsCollection.extend({model:InboxItemModel,initialize:function(b,a){ItemsCollection.prototype.initialize.apply(this,arguments)},parse:function(a){for(var d=0;d<a.length;d++){var c=a[d].participants;if(c){for(var b=c.length-1;b>-1;b--){var e=c[b].id;if(e===ProfileManager.getUserId()){c.splice(b,1)}else{if(this.defaultImg&&!c[b].img){c[b].img=this.defaultImg}}}}}return{models:a,metaData:a}},getParams:function(){this.params={userId:ProfileManager.getUserId()};return this.params},getServiceName:function(){return"DISCUSSION_DISCUSSIONS_GET"}}); (function(){var a=TemplateView.extend({onMessageSelected:function(b){this.openChat(b)},openChat:function(c){if(this.chatPage){this.chatPage.remove()}var b=new ChatModel({discussionId:c.get("discussionId"),participants:c.get("participants")});this.chatPage=new ChatPageView({model:b,message:"",id:"chatPage_"+Utils.Helpers.generateGUID()});this.$el.append(this.chatPage.render().el);$.mobile.changePage("#"+this.chatPage.id,{transition:"slide",reverse:IS_RTL})},render:function(d){var e=this.model.get("meta");var c=new InboxModel({userId:null,defaultImg:e[this.options.tabsName][d].defaultImg});c.bind("itemSelected",this.onMessageSelected,this);var b=new InboxView({model:c,id:"home_"+Utils.Helpers.generateGUID()});this.$el.append(b.render().el);this._homePagesViews[d]=b;TemplateView.prototype.render.apply(this,[d]);return this}});window.InboxTemplateView=a})(); var InboxMessageView=Backbone.View.extend({tagName:"li",className:"message_short_view t3d inbox_list_item clr_contTypeA_bg clr_contTypeA_brdr",events:{tap:"itemClicked"},initialize:function(){this.model.bind("change:selected",this.onSelectedChange,this)},render:function(){this.$el.attr("data-role","button");this.$el.append(inboxTemplates.message({text:Utils.String.sanitizeText(this.model.get("lastMessage").message.text,true),name:this.model.get("participants")[0].name,img:this.model.get("participants")[0].img,date:this._timeStampToDate(this.model.get("lastMessage").ts)}));return this},_timeStampToDate:function(b){var a=new Date(b*1000);return a.format("dateTime")},onSelectedChange:function(){if(LAYOUT===layoutFormat.wide){if(this.model.get("selected")){this.$el.addClass("selected")}else{this.$el.removeClass("selected")}}},itemClicked:function(a){a.preventDefault();this.model.trigger("itemClicked",this.model)}}); var InboxView=ItemsView.extend({loading:false,_renderShowMoreButton:function(){},initialize:function(){this.$el.attr({"data-role":"page","data-buttons":"navigation refresh"});this.$el.html(inboxTemplates.menusWrapper());Scrolling.init(this.$el.find(".scroll_wrapper"));this.$scroller=this.$el.find(".scroller");this.$el.bind("refresh",this.handleRefreshClick.hitch(this));this.$el.bind("silentRefresh",this.handleSilentRefresh.hitch(this));this.$el.bind("pageshow",this.onPageShow.hitch(this));ItemsView.prototype.initialize.apply(this,arguments)},handleRefreshClick:function(){if(!ProfileManager.isLoggedIn()){return}ItemsView.prototype.handleRefreshClick.apply(this,arguments)},handleSilentRefresh:function(){return},onPageShow:function(){if(this.myLastId!==ProfileManager.getUserId()){this._reset()}LoginOverlay.execute(function(){if(this.myLastId!==ProfileManager.getUserId()){this.refreshing=true;cqm.showLoading(_T("HtmlTextPaginationRefreshItems"),this.$el,true)}this.myLastId=ProfileManager.getUserId();this.model.getItems(executeTypeEnum.FORCE_NETWORK)}.hitch(this))},getRootView:function(){return this.$scroller},createItemView:function(a){return new InboxMessageView({model:a,id:"message_view_"+Utils.Helpers.generateGUID()})},_onGetItemsSuccess:function(){var a=this.model.get("items").length;var c=this.$scroller.find(".no_messages_container");if(a===0){this.$el.addClass("clr_contTypeB_bg");var b={text:_T("HtmlTextInboxNoMessagesStr"),text2:""};c.html(inboxTemplates.noMessages(b))}else{c.html("");this.$el.removeClass("clr_contTypeB_bg")}BaseItemsView.prototype._onGetItemsSuccess.apply(this)}}); var shareTemplates={};shareTemplates.facebookNarrowSharePage=_.template('<div id="facebook_share_page"><div class="share_input_message_container_facebook"><textarea class="share_input_message" rows="4" autocapitalize="off" autocorrect="off" autocomplete="off" placeholder="<%= inputPlaceholderStaticString %>"><%= comment %></textarea></div><div class="scroll_wrapper"><div class="scroller"><div class="share_data"><% if(typeof(userImageUrl) != "undefined" && userImageUrl !== ""){ %><div class="share_data_image"><img alt="" src="<%= userImageUrl %>" /></div><% } %><div class="share_data_content"><div class="share_data_title"><%= title %></div><div class="share_data_link"><%= url %></div><div class="share_data_text"><%= fbDesc %></div></div><div class="share_data_spacer"></div></div></div></div><div class="share_actions"><div class="share_actions_user"><span class="share_actions_user_name"><%= notUserName %></span><a class="share_actions_change_user" url="javascript:void();"><%= changeUserStaticString %></a></div><div class="share_actions_button cancel clr_appGeneral_dialog_btn2_bg clr_appGeneral_dialog_btn2_brdr clr_appGeneral_dialog_btn2_hdlTxt"><%= cancel %></div><div class="share_actions_button share clr_contTypeB_btn_bg clr_contTypeB_btn_brdr clr_contTypeB_btn_hdlTxt"><span class="share_service_image mask_sprite clr_contTypeB_btn_icn <%= serviceImageClass %>"></span><%= shareOn %></div></div></div>');shareTemplates.twitterNarrowSharePage=_.template('<div id="twitter_share_page"><div class="share_input_message_container_twitter"><textarea class="share_input_message" rows="6" autocapitalize="off" autocorrect="off" autocomplete="off" placeholder="<%= inputPlaceholderStaticString %>"><%= comment %></textarea></div><div class="share_actions"><div class="share_actions_user"><span class="share_actions_user_name"><%= notUserName %></span><a class="share_actions_change_user" url="javascript:void();"><%= changeUserStaticString %></a></div><div class="share_actions_button cancel clr_appGeneral_dialog_btn2_bg clr_appGeneral_dialog_btn2_brdr clr_appGeneral_dialog_btn2_hdlTxt"><%= cancel %></div><div class="share_actions_button share clr_contTypeB_btn_bg clr_contTypeB_btn_brdr clr_contTypeB_btn_hdlTxt"><span class="share_service_image mask_sprite clr_contTypeB_btn_icn <%= serviceImageClass %>"></span><%= shareOn %></div></div></div>'); var TwitterBridge=function(){};TwitterBridge.prototype={post:function(a,c,b){conduitApi.__BCAPI.social.tweet(a,c,b)},changeUser:function(a,b){a();conduitApi.social.logout(null,null,conduitApi.social.socialServicesEnum.Twitter)}}; var FacebookBridge=function(){};FacebookBridge.prototype={post:function(a,c,b){},changeUser:function(a,b){}}; var SharePage=Backbone.Model.extend({initialize:function(){switch(this.get("service")){case conduitApi.social.socialServicesEnum.Facebook:this.bridge=new FacebookBridge();break;case conduitApi.social.socialServicesEnum.Twitter:this.bridge=new TwitterBridge();break}},changeUser:function(){var a=function(){this.trigger("changeUserDone",true)};var b=function(){this.trigger("changeUserDone",false)};this.bridge.changeUser(a.hitch(this),b.hitch(this))},post:function(b){var a=function(){this.trigger("postDone",true)};var c=function(d){this.trigger("postDone",false,d)};this.bridge.post(a.hitch(this),c.hitch(this),b)}}); var SharePageView=Backbone.View.extend({id:"share_page",initialize:function(){this.model.bind("postDone",this.postDone,this);this.model.bind("changeUserDone",this.changeUserDone,this)},events:{"tap .share_actions_change_user":"changeUser","tap .share":"post","tap .cancel":"close"},render:function(){var c=this.model.toJSON();c.notUserName="";c.cancel=_T("ButtonCancel");c.shareOn=_T("DialogCaptionShareControlDialog");if(!c.comment){c.comment=""}var b;switch(this.model.get("service")){case conduitApi.social.socialServicesEnum.Facebook:b=shareTemplates.facebookNarrowSharePage;c.shareOn+=" "+_T("DialogCaptionFacebook");c.serviceImageClass="sprite-facebook-icon";c.changeUserStaticString=_T("HtmlTextShareFacebookChangeUserButton");c.inputPlaceholderStaticString=_T("HtmlTextShareFacebookWriteCommentPlaceholder");this.innerPostDone=this.facebookPostDone;this.innerChangeUserDone=this.facebookChangeUserDone;break;case conduitApi.social.socialServicesEnum.Twitter:b=shareTemplates.twitterNarrowSharePage;c.shareOn+=" "+_T("DialogCaptionTwitter");c.serviceImageClass="sprite-tweet";c.changeUserStaticString=_T("HtmlTextShareTwitterChangeUserButton");c.inputPlaceholderStaticString=_T("HtmlTextShareTwitterWriteCommentPlaceholder");this.innerPostDone=this.twitterPostDone;this.innerChangeUserDone=this.twitterChangeUserDone;break}var a=b(c);this.$el.append(a);this.$scrollWrapper=this.$el.find(".scroll_wrapper");if(this.$scrollWrapper.length>0){Scrolling.init(this.$scrollWrapper)}$(window).bind("throttledresize",this.onResize.hitch(this));this.onResize();switch(this.model.get("service")){case conduitApi.social.socialServicesEnum.Facebook:this.updateFacebookUserName();break;case conduitApi.social.socialServicesEnum.Twitter:this.updateTweeterUserName();break}$.mobile.openDialog(this.backHandle.hitch(this));if(DEVICE===conduitApi.platform.deviceInfo.deviceTypeEnum.android&&PLATFORM==conduitApi.platform.deviceInfo.platformEnum.nativeApp){conduitApi.app.addBackButton(null,null,null,true,{cb:function(){history.back()},isDialog:true})}return this},backHandle:function(){this.remove()},onResize:function(){var a=window.innerHeight+"px";var b=window.innerWidth+"px";this.$el.css({height:a,width:b});if(this.$scrollWrapper.length>0){Scrolling.onContentChanged(this.$scrollWrapper)}},updateFacebookUserName:function(){var b=this.$el.find(".share_actions_user_name").text("");function a(d){if(d&&d.name){var e=_T("HtmlTextShareChangeUserName",{name:d.name});b.text(e)}}function c(){}FacebookLib.getUserData(a,c)},updateTweeterUserName:function(){var c=this.$el.find(".share_actions_user_name").text("");function b(d){if(d&&d.name){var e=_T("HtmlTextShareChangeUserName",{name:d.name});c.text(e)}}function a(){}conduitApi.social.getAccessTokens(b,a,conduitApi.social.socialServicesEnum.Twitter,{useLoginForm:true})},changeUser:function(a){if(a&&typeof(a.preventDefault)==="function"){a.preventDefault()}conduitApi.UI.startActivityIndicator(null,null,_T("IndicatorShareLogOut"));this.model.changeUser()},post:function(a){if(a&&typeof(a.preventDefault)==="function"){a.preventDefault()}var b=this.$el.find(".share_input_message");b.blur();conduitApi.UI.startActivityIndicator(null,null,_T("IndicatorSharePublishing"));this.model.post(b.val())},postDone:function(b,a){conduitApi.UI.dismissActivityIndicator();this.innerPostDone(b,a)},facebookPostDone:function(b,a){this.close()},twitterPostDone:function(b,a){this.close()},changeUserDone:function(a){this.innerChangeUserDone(a)},facebookChangeUserDone:function(b){conduitApi.UI.dismissActivityIndicator();if(b){this.close()}else{var a=[{text:_T("ButtonClose"),cb:this.close.hitch(this)}];conduitApi.UI.showDialogBox(null,null,{title:_T("DialogCaptionFacebookLogout"),message:_T("DialogMessageFacebookLogoutFail"),buttons:a})}},twitterChangeUserDone:function(a){conduitApi.UI.dismissActivityIndicator();this.close()},close:function(a){if(a&&typeof(a.preventDefault)==="function"){a.preventDefault()}if(DEVICE===conduitApi.platform.deviceInfo.deviceTypeEnum.android&&PLATFORM==conduitApi.platform.deviceInfo.platformEnum.nativeApp){conduitApi.app.removeBackButton()}$.mobile.closeDialog(function(){this.remove()}.hitch(this))}}); var apiTestTemplates={api_categories:_.template('<div class="apitest_category_button apitest_button" data-role="button" data="AccelerometerTestView">Accelerometer (V)</div><div class="apitest_category_button apitest_button" data-role="button"data="AppTestView">App (X)</div><div class="apitest_category_button apitest_button" data-role="button" data="CameraTestView">Camera (V)</div><div class="apitest_category_button apitest_button" data-role="button" data="GeoTestView">Geo location (V)</div><div class="apitest_category_button apitest_button" data-role="button" data="DeviceInfoTestView">Device info (V)</div><div class="apitest_category_button apitest_button" data-role="button" data="GesturesTestView">Gestures (V)</div><div class="apitest_category_button apitest_button" data-role="button" data="LogTestView">Log (V)</div><div class="apitest_category_button apitest_button" data-role="button" data="OrientationTestView">Orientation (V)</div><div class="apitest_category_button apitest_button" data-role="button" data="PushTestView">Push notification (V)</div><div class="apitest_category_button apitest_button" data-role="button" data="SocialTestView">Social (X)</div><div class="apitest_category_button apitest_button" data-role="button" data="StorageTestView">Storage (V)</div><div class="apitest_category_button apitest_button" data-role="button" data="UITestView">UI (V)</div><div class="apitest_category_button apitest_button" data-role="button" data="VibrateTestView">Vibrate (V)</div><div>NOT HERE: "Media", "Video", "In app purchase", "Social?", "Analytics"</div>'),deviceInfoView:_.template('<div><div class="get_btn apitest_button" data-role="button">Get device info</div><div class="info_container"><div id="txtDevice">Device: </div><div id="txtPlatform">Platform: </div><div id="txtVersion">Version: </div><div id="txtUuid">Uuid: </div><div id="txtLanguage">Language: </div></div><div class="info_container result">(result...)</div></div>'),accelerometerView:_.template('<div><div class="info_container">Frequency (for register) (mSec):<input type="text" class="frequency" value="5000" /></div>Accelerometer:<div class="register_btn apitest_button" data-role="button"> Register! </div><div class="get_btn apitest_button" data-role="button"> Get Last Accelerometer! </div><div class="info_container result">(result...)</div></div>'),cameraView:_.template('<div><div class="info_container">allowEdit (boolean):<input type="checkbox" class="allowEdit" /></br>sourceType (PHOTOLIBRARY : 0, CAMERA : 1, SAVEDPHOTOALBUM : 2):<input type="text" class="sourceType" value="1" /></br>destinationType (DATA_URL : 0, FILE_URI : 1):<input type="text" class="destinationType" value="1" /></br>quality (Range is [0, 100]):<input type="text" class="quality" value="25" /></div><div class="get_btn apitest_button" data-role="button"> Capture Image! </div><div class="info_container result">(result...)</div><div class="info_container"><image class="capturedImg" alt="" width="80%"></image></div></div>'),vibrateView:_.template('<div><div class="info_container">Insert vibrate duration (mSec):<input type="text" id="vibr_duration" value="1000" /></div><div id="vibrate_btn" class="apitest_button" data-role="button">Start</div></div>'),geoView:_.template('<div><div class="info_container">enableHighAccuracy (boolean):<input type="checkbox" class="enableHighAccuracy" /></br>timeout (mSec):<input type="text" class="timeout" value="5000" /></br>maximumAge (mSec):<input type="text" class="maximumAge" value="60000" /></div>Geo change:<div class="register_btn apitest_button" data-role="button"> Register! </div><div class="get_btn apitest_button" data-role="button"> Get geo! </div><div class="info_container result">(result...)</div></div>'),storageView:_.template('<div><div class="info_container">global store (boolean):<input type="checkbox" class="global" /></br>key:<input type="text" class="key" value="hello" /></br>value:<input type="text" class="value" value="world!" /></div><div class="get_btn apitest_button" data-role="button"> Get item </div><div class="set_btn apitest_button" data-role="button"> Set item </div><div class="remove_btn apitest_button" data-role="button"> Remove item </div><div class="clear_btn apitest_button" data-role="button"> Clear Storage! </div><div class="info_container result">(result...)</div></div>'),uiView:_.template('<div><div class="info_container">force dismiss:<input type="checkbox" class="forceDismiss" /></br>message:<input type="text" class="message" value="dialog / toast / indicator text" /></br>caption:<input type="text" class="caption" value="Dialog caption" /></br> # of buttons:<input type="text" class="count" value="3" /></br>buttons caption:<input type="text" class="buttons_captions" value="button caption" /></br>toast duration (mSec):<input type="text" class="duration" value="5000" /></div><div class="show_activity_btn apitest_button" data-role="button"> Show activiy </div><div class="dis_activity_btn apitest_button" data-role="button"> Dismiss activiy </div><div class="dis_activity_btn2 apitest_button" data-role="button"> Dismiss activiy (after TimeOut of 5 sec) </div><div class="dialog_btn apitest_button" data-role="button"> Show dialog </div><div class="toast_btn apitest_button" data-role="button"> Show toast </div><div class="info_container result">(result...)</div></div>'),logView:_.template('<div><div class="info_container">Log message:<input type="text" class="message" value=" Log 2 (1024) = 10" /></div><div class="info apitest_button" data-role="button"> Write info! </div><div class="warning apitest_button" data-role="button"> Write warning! </div><div class="error apitest_button" data-role="button"> Write error! </div><div class="info_container result">(result...)</div></div>'),orientationView:_.template('<div><div class="info_container">degree (0, 90, 180, -90):<input type="text" class="degree" value="90" /></div>Orientation change:<div class="register_btn apitest_button" data-role="button"> Register! </div><div class="get_btn apitest_button" data-role="button"> Get Orientation! </div><div class="lock_btn apitest_button" data-role="button"> Lock Orientation </div><div class="unlock_btn apitest_button" data-role="button"> Unlock Orientation </div><div class="info_container result">(result...)</div></div>'),pushView:_.template('<div>Push notification:<div class="register_btn apitest_button" data-role="button"> Register! </div><div class="info_container result">(result...)</div></div>'),gesturesView:_.template('<div>Shake:<div class="register_btn apitest_button" data-role="button">Register!</div></div>')}; var APITestTemplateView=TemplateView.extend({render:function(a){var b=new APITestCategoriesTemplateView({model:this.model,id:"home_"+Utils.Helpers.generateGUID()});this.$el.append(b.render().el);this._homePagesViews[a]=b;b.bind("categorySelected",this.categorySelected,this);TemplateView.prototype.render.apply(this,[a]);return this},categorySelected:function(e){var b=$(e).attr("data");if(b&&window[b]){var c=this[b];if(!c){c=new window[b]({model:this.model,id:"apitest_page_"+Utils.Helpers.generateGUID()});var a=$(c.render().el);$(this.el).append(a);a.attr({"data-role":"page",dir:"ltr","data-buttons":"back"});this[b]=c}var d="#"+c.id;$.mobile.changePage(d,{transition:"slide",reverse:IS_RTL})}}});var TemplateHelper={createScrollerForContent:function(a,b){a.html('<div class="scroll_wrapper"><div class="scroller"></div></div>');var c=a.find(".scroller");c.html(b);var d=a.find(".scroll_wrapper");Scrolling.init(d)}}; var APITestCategoriesTemplateView=Backbone.View.extend({events:{"tap .apitest_category_button":"itemClicked"},render:function(){var a=apiTestTemplates.api_categories();TemplateHelper.createScrollerForContent(this.$el,a);this.$el.attr({"data-role":"page",dir:"ltr","data-buttons":"navigation"});return this},itemClicked:function(a){a.preventDefault();this.trigger("categorySelected",a.target)}}); var DeviceInfoTestView=TemplateView.extend({render:function(a){var b=apiTestTemplates.deviceInfoView();TemplateHelper.createScrollerForContent(this.$el,b);this.$el.find(".get_btn").bind("tap",this.onGet.hitch(this));return this},onGet:function(){var c=this;var a=function(d){cqm.showToastMessage("Success! data = "+d);c.printData(d);c.devicePrint(d)};var b=function(d){cqm.showToastMessage("cbFail. data = "+d);c.printData(d)};if(conduitApi.platform.deviceInfo.isSupported()){conduitApi.platform.deviceInfo.getDeviceInfo(a,b)}else{cqm.showToastMessage("Not supported")}},devicePrint:function(c){var b="";switch(c.device){case deviceTypeEnum.iphone:b="iOS";break;case deviceTypeEnum.android:b="Android";break;case deviceTypeEnum.rim:b="Rim";break;case deviceTypeEnum.winPhone:b="WinPhone";break;case deviceTypeEnum.symbian:b="Symbian";break}var a="webApp";switch(c.platform){case platformEnum.simulator:a="Simulator";break;case platformEnum.nativeApp:a="nativeApp";break;case platformEnum.webApp:a="webApp";break;case platformEnum.gadget:a="gadget";break;case platformEnum.playground:a="playground";break}$("#txtDevice").text("Device: "+b);$("#txtPlatform").text("Platform: "+a);$("#txtVersion").text("Version: "+c.version);$("#txtUuid").text("Uuid: "+c.uuid);$("#txtLanguage").text("Language: "+c.language)},printData:function(b){var a=this.$el.find(".result");a.html(this.objectToText(b))},objectToText:function(c){var d="";if(typeof(c)==="object"){for(var a in c){var b=this.objectToText(c[a]);d+='<div style="padding-left: 3px;">'+a+" : "+b+"</div>"}}else{d=c}return d}}); var AccelerometerTestView=TemplateView.extend({render:function(a){var b=apiTestTemplates.accelerometerView();TemplateHelper.createScrollerForContent(this.$el,b);this.$btn=this.$el.find(".register_btn");this.$btn.bind("tap",this.onRegister.hitch(this));this.$el.find(".get_btn").bind("tap",this.onGet.hitch(this));return this},onGet:function(){var c=this;var a=function(d){cqm.showToastMessage("Success! data = "+d);c.printData(d)};var b=function(d){cqm.showToastMessage("cbFail. data = "+d);c.printData(d)};if(conduitApi.platform.accelerometer.isSupported()){conduitApi.platform.accelerometer.getLastAcceleration(a,b)}else{cqm.showToastMessage("Not supported")}},onRegister:function(){var d=this;var a=function(f,e){d.isRegister=true;cqm.showToastMessage("Success / get data");d.accHandle=f;d.printData(e);d.updateButton()};var b=function(){d.isRegister=false;cqm.showToastMessage("Success Unregister");d.updateButton()};var c=function(e){cqm.showToastMessage("cbFail. data = "+e);d.printData(e)};if(conduitApi.platform.accelerometer.isSupported()){if(!d.isRegister){conduitApi.platform.accelerometer.startAcceleration(a,c,this.getOptions())}else{conduitApi.platform.accelerometer.stopAcceleration(b,c,this.accHandle)}}else{cqm.showToastMessage("Not supported")}},updateButton:function(){if(this.isRegister){this.$btn.html("unregister...")}else{this.$btn.html("Register!")}},getOptions:function(){var b=parseInt(this.$el.find(".frequency").val());var a={frequency:b};return a},printData:function(b){var a=this.$el.find(".result");a.html(this.objectToText(b))},objectToText:function(c){var d="";if(typeof(c)==="object"){for(var a in c){var b=this.objectToText(c[a]);d+='<div style="padding-left: 3px;">'+a+" : "+b+"</div>"}}else{d=c}return d}}); var CameraTestView=TemplateView.extend({render:function(a){var b=apiTestTemplates.cameraView();TemplateHelper.createScrollerForContent(this.$el,b);this.$el.find(".get_btn").bind("tap",this.onGet.hitch(this));return this},onGet:function(){var c=this;var a=function(e){cqm.showToastMessage("Success! data = "+c.objectToText(e));c.printData(e);var d=c.getOptions().destinationType;if(d==0){c.$el.find(".capturedImg").attr("src","data:image/jpeg;base64,"+e)}else{if(d==1){c.$el.find(".capturedImg").attr("src",e)}else{alert("unknown destinationType...")}}};var b=function(d){cqm.showToastMessage("cbFail. data = "+c.objectToText(d));c.printData(d)};if(conduitApi.platform.camera.isSupported()){conduitApi.platform.camera.captureImage(a,b,this.getOptions())}else{cqm.showToastMessage("Not supported")}},getOptions:function(){var e=parseInt(this.$el.find(".quality").val());var a=parseInt(this.$el.find(".destinationType").val());var d=parseInt(this.$el.find(".sourceType").val());var c=this.$el.find(".allowEdit").is(":checked");var b={quality:e,destinationType:a,sourceType:d,allowEdit:c};return b},getShortText:function(a){if(typeof(a)==="string"&&a.length>50){return(a.slice(0,47)+"...")}return a},printData:function(b){var a=this.$el.find(".result");a.html(this.objectToText(b))},objectToText:function(c){var d="";if(typeof(c)==="object"){for(var a in c){var b=this.objectToText(c[a]);d+='<div style="padding-left: 3px;">'+a+" : "+b+"</div>"}}else{d=this.getShortText(c)}return d}}); var VibrateTestView=TemplateView.extend({render:function(a){var b=apiTestTemplates.vibrateView();TemplateHelper.createScrollerForContent(this.$el,b);this.$el.find("#vibrate_btn").bind("tap",this.onVibrate.hitch(this));return this},onVibrate:function(){var c=$("#vibr_duration").val();var d=parseInt(c);if(d<0||d>10000){cqm.showToastMessage("duration: "+d+". valid values:  0 <= duration <= 10000");return}var a=function(){cqm.showToastMessage("Success! duration = "+d)};var b=function(e){cqm.showToastMessage("cbFail. message = "+e)};if(conduitApi.platform.vibrate.isSupported()){conduitApi.platform.vibrate.vibrateForTime(a,b,d)}else{cqm.showToastMessage("Not supported")}}}); var GesturesTestView=TemplateView.extend({render:function(a){var b=apiTestTemplates.gesturesView();TemplateHelper.createScrollerForContent(this.$el,b);this.$btn=this.$el.find(".register_btn");this.$btn.bind("tap",this.onRegister.hitch(this));return this},onRegister:function(){var d=this;var a=function(){d.isRegister=!d.isRegister;cqm.showToastMessage("Success");d.updateButton()};var c=function(e){cqm.showToastMessage("cbFail. message = "+e)};var b=function(e){cqm.showToastMessage("SHAKE!!!")};if(conduitApi.platform.gestures.isSupported()){if(!d.isRegister){conduitApi.platform.gestures.registerShake(a,c,b)}else{conduitApi.platform.gestures.unregisterShake(a,c)}}else{cqm.showToastMessage("Not supported")}},updateButton:function(){if(this.isRegister){this.$btn.html("unregister...")}else{this.$btn.html("Register!")}}}); var PushTestView=TemplateView.extend({render:function(a){var b=apiTestTemplates.pushView();TemplateHelper.createScrollerForContent(this.$el,b);this.$btn=this.$el.find(".register_btn");this.$btn.bind("tap",this.onRegister.hitch(this));return this},onRegister:function(){var d=this;var a=function(e){d.isRegister=!d.isRegister;cqm.showToastMessage("Success data = "+e);d.printData(e);d.updateButton()};var c=function(e){cqm.showToastMessage("cbFail. data = "+e);d.printData(e)};var b=function(e){cqm.showToastMessage("Event handler. data = "+e);d.printData(e)};if(conduitApi.platform.pushNotification.isSupported()){if(!d.isRegister){conduitApi.platform.pushNotification.registerPushNotification(a,c,b)}else{conduitApi.platform.pushNotification.stopGeoLocation(a,c)}}else{cqm.showToastMessage("Not supported")}},updateButton:function(){if(this.isRegister){this.$btn.html("unregister...")}else{this.$btn.html("Register!")}},printData:function(b){var a=this.$el.find(".result");a.html(this.objectToText(b))},objectToText:function(c){var d="";if(typeof(c)==="object"){for(var a in c){var b=this.objectToText(c[a]);d+='<div style="padding-left: 3px;">'+a+" : "+b+"</div>"}}else{d=c}return d}}); var OrientationTestView=TemplateView.extend({render:function(a){var b=apiTestTemplates.orientationView();TemplateHelper.createScrollerForContent(this.$el,b);this.$btn=this.$el.find(".register_btn");this.$btn.bind("tap",this.onRegister.hitch(this));this.$el.find(".get_btn").bind("tap",this.onGet.hitch(this));this.$el.find(".lock_btn").bind("tap",this.onLock.hitch(this));this.$el.find(".unlock_btn").bind("tap",this.onUnlock.hitch(this));return this},onGet:function(){var c=this;var a=function(d){cqm.showToastMessage("Success! data = "+d);c.printData(d)};var b=function(d){cqm.showToastMessage("cbFail. data = "+d);c.printData(d)};if(conduitApi.platform.orientation.isSupported()){conduitApi.platform.orientation.getOrientation(a,b)}else{cqm.showToastMessage("Not supported")}},onLock:function(){var c=this;var a=function(d){cqm.showToastMessage("Success! data = "+d);c.printData(d)};var b=function(d){cqm.showToastMessage("cbFail. data = "+d);c.printData(d)};if(conduitApi.platform.orientation.isSupported()){conduitApi.platform.orientation.lockOrientation(a,b,this.getDegree())}else{cqm.showToastMessage("Not supported")}},onUnlock:function(){var c=this;var a=function(d){cqm.showToastMessage("Success! data = "+d);c.printData(d)};var b=function(d){cqm.showToastMessage("cbFail. data = "+d);c.printData(d)};if(conduitApi.platform.orientation.isSupported()){conduitApi.platform.orientation.unlockOrientation(a,b)}else{cqm.showToastMessage("Not supported")}},onRegister:function(){var d=this;var a=function(e){d.isRegister=true;cqm.showToastMessage("Success / get orientation change. data = "+e);d.printData(e);d.updateButton()};var b=function(){d.isRegister=false;cqm.showToastMessage("Success Unregister");d.updateButton()};var c=function(e){cqm.showToastMessage("cbFail. data = "+e);d.printData(e)};if(conduitApi.platform.orientation.isSupported()){if(!d.isRegister){conduitApi.platform.orientation.startOrientation(a,c)}else{conduitApi.platform.orientation.stopOrientation(b,c)}}else{cqm.showToastMessage("Not supported")}},updateButton:function(){if(this.isRegister){this.$btn.html("unregister...")}else{this.$btn.html("Register!")}},getDegree:function(){var a=parseInt(this.$el.find(".degree").val());return a},printData:function(b){var a=this.$el.find(".result");a.html(this.objectToText(b))},objectToText:function(c){var d="";if(typeof(c)==="object"){for(var a in c){var b=this.objectToText(c[a]);d+='<div style="padding-left: 3px;">'+a+" : "+b+"</div>"}}else{d=c}return d}}); var GeoTestView=TemplateView.extend({render:function(a){var b=apiTestTemplates.geoView();TemplateHelper.createScrollerForContent(this.$el,b);this.$btn=this.$el.find(".register_btn");this.$btn.bind("tap",this.onRegister.hitch(this));this.$el.find(".get_btn").bind("tap",this.onGet.hitch(this));return this},onGet:function(){var c=this;var a=function(d){cqm.showToastMessage("Success! data = "+d);c.printData(d)};var b=function(d){cqm.showToastMessage("cbFail. data = "+d);c.printData(d)};if(conduitApi.platform.geo.isSupported()){conduitApi.platform.geo.getLocation(a,b,this.getOptions())}else{cqm.showToastMessage("Not supported")}},onRegister:function(){var d=this;var a=function(f,e){d.isRegister=true;cqm.showToastMessage("Success / get data");d.geoHandle=f;d.printData(e);d.updateButton()};var b=function(){d.isRegister=false;cqm.showToastMessage("Success Unregister");d.updateButton()};var c=function(e){cqm.showToastMessage("cbFail. data = "+e);d.printData(e)};if(conduitApi.platform.geo.isSupported()){if(!d.isRegister){conduitApi.platform.geo.startGeoLocation(a,c,this.getOptions())}else{conduitApi.platform.geo.stopGeoLocation(b,c,this.geoHandle)}}else{cqm.showToastMessage("Not supported")}},updateButton:function(){if(this.isRegister){this.$btn.html("unregister...")}else{this.$btn.html("Register!")}},getOptions:function(){var b=this.$el.find(".enableHighAccuracy").is(":checked");var d=parseInt(this.$el.find(".timeout").val());var a=parseInt(this.$el.find(".maximumAge").val());var c={enableHighAccuracy:b,timeout:d,maximumAge:a};return c},printData:function(b){var a=this.$el.find(".result");a.html(this.objectToText(b))},objectToText:function(c){var d="";if(typeof(c)==="object"){for(var a in c){var b=this.objectToText(c[a]);d+='<div style="padding-left: 3px;">'+a+" : "+b+"</div>"}}else{d=c}return d}}); var StorageTestView=TemplateView.extend({render:function(a){var b=apiTestTemplates.storageView();TemplateHelper.createScrollerForContent(this.$el,b);this.$el.find(".get_btn").bind("tap",this.onGet.hitch(this));this.$el.find(".set_btn").bind("tap",this.onSet.hitch(this));this.$el.find(".remove_btn").bind("tap",this.onRemove.hitch(this));this.$el.find(".clear_btn").bind("tap",this.onClear.hitch(this));return this},onSet:function(){var e=this;var d=this.$el.find(".global").is(":checked");var b=this.$el.find(".key").val();var f=this.$el.find(".value").val();alert("global = "+d+" key = "+b+" value = "+f);var a=function(g){cqm.showToastMessage("Success! data = "+g);e.printData(g)};var c=function(g){cqm.showToastMessage("cbFail. data = "+g);e.printData(g)};if(conduitApi.platform.storage.isSupported()){conduitApi.platform.storage.setItem(a,c,b,f,d)}else{cqm.showToastMessage("Not supported")}},onGet:function(){var e=this;var d=this.$el.find(".global").is(":checked");var b=this.$el.find(".key").val();alert("global = "+d+" key = "+b);var a=function(f){cqm.showToastMessage("Success! data = "+f);e.printData(f)};var c=function(f){cqm.showToastMessage("cbFail. data = "+f);e.printData(f)};if(conduitApi.platform.storage.isSupported()){conduitApi.platform.storage.getItem(a,c,b,d)}else{cqm.showToastMessage("Not supported")}},onRemove:function(){var e=this;var d=this.$el.find(".global").is(":checked");var b=this.$el.find(".key").val();alert("global = "+d+" key = "+b);var a=function(f){cqm.showToastMessage("Success! data = "+f);e.printData(f)};var c=function(f){cqm.showToastMessage("cbFail. data = "+f);e.printData(f)};if(conduitApi.platform.storage.isSupported()){conduitApi.platform.storage.removeItem(a,c,b,d)}else{cqm.showToastMessage("Not supported")}},onClear:function(){var c=this;var a=function(d){cqm.showToastMessage("Success! data = "+d);c.printData(d)};var b=function(d){cqm.showToastMessage("cbFail. data = "+d);c.printData(d)};if(conduitApi.platform.storage.isSupported()){conduitApi.platform.storage.clearStorage(a,b)}else{cqm.showToastMessage("Not supported")}},printData:function(b){var a=this.$el.find(".result");a.html(this.objectToText(b))},objectToText:function(c){var d="";if(typeof(c)==="object"){for(var a in c){var b=this.objectToText(c[a]);d+='<div style="padding-left: 3px;">'+a+" : "+b+"</div>"}}else{d=c}return d}}); var UITestView=TemplateView.extend({render:function(a){var b=apiTestTemplates.uiView();TemplateHelper.createScrollerForContent(this.$el,b);this.$el.find(".show_activity_btn").bind("tap",this.onShowActivity.hitch(this));this.$el.find(".dis_activity_btn").bind("tap",this.onDismissActivity.hitch(this));this.$el.find(".dis_activity_btn2").bind("tap",this.onDismissActivity2.hitch(this));this.$el.find(".dialog_btn").bind("tap",this.onDialog.hitch(this));this.$el.find(".toast_btn").bind("tap",this.onToast.hitch(this));return this},onShowActivity:function(){var d=this;var c=this.$el.find(".message").val();var a=function(e){cqm.showToastMessage("Success! data = "+e);d.printData(e)};var b=function(e){cqm.showToastMessage("cbFail. data = "+e);d.printData(e)};if(conduitApi.UI.isSupported()){conduitApi.UI.startActivityIndicator(a,b,c)}else{cqm.showToastMessage("Not supported")}},onDismissActivity:function(){var d=this;var a=this.$el.find(".forceDismiss").is(":checked");var b=function(e){cqm.showToastMessage("Success! data = "+e);d.printData(e)};var c=function(e){cqm.showToastMessage("cbFail. data = "+e);d.printData(e)};if(conduitApi.UI.isSupported()){conduitApi.UI.dismissActivityIndicator(b,c,a)}else{cqm.showToastMessage("Not supported")}},onDismissActivity2:function(){setTimeout(this.onDismissActivity.hitch(this),5000)},onDialog:function(){var d=this;var l=this.$el.find(".message").val();var j=this.$el.find(".caption").val();var h=this.$el.find(".buttons_captions").val();var e=parseInt(this.$el.find(".count").val());var f=[];for(var a=0;a<e;a++){var c={text:h+":"+a,cb:function(){alert("button clicked")}};f[a]=c}var k={title:j,message:l,buttons:f};var g=function(i){d.printData(i)};var b=function(i){d.printData(i)};if(conduitApi.UI.isSupported()){conduitApi.UI.showDialogBox(g,b,k)}else{cqm.showToastMessage("Not supported")}},onToast:function(){var d=this;var c=this.$el.find(".message").val();var e=parseInt(this.$el.find(".duration").val());var a=function(f){d.printData(f)};var b=function(f){d.printData(f)};if(conduitApi.UI.isSupported()){conduitApi.UI.showToastMessage(a,b,c,e)}else{cqm.showToastMessage("Not supported")}},printData:function(b){var a=this.$el.find(".result");a.html(this.objectToText(b))},objectToText:function(c){var d="";if(typeof(c)==="object"){for(var a in c){var b=this.objectToText(c[a]);d+='<div style="padding-left: 3px;">'+a+" : "+b+"</div>"}}else{d=c}return d}}); var LogTestView=TemplateView.extend({render:function(a){var b=apiTestTemplates.logView();TemplateHelper.createScrollerForContent(this.$el,b);this.$el.find(".info").bind("tap",this.onInfo.hitch(this));this.$el.find(".warning").bind("tap",this.onWarning.hitch(this));this.$el.find(".error").bind("tap",this.onError.hitch(this));return this},onInfo:function(){var d=this;var c=this.$el.find(".message").val();var a=function(e){cqm.showToastMessage("Success! data = "+e);d.printData(e)};var b=function(e){cqm.showToastMessage("cbFail. data = "+e);d.printData(e)};if(conduitApi.log.isSupported()){conduitApi.log.info(a,b,c)}else{cqm.showToastMessage("Not supported")}},onWarning:function(){var d=this;var c=this.$el.find(".message").val();var a=function(e){cqm.showToastMessage("Success! data = "+e);d.printData(e)};var b=function(e){cqm.showToastMessage("cbFail. data = "+e);d.printData(e)};if(conduitApi.log.isSupported()){conduitApi.log.warning(a,b,c)}else{cqm.showToastMessage("Not supported")}},onError:function(){var d=this;var c=this.$el.find(".message").val();var a=function(e){cqm.showToastMessage("Success! data = "+e);d.printData(e)};var b=function(e){cqm.showToastMessage("cbFail. data = "+e);d.printData(e)};if(conduitApi.log.isSupported()){conduitApi.log.error(a,b,c)}else{cqm.showToastMessage("Not supported")}},printData:function(b){var a=this.$el.find(".result");a.html(this.objectToText(b))},objectToText:function(c){var d="";if(typeof(c)==="object"){for(var a in c){var b=this.objectToText(c[a]);d+='<div style="padding-left: 3px;">'+a+" : "+b+"</div>"}}else{d=c}return d}}); var colorTypes={state:{DEFAULT:"default",SELECTED:"selected",CLICK:"clicked",DISABLED:"disabled",MANDATORY:"mandatory",PLACEHOLDER:"watermark",PLACEHOLDER_MANDATORY:"mandWatermark"},colorType:{BACKGROUND:"background",ICON:"icon",SERVER_ICON:"server_icon",TEXT:"text",BORDER:"border",SVG:"svg"},gradientOrientation:{VERTICAL:"vertical",HORIZONTAL:"horizontal",RADIAL:"radial",DIAGONAL_TL_BR:"diagonal",DIAGONAL_BL_TR:"diagonal2"},backgroundType:{SOLID:"solid",GRADIENT:"gradient"}}; var LayoutApplier=(function(){var g={};g.colorThemeCSS={};function i(o){var n="";if($.support.opacity){if(o.a){n="background-color:rgba("+o.r+","+o.g+","+o.b+","+o.a+");"}else{n="background-color:rgb("+o.r+","+o.g+","+o.b+");"}}else{var p="#"+Utils.Colors.colorToHex(o,true);n='background: transparent; -ms-filter: "progid:DXImageTransform.Microsoft.gradient(startColorstr='+p+",endColorstr="+p+')"; filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='+p+",endColorstr="+p+"); zoom: 1;"}return n}function c(o,p){var n="";var z=[];var w;for(w=0;w<o.length;w++){var r=o[w];var v=j(r.color)+" "+parseInt(r.location*100)+"% ";z.push(v)}var t=z.join(",");var x=o[0].color;var q=o[o.length-1].color;var u=j(x);var s=j(q);if(p===colorTypes.gradientOrientation.HORIZONTAL){var y='-ms-filter: "progid:DXImageTransform.Microsoft.gradient(startColorstr='+x+",endColorstr="+q+')";filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='+x+",endColorstr="+q+"); zoom: 1;background-image: -webkit-gradient(linear, left top, right top, from("+u+"), to("+s+"));background-image: -webkit-linear-gradient(left, "+t+");background-image:    -moz-linear-gradient(left, "+t+");background-image:     -ms-linear-gradient(left, "+t+");background-image:      -o-linear-gradient(left, "+t+");background-image:         linear-gradient(left, "+t+");"}else{if(p===colorTypes.gradientOrientation.DIAGONAL_TL_BR){var y='-ms-filter: "progid:DXImageTransform.Microsoft.gradient(startColorstr='+x+",endColorstr="+q+')";filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='+x+",endColorstr="+q+"); zoom: 1;background-image: -webkit-gradient(linear, left top, right bottom, from("+u+"), to("+s+"));background-image: -webkit-linear-gradient(-45deg, "+t+");background-image:    -moz-linear-gradient(-45deg, "+t+");background-image:     -ms-linear-gradient(-45deg, "+t+");background-image:      -o-linear-gradient(-45deg, "+t+");background-image:         linear-gradient(-45deg, "+t+");"}else{if(p===colorTypes.gradientOrientation.DIAGONAL_BL_TR){var y='-ms-filter: "progid:DXImageTransform.Microsoft.gradient(startColorstr='+x+",endColorstr="+q+')";filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='+x+",endColorstr="+q+"); zoom: 1;background-image: -webkit-gradient(linear, left bottom, right top, from("+u+"), to("+s+"));background-image: -webkit-linear-gradient(45deg, "+t+");background-image:    -moz-linear-gradient(45deg, "+t+");background-image:     -ms-linear-gradient(45deg, "+t+");background-image:      -o-linear-gradient(45deg, "+t+");background-image:         linear-gradient(45deg, "+t+");"}else{if(p===colorTypes.gradientOrientation.RADIAL){var y='-ms-filter: "progid:DXImageTransform.Microsoft.gradient(startColorstr='+x+",endColorstr="+q+')";filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='+x+",endColorstr="+q+"); zoom: 1;background-image: -webkit-gradient(radial, center center, from("+u+"), to("+s+"));background-image: -webkit-radial-gradient(center, ellipse cover, "+t+");background-image:    -moz-radial-gradient(center, ellipse cover, "+t+");background-image:     -ms-radial-gradient(center, ellipse cover, "+t+");background-image:      -o-radial-gradient(center, ellipse cover, "+t+");background-image:         radial-gradient(center, ellipse cover, "+t+");"}else{var y='-ms-filter: "progid:DXImageTransform.Microsoft.gradient(startColorstr='+x+",endColorstr="+q+')";filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='+x+",endColorstr="+q+"); zoom: 1;background-image: -webkit-gradient(linear, left top, left bottom, from("+u+"), to("+s+"));background-image: -webkit-linear-gradient(top, "+t+");background-image:    -moz-linear-gradient(top, "+t+");background-image:     -ms-linear-gradient(top, "+t+");background-image:      -o-linear-gradient(top, "+t+");background-image:         linear-gradient(top, "+t+");"}}}}return y}function j(n){var o=Utils.Colors.hexToColor(n);if($.support.opacity){if(!o){return"rgba(0,0,0,1)"}return"rgba("+o.r+","+o.g+","+o.b+","+(o.a||"1.0")+")"}else{if(!o){return"rgb(0,0,0)"}return"rgb("+o.r+","+o.g+","+o.b+")"}}function m(s){if(!s.color){return""}var p=j(s.color);var n=s.x||"";var r=s.y||"";var q=s.blur||"";var o=n+" "+r+" "+q+" "+p;if(s.isInset){o="inset "+o}return o}function f(r){if(!r.color){return""}var o=j(r.color);var n=r.x||"";var q=r.y||"";var p=r.blur||"";return n+" "+q+" "+p+" "+o}function d(s){var n="";if(s&&s.type&&s.color){var q=s.color;var p=s.type;if(p===colorTypes.backgroundType.GRADIENT){n=c(q,s.orientation)}else{if(p===colorTypes.backgroundType.SOLID){var t=Utils.Colors.hexToColor(q);n=i(t)}}if(s.shadow){var o="";if(s.shadow.length>0){for(var r=0;r<s.shadow.length-1;r++){o=o+m(s.shadow[r])+","}o=o+m(s.shadow[r])}else{o=m(s.shadow)}if(o){o=o+";";n+="box-shadow:"+o;n+="-webkit-box-shadow:"+o;n+="-moz-box-shadow:"+o}}if(s.image){n+='background-image:url("'+s.image.url+'");';if(s.image.position){n+="background-position:"+s.image.position+";"}if(s.image.size){n+="background-size:"+s.image.size+";"}if(s.image.repeat){n+="background-repeat:"+s.image.repeat+";"}}}return n}function k(r){var o="";if(r&&r.color){var p=r.color;o="color:"+j(p)+";";if(r.shadow){var n="";if(r.shadow.length>0){for(var q=0;q<r.shadow.length-1;q++){n=n+f(r.shadow[q])+","}n=n+f(r.shadow[q])}else{n=f(r.shadow)}o+="text-shadow:"+n+";"}}return o}function h(o){var n="";_.each(o,function(t,q){var s=t.width||"1px";var r=t.style||"solid";var p=j(t.color);if(q==="ltrLeft"){if(IS_RTL){q="right"}else{q="left"}}if(q==="ltrRight"){if(IS_RTL){q="left"}else{q="right"}}n+="border-"+q+"-width:"+s+";";n+="border-"+q+"-style:"+r+";";n+="border-"+q+"-color:"+p+";"});return n}function b(q){var n="";if(!(q&&q.type&&q.color)){return n}var p=q.color;var o=q.type;if(o===colorTypes.backgroundType.SOLID){var r=Utils.Colors.hexToColor(p);n="fill:rgba("+r.r+","+r.g+","+r.b+","+r.a+");"}return n}function l(p,o,q,r){var n={};_.each(r,function(w){var y=w.cssPrefix||"";var s=w.cssSuffix||"";if(o===colorTypes.colorType.BACKGROUND){n[y+q+s]=d(p)}else{if(o===colorTypes.colorType.ICON){var t="";if((p.isSimple&&DeviceSupport.isSimpleMaskSupported)||DeviceSupport.isMaskSupported){t=d(p)}else{t="background-image: url(app/interface/web/img/";if(window.devicePixelRatio>=2){t+="@2/"}else{if(window.devicePixelRatio>=1.5){t+="@2/"}else{t+="@1/"}}if(p.isBlack){t+="blackSprite.png);"}else{t+="whiteSprite.png);"}}n[y+q+s]=t}else{if(o===colorTypes.colorType.SVG){n[y+q+s]=b(p);n[y+q+s+"_fallback"]=d(p);n[y+q+s+"_fallback_text"]=k(p)}else{if(o===colorTypes.colorType.SERVER_ICON){var v="display: none !important;";var u="display: none !important;";var x="display: none !important;";if((p.isSimple&&DeviceSupport.isSimpleMaskSupported)||DeviceSupport.isMaskSupported){v=d(p)}else{if(p.isBlack){u=""}else{x=""}}n[y+q+"_mask_icon"+s]=v;n[y+q+"_black_icon"+s]=u;n[y+q+"_white_icon"+s]=x}else{if(o===colorTypes.colorType.TEXT){n[y+q+s]=k(p)}else{if(o===colorTypes.colorType.BORDER){n[y+q+s]=h(p)}}}}}}});return n}function a(o){if(PLATFORM===platformEnum.webApp&&ScrollingFactory.getScrollerName()===ScrollingFactory.FIXED_SCROLL_NAME){if(o&&o.appGeneral&&o.appGeneral.footer&&o.appGeneral.footer.bg&&o.appGeneral.footer.bg.data&&o.appGeneral.footer.bg.data["default"]&&o.appGeneral.footer.bg.data["default"].color){var n=o.appGeneral.footer.bg.data["default"];var p=n.color;n.color="#FF"+p.substr(3,6)}}}function e(p,o,n){_.each(n,function(q,s){var r=o+"_"+s;if(q.type){_.each(q.data,function(v,u){if(u===colorTypes.state.DEFAULT){var w=[{}]}else{if(u===colorTypes.state.SELECTED){var w=[{cssPrefix:".selected"}]}else{if(u===colorTypes.state.DISABLED){var w=[{cssPrefix:".disabled"}]}else{if(u===colorTypes.state.CLICK){var w=[{cssPrefix:".ui-btn-hover"}]}else{if(u===colorTypes.state.MANDATORY){var w=[{cssPrefix:".mandatory"}]}else{if(u===colorTypes.state.PLACEHOLDER){var w=[{cssSuffix:">.watermark"},{cssSuffix:"::-webkit-input-placeholder"},{cssSuffix:":-moz-placeholder"}]}else{if(u===colorTypes.state.PLACEHOLDER_MANDATORY){var w=[{cssPrefix:".mandatory",cssSuffix:">.watermark"},{cssPrefix:".mandatory",cssSuffix:"::-webkit-input-placeholder"},{cssPrefix:".mandatory",cssSuffix:":-moz-placeholder"}]}else{return}}}}}}}var t=l(v,q.type,r,w);_.extend(p,t)})}else{e(p,r,q)}})}g.generateColorTheme=function(r){var p=r.get("appLayout");var o=p.get("backgroundImage");var n=p.get("colors");a(n);var q={};if(DEVICE!=deviceTypeEnum.android||PLATFORM!=platformEnum.nativeApp){q[".theme_background_image"]="background-image:url("+o+");background-color:white"}e(q,".clr",n);return q};g.apply=function(o){var n=g.generateColorTheme(o);if(n){g.colorThemeCSS=Utils.Helpers.deepClone(true,{},n);for(colorIndex in n){n[colorIndex]="{ "+n[colorIndex]+" }"}if(DeviceSupport.isMaskSupported){n[".mask_sprite"]="{ background-position: 0 0 !important; }"}Utils.Html.addCssStyle(n,document,"themeColors")}};return g})(); var StateManager=(function(){var c={};var g;var f;var d;var b=function(h){switch(d){case socialServiceReturnType.FACEBOOK:setTimeout(function(){conduitApi.__BCAPI.social.handleFacebookShareLoginReturn(h)},1000);break;case socialServiceReturnType.TWITTER:setTimeout(function(){conduitApi.__BCAPI.social.handleTwitterShareLoginReturn(h)},1000);break}};var a=function(){var h;switch(d){case socialServiceReturnType.TWITTER:h=TWITTER_TOKENS;break}if(h){conduitApi.platform.storage.setItem(null,null,h,JSON.stringify(g),true)}};var e=function(i){var h="user_denied";conduitApi.platform.storage.removeItem(null,null,RETURN_STATE_INFO,true);if(i){var j=JSON.parse(i);d=parseInt(g.type);if(j&&j.pageState&&j.pageState.shareInfo){if(!g.error){b(j.pageState)}j.pageState=j.pageState.pageState}if(!g.error){a()}f(j)}else{f()}};c.loadSavedState=function(h){f=h;g=Utils.Url.getHashObject();if(g&&g.hasOwnProperty("type")&&conduitApi.platform.storage.isSupported()){conduitApi.platform.storage.getItem(e,f,RETURN_STATE_INFO,true)}else{var i=Utils.Url.getQueryValue("appId");if(i){APP_ID=i}f()}};return c})(); var DeviceReady=(function(){var a={};a.ready=function(b){b()};return a}()); var ImagesLoader=(function(){me={};me.init=function(){if(window.devicePixelRatio>=2){var b="@2/"}else{if(window.devicePixelRatio>=1.5){var b="@2/"}else{var b="@1/"}}var a=["app/interface/web/img/"+b+"sprite.png","app/interface/web/img/"+b+"blackSprite.png","app/interface/web/img/ajax-loader.png","pages/common/controls/photoswipe/loader.gif"];if(!DeviceSupport.isMaskSupported){a[a.length]="app/interface/web/img/"+b+"whiteSprite.png"}Utils.Html.preloadImages(a)};return me}()); var TestAmsData={addTestData:function(a){this.overrideNavigationLayout(a.layout);this.addTestTemplates(a.pages);this.addTestSettings(a.settings);this.overrideColorsLayout(a.layout);this.overrideHeaderData(a.meta.header);this.addGeneralTests(a);this.overrideServices(a)},overrideServices:function(e){if(false){var d=["CMS_TWITTER_QUERY_GET","CMS_TWITTER_USER_GET"];for(var b=0;b<d.length;b++){var a=d[b];var c=_.find(e.settings.overrideServices,function(f){return f.key===a});if(!c){c={key:a,params:{},version:null};e.settings.overrideServices.push(c)}c.version=1}}},overrideNavigationLayout:function(b){var a=false;if(a){b.layoutType=navigationLayoutTypes.sideMenu}},addGeneralTests:function(b){var a=false;if(a){b.social={facebook:{appId:"278356942286793"}};b.social.twitter={appAccessToken:"AAAAAAAAAAAAAAAAAAAAAMF2EAAAAAAAkZ9X1SDa6vqTlQJTwY7g%2Fl1eo2Y%3DKE1X5rE9QTxjR1iobyZ1fxvmW8rGzraY0zosJDapPS4"}}},overrideHeaderData:function(b){var a=false;if(a){b.content="NBA Title";b.imageUrl="http://communabuilder.tapuz.co.il/UsersFolders/garame/images/2103200676258.jpg";b.type=2}},addTestTemplates:function(y){var K=false;if(K){var L={channels:[{id:"3d5038bb-376d-86d5-3c3f-3cf017253109",title:"rihanna feed",postsSource:"feed",user:"rihanna"},{id:"332f06ac-9702-4dcc-45f5-bbc6df3f8a69",title:"NBA posts",postsSource:"posts",user:"nba"},{id:"31842c61-d769-8d3f-8466-d4aa2581f0cd",title:"cocacola feed",postsSource:"feed",user:"cocacola"},{id:"c2889774-92c1-0811-9524-83fccbc972fd",title:"cocacola posts",postsSource:"posts",user:"cocacola"},{id:"a65cdd08-a222-b289-9fad-57346968ca98",title:"ABC",user:"abcnews"}]};var av={icon:"http://storage.conduit.com/images/mobile/controlpanel/pages/icons/white_t/Social.png",id:"086b4be8-f548-5577-d8b9-6bb47040146f",label:"TEST",meta:L,minVersion:"0.0.0.0",type:"df7d11f3-233c-4d49-8f2a-d1886e07c641",version:null};y.push(av)}var X=false;if(X){var Y={type:"a95e67d5-4816-11c2-318d-fe64a33e32d2",label:"USERS LIST",minVersion:"3.2.0.4",version:"100.0.0.0",icon:"http://images.mobile.site-services.com/icon/5",id:"83d40af6-7a4c-1c01-f3a5-8631ec1f1cf2",meta:{items:[{title:"tab1",id:"",params:{provider:"conduit",groupId:"9bd5bdde-83fa-4236-9d5e-7c10fda796fc",extraInfo:{order:{field:"name",order:1}}}}]}};y.push(Y)}var au=false;if(au){var W={alias:"twitter",displayDevices:0,icon:"http://images.mobile.site-services.com/icon/58",id:"ab90491e-6eb6-4b6f-bbee-e721d03ae074",label:"Twitter",meta:{pageLayout:1,feeds:[{id:"44ffe3ee-3582-e15e-48a1-668f834e3ade",title:"user",type:"0",userName:"mashable",params:{}},{id:"32a875e1-cd88-e78e-50bf-6296d188900a",title:"search",type:"2",userName:"engadget",params:{}},{id:"32a875e1-cd88-e78e-50bf-6296d188900a",title:"list",type:"1",userName:"twitter",params:{listName:"Team"}}],layout:null},minVersion:"0.0.0.0",type:"a77583ef-758f-45f3-9ad1-9704d82a2154",version:null};y.splice(0,0,W)}var aE=false;if(aE){var aG={type:"a8c1cd8e-7e55-828d-3bd2-fb2122472fa3",label:"Inbox",minVersion:"3.2.0.4",version:"100.0.0.0",icon:"http://images.mobile.site-services.com/icon/6",id:"83d40af6-7a4c-1c01-f3a5-8631ec1f1cf2",meta:{}};y.push(aG)}var at=false;if(at){var F={type:"fe6a4b7d-cf62-172e-8eba-a231dd39eb20",label:"My Profile",minVersion:"3.2.0.4",version:"100.0.0.0",icon:"http://images.mobile.site-services.com/icon/6",id:"83d40af6-7a4c-1c01-f3a5-8631ec1f1cf1",meta:{items:[{title:"",id:"aaaaaaf6-7a4c-1c01-f3a5-8631ec1f1cf2",params:{extraInfo:{}}}]}};y.push(F)}var aI=false;if(aI){var aI={displayDevices:511,icon:"http://images.mobile.site-services.com/icon/82",id:"877a15db-d18a-2d19-7b9d-57eea6e39401",isDeleted:false,label:"Menu",meta:{pageLayout:-1,items:[]},subType:"00000000-0000-0000-0000-000000000000",type:"8901e95e-4dc9-411f-835a-0f18a7872122"};y.push(aI)}var Z=false;if(TEST_LOYALTY){Z=true}if(Z){var Z={minVersion:"3.0.0.0",displayDevices:511,type:"0255eb38-1fb5-4b65-abee-b6fdb69c8f07",label:"Coupons test",isDeleted:false,icon:"http://images.mobile.site-services.com/icon/86",id:"6f4cf51e-9b47-41a2-bf8d-d9eceb5b241c",meta:{pageLayout:-1,items:[{params:{listId:"0b93d2e1-bfa1-40a0-a43e-209e1d194d72",type:"contenthost"}}]}};y.splice(0,0,Z)}var O=false;if(O){var aC={type:"e9773a60-828f-6a16-a1fb-770163905537",label:"POLL TEST!",minVersion:"0.0.0.0",version:"10.0.0.0",icon:"http://images.mobile.site-services.com/icon/5",id:"b42799b1-bdec-aa36-9ea8-416daa2a4717",meta:{items:[{title:"tab1",id:"e6f02f39-d04d-5fd1-7afa-c972d79680ce",params:{type:"custom",pollId:"FC71DCF6-9A7D-4274-B51B-CEDA81188B5D"}}]}};y.push(aC)}var ax=false;if(ax){var F={type:"fe6a4b7d-cf62-172e-8eba-a231dd39eb20",displayDevices:0,id:"c545de00-a684-4720-bb7a-acb8e7eef5d7",label:"myProfile",minVersion:"0.0.0.0",version:"10.0.0.0",icon:"http://images.mobile.site-services.com/icon/85",meta:{pageLayout:-1}};y.push(F)}var C=false;if(C){var aO={type:"38ab2b78-a1ad-42f8-8cb7-9475498c0f30",displayDevices:0,id:"c545de00-a684-4720-bb7a-acb8e7eef5da",label:"Report",minVersion:"0.0.0.0",version:"10.0.0.0",icon:"http://images.mobile.site-services.com/icon/85",meta:{pageLayout:-1,items:[{reportId:"c66f7a89-ee65-4694-9c37-d926506c622d",reportVersion:"1",name:"Tomer's",desc:"Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum.",logoImgUrl:"http://fc00.deviantart.net/fs71/f/2012/346/b/0/b04e71f9e9ca95220dc7324357854112-d5nsqq6.jpg",sendButton:{caption:"Submit"},controls:[{caption:"Select a date:",type:"date",id:"date",default_value:1365206400,isMandatory:true,isActive:true},{caption:"Select time:",type:"time",id:"time",default_value:317*60,isMandatory:true,isActive:true},{caption:"Ice-cream (Radio group)",type:"radio",id:"radio1",isActive:true,default_value:"radioOption3",items:[{caption:"Vanilla",value:"radioOption1"},{caption:"Chocolate",value:"radioOption2"},{caption:"Herring",value:"radioOption3"},{caption:"Strawberry",value:"radioOption4"}]},{caption:"Country (Combo: hard-coded in the client)",type:"combobox",isMandatory:true,isActive:true,subType:"country",id:"combo2",items:null},{caption:"State (Combo: hard-coded in the client)",isMandatory:true,isActive:true,type:"combobox",subType:"state",id:"combo3",items:null},{caption:"First name (Text)",type:"inputtext",id:"input1",isMandatory:true},{caption:"Phone number (Telephone)",isActive:true,type:"inputtext",id:"inputTel1",subType:"tel",isMandatory:true},{caption:"Email (inactive)",isActive:false,type:"inputtext",subType:"email",id:"inputEmail",isMandatory:true,placeholder:"your@email.com"}]}]}};y.splice(2,0,aO)}var d=false;if(d){var M={type:"0311d37d-6d9f-fc9d-35fd-45b471d2382f",label:"TEST TEST",minVersion:"0.0.0.0",version:"10.0.0.0",icon:"http://images.mobile.site-services.com/icon/5",id:"d1f16b9a-2e85-b96a-3422-1b34a58e3952",meta:{header:{title:"This is the title for all the quizzes",descr:"This is the description for all the quizzes. Maybe it will be a very long text. Maybe not. Who can know? Maybe number 1. -Who? Me? - Yes you. - What suddenly? But who?",imageUrl:"http://images.all-free-download.com/images/graphiclarge/cars_pixar_8_95489.jpg"},items:[{title:"quiz 1 (Clclst)",imageUrl:"http://groworganic.info/wordpress/gallery/wp-icons/bull.png",id:"808d8a45-2afe-305b-0cb5-1112ea9c267f",params:{type:"custom",pollId:"FC71DCF6-9A7D-4274-B51B-CEDA81188B5D"}},{title:"quiz 2",imageUrl:"https://encrypted-tbn1.gstatic.com/images?q=tbn:ANd9GcSVGQDrAfUwI1uUq8tLR3QRe-XOifbBX94zxQCszy7ilD20xVvgYQ",id:"808d8a45-2afe-305b-0cb5-1112ea9c2222",grades:[{value:0,text:"0 or 1",imageUrl:"http://t3.gstatic.com/images?q=tbn:ANd9GcT5c2t0fIQzs4aCNYrVpw8APoPrT7XrgYTOP09JKrw1nI2pZM7iEw"},{value:2,text:"2 +",imageUrl:"http://t0.gstatic.com/images?q=tbn:ANd9GcRlt9kAnvxdUONAQj6LDcI9tR7GyxMNOUjkHioE5aCB-q4_b-Gh3Q"}],params:{type:"custom",pollId:"87BF43E6-D7E2-4838-9F09-38CCC9FD77EB"}},{title:"",imageUrl:"https://encrypted-tbn1.gstatic.com/images?q=tbn:ANd9GcT72rpCVXG12r5zVKmxihIkkm7z3Eiq2g31LFuHo7owGB4QCTqn2g",id:"808d8a45-2afe-305b-0cb5-1112ea9c2333",params:{type:"custom",pollId:"87BF43E6-D7E2-4838-9F09-38CCC9FD77EB"}},{title:"quiz 4 (Maor)",imageUrl:"http://images.all-free-download.com/images/graphiclarge/cars_pixar_8_95489.jpg",id:"3a67638a-745c-8ea3-5271-8d6f9dd5b204",gameEnd:"end of questions",grades:[{value:0,text:"U R 0",imageUrl:""},{value:1,text:"Very Bad!"},{value:5,text:"Not so Bad"},{value:7,text:"Good!"},{value:10,text:"PERFECT!"}],params:{type:"custom",pollId:"87BF43E6-D7E2-4838-9F09-38CCC9FD77EB"}}]}};y.push(M)}var aD=false;if(aD){var aH={type:"f61f12d6-df0c-465c-b3ba-70fb8f3894a4",label:"AGENDA TEST!",minVersion:"0.0.0.0",version:"10.0.0.0",icon:"http://images.mobile.site-services.com/icon/5",id:"5e5e531f-d48b-374f-ae22-7b6637ea9778",meta:{items:[{title:"tab1",id:"f4b01aca-be51-e5a2-a129-8ef5a7143b0f",params:{type:"custom",id:"BC45E512-F9FF-4F6F-8E5E-279A9BFF0DB6",ranges:""}}]}};y.push(aH)}var N=false;if(N){var V={type:"ff4532d2-9137-8da2-f97f-be8b3ddd08e4",label:"SPEAKERS TEST!",minVersion:"0.0.0.0",version:"10.0.0.0",icon:"http://images.mobile.site-services.com/icon/5",id:"c8c3d697-c036-df3c-a3a7-11855acf1968",meta:{items:[{title:"tab1",id:"f4b01aca-be51-e5a2-a129-8ef5a7143b0f",params:{type:"custom",id:"BC45E512-F9FF-4F6F-8E5E-279A9BFF0DB6",ranges:""}}]}};y.push(V)}var al=false;if(al){var u={type:"e0adcb11-f7bb-8107-1cd0-77690221f31c",label:"Instagram",minVersion:"0.0.0.0",version:"10.0.0.0",icon:"http://images.mobile.site-services.com/icon/5",id:"6f4cf51e-9b47-41a2-bf8d-d9eceb5b241a",meta:{items:[{title:"tab1",id:"067e6521-2878-a7d3-5fdd-b66596503691",type:"instagram",userName:"189817868"},{title:"tab2",id:"71d2eddb-310b-c0cc-b970-d3ab3e5f3c2f",type:"instagram",userName:"1574083"}]}};y.push(u)}var ay=!true;if(ay){var a={type:"e0adcb11-f7bb-8107-1cd0-77690221f31c",label:"Ins2",minVersion:"0.0.0.0",version:"10.0.0.0",icon:"http://images.mobile.site-services.com/icon/1",id:"d1be774c-4873-044d-ecb2-ae0c67f3bec6",meta:{items:[{title:"tab1",id:"d003570b-6191-9c26-af02-b32b87453ff6",type:"instagram",userName:"189817868"}]}};y.push(a)}var i=false;if(i){var p={items:[{logoImgUrl:null,hideHeader:true,id:"b3f782c1-ca7e-f2ae-8ab5-7997bc603738",title:"mrss",params:{id:"ddd0fce3-6eba-f062-7e53-fd803e46effb",url:"http://rss.moddb.com/audio/feed/rss.xml",icon:"/Images/Providers/Audio/small_icon_1.png",type:1,params:{expiration:0,sort:{}}}},{id:"7962c5ff-a38f-a6f2-9065-7fd67cd1853e",title:"play list",params:{id:"b8cad3a2-cd9c-9547-47cb-a642f90a9124",url:"http://media.mobile.site-services.com/Services/Rss/Radio/330ae4f9-7018-44d7-abb3-d841a08d06ec",icon:"/Images/Providers/Audio/small_icon_2.png",type:2,params:{}}},{id:"7b2871c5-8f26-90fe-45df-52f3e24583d3",title:"bad camp",params:{id:"e0eceb62-83a1-9631-a75a-f7244b04ecd1",url:"http://cms.mobile.site-services.com/bandcamp/audio?album=321711561",icon:"/Images/Providers/Audio/small_icon_4.png",type:4,bandCamp:{albumId:321711561,artistId:3463798201,hint:{art:"http://f0.bcbits.com/z/17/26/172695457-1.jpg",title:"Who Killed Amanda Palmer [Alternate Tracks]"}},params:{}}}]};var ak={icon:"http://storage.conduit.com/images/mobile/controlpanel/pages/icons/white_t/Social.png",id:"2acbb41d-2379-0e60-1c46-95c931eb234d",label:"Audio TEST",meta:p,minVersion:"0.0.0.0",type:"30be1358-8b36-4d22-b6d2-50c38f4246c4",version:null};y.push(ak)}var T=false;if(T){var aB={items:[{title:"buzzer",params:{url:"http://www.conduit.com/Images/Mobile/LeumiBuzzer/LeumiBuzzer.xml",type:2,params:{}}},{title:"youtube",params:{url:"http://gdata.youtube.com/feeds/api/users/nba/uploads?v=2&orderby=published",type:2,params:{}}},{title:"fora.tv",params:{url:"http://fora.tv/media/rss/podcasts/wfc_video.xml",type:2,params:{}}}]};var H={icon:"http://storage.conduit.com/images/mobile/controlpanel/pages/icons/white_t/Social.png",id:"b3ae29df-c4ea-f835-a739-def7b8c51c71",label:"Video",meta:aB,minVersion:"0.0.0.0",type:"4680c3f3-e767-4ebf-b112-9ba769c3ff2a",version:"99999.0.0"};y.push(H)}var j=false;if(j){var ap={blogTitle:"take ranch",token:"123",buttons:[{type:"linkedin",url:"http://in.linkedin.com/in/nbainstitutions"},{type:"facebook",url:"http://www.facebook.com/nba"},{type:"twitter",url:"http://www.twitter.com/nba"}]};var ad={icon:"http://storage.conduit.com/images/mobile/controlpanel/pages/icons/white_t/Social.png",id:"695dbae0-56b9-6cc3-9451-83bcbdc6593c",label:"Subscribe!",meta:ap,minVersion:"0.0.0.0",type:"c6bb3e68-0ea7-43dc-a358-b40d9b75d224",version:"99999.0.0.0"};y.push(ad)}var e=false;if(e){var aN={items:[{email:"Matanya@conduit.com"}]};var aS={icon:"http://storage.conduit.com/images/mobile/controlpanel/pages/icons/white_t/Social.png",id:"44f6a555-dd49-d351-77a5-e41635408c41",label:"Mail Us!",meta:aN,minVersion:"0.0.0.0",type:"ec79d314-f6aa-f396-a651-3f9b3344dd99",version:"9999.0.0.0"};y.push(aS)}var ab=false;if(ab){var k={items:[{phone:"97289461713"}]};var Q={icon:"http://storage.conduit.com/images/mobile/controlpanel/pages/icons/white_t/Social.png",id:"c0a74c53-c8a8-5456-37c6-11b1daa0ecce",label:"Call Us!",meta:k,minVersion:"0.0.0.0",type:"308af5fa-e91b-d7e7-1926-acfea8f266dc",version:"9999.0.0.0"};y.push(Q)}var af=false;if(af){var s={items:[{imgUrl:"http://www.godwinprop.co.za/images/dolphin_coast_wide.jpg",name:"Techcrunch",title:"Tech blog",description:"An antioxidant is a molecule that inhibits the oxidation of other molecules.\n Oxidation is a chemical reaction that transfers electrons or hydrogen from a substance to an oxidizing agent. Oxidation reactions can produce free radicals. In turn, these radicals can start chain reactions. When the chain reaction occurs in a cell, it can cause damage or death to the cell. Antioxidants terminate these chain reactions by removing free radical intermediates, and inhibit other oxidation reactions. They do this by being oxidized themselves, so antioxidants are often reducing agents such as thiols, ascorbic acid, or polyphenols.\nAntioxidants are important additives in gasoline. These antioxidants prevent the formation of gums that interfere with the operation of internal combustion engines.",about:"RKO Pictures is an American film production and distribution company (http://www.nba.com, www.pixar.com, nba.com). It was one of the Big Five studios of Hollywood's Golden Age.",list:[{icon:"http://storage.site.com/Images/Mobile/controlpanel/AboutUs/icons_white/Album.png",iconBlack:"http://storage.site.com/Images/Mobile/controlpanel/AboutUs/icons_black/Album.png",title:"Title",dataType:"html",data:{html:"This is the <i>HTML</i> description. maybe cantains long words like 0000111122223333444455556666777788889999 and/or long text. <br> Enjoy."}},{icon:"http://storage.site.com/Images/Mobile/controlpanel/AboutUs/icons_white/Product.png",iconBlack:"http://storage.site.com/Images/Mobile/controlpanel/AboutUs/icons_black/Product.png",title:"{$HtmlTextAboutUsItemTitleFoodStyle}",dataType:"html",data:{html:"<b>Italian</b> - Yam.<br><b>Japanese</b> - Yack."}},{icon:"http://storage.site.com/Images/Mobile/controlpanel/AboutUs/icons_white/Scroll.png",iconBlack:"http://storage.site.com/Images/Mobile/controlpanel/AboutUs/icons_black/Scroll.png",title:"Too long title 1234567890!",dataType:"list",data:{list:["list item 1","list item 2","rubber duck","list item 4"]}},{icon:"http://storage.site.com/Images/Mobile/controlpanel/AboutUs/icons_white/Scroll.png",iconBlack:"http://storage.site.com/Images/Mobile/controlpanel/AboutUs/icons_black/Scroll.png",title:"long list",dataType:"list",data:{list:["list item 1","list item 2","rubber duck","list item 4","list item 5","list item 6","list item 7","list item 8","list item 9","list item 10\n with break lines","list item 11 NOTE: it is not HTML - it is text:<div>a</div>"]}},{icon:"http://storage.site.com/Images/Mobile/controlpanel/AboutUs/icons_white/Awards.png",iconBlack:"http://storage.site.com/Images/Mobile/controlpanel/AboutUs/icons_black/Awards.png",title:"TITLE",dataType:"text",data:{text:"text! no description! <div> inside div </div>"}},{icon:"http://storage.site.com/Images/Mobile/controlpanel/AboutUs/icons_white/Hometown.png",iconBlack:"http://storage.site.com/Images/Mobile/controlpanel/AboutUs/icons_black/Hometown.png",title:"no text",dataType:"text",data:{text:""}},{icon:null,iconBlack:null,title:"no icon + empty list",dataType:"list",data:{list:[]}},{icon:"http://storage.site.com/Images/Mobile/controlpanel/AboutUs/icons_white/Note.png",iconBlack:"http://storage.site.com/Images/Mobile/controlpanel/AboutUs/icons_black/Note.png",title:"",dataType:"text",data:{text:"short text, but no title"}},{icon:"http://storage.site.com/Images/Mobile/controlpanel/AboutUs/icons_white/Hours.png",iconBlack:"http://storage.site.com/Images/Mobile/controlpanel/AboutUs/icons_black/Hours.png",title:"{$HtmlTextAboutUsItemTitleHours}",dataType:"hours",data:{alwaysOpen:true}},{icon:"http://storage.site.com/Images/Mobile/controlpanel/AboutUs/icons_white/Hours.png",iconBlack:"http://storage.site.com/Images/Mobile/controlpanel/AboutUs/icons_black/Hours.png",title:"{$HtmlTextAboutUsItemTitleHours}",dataType:"hours",data:null},{icon:"http://storage.site.com/Images/Mobile/controlpanel/AboutUs/icons_white/Hours.png",iconBlack:"http://storage.site.com/Images/Mobile/controlpanel/AboutUs/icons_black/Hours.png",title:"{$HtmlTextAboutUsItemTitleHours}",dataType:"hours",data:{hours:[{days:[7,1,3],startHour:"13:00",endHour:"16:00"},{days:[7,5,6],startHour:"8:00",endHour:"12:00"},{days:[3],startHour:"23:45",endHour:"23:59"},{days:[1,2,4,6,7],startHour:"5:00",endHour:"5:30"}]}},{icon:"http://storage.site.com/Images/Mobile/controlpanel/AboutUs/icons_white/Group.png",iconBlack:"http://storage.site.com/Images/Mobile/controlpanel/AboutUs/icons_black/Group.png",title:"long text",dataType:"text",data:{text:"Uncle Tupelo was an alternative country music group from Belleville, Illinois, active between 1987 and 1994. Jay Farrar (pictured), Jeff Tweedy, and Mike Heidorn formed the band after the lead singer of their previous band, The Primitives, left to attend college. The trio recorded three albums for Rockville Records, before signing with Sire Records and expanding to a five-piece. Shortly after the release of the band's major label debut album Anodyne, Farrar announced his decision to leave the band due to a soured relationship with his co-songwriter Tweedy. Uncle Tupelo split on May 1, 1994, after completing a farewell tour. Following the breakup, Farrar formed Son Volt with Heidorn, while the remaining members continued as Wilco. Although Uncle Tupelo broke up before they achieved commercial success, the band is renowned for its impact on the alternative country music scene. The group's first album, No Depression, became a byword for the genre and was widely influential. Uncle Tupelo's sound was unlike popular country music of the time, drawing inspiration from styles as diverse as the hardcore punk of The Minutemen and the country instrumentation and harmony of the Carter Family and Hank Williams. Farrar and Tweedy lyrics frequently referred to Middle America and the working class of Belleville."}},{icon:"http://storage.site.com/Images/Mobile/controlpanel/AboutUs/icons_white/Manager.png",iconBlack:"http://storage.site.com/Images/Mobile/controlpanel/AboutUs/icons_black/Manager.png",dataType:"text",title:"long text2",data:{text:"The African Crake (Crex egregia) is a bird in the rail family that breeds in most of sub-Saharan Africa away from the arid south and southwest. It is seasonally common in most of its range other than the rainforests and areas that have low annual rainfall. This crake is a partial migrant, moving away from the equator as soon as the rains provide sufficient grass cover to allow it to breed elsewhere. There have been a few records of vagrant birds reaching Atlantic islands. This species nests in a wide variety of grassland types, and agricultural land with tall crops may also be used."}},{icon:"http://storage.site.com/Images/Mobile/controlpanel/AboutUs/icons_white/Manager.png",iconBlack:"http://storage.site.com/Images/Mobile/controlpanel/AboutUs/icons_black/Manager.png",dataType:"text",title:"long text + links and new lines",data:{text:"From http://en.wikipedia.org/wiki/Main_Page: The Courageous class comprised three battlecruisers built for the Royal Navy during World War I.\nNominally designed to support Admiral of the Fleet Lord John Fisher's Baltic Project, which was intended to land troops on the German Baltic Coast, ships of this class were fast but very lightly armoured with only a few heavy guns.\n\nTo maximize their speed, the Courageous-class battlecruisers were the first capital ships of the Royal Navy to use geared steam turbines and small-tube boilers. The first two ships, Courageous and Glorious, were commissioned in 1917 and spent the war patrolling the North Sea. Their half-sister Furious was designed with a pair of 18-inch (457 mm) guns, the largest guns ever fitted on a ship of the Royal Navy, but was modified during construction to take a flying-off deck and hangar in lieu of her forward gun turret and barbette. All three ships were laid up after the end of the war and were rebuilt as aircraft carriers during the 1920s."}}],buttons:{email:"test@email.com",twitter:"http://www.twitter.com/nba",facebook:"http://www.facebook.com/nba",mySpace:"http://www.myspace.com/nba",linkedin:"http://in.linkedin.com/in/nbainstitutions",webSite:"http://www.techcrunch.com"}},{imgUrl:"",name:"Techcrunch2",title:"Tech blog2",description:"bla bla bla",buttons:{facebook:"http://www.facebook.com/nba",link:"http://www.techcrunch.com"}}]};var D={icon:"http://storage.conduit.com/images/mobile/controlpanel/pages/icons/white_t/Social.png",id:"ca41d26e-9263-2a48-4ff5-2e4f678a3c52",label:"About Us!",meta:s,minVersion:"0.0.0.0",type:"5a8368df-6ebd-c0f2-2d82-e173c1f33d40",version:"9999.0.0.0"};y.push(D)}var ac=false;if(ac){var r={};var ar={icon:"http://storage.conduit.com/images/mobile/controlpanel/pages/icons/white_t/Social.png",id:"26826eb8-f051-e48f-90ab-e0057de00c0c",label:"Favorties",meta:r,minVersion:"0.0.0.0",type:"fa7071be-8262-3b0d-b439-d2edd1ac35ec",minVersion:"1.9.0.0"};y.splice(2,0,ar)}var ah=false;if(ah){var aA={items:[{location:{lat:30,lng:36},header:"This is the header",text:"This is some example text"},{location:{lat:31.9,lng:34.8},header:"header2",text:"Text"},{location:{lat:-5,lng:29},header:"header 3",address:"address3"},{location:{lat:-45,lng:-29},header:"4",address:"address4"}]};var c={icon:"http://storage.conduit.com/images/mobile/controlpanel/pages/icons/white_t/Social.png",id:"78e550d7-a743-20dc-4cc8-94a90429222b",label:"Maps 4",meta:aA,minVersion:"0.0.0.0",type:"aca2f190-b22b-920d-f12a-998101ad4b70",version:"9999.0.0.0"};y.push(c);var aA={items:[{location:{lat:31.9,lng:34.8},header:"This is the header",text:"This is some example text"}]};var c={icon:"http://storage.conduit.com/images/mobile/controlpanel/pages/icons/white_t/Social.png",id:"78e550d7-a743-20dc-4cc8-94a904292221",label:"Maps 1",meta:aA,minVersion:"0.0.0.0",type:"aca2f190-b22b-920d-f12a-998101ad4b70",version:"9999.0.0.0"};y.push(c)}var aJ=false;if(aJ){var aL={url:"http://www.conduit.com"};var g={icon:"http://storage.conduit.com/images/mobile/controlpanel/pages/icons/white_t/Social.png",id:"0a5321d7-2ef6-0ea5-5ca0-669535274d17",label:"EPage",meta:aL,minVersion:"0.0.0.0",type:"0053bbba-1ca1-11e0-89a4-af28e0d72085",version:"9999.0.0.0"};y.splice(2,0,g)}var aa=false;if(aa){var I={hideHeader:!true,items:[{title:"0",layoutId:0,imgUrl:"http://imgisland.com/wallpapers/Around%20The%20World/2248_Aerial_View,_Singapore_City,_Singapore.jpg",logoImgUrl:"http://lh5.ggpht.com/-rw9perBWVMk/Rib9jG7OxbI/AAAAAAAAABc/CmIGUCEcjcc/3008x1960.jpg",header:"Cool header",text:"Tech blog it amet, consectetur adipiscing elit.\n\nVivamus imperdiet tortor eu erat dapibus mollis. Nullam molestie augue id justo facilisis fermentum. Maecenas sit amet turpis metus. Morbi dolor tellus, pellentesque vitae auctor ut, ullamcorper ac felis. Ut malesuada fermentum turpis eu adipiscing.",address:"Golda Meir 5 Nes Tziona",lat:32,"long":34.8,phone:"08-9999999",fax:"08-8888888",mail:"test@email.com",url:"http://mobile.conduit.com",urlTitle:"Conduit Mobile",description:'Lorem <a href="#">ipsum dolor </a>sit amet, consectetur adipiscing elit.\n\nVivamus imperdiet tortor eu erat dapibus mollis. Nullam molestie augue id justo facilisis fermentum. Maecenas sit amet turpis metus. Morbi dolor tellus, pellentesque vitae auctor ut, ullamcorper ac felis. Ut malesuada fermentum turpis eu adipiscing. '},{title:"1",layoutId:1,imgUrl:"http://imgisland.com/wallpapers/Around%20The%20World/2248_Aerial_View,_Singapore_City,_Singapore.jpg",logoImgUrl:"http://lh5.ggpht.com/-rw9perBWVMk/Rib9jG7OxbI/AAAAAAAAABc/CmIGUCEcjcc/3008x1960.jpg",header:"Cool header",text:"Tech blog it amet, consectetur adipiscing elit.\n\nVivamus imperdiet tortor eu erat dapibus mollis. Nullam molestie augue id justo facilisis fermentum. Maecenas sit amet turpis metus. Morbi dolor tellus, pellentesque vitae auctor ut, ullamcorper ac felis. Ut malesuada fermentum turpis eu adipiscing.",address:"Golda Meir 5 Nes Tziona",lat:33,"long":35,phone:"08-9999999",fax:"08-8888888",mail:"test@email.com",url:"http://mobile.conduit.com",urlTitle:"Conduit Mobile",description:'Lorem <a href="#">ipsum dolor </a>sit amet, consectetur adipiscing elit.\n\nVivamus imperdiet tortor eu erat dapibus mollis. Nullam molestie augue id justo facilisis fermentum. Maecenas sit amet turpis metus. Morbi dolor tellus, pellentesque vitae auctor ut, ullamcorper ac felis. Ut malesuada fermentum turpis eu adipiscing. ',extraPhones:[{title:"Phone 2",phone:"08-1234567"},{title:"Phone 3",phone:"08-1234567"},{title:"Phone 4",phone:"08-1234567"}]},{title:"2",layoutId:2,imgUrl:"http://imgisland.com/wallpapers/Around%20The%20World/2248_Aerial_View,_Singapore_City,_Singapore.jpg",logoImgUrl:"http://lh5.ggpht.com/-rw9perBWVMk/Rib9jG7OxbI/AAAAAAAAABc/CmIGUCEcjcc/3008x1960.jpg",header:"Cool header",text:"Tech blog it amet, consectetur adipiscing elit.\n\nVivamus imperdiet tortor eu erat dapibus mollis. Nullam molestie augue id justo facilisis fermentum. Maecenas sit amet turpis metus. Morbi dolor tellus, pellentesque vitae auctor ut, ullamcorper ac felis. Ut malesuada fermentum turpis eu adipiscing.",address:"Golda Meir 5 Nes Tziona",lat:33,"long":35,phone:"08-9999999",fax:"08-8888888",mail:"test@email.com",url:"http://mobile.conduit.com",urlTitle:"Conduit Mobile",description:'Lorem <a href="#">ipsum dolor </a>sit amet, consectetur adipiscing elit.\n\nVivamus imperdiet tortor eu erat dapibus mollis. Nullam molestie augue id justo facilisis fermentum. Maecenas sit amet turpis metus. Morbi dolor tellus, pellentesque vitae auctor ut, ullamcorper ac felis. Ut malesuada fermentum turpis eu adipiscing. '},{title:"3",layoutId:3,imgUrl:"http://imgisland.com/wallpapers/Around%20The%20World/2248_Aerial_View,_Singapore_City,_Singapore.jpg",logoImgUrl:"http://lh5.ggpht.com/-rw9perBWVMk/Rib9jG7OxbI/AAAAAAAAABc/CmIGUCEcjcc/3008x1960.jpg",header:"Cool header",text:"Tech blog it amet, consectetur adipiscing elit.\n\nVivamus imperdiet tortor eu erat dapibus mollis. Nullam molestie augue id justo facilisis fermentum. Maecenas sit amet turpis metus. Morbi dolor tellus, pellentesque vitae auctor ut, ullamcorper ac felis. Ut malesuada fermentum turpis eu adipiscing.",address:"Golda Meir 5 Nes Tziona",lat:41,"long":-87,phone:"08-9999999",fax:"08-8888888",mail:"test@email.com",url:"http://mobile.conduit.com",urlTitle:"Conduit Mobile",description:'Lorem <a href="#">ipsum dolor </a>sit amet, consectetur adipiscing elit.\n\nVivamus imperdiet tortor eu erat dapibus mollis. Nullam molestie augue id justo facilisis fermentum. Maecenas sit amet turpis metus. Morbi dolor tellus, pellentesque vitae auctor ut, ullamcorper ac felis. Ut malesuada fermentum turpis eu adipiscing. '},{title:"4",layoutId:4,imgUrl:"http://imgisland.com/wallpapers/Around%20The%20World/2248_Aerial_View,_Singapore_City,_Singapore.jpg",logoImgUrl:"http://lh5.ggpht.com/-rw9perBWVMk/Rib9jG7OxbI/AAAAAAAAABc/CmIGUCEcjcc/3008x1960.jpg",header:"Cool header",text:"Tech blog",address:"Golda Meir 5 Nes Tziona",lat:33,"long":35,phone:"08-9999999",mail:"test@email.com",url:"http://mobile.conduit.com",urlTitle:"Conduit Mobile",description:'Lorem <a href="#">ipsum dolor </a>sit amet, consectetur adipiscing elit.\n\nVivamus imperdiet tortor eu erat dapibus mollis. Nullam molestie augue id justo facilisis fermentum. Maecenas sit amet turpis metus. Morbi dolor tellus, pellentesque vitae auctor ut, ullamcorper ac felis. Ut malesuada fermentum turpis eu adipiscing. '},{title:"5",layoutId:5,imgUrl:"http://imgisland.com/wallpapers/Around%20The%20World/2248_Aerial_View,_Singapore_City,_Singapore.jpg",logoImgUrl:"http://lh5.ggpht.com/-rw9perBWVMk/Rib9jG7OxbI/AAAAAAAAABc/CmIGUCEcjcc/3008x1960.jpg",header:"Cool header",text:"Tech blog",address:"Golda Meir 5 Nes Tziona",lat:33,"long":35,phone:"08-9999999",url:"http://mobile.conduit.com",urlTitle:"Conduit Mobile",description:'Lorem <a href="#">ipsum dolor </a>sit amet, consectetur adipiscing elit.\n\nVivamus imperdiet tortor eu erat dapibus mollis. Nullam molestie augue id justo facilisis fermentum. Maecenas sit amet turpis metus. Morbi dolor tellus, pellentesque vitae auctor ut, ullamcorper ac felis. Ut malesuada fermentum turpis eu adipiscing. '}]};var aj={icon:"http://storage.conduit.com/images/mobile/controlpanel/pages/icons/white_t/Social.png",id:"fa7819e6-3f63-15ac-4969-bc03acc70399",label:"Contact Us!",meta:I,minVersion:"0.0.0.0",type:"083e52df-721d-4ca4-efa3-25161d344f40",version:"9999.0.0.0"};y.splice(2,0,aj)}var aF=false;if(aF){var E={usePreviews:true,pageLayout:2,layoutParams:{loop:true,descriptionPosition:"top",iconPosition:"left"},feeds:[{hideHeader:false,logoImgUrl:"http://www.rail.co.il/resources/he-IL/Images/Master/header_right.gif",overrideDescription:"This text override all the descriptions",title:"tab 1",id:"a6a5f01b-b028-8842-7c72-d50e93f1b8be",type:"picasa",userName:"matanya.bir3",params:{albumId:"5582728848724476929",albumName:"20110311"}},{title:"Instagram",id:"067e6521-2878-a7d3-5fdd-b66596503691",type:"instagram",userName:"1574083"},{title:"tab 2",id:"f02f60cd-67f5-b4eb-a497-08ae3ceb5c7c",type:"picasa",userName:"matanya.bir4",params:{albumId:"5637383265425670465",albumName:"20110805"}}]};var ag={icon:"http://images.mobile.site-services.com/icon/42",id:"cd2b93f7-62d0-e663-45ee-04834800d3b9",label:"test photos",meta:E,minVersion:"0.0.0.0",type:"3b11bcdf-ba5e-4eaa-9059-ea580b3f1681",version:"9999.0.0.0"};y.splice(2,0,ag)}var az=false;if(az){var P={usePreviews:true,pageLayout:2,layoutParams:{loop:true,descriptionPosition:"top",iconPosition:"left"},feeds:[{hideHeader:false,logoImgUrl:"http://www.rail.co.il/resources/he-IL/Images/Master/header_right.gif",overrideDescription:"This text override all the descriptions",title:"tab 1",id:"a6a5f01b-b028-8842-7c72-d50e93f1b8be",type:"picasa",userName:"matanya.bir3",params:{albumId:"5582728848724476929",albumName:"20110311"}}]};var aM={icon:"http://images.mobile.site-services.com/icon/42",id:"cd2b93f7-62d0-e663-45ee-04834800d3b9",label:"Live Album",meta:P,minVersion:"0.0.0.0",type:"26ae8ccc-5464-7979-4fdf-3a13f166ffff",version:"9999.0.0.0"};y.splice(2,0,aM)}var f=false;if(f){var U={feeds:[{id:"c4d95826-f6a1-e9c2-8bb1-5f76d633c0c4",url:"http://feeds.abcnews.com/abcnews/topstories",title:"abc",params:{addGeo:true,sort:{},expiration:null}}]};var B={icon:"http://storage.conduit.com/images/mobile/controlpanel/pages/icons/white_t/Social.png",id:"c69ffba8-820d-8468-2ac1-cd3543179068",label:"RSS!",meta:U,minVersion:"0.0.0.0",type:"51a61af7-1e90-4d68-88db-b1e69a0cca59",version:"9999.0.0.0"};y.push(B)}var x=false;if(x){var aw={tabs:[{title:"tab1",apiKey:"82e23d794c6741e19fb3c22a5b693a6d",lpServer:"dev.liveperson.net",lpNumber:"P29473731"}]};var m={icon:"http://storage.conduit.com/images/mobile/controlpanel/pages/icons/white_t/Social.png",id:"4bfbd276-2d4c-e9b7-d181-50d2b44ec5cd",label:"Live Chat",meta:aw,minVersion:"0.0.0.0",type:"a00b52bb-ff49-704f-bdf3-fb0bd0fd4739",version:"10.0.0.0"};y.splice(2,0,m)}var G=false;if(G){var H={type:"4680c3f3-e767-4ebf-b112-9ba769c3ff2a",label:"video",minVersion:"0.0.0.0",version:"10.0.0.0",icon:"http://cdn.wibiya.com/Apps/9005_video/front/video_iphone.png",id:"eb28bb12-7ab0-4fac-061b-14d5a3bb9113",meta:{items:[{title:"vimeo",params:{url:"http://cms.mobile.site-services.com/vimeo/video/1/?query=dogs",params:{}},wibiyaUsername:"dogs",wibiyaService:"search"}],appId:"4025282"}};y.push(H)}var aK=false;if(aK){var aR={type:"7a2641b0-ceb2-48d6-b715-344198c73dd3",label:"R.V.iews",minVersion:"2.0.0.0",version:"10.0.0.0",icon:"http://images.mobile.qasite-services.com/icon/58",id:"9545a8f3-cb53-84be-992a-42174ac35354",meta:{pageLayout:2,items:[]}};y.push(aR)}var am=false;if(TEST_LOYALTY){am=true}if(am){var aq={alias:"punch-cards",displayDevices:0,icon:"http://images.mobile.qasite-services.com/icon/58",id:"19cec4e7-5b14-4b6b-aafb-658cc77cc0b0",label:"TEST PunchCards",meta:{items:[{id:"c7f0d05a-c991-4ac1-8e6c-90f9990ebeed",name:"Crazy Al's Freebies",params:{listId:"ad06042e-0053-448a-b986-b6f66e503c39",type:"contentHost"}}],pageLayout:-1},minVersion:"3.0.0.0",type:"9953766f-6b47-4878-8d38-b9cde750fe58",version:null};y.splice(0,0,aq)}var t=false;if(t){var z={type:"1002937d-8b19-40de-9df5-ba0d1ea2fbb2",label:"TEST Events",minVersion:"0.0.0.0",version:"10.0.0.0",icon:"http://images.mobile.qasite-services.com/icon/58",id:"eb28bb12-7ab0-4fac-061b-14d5a3bb9114",meta:{pageLayout:2,layout:{meta:{bgImage:"http://wallpapernet.eu/wp-content/gallery/4_landscape_02/landscape-9643.jpg"}},items:[{title:"My Events",params:{type:2,id:"conduit.android@gmail.com",extraInfo:{}},views:[{title:"{$HtmlTextEventsPastEvents}",since:"$date-30d",until:"$date",logoImgUrl:"http://blog.conduit.com/wp-content/uploads/2012/03/SXSW.jpg",extraInfo:{order:"desc"}},{title:"{$HtmlTextEventsFutureEvents}",since:"$date",until:"$date+3m",logoImgUrl:"http://www.rail.co.il/resources/he-IL/Images/Master/header_right.gif",extraInfo:{order:"asc"}}]},{title:"My Events2",params:{type:4,id:"331163",extraInfo:{customId:"654354354"}},views:[{title:"Year to date",since:"1323993599",until:"1639871999",logoImgUrl:"http://www.rail.co.il/resources/he-IL/Images/Master/header_right.gif",extraInfo:{order:"desc"}},{title:"My Events",since:"$date",until:"$date+1y",extraInfo:{order:"asc"}}]}]}};y.splice(2,0,z)}if(t){var z={type:"1002937d-8b19-40de-9df5-ba0d1ea2fbb2",label:"Events 2",minVersion:"0.0.0.0",version:"10.0.0.0",icon:"http://images.mobile.qasite-services.com/icon/58",id:"eb48bb12-7ab0-4fac-061b-14d5a3bb9114",meta:{pageLayout:2,layout:{meta:{bgImage:"http://wallpapernet.eu/wp-content/gallery/4_landscape_07/landscape-wallpapers-rezolucija-ekrana.jpg"}},items:[{title:"My Events",params:{type:2,id:"conduit.android@gmail.com",extraInfo:{}},views:[{title:"{$HtmlTextEventsFutureEvents}",since:"$date+30d",until:"$date",logoImgUrl:"",extraInfo:{order:"desc"}},{title:"{$HtmlTextEventsPastEvents}",since:"$date",until:"$date-3m",logoImgUrl:"http://www.rail.co.il/resources/he-IL/Images/Master/header_right.gif",extraInfo:{order:"asc"}}]}]}};y.splice(1,0,z)}var R=false;if(R){var w={icon:"http://images.mobile.site-services.com/icon/external/?src=http%3A%2F%2Fstorage.site.com%2Fimages%2Fmobile%2Fcontrolpanel%2Fpages%2Ficons%2Fwhite_t%2FLiveAlbum_White.png",id:"GUID_123123",label:"LA: Template",meta:{pageLayout:-1,albums:[{id:"d2886776-4629-112e-1372-237345231f5a",socialId:"100001084128133",isSmallImages:true,socialName:"Nuni Bas",parentSocialId:"100001084128133",albumId:"219155498130586",albumName:"LA test",albumDesc:"test for LA",parentAccessToken:"120397844671083|6aadcbed5092462ce441ba73.1-100001084128133|ohkyoKiOIqf4u5_CgSXA2VF5roI"},{id:"62b380b4-4181-b683-b0ae-be52934c9588",socialId:"100001084128133",isSmallImages:true,socialName:"Nuni Bas",parentSocialId:"100001084128133",albumId:"215058001873669",albumName:"album test2",albumDesc:"test",parentAccessToken:"120397844671083|6aadcbed5092462ce441ba73.1-100001084128133|ohkyoKiOIqf4u5_CgSXA2VF5roI"},{id:"68c52a09-88cb-62f9-f54b-0397f34ead04",socialId:"131000090328277",isSmallImages:false,socialName:"Conduit Mobile",parentSocialId:"100001084128133",albumId:"131000340328252",albumName:"August 10, 2011",albumDesc:"undefined",parentAccessToken:"120397844671083|6aadcbed5092462ce441ba73.1-100001084128133|ohkyoKiOIqf4u5_CgSXA2VF5roI"},{id:"34c6356b-36a8-090a-73ef-02202086b829",socialId:"100001084128133",socialName:"Nuni Bas",parentSocialId:"100001084128133",albumId:"215057638540372",albumName:"album test 17",albumDesc:"this is the description of album test!\r\nNOTE: this description is very very long, we probably will trim this long description in the client.\r\nsome formulas: E = MC^2, 1 1 = 2, E^(i*pi) = -1. the end!",parentAccessToken:"120397844671083|6aadcbed5092462ce441ba73.1-100001084128133|ohkyoKiOIqf4u5_CgSXA2VF5roI"}]},minVersion:"1.10.0.0",type:"4d365620-d00a-266d-ca8c-6cf6d762a7fc",version:null};y.push(w)}var h=!true;if(h){var J={icon:"http://images.mobile.site-services.com/icon/external/?src=http%3A%2F%2Fstorage.site.com%2Fimages%2Fmobile%2Fcontrolpanel%2Fpages%2Ficons%2Fwhite_t%2FLiveAlbum_White.png",id:"GUID_123123",label:"API Test",meta:{pageLayout:-1},minVersion:"1.10.0.0",type:"0",version:null};y.splice(0,0,J)}var ai=false;if(ai){var l={icon:"http://images.mobile.site-services.com/icon/external/?src=http%3A%2F%2Fstorage.site.com%2Fimages%2Fmobile%2Fcontrolpanel%2Fpages%2Ficons%2Fwhite_t%2FLiveAlbum_White.png",id:"fbbc1cff-01fc-7708-246f-3b593c0e9029",label:"test Form",minVersion:"1.10.0.0",type:"79eec590-f806-f7ac-946b-1fd9c90283ba",version:null,meta:{pageLayout:-1,items:[{logoImgUrl:"http://www.rail.co.il/resources/he-IL/Images/Master/header_right.gif",text:"This is the header text on the image",description:'<p dir="rtl"><span>RTL!</span></p><hr /><p><strong>Bolt</strong></p><p><span style="font-size: 20pt; color: #ff0000;"><strong>big red</strong></span></p><p><strong>link to <a href="http://www.google.com" title="new">google</a></strong></p><p><strong>another link to <a href="http://www.google.com" title="samw">google</a></strong></p><p><strong>send mail: <a href="mailto:matanya@conduit.com">click!</a></strong></p><p><strong>internal link to nav page: <a href="GoToPage:navigation">click!</a></strong></p><p><strong>internal link to page index = 3: <a href="GoToPage:index:3">click!</a></strong></p><p><strong></strong><strong>look! a line:</strong></p><hr /><p><span style="font-family: comic sans ms,sans-serif; color: #ff0000; font-size: 16pt;">&nbsp;</span><img alt="barvaz" height="79" src="data:image/jpg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAkGBhQRBRUTEBMTEhUUGBQTFxUYFRQSFBUVFhQXGBUcGRYcHCYqFxkmHxQUHzsgLzMpLyw4FSYxNjwqOCYxLDUBCQoKDQsNGQ4OGTUkHiQ1NTU1NTU1NTU1NTU1LDU1NTUtNTUwNDU1NTU0NTQ1NTUsLDA0MDU1NC8wMCw0NDU1NP/AABEIAE8ATwMBIgACEQEDEQH/xAAbAAACAgMBAAAAAAAAAAAAAAAFBgMEAAECB//EAEQQAAEDAQMEDQcKBwAAAAAAAAECAwQABQYREiExUQcTIjY3QVRhdIORs7QUFnGBlMHSFzJCUpOhw9HT8CNEgpKi4fH/xAAbAQABBQEBAAAAAAAAAAAAAAAFAAIDBAYBB//EACsRAAEEAQMCBQMFAAAAAAAAAAEAAgMEEQUhMRITIjJBwfAUcZEGM0JRYf/aAAwDAQACEQMRAD8Afbo3RhLuZEUuHFUpUeOpSjHZKlEsoJJJTnJJJxot5mQeRQ/ZmPgrLmbxofRo3cIozXUkG8y4PIofszHwVWl3ZgJOAgwyejMZv8KPvPBLRJ/7STbFsyRbzTceMp5LhynHTilttOVgd3oCgMT2AA40F1S1M3Far+47f7AKeJgPidwpnrvwx/JxPZo/wVYsuwYLi8lcGGFaQfJmM4/s01zKe3VC7OvC2q3C22sFbRSVjjGf9islp+oW45+suLm+ucnb2RN1Zjo8YwfRNHmXB5FD9mY+Cs8zIPIofszHwUarVejoKg3mZB5FD9mY+ClPZUuvEa2N5C2osZtadpwUhhpChjIaBwUEgjMSPXXotJ2y/wAF0rqfEs0kkYuZvGh9GjdwijVBbmbxofRo3cIozXUkLttwhSdWf3Uh3nvsqI6W0IOjKyjiU59QGnVXotpxNshkDSM49OqkK8l30yrPyVblSc6FcYP5GsRqcba+pd2byPHtj4P9R3TTE4ASDOPmUlI2RnPKwV7pPGMlKezCmWy4jKrT8qZ0uoAUQTgTiM+T9E5gD6KT/MV0yMFrbCdYxJ7MKdbp3YKRtTRURjlKUdA4vVo0V2x2OjoqeZ2xAHIRW2IMB22y9NhP5cFCtYFTVxHYCIyUDQkAdlcOzm0PBKlgE8RP7wrXtf24290gHb8rIEdTj0hTUnbL/BdK6nxLNONJ2y/wXSup8SzUyYjFzN40Po0buEUaoLcveND6NG7hFXrRl5KMkaT9wqvZssqxGWTgJzGl56QsmzglshOdWj0UAfSMirJVmqo6rPXm2oahLekD37AcD+kYrxCPhC5EEFeNN1gqQLHTk4DD52gbrjxpeOmuVMjKzYipdO1E0pC8tzthT2Iu80NzhH7QvAlCSG92rX9EfnSpKKlulRJJOcmrW11igMmu3NSmuuy/j0A4ShgZCPCjd2rSKmtrWcSBik8w0ihWy/wXSup8SzW7GVhbbeGsj1FJxrWy/wAF0rqfEs1sdEnfLVw/+JwhVxgbJt6ozcveND6NG7hFQT38ZyuY4dmaprmbxofRo3cIqjaAybQWOcntz++qP6m6vpmAcZ9inUgC8rSnM1V1GtFdQOv4CsPuUXa3Ckyt1XC3QNdUvLcHKgkz91mJqZsRJT1cclZ/3hVfbzjnqml2pozSnJAbbGUpWYe8nUBVlkJJDWjdMJAGSmG6bGXaCnOJAw/qV/rHtqLZf4LpXU+JZpnsyz0sQA2nPhnJ+so6TSxsv8F0rqfEs16HQq/S1xGeeT90Ank7ry5Gbl7xofRo3cIrq37PUtnLbGKkjOnjUnm5xSbdLZYs5u6kdp2RkLaZYbUNqfVuksoBwKWziOL1as5L/K/ZfKx9jJ/SqazXjsxGKTgpkchjcHNQly06pvTsau2pfmxJC8pcjJV9ZDUlKj6f4WB9YoO7bVjk7m0XB6Y7yvwhWUdoErHeDBCLNvRkb7Lh2QcquFPa6lRa9i5W6tB5XMGXkfgmiES9FgNnHbg4dbjctz7i3h91Ts0WY+YgJrrsY4VOzYzsh7JYQV61aED0q0CvR7v2CmLE0hTivnL9w1JFAG9lqyUt4JkpSBxBiQB2BquvlfsvlY+xk/pUap6dFVPVy5UprLpduAnGk7Zf4LpXU+JZrPlfsvlY+xk/pUq7JmydAk3Gejx39sccDZA2t5A3D7SjnUgZ8Aew8wJJVV//2Q==" width="79" />&nbsp;</p><p>look! bad image:</p><p><img alt="aaa" src="sdfdcvergfefv35fc/34f34rf.dfhgdfh" /></p>"',title:"page1",id:"6b9869bb-f4b8-e9ab-c897-57b24900e0dc",postUrl:"http://sms.wmg.com/sms/register?js=true&updateprofile=yes&newsletterId=wakaflockaflame&keywordId=wakaflockaflamebase&signuptype=any",formId:"b23cfedb-c5db-65e7-4b7b-993325c48e9a",action:"get",sendButton:{bgImage:""},controls:[{caption:"Hellow",placeholder:"World",isActive:true,isMandatory:true,type:"combobox",id:"combo1",selectedIndex:null,items:[{caption:"Male",value:"m"},{caption:"Female",value:"f"}]},{caption:"Ice-cream (Radio group)",type:"radio",id:"radio1",selectedIndex:2,isActive:true,items:[{caption:"Vanilla",value:"radioOption1"},{caption:"Chocolate",value:"radioOption2"},{caption:"Herring",value:"radioOption3"},{caption:"Strawberry",value:"radioOption4"}]},{caption:"Country (Combo: hard-coded in the client)",placeholder:"Select country",type:"combobox",isActive:true,subType:"country",id:"combo2",items:null},{placeholder:"Select state",isActive:true,type:"combobox",subType:"state",id:"combo3",items:null},{isActive:true,type:"inputtext",id:"input1",isMandatory:true,placeholder:"Write something"},{isActive:true,type:"inputtext",id:"inputTel1",subType:"tel",isMandatory:false,placeholder:"02-1234567"},{isActive:true,type:"inputtext",subType:"email",id:"inputEmail",isMandatory:false,placeholder:"your@email.com"},{caption:"Birthday (Date)",isActive:true,type:"dateedit",subType:"date",id:"inputDate",isMandatory:true,placeholder:"enter date"},{caption:"Deathday (Datetime)",isActive:true,type:"dateedit",subType:"datetime",id:"inputDateTime",isMandatory:!true,placeholder:"Date + Time"},{caption:"Comments (Memo)",isActive:true,type:"textarea",id:"textarea1",rows:5,isMandatory:true,placeholder:"Write something"},{caption:"Ice-cream (Checkboxs group)",isActive:true,type:"checkbox",id:"checkbox1",items:[{caption:"Vanilla",value:"radioOption1"},{caption:"Chocolate",value:"radioOption2"},{caption:"Herring",value:"radioOption3"},{caption:"Strawberry",value:"radioOption4"}]}]}]}};y.splice(0,0,l)}var o=false;if(o){var ao={icon:"http://images.mobile.site-services.com/icon/external/?src=http%3A%2F%2Fstorage.site.com%2Fimages%2Fmobile%2Fcontrolpanel%2Fpages%2Ficons%2Fwhite_t%2FLiveAlbum_White.png",id:"7bf11e07-688a-86fa-6571-7d176d78f2e9",label:"static HTML test",minVersion:"0.0.0.0",type:"27f91d0a-42c0-48fa-90a8-7138641ddecf",version:null,meta:{pageLayout:-1,notes:[{id:"1fd5904c-37d5-c257-de02-1748320df7d1",html:'<p dir="rtl"><span>RTL!</span></p><hr /><p><span style="font-size: 20pt; color: #ff0000;"><strong>big red</strong></span></p><p><strong>link to <a href="http://www.google.com" title="new">google</a></strong></p><p><strong>another link to <a href="http://www.google.com" class="bbb" title="samw">google</a></strong></p><p><strong>send mail: <a href="mailto:matanya@conduit.com">click!</a></strong></p><p><strong>internal link to nav page: <a href="GoToPage:navigation">click!</a></strong></p><p><strong>internal link to page index = 3: <a href="GoToPage:index:3">click!</a></strong></p><p><strong></strong><strong>look! a line:</strong></p><hr /><p><span style="font-family: comic sans ms,sans-serif; color: #ff0000; font-size: 16pt;">&nbsp;</span><img alt="barvaz" height="79" src="data:image/jpg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAkGBhQRBRUTEBMTEhUUGBQTFxUYFRQSFBUVFhQXGBUcGRYcHCYqFxkmHxQUHzsgLzMpLyw4FSYxNjwqOCYxLDUBCQoKDQsNGQ4OGTUkHiQ1NTU1NTU1NTU1NTU1LDU1NTUtNTUwNDU1NTU0NTQ1NTUsLDA0MDU1NC8wMCw0NDU1NP/AABEIAE8ATwMBIgACEQEDEQH/xAAbAAACAgMBAAAAAAAAAAAAAAAFBgMEAAECB//EAEQQAAEDAQMEDQcKBwAAAAAAAAECAwQABQYREiExUQcTIjY3QVRhdIORs7QUFnGBlMHSFzJCUpOhw9HT8CNEgpKi4fH/xAAbAQABBQEBAAAAAAAAAAAAAAAFAAIDBAYBB//EACsRAAEEAQMCBQMFAAAAAAAAAAEAAgMEEQUhMRITIjJBwfAUcZEGM0JRYf/aAAwDAQACEQMRAD8Afbo3RhLuZEUuHFUpUeOpSjHZKlEsoJJJTnJJJxot5mQeRQ/ZmPgrLmbxofRo3cIozXUkG8y4PIofszHwVWl3ZgJOAgwyejMZv8KPvPBLRJ/7STbFsyRbzTceMp5LhynHTilttOVgd3oCgMT2AA40F1S1M3Far+47f7AKeJgPidwpnrvwx/JxPZo/wVYsuwYLi8lcGGFaQfJmM4/s01zKe3VC7OvC2q3C22sFbRSVjjGf9islp+oW45+suLm+ucnb2RN1Zjo8YwfRNHmXB5FD9mY+Cs8zIPIofszHwUarVejoKg3mZB5FD9mY+ClPZUuvEa2N5C2osZtadpwUhhpChjIaBwUEgjMSPXXotJ2y/wAF0rqfEs0kkYuZvGh9GjdwijVBbmbxofRo3cIozXUkLttwhSdWf3Uh3nvsqI6W0IOjKyjiU59QGnVXotpxNshkDSM49OqkK8l30yrPyVblSc6FcYP5GsRqcba+pd2byPHtj4P9R3TTE4ASDOPmUlI2RnPKwV7pPGMlKezCmWy4jKrT8qZ0uoAUQTgTiM+T9E5gD6KT/MV0yMFrbCdYxJ7MKdbp3YKRtTRURjlKUdA4vVo0V2x2OjoqeZ2xAHIRW2IMB22y9NhP5cFCtYFTVxHYCIyUDQkAdlcOzm0PBKlgE8RP7wrXtf24290gHb8rIEdTj0hTUnbL/BdK6nxLNONJ2y/wXSup8SzUyYjFzN40Po0buEUaoLcveND6NG7hFXrRl5KMkaT9wqvZssqxGWTgJzGl56QsmzglshOdWj0UAfSMirJVmqo6rPXm2oahLekD37AcD+kYrxCPhC5EEFeNN1gqQLHTk4DD52gbrjxpeOmuVMjKzYipdO1E0pC8tzthT2Iu80NzhH7QvAlCSG92rX9EfnSpKKlulRJJOcmrW11igMmu3NSmuuy/j0A4ShgZCPCjd2rSKmtrWcSBik8w0ihWy/wXSup8SzW7GVhbbeGsj1FJxrWy/wAF0rqfEs1sdEnfLVw/+JwhVxgbJt6ozcveND6NG7hFQT38ZyuY4dmaprmbxofRo3cIqjaAybQWOcntz++qP6m6vpmAcZ9inUgC8rSnM1V1GtFdQOv4CsPuUXa3Ckyt1XC3QNdUvLcHKgkz91mJqZsRJT1cclZ/3hVfbzjnqml2pozSnJAbbGUpWYe8nUBVlkJJDWjdMJAGSmG6bGXaCnOJAw/qV/rHtqLZf4LpXU+JZpnsyz0sQA2nPhnJ+so6TSxsv8F0rqfEs16HQq/S1xGeeT90Ank7ry5Gbl7xofRo3cIrq37PUtnLbGKkjOnjUnm5xSbdLZYs5u6kdp2RkLaZYbUNqfVuksoBwKWziOL1as5L/K/ZfKx9jJ/SqazXjsxGKTgpkchjcHNQly06pvTsau2pfmxJC8pcjJV9ZDUlKj6f4WB9YoO7bVjk7m0XB6Y7yvwhWUdoErHeDBCLNvRkb7Lh2QcquFPa6lRa9i5W6tB5XMGXkfgmiES9FgNnHbg4dbjctz7i3h91Ts0WY+YgJrrsY4VOzYzsh7JYQV61aED0q0CvR7v2CmLE0hTivnL9w1JFAG9lqyUt4JkpSBxBiQB2BquvlfsvlY+xk/pUap6dFVPVy5UprLpduAnGk7Zf4LpXU+JZrPlfsvlY+xk/pUq7JmydAk3Gejx39sccDZA2t5A3D7SjnUgZ8Aew8wJJVV//2Q==" width="79" />&nbsp;</p><p>look! bad image:</p><p><img alt="aaa" src="sdfdcvergfefv35fc/34f34rf.dfhgdfh" /></p>"'}]}};y.splice(2,0,ao)}var b=false;if(b){var v={icon:"http://images.mobile.site-services.com/icon/external/?src=http%3A%2F%2Fstorage.site.com%2Fimages%2Fmobile%2Fcontrolpanel%2Fpages%2Ficons%2Fwhite_t%2FLiveAlbum_White.png",id:"430db20e-da28-eb6f-8110-9bccb186f585",label:"links test",minVersion:"2.5.0.0",type:"fc6700a7-a11e-de90-93f8-7357f9f0037f",version:null,meta:{pageLayout:0,items:[{logoImgUrl:"http://www.rail.co.il/resources/he-IL/Images/Master/header_right.gif",text:"This is the header text on the image",id:"1fd5904c-37d5-c257-de02-1748320df7d1",title:"tab1",links:[{title:"Google",url:"http://www.google.co.il"},{title:"Raqevet",imageUrl:"http://www.rail.co.il/resources/he-IL/Images/Master/header_right.gif",url:"http://www.rail.co.il/he/Pages/homepage.aspx",details:{title:"Rak Raqevet",imageUrl:"http://upload.wikimedia.org/wikipedia/commons/thumb/8/81/BNSF_GE_Dash-9_C44-9W_Kennewick_-_Wishram_WA.jpg/220px-BNSF_GE_Dash-9_C44-9W_Kennewick_-_Wishram_WA.jpg",linkTitle:"link Title",description:"<b>Motive power</b> is provided by a separate locomotive or individual motors in self-propelled multiple units. Although historically steam propulsion dominated, the most common modern forms are diesel and electric locomotives, the latter supplied by overhead wires or additional rails. Other energy sources include horses, rope or wire, gravity, pneumatics, batteries, and gas turbines."}},{imageUrl:"http://i.cdn.turner.com/nba/nba/.element/img/2.0/global/nbaErrorLogoPic.gif",url:"http://www.nba.com"},{title:"Pixar",imageUrl:"http://cdn.s7.disneystore.com/is/image/DisneyShopping/1261000441656?$carousel$",url:"http://www.pixar.com"}]},{logoImgUrl:"http://www.pixar.com/images/brave/brave3.jpg",id:"6661b744-9019-6570-fc8f-99f44af6fd61",title:"tab 1.5",links:[{title:"Google",imageUrl:"http://androidheadlines.com/wp-content/uploads/2011/02/google-music-logo.jpg",url:"http://www.google.co.il"},{title:"Raqevet",imageUrl:"http://www.rail.co.il/resources/he-IL/Images/Master/header_right.gif",url:"http://www.rail.co.il/he/Pages/homepage.aspx"},{title:"Pixar",imageUrl:"http://cdn.s7.disneystore.com/is/image/DisneyShopping/1261000441656?$carousel$",url:"http://www.pixar.com"}]},{logoImgUrl:"http://www.pixar.com/images/brave/brave4.jpg",text:"This is the header text on the image. maybe this text can be long and with long words 00112233445566778899! bla bla bla! the end!",id:"e2e4e402-18cd-cdcf-2e6f-64ea60db04bd",title:"tab 1.75",links:[{title:"Google",imageUrl:"http://androidheadlines.com/wp-content/uploads/2011/02/google-music-logo.jpg",url:"http://www.google.co.il"},{title:"Raqevet - with a very long title that ends with 9",url:"http://www.rail.co.il/he/Pages/homepage.aspx"},{imageUrl:"http://i.cdn.turner.com/nba/nba/.element/img/2.0/global/nbaErrorLogoPic.gif",url:"http://www.nba.com"},{title:"Pixar",imageUrl:"http://25.media.tumblr.com/tumblr_lh72aiuAnn1qh3v2go1_r1_400.jpg",url:"http://www.pixar.com"},{title:"Google",imageUrl:"http://androidheadlines.com/wp-content/uploads/2011/02/google-music-logo.jpg",url:"http://www.google.co.il"},{title:"Raqevet",imageUrl:"http://www.rail.co.il/resources/he-IL/Images/Master/header_right.gif",url:"http://www.rail.co.il/he/Pages/homepage.aspx"},{imageUrl:"http://i.cdn.turner.com/nba/nba/.element/img/2.0/global/nbaErrorLogoPic.gif",url:"http://www.nba.com"},{title:"Pixar",imageUrl:"http://cdn.s7.disneystore.com/is/image/DisneyShopping/1261000441656?$carousel$",url:"http://www.pixar.com"},{url:"http://www.google.co.il",imageUrl:"bad image"},{title:"Raqevet",url:"http://www.rail.co.il/he/Pages/homepage.aspx"},{imageUrl:"http://i.cdn.turner.com/nba/nba/.element/img/2.0/global/nbaErrorLogoPic.gif",url:"http://www.nba.com"},{title:"Pixar",imageUrl:"http://cdn.s7.disneystore.com/is/image/DisneyShopping/1261000441656?$carousel$",url:"http://www.pixar.com"}]},{id:"5be5ee29-c0a0-73f7-ea63-5d7a36e93ffa",title:"tab2",links:[{title:"nba",url:"http://www.nba.com"}]}]}};y.splice(2,0,v)}var an=false;if(an){var q={icon:"http://images.mobile.site-services.com/icon/external/?src=http%3A%2F%2Fstorage.site.com%2Fimages%2Fmobile%2Fcontrolpanel%2Fpages%2Ficons%2Fwhite_t%2FLiveAlbum_White.png",id:"9fade8d5-05ca-a251-aed9-34805fbac222",label:"Link",minVersion:"2.5.0.0",type:"c54d24ef-faf5-45dd-8859-85e3ebe7cecf",version:null,meta:{items:[{openInExternalBrowser:true,link:"http://www.google.com",title:"google"}]}};y.splice(2,0,q)}var aQ=false;if(aQ){var aP={icon:"http://images.mobile.site-services.com/icon/external/?src=http%3A%2F%2Fstorage.site.com%2Fimages%2Fmobile%2Fcontrolpanel%2Fpages%2Ficons%2Fwhite_t%2FLiveAlbum_White.png",id:"9fade8d5-05ca-a251-aed9-34805fbac233",label:"WEB MODULE",minVersion:"2.5.0.0",type:"9eea8149-956c-46f9-8597-167401c63cd7",version:null,meta:{items:[]}};y.splice(0,0,aP)}var ae=false;if(ae){var n={type:"6181507a-fdf4-4b90-a270-cbd286603443",label:"Collection",icon:"http://images.mobile.site-services.com/icon/87",subType:"00000000-0000-0000-0000-000000000000",id:"72e9c318-05fa-ac72-b292-a1df3fb1a1e8",meta:{pageLayout:-1,items:[{id:"30d5917e-6ad4-6a9a-e64d-25c56e939f19",params:{id:"2de87be4-1346-468f-86ef-49892ae8c17a"},name:"title"}]}};y.splice(0,0,n)}var S=false;if(S){var A={type:"8d7507ff-317e-44b1-9ad3-776ad52d6ee2",label:"Homepage",icon:"http://images.mobile.site-services.com/icon/87",subType:"00000000-0000-0000-0000-000000000000",id:"01b241ed-676c-4f11-9045-309271f6acc3",meta:{pageLayout:-1,items:[{id:"30d5917e-6ad4-6a9a-e64d-25c56e939f19",widgets:[{id:"31d5917e-6ad4-6a9a-e64d-25c56e939f19",type:"495cb1c8-b08b-4c7e-82cf-7ffb93e2d5b3",title:"CHOOSE YOUR GAME",params:{initialInterval:1000,interval:4000,refreshRate:30000},models:[{title:"Game 1",imageUrl:"http://storage.conduit.com/storage/mobile/9b/fa/9bd5bdde-83fa-4236-9d5e-7c10fda796fc/icons/game1.png",click:{type:"twitter",value:"drink"}},{title:"Game 2",imageUrl:"http://storage.conduit.com/storage/mobile/9b/fa/9bd5bdde-83fa-4236-9d5e-7c10fda796fc/icons/game2.png",click:{type:"twitter",value:"QA game 1"}},{title:"Game 3",imageUrl:"http://storage.conduit.com/storage/mobile/9b/fa/9bd5bdde-83fa-4236-9d5e-7c10fda796fc/icons/game3.png",click:{type:"twitter",value:"QA game 2"}},{title:"Game 4",imageUrl:"http://storage.conduit.com/storage/mobile/9b/fa/9bd5bdde-83fa-4236-9d5e-7c10fda796fc/icons/game4.png",click:{type:"twitter",value:"QA game 3"}}]},{id:"32d5917e-6ad4-6a9a-e64d-25c56e939f19",type:"a2c260a1-9b61-4209-a18a-2472a5401c47",params:{initialInterval:1000,interval:4000,refreshRate:30000},pages:[{pageId:"cab6d296-0dc4-41cc-9f28-7cde7201ae29",selectedItemIndex:0}],title:"LIVE ALBUM"},{id:"33d5917e-6ad4-6a9a-e64d-25c56e939f19",type:"469cf7b9-4dbe-49dc-837d-944e014b425c",params:{initialInterval:1000,interval:4000,refreshRate:30000},pages:[{pageId:"a3252f83-8eb9-4d34-b994-fa297386967f",selectedItemIndex:0}],title:"Events"},{id:"30d5917e-6ad4-6a9a-e64d-25c56e939f19",type:"2793d32c-34f1-43fc-8d60-87f5051bf585",params:{initialInterval:1000,interval:4000,refreshRate:30000},pages:[{pageId:"83d40af6-7a4c-1c01-f3a5-8631ec1f1cf2",selectedItemIndex:0}],title:"People"},{id:"33d5917e-6ad4-6a9a-e64d-25c56e939f19",type:"e7252cf7-2d0a-4c05-899c-5b9f3672a45e",params:{initialInterval:1000,interval:4000,refreshRate:30000},pages:[{pageId:"be3c599e-f8ab-4de8-a589-ac993f250651",selectedItemIndex:0}],title:"Twitter"}]}]}};y.splice(0,0,A)}},addTestSettings:function(f){var c=false;if(c){f.overrideTranslation={HtmlTextAboutUsItemHoursAlwaysOpen:"24/7",ButtonOk:"Sure!",HtmlTextInboxNoMessagesStr:"inbox is empty"}}var b=false;if(b){f.brand={name:"En Bee Hey!",link:"http://www.nba.com",showAppLinks:true}}var a=false;if(a){f.ads={enabled:true,fullScreenAdEnabled:false,bottomBarAdEnabled:true,bottomBarSwitchInterval:5000,adBarCycles:2,fullScreenAdDisplayDuration:3500,fullScreenAdTO:1000}}var g=false;if(g){var h="B0F623544089136A611CCFED8026548B";f.appsFire={enabled:true,appKey:h}}var i=false;if(i){f.instagramShare={enabled:true,title:"@MeekMill #DreamsandNightmares"}}var e=false;if(e){f.fbAppId="117766941714411"}var d=false;if(d){f.startupDialog={id:"6",startDueDate:0,interval:864000,title:"{$DialogCaptionError}",message:"Rate me!",buttons:[{title:"{$ButtonOk}",url:"http://www.google.com",stop:true},{title:"NEVER!",stop:true},{title:"Remind me later",stop:false}]}}},overrideColorsLayout:function(c){var d=false;if(d){c.colorTheme={appBg:"#00ffffff",hdrBg:"#ffffffff",hdrTxt:"#FFFFFFFF",navBg:"#ffffffff",navTxt:"#FFFFFFFF",navIcn:"#FFFFFFFF",contAbg:"#FFFFFFFF",contAhdlTxt:"#ffd01e24",contAtxt:"#ff585a5a",contAsubTxt:"#FFB4B4B4",contAbrdr:"#FFDDDDDD",contBbg:"#FFFFFFFF",contBhdlTxt:"#ffd01e24",contBtxt:"#ff585a5a",contBsubTxt:"#FFB4B4B4",contBbrdr:"#FFC1C1C2",contCbg:"#ffffffff",contChdlTxt:"#FFFFFFFF",contCtxt:"#FFFFFFFF",contCsubTxt:"#FFB4B4B4",lnkTxt:"#ff043d89",actBtn:"#ff043d89"}}var a=false;if(TEST_LOYALTY){a=true}if(a){var b={appGeneral:{errTxt:{type:"text",data:{"default":{color:"#FFB60021"}}},bg:{type:"background",data:{"default":{type:"solid",color:{_replace:[{param:"appBg"}]}}}},loadingSmallIcn:{type:"icon",data:{"default":{type:"solid",color:{_replace:[{param:"contAsubTxt"}]},isBlack:false,isSimple:false}}},footer:{bg:{type:"background",data:{"default":{type:"solid",color:"#00000000",shadow:{isInset:false,x:"0px",y:"-2px",blur:"3px",color:"#99000000"}}}}},scrnDiv:{bg:{type:"background",data:{"default":{type:"solid",color:"#00000000",shadow:{isInset:false,x:"3px",y:"0px",blur:"10px",color:"#99000000"}}}},brdr:{type:"border",data:{"default":{right:{color:"#FF000000",width:"1px"}}}}},dialog:{bg:{type:"background",data:{"default":{type:"solid",color:"#CC000000"}}},btn2:{bg:{type:"background",data:{"default":{type:"gradient",orientation:"vertical",color:[{color:"#FFe4e4e4",location:0},{color:"#FF8d8d8d",location:1}]},clicked:{type:"solid",color:"#FF8d8d8d"},disabled:{type:"solid",color:"#33333333"}}},brdr:{type:"border",data:{"default":{bottom:{color:"#FFBFBBB8",width:"1px"},right:{color:"#FFBFBBB8",width:"1px"},left:{color:"#FFBFBBB8",width:"1px"},top:{color:"#FFBFBBB8",width:"1px"}},clicked:{bottom:{color:"#FF757575",width:"1px"},right:{color:"#FF757575",width:"1px"},left:{color:"#FF757575",width:"1px"},top:{color:"#FF757575",width:"1px"}}}},hdlTxt:{type:"text",data:{"default":{color:"#FF5F5B5A",shadow:{x:"0",y:"1px",blur:"0",color:"#80FFFFFF"}},selected:{color:"#CC000000",shadow:{x:"0",y:"1px",blur:"0",color:"#80FFFFFF"}},disabled:{color:"#CCCCCCCC"}}},icn:{type:"icon",data:{"default":{type:"solid",color:"#FF5F5B5A",isBlack:true,isSimple:true},clicked:{type:"solid",color:"#FF464342",isBlack:true,isSimple:true},disabled:{type:"solid",color:"#CCCCCCCC",isBlack:true,isSimple:true}}}}},floatBtn:{bg:{type:"background",data:{"default":{type:"solid",color:"#00000000"},clicked:{},disabled:{}}},brdr:{type:"border",data:{}},hdlTxt:{type:"text",data:{"default":{color:"#FFFFFFFF",shadow:{x:"0px",y:"1px",blur:"2px",color:"#E5000000"}},selected:{color:"#ffb0b0b0"},disabled:{color:"#CCCCCCCC"}}},icn:{type:"icon",data:{"default":{type:"solid",color:"#FFFFFFFF",isBlack:false,isSimple:true}}}},shareViewIcn:{type:"icon",data:{"default":{type:"solid",color:"#FFa29f9e",isBlack:true,isSimple:true}}},adBar:{bg:{type:"background",data:{"default":{type:"solid",color:{_replace:[{param:"contBbg",fn:"hsla",params:[1,1,1,0.9]}]}}}},brdr:{type:"border",data:{top:{color:{_replace:[{param:"contBbg"}]},width:"1px"}}},hdlTxt:{type:"text",data:{"default":{color:{_replace:[{param:"contBhdlTxt"}]}}}}},pullToRef:{typeA:{bg:{type:"background",data:{"default":{type:"solid",color:{_replace:[{param:"contAbg"}]},shadow:{isInset:true,x:"-1px",y:"1px",blur:"2px",color:"#54000000"}}}},txt:{type:"text",data:{"default":{color:{_replace:[{param:"contAsubTxt"}]}}}},brdr:{type:"border",data:{"default":{bottom:{color:{_replace:[{param:"contAbrdr"}]},width:"1px"}}}}},typeB:{bg:{type:"background",data:{"default":{type:"solid",color:{_replace:[{param:"contBbg"}]},shadow:{isInset:true,x:"-1px",y:"1px",blur:"2px",color:"#54000000"}}}},txt:{type:"text",data:{"default":{color:{_replace:[{param:"contBsubTxt"}]}}}},brdr:{type:"border",data:{"default":{bottom:{color:{_replace:[{param:"contBbrdr"}]},width:"1px"}}}}},icn:{type:"icon",data:{"default":{type:"solid",color:{_replace:[{param:"subTxt"}]},isBlack:true,isSimple:false}}}},ribbon:{txt:{type:"text",data:{"default":{color:"#FF000000"}}},bg:{type:"background",data:{"default":{type:"solid",color:"#FFFFFFFF",shadow:{isInset:false,x:"0px",y:"0px",blur:"3px",color:"#99000000"}}}},brdr:{type:"border",data:{"default":{top:{color:"#FF000000",width:"1px"},bottom:{color:"#FF000000",width:"1px"}}}}}},appHeader:{bg:{type:"background",data:{"default":{type:"gradient",orientation:"vertical",color:[{color:{_replace:[{param:"hdrBg",fn:"t_hsla",params:[0.5,[1,0.7,1.6,1],[1,0.9,1.25,0.92]]}]},location:0},{color:{_replace:[{param:"hdrBg",fn:"t_hsla",params:[0.5,[1,0.9,1.4,1],[1,1,1.13,0.95]]}]},location:0.25},{color:{_replace:[{param:"hdrBg",fn:"t_hsla",params:[0.5,[1,1,1.1,1],[1,1,1.1,1]]}]},location:0.49},{color:{_replace:[{param:"hdrBg",fn:"t_hsla",params:[0.5,[1,1,1,1],[1,1,1,1]]}]},location:0.5},{color:{_replace:[{param:"hdrBg",fn:"t_hsla",params:[0.5,[1,1,0.8,1],[1,1,0.8,0.9]]}]},location:0.73},{color:{_replace:[{param:"hdrBg",fn:"t_hsla",params:[0.5,[1,1,0.7,1],[1,0.7,0.5,1]]}]},location:1}],shadow:{isInset:false,x:"0px",y:"1px",blur:"3px",color:{_replace:[{param:"hdrBg",fn:"t_hsla",params:[0.5,[1,0.7,0.3,0.8],[1,0.7,0.2,1]]}]}}}}},bgTint:{type:"background",data:{"default":{type:"solid",color:{_replace:[{param:"hdrTxt"}]}}}},brdr:{type:"border",data:{"default":{bottom:{color:{_replace:[{param:"hdrBg",fn:"t_hsla",params:[0.5,[1,0.5,1.05,1],[1,0.7,0.6,0.9]]}]},width:"1px"}}}},hdlTxt:{type:"text",data:{"default":{color:{_replace:[{param:"hdrTxt"}]}}}},btn:{bg:{type:"background",data:{"default":{type:"solid",color:{_replace:[{param:"hdrBg",fn:"t_hsla",params:[0.5,[1,0.9,0.7,0.4],[1,0.9,0.5,0.4]]}]}},clicked:{type:"solid",color:"#4C000000",shadow:{isInset:true,x:"-1px",y:"1px",blur:"2px",color:"#66000000"}},selected:{type:"solid",color:"#4C000000",shadow:{isInset:true,x:"-1px",y:"1px",blur:"2px",color:"#66000000"}}}},icn:{type:"icon",data:{"default":{type:"solid",color:{_replace:[{param:"hdrTxt"}]},isBlack:false,isSimple:true}}}}},navBar:{item:{bg:{type:"background",data:{"default":{type:"gradient",orientation:"vertical",color:[{color:{_replace:[{param:"navBg",fn:"t_hsla",params:[0.5,[1,0.8,1.3,1],[1,0.9,1.25,0.95]]}]},location:0},{color:{_replace:[{param:"navBg",fn:"t_hsla",params:[0.5,[1,0.9,1.2,1],[1,1,1,0.95]]}]},location:0.18},{color:{_replace:[{param:"navBg",fn:"t_hsla",params:[0.5,[1,1,1,1],[1,1,0.7,1]]}]},location:0.55},{color:{_replace:[{param:"navBg",fn:"t_hsla",params:[0.5,[1,1,0.8,1],[1,1,0.5,1]]}]},location:0.84},{color:{_replace:[{param:"navBg",fn:"t_hsla",params:[0.5,[1,1,0.7,1],[1,0.6,0.4,1]]}]},location:1}]},clicked:{type:"gradient",orientation:"vertical",color:[{color:{_replace:[{param:"navBg",fn:"t_hsla",params:[0.5,[1,1,0.5,0.7],[1,0.6,0.5,1]]}]},location:0},{color:{_replace:[{param:"navBg",fn:"t_hsla",params:[0.5,[1,1,0.5,0.7],[1,1,0.35,1]]}]},location:0.18},{color:{_replace:[{param:"navBg",fn:"t_hsla",params:[0.5,[1,1,0.4,0.7],[1,1,0.3,1]]}]},location:0.55},{color:{_replace:[{param:"navBg",fn:"t_hsla",params:[0.5,[1,0.8,0.2,0.7],[1,1,0.4,1]]}]},location:0.84},{color:{_replace:[{param:"navBg",fn:"t_hsla",params:[0.5,[1,0.5,0.1,0.7],[1,0.9,0.5,1]]}]},location:1}],shadow:{isInset:true,x:"0px",y:"0px",blur:"2px",color:"#FF000000"}},selected:{type:"gradient",orientation:"vertical",color:[{color:{_replace:[{param:"navBg",fn:"t_hsla",params:[0.5,[1,1,0.5,0.7],[1,0.6,0.5,1]]}]},location:0},{color:{_replace:[{param:"navBg",fn:"t_hsla",params:[0.5,[1,1,0.5,0.7],[1,1,0.35,1]]}]},location:0.18},{color:{_replace:[{param:"navBg",fn:"t_hsla",params:[0.5,[1,1,0.4,0.7],[1,1,0.3,1]]}]},location:0.55},{color:{_replace:[{param:"navBg",fn:"t_hsla",params:[0.5,[1,0.8,0.2,0.7],[1,1,0.4,1]]}]},location:0.84},{color:{_replace:[{param:"navBg",fn:"t_hsla",params:[0.5,[1,0.5,0.1,0.7],[1,0.9,0.5,1]]}]},location:1}],shadow:{isInset:true,x:"0px",y:"0px",blur:"2px",color:"#FF000000"}}}},bubbleBg:{type:"background",data:{"default":{},clicked:{}}},brdr:{type:"border",data:{"default":{},clicked:{}}},hdlTxt:{type:"text",data:{"default":{color:{_replace:[{param:"navTxt",fn:"hsla",params:[1,1,1,0.8]}]}},clicked:{color:{_replace:[{param:"navTxt"}]}},selected:{color:{_replace:[{param:"navTxt"}]}}}},icn:{type:"icon",data:{"default":{type:"solid",color:{_replace:[{param:"navIcn"}]},isBlack:false,isSimple:true}}}}},navGrid:{bg:{type:"background",data:{"default":{type:"solid",color:"#33000000"}}},btn:{bg:{type:"background",data:{"default":{},clicked:{}}},brdr:{type:"border",data:{"default":{},clicked:{}}},txt:{type:"text",data:{"default":{color:{_replace:[{param:"navTxt",fn:"hsla",params:[1,1,1,0.8]}]}},clicked:{color:{_replace:[{param:"navTxt"}]}}}}}},navList:{bg:{type:"background",data:{"default":{type:"solid",color:"#33000000"}}},item:{bg:{type:"background",data:{"default":{},clicked:{type:"solid",color:"#40000000"}}},brdr:{type:"border",data:{"default":{bottom:{color:"#4c2a2a2a",width:"1px"}},clicked:{}}},txt:{type:"text",data:{"default":{color:{_replace:[{param:"navTxt"}]}},clicked:{}}}}},navSidebar:{bg:{type:"background",data:{"default":{type:"solid",color:"#FF282828"}}},scrnDiv:{bg:{type:"background",data:{"default":{type:"solid",color:"#00000000",shadow:{isInset:false,x:"-3px",y:"0px",blur:"10px",color:"#99000000"}}}},brdr:{type:"border",data:{"default":{left:{color:"#FF000000",width:"1px"}}}}},item:{bg:{type:"background",data:{"default":{},clicked:{type:"solid",color:"#33000000",shadow:{isInset:true,x:"0px",y:"1px",blur:"3px",color:"#99000000"}},selected:{type:"solid",color:"#33000000",shadow:{isInset:true,x:"0px",y:"1px",blur:"3px",color:"#99000000"}}}},marker:{type:"background",data:{"default":{},clicked:{type:"solid",color:{_replace:[{param:"actBtn"}]}},selected:{type:"solid",color:{_replace:[{param:"actBtn"}]}}}},brdr:{type:"border",data:{"default":{bottom:{color:"#FF3e3e3e",width:"1px"}},clicked:{},selected:{}}},txt:{type:"text",data:{"default":{color:"#FFefefef"},clicked:{color:"#FFFFFFFF"},selected:{color:"#FFFFFFFF"}}}}},tabBar:{bg:{type:"background",data:{"default":{type:"solid",color:"#E1FFFFFF"}}},brdr:{type:"border",data:{"default":{bottom:{color:"#FFC1C1C2",width:"1px"}}}},item:{bg:{type:"background",data:{"default":{},clicked:{}}},bubble:{bg:{type:"background",data:{"default":{},clicked:{type:"solid",color:"#3C000000"},selected:{type:"solid",color:"#FFb0b0b1"}}},brdr:{type:"border",data:{"default":{},clicked:{},selected:{}}},txt:{type:"text",data:{"default":{color:{_replace:[{param:"lnkTxt"}]},shadow:{x:"0",y:"1px",blur:"0",color:"#FFf6f5f1"}},clicked:{color:"#FFFFFFFF",shadow:{x:"0",y:"1px",blur:"0",color:"#FFa1a09e"}},selected:{color:"#FFFFFFFF",shadow:{x:"0",y:"1px",blur:"1px",color:"#FFa1a09e"}}}}},brdr:{type:"border",data:{"default":{},clicked:{}}}}},tab2Bar:{bg:{type:"background",data:{"default":{type:"gradient",orientation:"horizontal",color:[{color:"#DCCDCDCD",location:0},{color:"#E6FFFFFF",location:0.5},{color:"#DCCDCDCD",location:1}],shadow:[{isInset:true,x:"0px",y:"-1px",blur:"0px",color:{_replace:[{param:"lnkTxt"}]}},{isInset:true,x:"0px",y:"1px",blur:"0px",color:{_replace:[{param:"lnkTxt"}]}},{isInset:true,x:"0px",y:"1px",blur:"10px -2px",color:"#B4000000"},{isInset:true,x:"0px",y:"-1px",blur:"10px -2px",color:"#B4000000"}]}}},triangle:{type:"border",data:{"default":{top:{width:"6px",color:{_replace:[{param:"contAtxt"}]}},left:{width:"8px",color:"#00000000"},right:{width:"8px",color:"#00000000"},bottom:{width:"6px",color:{_replace:[{param:"contAtxt"}]}}}}},item:{bg:{type:"background",data:{"default":{type:"solid",color:"#00000000"},selected:{type:"solid",color:"#00000000"}}},txt:{type:"text",data:{"default":{color:{_replace:[{param:"lnkTxt"}]}},selected:{color:{_replace:[{param:"contAtxt"}]}}}}}},punch:{wideBg:{type:"background",data:{"default":{type:"solid",color:"#B2000000"}}},bgImage:{bg:{type:"background",data:{"default":{type:"solid",color:"#FF123456"}}},overlayBg:{type:"background",data:{"default":{type:"solid",color:"#DDFFFFFF"}}}},slot:{whole:{bg:{type:"svg",data:{"default":{type:"solid",color:{_replace:[{param:"actBtn"}]}}}},overlay:{type:"svg",data:{"default":{type:"solid",color:"#55FFFFFF"}}},txt:{type:"text",data:{"default":{color:"#FFFFFFFF"}}}},punch:{bg:{type:"svg",data:{"default":{type:"solid",color:{_replace:[{param:"actBtn"}]}}}},overlay:{type:"svg",data:{"default":{type:"solid",color:"#FFFFFFFF"}}},txt:{type:"text",data:{"default":{color:{_replace:[{param:"lnkTxt"}]}}}}}}},contTypeA:{hdlTxt:{type:"text",data:{"default":{color:{_replace:[{param:"contAhdlTxt"}]}}}},hdlTxtBrdr:{type:"border",data:{"default":{top:{width:"1px",color:"#FFCCCCCC"},bottom:{width:"1px",color:"#FFCCCCCC"}}}},txt:{type:"text",data:{"default":{color:{_replace:[{param:"contAtxt"}]}},mandatory:{color:"#FFBB0000"}}},subTxt:{type:"text",data:{"default":{color:{_replace:[{param:"contAsubTxt"}]}}}},lnkTxt:{type:"text",data:{"default":{color:{_replace:[{param:"lnkTxt"}]}}}},hdlIcn:{type:"server_icon",data:{"default":{type:"solid",color:{_replace:[{param:"contAhdlTxt"}]},isBlack:true,isSimple:true}}},icn:{type:"icon",data:{"default":{type:"solid",color:{_replace:[{param:"contAtxt"}]},isBlack:true,isSimple:false}}},subIcn:{type:"icon",data:{"default":{type:"solid",color:{_replace:[{param:"contAsubTxt"}]},isBlack:true,isSimple:false}}},bg:{type:"background",data:{"default":{type:"solid",color:{_replace:[{param:"contAbg"}]}},clicked:{type:"solid",color:"#FFf5f3ef"},selected:{type:"solid",color:"#FFf7f7f7"}}},subBg:{type:"background",data:{"default":{type:"solid",color:"#FFeeeeee"}}},brdr:{type:"border",data:{"default":{bottom:{color:{_replace:[{param:"contAbrdr"}]},width:"1px"}},clicked:{},selected:{top:{width:"1px",color:{_replace:[{param:"contAbrdr",fn:"hsla",params:[1,1,0.5,1]}]}},bottom:{width:"1px",color:{_replace:[{param:"contAbrdr",fn:"hsla",params:[1,1,0.5,1]}]}},left:{width:"1px",color:{_replace:[{param:"contAbrdr",fn:"hsla",params:[1,1,0.5,1]}]}},right:{width:"1px",color:{_replace:[{param:"contAbrdr",fn:"hsla",params:[1,1,0.5,1]}]}}}}},classicItem:{bg:{type:"background",data:{"default":{type:"solid",color:{_replace:[{param:"contAbg"}]}},clicked:{type:"solid",color:"#FFf5f3ef"},selected:{type:"solid",color:"#FFf7f7f7"}}},brdr:{type:"border",data:{"default":{bottom:{color:{_replace:[{param:"contAbrdr"}]},width:"1px"}},clicked:{},selected:{top:{width:"1px",color:{_replace:[{param:"contAbrdr",fn:"hsla",params:[1,1,0.5,1]}]}},bottom:{width:"1px",color:{_replace:[{param:"contAbrdr",fn:"hsla",params:[1,1,0.5,1]}]}},left:{width:"1px",color:{_replace:[{param:"contAbrdr",fn:"hsla",params:[1,1,0.5,1]}]}},right:{width:"1px",color:{_replace:[{param:"contAbrdr",fn:"hsla",params:[1,1,0.5,1]}]}}}}}},btn:{bg:{type:"background",data:{"default":{type:"gradient",orientation:"vertical",color:[{color:"#FFfcfcfc",location:0},{color:"#FFe5e5e5",location:1}],shadow:[{isInset:false,x:"1px",y:"1px",blur:"2px",color:"#26000000"},{isInset:true,x:"-1px",y:"-1px",blur:"0px",color:"#CCFFFFFF"}]},clicked:{type:"gradient",orientation:"vertical",color:[{color:"#FFe5e5e5",location:0},{color:"#FFfcfcfc",location:1}],shadow:[{isInset:false,x:"1px",y:"1px",blur:"1px",color:"#4c000000"},{isInset:true,x:"1px",y:"1px",blur:"0px",color:"#CCFFFFFF"}]},disabled:{type:"gradient",orientation:"vertical",color:[{color:"#FFe7e7e7",location:0},{color:"#FFE6E6E6",location:1}]}}},brdr:{type:"border",data:{"default":{bottom:{color:"#FFBFBBB8",width:"1px"},right:{color:"#FFBFBBB8",width:"1px"},left:{color:"#FFBFBBB8",width:"1px"},top:{color:"#FFBFBBB8",width:"1px"}},clicked:{bottom:{color:"#FFa7a7a7",width:"1px"},right:{color:"#FFa7a7a7",width:"1px"},left:{color:"#FFa7a7a7",width:"1px"},top:{color:"#FFa7a7a7",width:"1px"}}}},hdlTxt:{type:"text",data:{"default":{color:"#FF5F5B5A",shadow:{x:"0",y:"1px",blur:"0",color:"#80FFFFFF"}},selected:{color:"#CC000000",shadow:{x:"0",y:"1px",blur:"0",color:"#80FFFFFF"}},disabled:{color:"#ffCCCCCC"}}},icn:{type:"icon",data:{"default":{type:"solid",color:"#FF2a2a2a",isBlack:true,isSimple:false}}}},actBtn:{bg:{type:"background",data:{"default":{type:"solid",color:{_replace:[{param:"actBtn"}]}},clicked:{type:"solid",color:{_replace:[{param:"actBtn",fn:"t_hsla",params:[0.5,[1,1,1.3,1],[1,1,0.5,1]]}]}},disabled:{type:"solid",color:"#33333333"}}},brdr:{type:"border",data:{}},hdlTxt:{type:"text",data:{"default":{color:"#FFFFFFFF"},selected:{color:"#FFFFFFFF"},disabled:{color:"#ffCCCCCC"}}},icn:{type:"icon",data:{"default":{type:"solid",color:"#FFFFFFFF",isBlack:false,isSimple:true}}}},contentSession:{bg:{type:"background",data:{"default":{type:"solid",color:{_replace:[{param:"contAhdlTxt",fn:"hsla",params:[1,1,1,0.88]}]}}}},hdlTxt:{type:"text",data:{"default":{color:{_replace:[{param:"contAbg"}]}}}},txt:{type:"text",data:{"default":{color:{_replace:[{param:"contAbg",fn:"hsla",params:[1,1,1,0.69]}]}}}},subTxt:{type:"text",data:{"default":{color:{_replace:[{param:"contAbg",fn:"hsla",params:[1,1,1,0.49]}]}}}},btn:{bg:{type:"background",data:{"default":{type:"solid",color:"#00FFFFFF",shadow:[{isInset:false,x:"0px",y:"0px",blur:"0px 1px",color:"#66000000"},{isInset:true,x:"1px",y:"1px",blur:"0px",color:"#4Dffffff"}]}}},icn:{type:"icon",data:{"default":{type:"solid",color:"#FFFFFFFF",isBlack:false,isSimple:true}}}}},contentSession2:{bg:{type:"background",data:{"default":{type:"solid",color:{_replace:[{param:"lnkTxt",fn:"hsla",params:[1,1,1,0.88]}]}}}},hdlTxt:{type:"text",data:{"default":{color:{_replace:[{param:"contAbg"}]}}}},txt:{type:"text",data:{"default":{color:{_replace:[{param:"contAbg",fn:"hsla",params:[1,1,1,0.69]}]}}}},subTxt:{type:"text",data:{"default":{color:{_replace:[{param:"contAbg",fn:"hsla",params:[1,1,1,0.49]}]}}}},btn:{bg:{type:"background",data:{"default":{type:"solid",color:"#00FFFFFF",shadow:[{isInset:false,x:"1px",y:"1px",blur:"0px",color:"#66ffffff"},{isInset:true,x:"1px",y:"1px",blur:"3px",color:"#99000000"}]}}},icn:{type:"icon",data:{"default":{type:"solid",color:"#FFFFFFFF",isBlack:false,isSimple:true}}}}},calBoxBrdr1:{type:"border",data:{"default":{top:{width:"1px",color:{_replace:[{param:"contBbrdr"}]}},bottom:{width:"1px",style:"dotted",color:{_replace:[{param:"contBbrdr",fn:"hsla",params:[1,1,1,0.7]}]}}}}},calBoxBrdr2:{type:"border",data:{"default":{top:{width:"1px",style:"dotted",color:{_replace:[{param:"contBbrdr",fn:"hsla",params:[1,1,1,0.7]}]}},bottom:{width:"1px",style:"dotted",color:{_replace:[{param:"contBbrdr",fn:"hsla",params:[1,1,1,0.7]}]}}}}}},contTypeB:{hdlTxt:{type:"text",data:{"default":{color:{_replace:[{param:"contBhdlTxt"}]},shadow:{x:"1px",y:"1px",blur:"0",color:"#ccFFFFFF"}}}},hdlTxtBrdr:{type:"border",data:{"default":{top:{width:"1px",color:{_replace:[{param:"contBhdlTxt",fn:"hsla",params:[1,1,1,0.2]}]}},bottom:{width:"1px",color:{_replace:[{param:"contBhdlTxt",fn:"hsla",params:[1,1,1,0.2]}]}}}}},txt:{type:"text",data:{"default":{color:{_replace:[{param:"contBtxt"}]},shadow:{x:"1px",y:"1px",blur:"1px",color:"#FFFFFFFF"}},mandatory:{color:"#FFBB0000",shadow:{x:"1px",y:"1px",blur:"1px",color:"#FFFFFFFF"}}}},subTxt:{type:"text",data:{"default":{color:{_replace:[{param:"contBsubTxt"}]},shadow:{x:"1px",y:"1px",blur:"1px",color:"#FFFFFFFF"}}}},lnkTxt:{type:"text",data:{"default":{color:{_replace:[{param:"lnkTxt"}]},shadow:{x:"1px",y:"1px",blur:"1px",color:"#FFf6f5f1"}}}},icn:{type:"icon",data:{"default":{type:"solid",color:{_replace:[{param:"contBtxt"}]},isBlack:true,isSimple:false}}},subIcn:{type:"icon",data:{"default":{type:"solid",color:{_replace:[{param:"contBsubTxt"}]},isBlack:true,isSimple:true}}},hdlIcn:{type:"server_icon",data:{"default":{type:"solid",color:{_replace:[{param:"contBhdlTxt"}]},isBlack:true,isSimple:true}}},bg:{type:"background",data:{"default":{type:"solid",color:{_replace:[{param:"contBbg",fn:"hsla",params:[1,1,1,0.88]}]},shadow:{isInset:false,x:"1px",y:"1px",blur:"3px",color:"#96000000"}},clicked:{type:"solid",color:{_replace:[{param:"contBbg",fn:"hsla",params:[1,1,1,0.82]}]},shadow:{isInset:false,x:"1px",y:"1px",blur:"3px",color:"#96000000"}},selected:{type:"solid",color:{_replace:[{param:"contBbg",fn:"hsla",params:[1,1,1,0.82]}]},shadow:{isInset:false,x:"1px",y:"1px",blur:"3px",color:"#96000000"}}}},subBg:{type:"background",data:{"default":{type:"solid",color:"#FFe1e1e1"}}},brdr:{type:"border",data:{"default":{bottom:{color:{_replace:[{param:"contBbrdr"}]},width:"1px"}},clicked:{bottom:{color:{_replace:[{param:"contBbrdr"}]},width:"1px"}},selected:{top:{color:{_replace:[{param:"contBbrdr",fn:"hsla",params:[1,1,0.6,1]}]},width:"1px"},bottom:{color:{_replace:[{param:"contBbrdr",fn:"hsla",params:[1,1,0.6,1]}]},width:"1px"},left:{color:{_replace:[{param:"contBbrdr",fn:"hsla",params:[1,1,0.6,1]}]},width:"1px"},right:{color:{_replace:[{param:"contBbrdr",fn:"hsla",params:[1,1,0.6,1]}]},width:"1px"}}}},bubbleItem:{bg:{type:"background",data:{"default":{type:"solid",color:{_replace:[{param:"contBbg",fn:"hsla",params:[1,1,1,0.88]}]},shadow:{isInset:false,x:"1px",y:"1px",blur:"3px",color:"#96000000"}},clicked:{type:"solid",color:{_replace:[{param:"contBbg",fn:"hsla",params:[1,1,1,0.82]}]},shadow:{isInset:false,x:"1px",y:"1px",blur:"3px",color:"#96000000"}},selected:{type:"solid",color:{_replace:[{param:"contBbg"}]},shadow:[{isInset:false,x:"0px",y:"0px",blur:"1px",color:"#FFFFFFFF"},{isInset:false,x:"0px",y:"0px",blur:"2px",color:"#FFFFFFFF"},{isInset:false,x:"0px",y:"0px",blur:"2px",color:"#FFFFFFFF"},{isInset:false,x:"0px",y:"0px",blur:"2px",color:"#FFFFFFFF"}]}}},ovrImg:{bg:{type:"background",data:{"default":{type:"solid",color:"#B2000000"},clicked:{type:"solid",color:{_replace:[{param:"lnkTxt",fn:"hsla",params:[1,1,1,0.6]}]}},selected:{type:"solid",color:{_replace:[{param:"lnkTxt",fn:"hsla",params:[1,1,1,0.8]}]}}}},icn:{type:"icon",data:{"default":{type:"solid",color:"#b2ffffff",isBlack:false,isSimple:false}}},hdlTxt:{type:"text",data:{"default":{color:"#FFFFFFFF"}}},txt:{type:"text",data:{"default":{color:"#B2FFFFFF"}}},subTxt:{type:"text",data:{"default":{color:"#7fFFFFFF"}}}},brdr:{type:"border",data:{}}},headerItem:{bg:{type:"background",data:{"default":{type:"solid",color:{_replace:[{param:"contBbg",fn:"hsla",params:[1,1,1,0.88]}]}},clicked:{type:"solid",color:{_replace:[{param:"contBbg",fn:"hsla",params:[1,1,1,0.82]}]}},selected:{type:"solid",color:{_replace:[{param:"contBbg",fn:"hsla",params:[1,1,1,0.82]}]}}}},brdr:{type:"border",data:{"default":{bottom:{color:{_replace:[{param:"contBbrdr"}]},width:"1px"}}}}},trackItem:{bg:{type:"background",data:{"default":{type:"solid",color:{_replace:[{param:"contBbg",fn:"hsla",params:[1,1,1,0.88]}]},shadow:{isInset:false,x:"1px",y:"1px",blur:"3px",color:"#96000000"}},clicked:{type:"solid",color:{_replace:[{param:"contBbg",fn:"hsla",params:[1,1,1,0.82]}]},shadow:{isInset:false,x:"1px",y:"1px",blur:"3px",color:"#96000000"}},selected:{type:"solid",color:{_replace:[{param:"contBbg"}]}}}},brdr:{type:"border",data:{"default":{top:{color:{_replace:[{param:"contBbrdr"}]},width:"1px"},bottom:{color:{_replace:[{param:"contBbrdr"}]},width:"1px"},left:{color:{_replace:[{param:"contBbrdr"}]},width:"1px"},right:{color:{_replace:[{param:"contBbrdr"}]},width:"1px"}},clicked:{top:{color:{_replace:[{param:"hdrBg"}]},width:"1px"},bottom:{color:{_replace:[{param:"hdrBg"}]},width:"1px"},left:{color:{_replace:[{param:"hdrBg"}]},width:"1px"},right:{color:{_replace:[{param:"hdrBg"}]},width:"1px"}},selected:{top:{color:{_replace:[{param:"contBbrdr"}]},width:"1px"},bottom:{color:{_replace:[{param:"contBbrdr"}]},width:"1px"},left:{color:{_replace:[{param:"contBbrdr"}]},width:"1px"},right:{color:{_replace:[{param:"contBbrdr"}]},width:"1px"}}}}},fullPage:{bg:{type:"background",data:{"default":{type:"solid",color:{_replace:[{param:"contBbg",fn:"hsla",params:[1,1,1,0.68]}]}}}}},fullPage2:{bg:{type:"background",data:{"default":{type:"solid",color:{_replace:[{param:"contBbg",fn:"hsla",params:[1,1,1,0.1]}]}}}}},fullPage3:{bg:{type:"background",data:{"default":{type:"solid",color:{_replace:[{param:"contBbg",fn:"hsla",params:[1,1,1,0.95]}]}}}}},sep:{brdr:{type:"border",data:{"default":{top:{width:"1px",color:{_replace:[{param:"contBbrdr",fn:"hsla",params:[1,1,0.6,1]}]}}}}}},btn:{bg:{type:"background",data:{"default":{type:"gradient",orientation:"vertical",color:[{color:"#FFFFFFFF",location:0},{color:"#FFE6E6E6",location:1}]},clicked:{type:"gradient",orientation:"vertical",color:[{color:"#ffdddddd",location:0},{color:"#ffcccccc",location:1}]},disabled:{type:"gradient",orientation:"vertical",color:[{color:"#FFe7e7e7",location:0},{color:"#FFE6E6E6",location:1}]}}},brdr:{type:"border",data:{"default":{bottom:{color:"#FFBFBBB8",width:"1px"},right:{color:"#FFBFBBB8",width:"1px"},left:{color:"#FFBFBBB8",width:"1px"},top:{color:"#FFBFBBB8",width:"1px"}},clicked:{bottom:{color:"#FF757575",width:"1px"},right:{color:"#FF757575",width:"1px"},left:{color:"#FF757575",width:"1px"},top:{color:"#FF757575",width:"1px"}}}},hdlTxt:{type:"text",data:{"default":{color:"#FF5F5B5A",shadow:{x:"0",y:"1px",blur:"0",color:"#80FFFFFF"}},selected:{},disabled:{color:"#CCCCCCCC"}}},icn:{type:"icon",data:{"default":{type:"solid",color:"#FF5F5B5A",isBlack:true,isSimple:false},clicked:{type:"solid",color:"#FF464342",isBlack:true,isSimple:false},disabled:{type:"solid",color:"#CCCCCCCC",isBlack:true,isSimple:false}}}},actBtn:{bg:{type:"background",data:{"default":{type:"solid",color:{_replace:[{param:"actBtn"}]}},clicked:{type:"solid",color:{_replace:[{param:"actBtn",fn:"t_hsla",params:[0.5,[1,1,1.3,1],[1,1,0.5,1]]}]}},disabled:{type:"solid",color:"#33333333"}}},brdr:{type:"border",data:{}},hdlTxt:{type:"text",data:{"default":{color:"#FFFFFFFF"},selected:{color:"#FFFFFFFF"},disabled:{color:"#ffCCCCCC"}}},icn:{type:"icon",data:{"default":{type:"solid",color:"#FFFFFFFF",isBlack:false,isSimple:true}}}},subBtn:{bg:{type:"background",data:{"default":{type:"solid",color:{_replace:[{param:"contBsubTxt",fn:"hsla",params:[1,1,0.8,1]}]}},selected:{type:"solid",color:{_replace:[{param:"contBsubTxt"}]}}}},hdlTxt:{type:"text",data:{"default":{color:"#FFFFFFFF",shadow:{x:"0px",y:"1px",blur:"1px",color:"#80FFFFFF"}}}}}},contTypeC:{hdlTxt:{type:"text",data:{"default":{color:{_replace:[{param:"contChdlTxt"}]}}}},txt:{type:"text",data:{"default":{color:{_replace:[{param:"contCtxt"}]}}}},subTxt:{type:"text",data:{"default":{color:{_replace:[{param:"contCsubTxt"}]}}}},lnkTxt:{type:"text",data:{"default":{color:{_replace:[{param:"lnkTxt"}]}}}},bg:{type:"background",data:{"default":{type:"solid",color:{_replace:[{param:"contCbg",fn:"t_hsla",params:[0.5,[1,1,0.6,0.9],[1,1,0.3,0.9]]}]}}}},btn:{bg:{type:"background",data:{"default":{type:"solid",color:{_replace:[{param:"actBtn"}]}},clicked:{type:"solid",color:{_replace:[{param:"actBtn",fn:"t_hsla",params:[0.5,[1,1,1.3,1],[1,1,0.5,1]]}]}},disabled:{type:"solid",color:"#33333333"}}},brdr:{type:"border",data:{}},hdlTxt:{type:"text",data:{"default":{color:"#FFFFFFFF"},selected:{color:"#FFFFFFFF"},disabled:{color:"#ffCCCCCC"}}}}},form:{element:{bg:{type:"background",data:{"default":{type:"gradient",orientation:"vertical",color:[{color:"#FFe4e4e4",location:0},{color:"#FF8d8d8d",location:1}]},mandatory:{type:"gradient",orientation:"vertical",color:[{color:"#FFFFFFFF",location:0},{color:"#FF8d8d8d",location:1}],shadow:{isInset:false,x:"1px",y:"1px",blur:"3px",color:"#4cb60021"}}}},brdr:{type:"border",data:{"default":{top:{width:"1px",color:"#FFC1C1C2"},bottom:{width:"1px",color:"#FFC1C1C2"},left:{width:"1px",color:"#FFC1C1C2"},right:{width:"1px",color:"#FFC1C1C2"}},mandatory:{top:{color:"#FFB60021",width:"1px"},bottom:{color:"#FFB60021",width:"1px"},left:{color:"#FFB60021",width:"1px"},right:{color:"#FFB60021",width:"1px"}}}},txt:{type:"text",data:{"default":{color:"#FF111111"},watermark:{color:"#FF888888"},mandWatermark:{color:"#FFb60021"}}}},dropdown:{icn:{type:"icon",data:{"default":{type:"solid",color:"#FF2a2a2a",isBlack:true,isSimple:true}}},bg:{type:"background",data:{"default":{type:"solid",color:"#22000000"}}},brdr:{type:"border",data:{"default":{left:{color:"#FFC1C1C2",width:"1px"},right:{color:"#FFC1C1C2",width:"1px"}}}}},input:{bg:{type:"background",data:{"default":{type:"solid",color:"#FFFFFFFF"},disabled:{type:"solid",color:"#FFCCCCCC"},mandatory:{type:"solid",color:"#FFfff8f8",shadow:{isInset:false,x:"1px",y:"1px",blur:"5px",color:"#4cb60021"}}}},brdr:{type:"border",data:{"default":{top:{width:"1px",color:"#FFC1C1C2"},bottom:{width:"1px",color:"#FFC1C1C2"},left:{width:"1px",color:"#FFC1C1C2"},right:{width:"1px",color:"#FFC1C1C2"}},diabled:{},mandatory:{top:{color:"#FFB60021",width:"1px"},bottom:{color:"#FFB60021",width:"1px"},left:{color:"#FFB60021",width:"1px"},right:{color:"#FFB60021",width:"1px"}}}},txt:{type:"text",data:{"default":{color:"#FF000000"},watermark:{color:"#FF8e8e8e"},mandWatermark:{color:"#FFb60021"}}},icn:{type:"icon",data:{"default":{type:"solid",color:"#FFa8a8a8",isBlack:false,isSimple:true},selected:{type:"solid",color:"#FF2a2a2a",isBlack:true,isSimple:true},clicked:{type:"solid",color:"#FF626262",isBlack:true,isSimple:true}}}},checkBox:{bg:{type:"background",data:{"default":{type:"solid",color:"#FFFFFFFF",shadow:{isInset:true,x:"1px",y:"1px",blur:"2px",color:"#33000000"}},selected:{type:"solid",color:"#FFFFFFFF",shadow:{isInset:true,x:"1px",y:"1px",blur:"2px",color:"#33000000"}},mandatory:{type:"solid",color:"#FFFFFFFF",shadow:{isInset:true,x:"1px",y:"1px",blur:"2px",color:"#33000000"}},disabled:{type:"solid",color:"#54d3d3d3",shadow:{isInset:false,x:"0px",y:"1px",blur:"0px",color:"#FFFFFFFF"}}}},brdr:{type:"border",data:{"default":{top:{width:"1px",color:{_replace:[{param:"contBbrdr"}]}},bottom:{width:"1px",color:{_replace:[{param:"contBbrdr"}]}},left:{width:"1px",color:{_replace:[{param:"contBbrdr"}]}},right:{width:"1px",color:{_replace:[{param:"contBbrdr"}]}}},selected:{top:{width:"1px",color:{_replace:[{param:"contBbrdr"}]}},bottom:{width:"1px",color:{_replace:[{param:"contBbrdr"}]}},left:{width:"1px",color:{_replace:[{param:"contBbrdr"}]}},right:{width:"1px",color:{_replace:[{param:"contBbrdr"}]}}},mandatory:{top:{color:"#FFB60021",width:"1px"},bottom:{color:"#FFB60021",width:"1px"},left:{color:"#FFB60021",width:"1px"},right:{color:"#FFB60021",width:"1px"}},disabled:{top:{width:"1px",color:{_replace:[{param:"contBbrdr"}]}},bottom:{width:"1px",color:{_replace:[{param:"contBbrdr"}]}},left:{width:"1px",color:{_replace:[{param:"contBbrdr"}]}},right:{width:"1px",color:{_replace:[{param:"contBbrdr"}]}}}}},icn:{type:"icon",data:{"default":{type:"solid",color:"#00FFFFFF",isBlack:false,isSimple:true},selected:{type:"solid",color:"#FF2a2a2a",isBlack:true,isSimple:true}}}},radioBtn:{bg:{type:"background",data:{"default":{type:"solid",color:"#FFFFFFFF",shadow:{isInset:true,x:"1px",y:"1px",blur:"2px",color:"#33000000"}},selected:{type:"solid",color:"#FFFFFFFF",shadow:{isInset:true,x:"1px",y:"1px",blur:"2px",color:"#33000000"}},mandatory:{type:"solid",color:"#FFFFFFFF",shadow:{isInset:true,x:"1px",y:"1px",blur:"2px",color:"#33000000"}},disabled:{type:"solid",color:"#54d3d3d3",shadow:{isInset:false,x:"0px",y:"1px",blur:"0px",color:"#FFFFFFFF"}}}},brdr:{type:"border",data:{"default":{top:{width:"1px",color:{_replace:[{param:"contBbrdr"}]}},bottom:{width:"1px",color:{_replace:[{param:"contBbrdr"}]}},left:{width:"1px",color:{_replace:[{param:"contBbrdr"}]}},right:{width:"1px",color:{_replace:[{param:"contBbrdr"}]}}},selected:{top:{width:"1px",color:{_replace:[{param:"contBbrdr"}]}},bottom:{width:"1px",color:{_replace:[{param:"contBbrdr"}]}},left:{width:"1px",color:{_replace:[{param:"contBbrdr"}]}},right:{width:"1px",color:{_replace:[{param:"contBbrdr"}]}}},mandatory:{top:{color:"#FFB60021",width:"1px"},bottom:{color:"#FFB60021",width:"1px"},left:{color:"#FFB60021",width:"1px"},right:{color:"#FFB60021",width:"1px"}},disabled:{top:{width:"1px",color:{_replace:[{param:"contBbrdr"}]}},bottom:{width:"1px",color:{_replace:[{param:"contBbrdr"}]}},left:{width:"1px",color:{_replace:[{param:"contBbrdr"}]}},right:{width:"1px",color:{_replace:[{param:"contBbrdr"}]}}}}},icn:{type:"background",data:{"default":{},selected:{type:"solid",color:"#FF2a2a2a",isBlack:true,isSimple:true},disabled:{type:"solid",color:"#FFd3d3d3",isBlack:true,isSimple:true}}}}},audioPlayer:{hdlTxt:{type:"text",data:{"default":{color:{_replace:[{param:"hdrTxt"}]}}}},txt:{type:"text",data:{"default":{color:{_replace:[{param:"hdrTxt",fn:"hsla",params:[1,1,1,0.8]}]}}}},icn:{type:"icon",data:{"default":{type:"solid",color:{_replace:[{param:"hdrTxt"}]},isBlack:false,isSimple:false}}},bg:{type:"background",data:{"default":{type:"solid",color:{_replace:[{param:"hdrBg",fn:"hsla",params:[1,1,0.3,1]}]}}}},bgMini:{type:"background",data:{"default":{type:"solid",color:{_replace:[{param:"hdrBg",fn:"hsla",params:[1,1,0.3,1]}]}}}},brdr:{type:"border",data:{"default":{bottom:{color:{_replace:[{param:"hdrBg",fn:"t_hsla",params:[0.5,[1,0.5,0.7,0.9],[1,0.7,0.6,0.9]]}]},width:"1px"}}}},seekBar:{bg:{type:"background",data:{"default":{type:"solid",color:{_replace:[{param:"hdrBg",fn:"t_hsla",params:[0.5,[1,0.7,1.3,1],[1,0.7,0.7,1]]}]},shadow:{isInset:true,x:"1px",y:"1px",blur:"2px",color:{_replace:[{param:"hdrBg",fn:"t_hsla",params:[0.5,[1,0.7,0.001,1],[1,0.7,0.001,1]]}]}}}}},brdr:{type:"border",data:{"default":{top:{color:{_replace:[{param:"hdrBg",fn:"t_hsla",params:[0.5,[1,0.7,1.1,1],[1,0.7,0.7,1]]}]},width:"1px"},bottom:{color:{_replace:[{param:"hdrBg",fn:"t_hsla",params:[0.5,[1,0.7,1.8,1],[1,0.7,0.7,1]]}]},width:"1px"},right:{color:{_replace:[{param:"hdrBg",fn:"t_hsla",params:[0.5,[1,0.7,1.8,1],[1,0.7,0.7,1]]}]},width:"1px"},left:{color:{_replace:[{param:"hdrBg",fn:"t_hsla",params:[0.5,[1,0.7,1.1,1],[1,0.7,0.7,1]]}]},width:"1px"}}}},seekFill:{type:"background",data:{"default":{type:"solid",color:{_replace:[{param:"hdrTxt"}]},shadow:{isInset:true,x:"0px",y:"1px",blur:"1px",color:"#ff000000"}}}}}},liveChat:{bubbleMe:{bg:{type:"background",data:{"default":{type:"solid",color:{_replace:[{param:"contBbg",fn:"hsla",params:[1,1,1,0.88]}]},shadow:{isInset:false,x:"1px",y:"1px",blur:"3px",color:"#96000000"}}}},triangle:{type:"border",data:{"default":{ltrLeft:{color:{_replace:[{param:"contBbg",fn:"hsla",params:[1,1,1,0.88]}]},width:"10px"},bottom:{color:"#00000000",width:"10px"},top:{color:"#00000000",width:"10px"}}}},txt:{type:"text",data:{"default":{color:{_replace:[{param:"contBhdlTxt"}]},shadow:{x:"1px",y:"1px",blur:"0",color:"#CCFFFFFF"}}}},subTxt:{type:"text",data:{"default":{color:{_replace:[{param:"contBsubTxt"}]},shadow:{x:"1px",y:"1px",blur:"1px",color:"#FFFFFFFF"}}}}},bubbleOther:{bg:{type:"background",data:{"default":{type:"solid",color:{_replace:[{param:"contAbg"}]},shadow:{isInset:false,x:"1px",y:"1px",blur:"3px",color:"#96000000"}}}},triangle:{type:"border",data:{"default":{ltrRight:{color:{_replace:[{param:"contAbg"}]},width:"10px"},bottom:{color:"#00000000",width:"10px"},top:{color:"#00000000",width:"10px"}}}},txt:{type:"text",data:{"default":{color:{_replace:[{param:"contAhdlTxt"}]},shadow:{x:"1px",y:"1px",blur:"0px",color:"#CCFFFFFF"}}}},subTxt:{type:"text",data:{"default":{color:{_replace:[{param:"contBsubTxt"}]},shadow:{x:"1px",y:"1px",blur:"0px",color:"#FFFFFFFF"}}}}}},facebook:{txt:{type:"text",data:{"default":{color:"#FF576b95"}}},bubble:{bg:{type:"background",data:{"default":{type:"solid",color:"#FFedeff4"}}},brdr:{type:"border",data:{"default":{left:{color:"#FFced5e4",width:"1px"},right:{color:"#FFced5e4",width:"1px"},bottom:{color:"#FFced5e4",width:"1px"},top:{color:"#FFced5e4",width:"1px"}}}},triangle:{type:"border",data:{"default":{left:{color:"#00000000",width:"4px"},right:{color:"#00000000",width:"4px"},bottom:{color:"#FFedeff4",width:"4px"}}}},triangleBrdr:{type:"border",data:{"default":{left:{color:"#00000000",width:"6px"},right:{color:"#00000000",width:"6px"},bottom:{color:"#FFced5e4",width:"6px"}}}}},btn:{bg:{type:"background",data:{"default":{type:"solid",color:"#00000000"},clicked:{type:"solid",color:"#FFFFCCAA"},disabled:{type:"solid",color:"#33333333"}}},brdr:{type:"border",data:{"default":{left:{color:"#00000000",width:"1px"},right:{color:"#00000000",width:"1px"},bottom:{color:"#00000000",width:"1px"},top:{color:"#00000000",width:"1px"}},clicked:{bottom:{color:"#FFFF6611",width:"1px"},right:{color:"#FFFF6611",width:"1px"},left:{color:"#FFFF6611",width:"1px"},top:{color:"#FFFF6611",width:"1px"}}}},hdlTxt:{type:"text",data:{"default":{color:"#FF576b95"},selected:{color:"#FF576b95"},disabled:{color:"#CCCCCCCC"}}},icn:{type:"icon",data:{"default":{type:"solid",color:"#FF5F5B5A",isBlack:true,isSimple:true},clicked:{type:"solid",color:"#FF464342",isBlack:true,isSimple:true},disabled:{type:"solid",color:"#CCCCCCCC",isBlack:true,isSimple:true}}}}},events:{calPict:{bg:{type:"background",data:{"default":{type:"solid",color:{_replace:[{param:"contBbg",fn:"hsla",params:[1,1,1,0.78]}]},shadow:{isInset:false,x:"1px",y:"1px",blur:"2px",color:"#FF000000"}}}}}},comment:{bg:{type:"background",data:{"default":{type:"solid",color:"#FFFFFFFF"}}},panel:{bg:{type:"background",data:{"default":{type:"solid",color:"#FFF0F0F0"}}},brdr:{type:"border",data:{"default":{bottom:{color:"#FFCCCCCC",width:"1px"}}}}}},images:{image1:{bg:{type:"background",data:{"default":{type:"solid",color:"#FFFFFFFF"}}},brdr:{type:"border",data:{"default":{bottom:{color:"#FFC1C1C2",width:"1px"},top:{color:"#FFC1C1C2",width:"1px"},right:{color:"#FFC1C1C2",width:"1px"},left:{color:"#FFC1C1C2",width:"1px"}}}}},image2:{bg:{type:"background",data:{"default":{type:"solid",color:"#FFFFFFFF"}}},brdr:{type:"border",data:{"default":{bottom:{color:"#FF000000",width:"1px"},top:{color:"#FF000000",width:"1px"},right:{color:"#FF000000",width:"1px"},left:{color:"#FF000000",width:"1px"}}}}},catImage:{bg:{type:"background",data:{"default":{type:"solid",color:"#00000000",shadow:[{isInset:false,x:"0px",y:"0px",blur:"1px",color:"#FF000000"},{isInset:true,x:"0px",y:"0px",blur:"0px 3px",color:"#FFFFFFFF"},{isInset:true,x:"0px",y:"0px",blur:"1px 3px",color:"#66000000"}]},clicked:{type:"solid",color:"#00000000",shadow:{isInset:true,x:"1px",y:"1px",blur:"3px",color:"#CC000000"}},selected:{type:"solid",color:"#00000000",shadow:{isInset:true,x:"1px",y:"1px",blur:"3px",color:"#CC000000"}}}},bgGrad:{type:"background",data:{"default":{type:"gradient",orientation:"vertical",color:[{color:"#00000000",location:0},{color:"#00000000",location:0.47},{color:"#59000000",location:1}],shadow:[{isInset:false,x:"0px",y:"0px",blur:"1px",color:"#FF000000"},{isInset:true,x:"0px",y:"0px",blur:"0px 3px",color:"#FFFFFFFF"},{isInset:true,x:"0px",y:"0px",blur:"1px 3px",color:"#66000000"}]}}},txt:{type:"text",data:{"default":{color:"#FFFFFFFF",shadow:[{x:"0px",y:"0px",blur:"1px",color:"#FF000000"},{x:"1px",y:"1px",blur:"3px",color:"#CC000000"}]}}}},imgBtn:{bg:{type:"background",data:{"default":{type:"solid",color:"#FFFFFFFF",shadow:{isInset:false,x:"1px",y:"1px",blur:"3px",color:"#FF000000"}},clicked:{type:"solid",color:"#FFFFFFFF"},selected:{type:"solid",color:"#FFFFFFFF"}}},overlayBg:{type:"background",data:{"default":{type:"solid",color:"#99000000"},clicked:{type:"solid",color:"#00000000"},selected:{type:"solid",color:"#00000000"}}},brdr:{type:"border",data:{"default":{left:{color:"#ffffffff",width:"3px"},right:{color:"#ffffffff",width:"3px"},bottom:{color:"#ffffffff",width:"3px"},top:{color:"#ffffffff",width:"3px"}},clicked:{bottom:{color:"#00000000",width:"0px"},right:{color:"#00000000",width:"0px"},left:{color:"#00000000",width:"0px"},top:{color:"#00000000",width:"0px"}},selected:{bottom:{color:"#00000000",width:"0px"},right:{color:"#00000000",width:"0px"},left:{color:"#00000000",width:"0px"},top:{color:"#00000000",width:"0px"}}}}}},coupons:{claimed:{txt:{type:"text",data:{"default":{color:"#FFFFFFFF"}}},bg:{type:"background",data:{"default":{type:"solid",color:"#FF9cba3e",shadow:{isInset:true,x:"0px",y:"-1px",blur:"3px",color:"#96000000"}}}},icn:{type:"icon",data:{"default":{type:"solid",color:"#FFFFFFFF",isBlack:false,isSimple:true}}},brdr:{type:"border",data:{"default":{bottom:{width:"1px",color:"#FF2a2a2a"}}}}},notClaimed:{bg:{type:"background",data:{"default":{type:"solid",color:{_replace:[{param:"hdrBg"}]},shadow:{isInset:true,x:"0px",y:"-1px",blur:"3px",color:"#96000000"}}}},brdr:{type:"border",data:{"default":{bottom:{style:"dotted",width:"1px",color:"#FF2A2A2A"}}}}}},punchcards:{bg:{type:"background",data:{"default":{type:"solid",color:{_replace:[{param:"contBbg",fn:"hsla",params:[1,1,1,0.7]}]}}}},watermarkSlot:{bgIcn:{type:"icon",data:{"default":{type:"solid",color:{_replace:[{param:"actBtn"}]},isBlack:true,isSimple:true}}},icn:{type:"icon",data:{"default":{type:"solid",color:"#4cFFFFFF",isBlack:false,isSimple:true},selected:{type:"solid",color:"#FFFFFFFF",isBlack:false,isSimple:true}}},txt:{type:"text",data:{"default":{color:"#FFFFFFFF"},selected:{color:{_replace:[{param:"actBtn"}]}}}}},slot:{bgIcn:{type:"icon",data:{"default":{type:"solid",color:{_replace:[{param:"actBtn"}]},isBlack:true,isSimple:true}}},icn:{type:"icon",data:{"default":{type:"solid",color:"#FFFFFFFF",isBlack:false,isSimple:true}}},txt:{type:"text",data:{"default":{color:{_replace:[{param:"actBtn"}]}}}}}}};c.template=b}}}; var testServiceData=(function(){var b=[];if(false){b.push({key:"DISCUSSION_MESSAGES_GET",result:{items:[{fromId:"100",ts:1359529950432,message:{text:"aaa bbb asda fasf asdgs drfg"}},{fromId:"100",ts:1359529000000,message:{text:"sdf sdf w4rt esgerty"}},{fromId:"123456",ts:1359520000000,message:{text:"It's me! again!"}},{fromId:"100",ts:1359500000000,message:{text:"hi, I'm another user"}},{fromId:"123456",ts:1359000000000,message:{text:"old message"}}],nextUrl:"http://...."}})}if(false){b.push({key:"ADS_POST",result:[{cId:"ConduitMobile2",displayType:2,imageUrl:"http://storage.conduit.com/Images/Mobile/ads/Banner_320x50.png",impressionId:"1ac37464-c6ea-462f-90dc-35fd3e9dbf0d",link:"http://ads.mobile.conduit-services.com/click/?link=http%3a%2f%2fmobile.conduit.com%2fWhy-Conduit-Mobile.aspx&appId=323666de-61b7-4aef-913b-3cc533ad532a&deviceType=1&cId=ConduitMobile2&displayType=2&imageUrl=http%3a%2f%2fstorage.conduit.com%2fImages%2fMobile%2fads%2fBanner_320x50.png&text=Conduit+Mobile&impId=1ac37464-c6ea-462f-90dc-35fd3e9dbf0d",slot:1,text:"Conduit Mobile"},{cId:"99999",displayType:2,imageUrl:"http://cdas.buzzcity.net/img.php?contentid=adc48bec0166df5c",impressionId:"ed57e64e-efd4-4285-8962-01e5a69ca713",link:"http://ads.mobile.conduit-services.com/click/?link=http%3a%2f%2fm2m1.inner-active.com%2fsimpleM2M%2fClientUpdateStatus%3fcn%3dConDoIt_ConDoItTest%26v%3dSm2m-1_5_1%26ci%3d99999%26s%3d1860345477%26cip%3d188-120-136-220%26po%3d559%26re%3d1%26lt%3d12%26cc%3dIL&appId=323666de-61b7-4aef-913b-3cc533ad532a&deviceType=1&cId=99999&displayType=2&imageUrl=http%3a%2f%2fcdas.buzzcity.net%2fimg.php%3fcontentid%3dadc48bec0166df5c&text=&impId=ed57e64e-efd4-4285-8962-01e5a69ca713",slot:1,text:""}]})}if(false){b.push({key:"DISCUSSION_MESSAGES_SEND_POST",result:{discussionId:"17"}})}if(false){b.push({key:"COMMUNITY_SOCIAL_LOGIN_POST",result:function(f,g){return{userId:"123456",profile:{id:"123456",img:{original:g.data.pictureUrl||""},name:"test_"+g.data.firstname,company:"company test",field:"test_"+g.data.industry,summary:"test_summary",country:"test_country",job_title:"test_"+g.data.sub_headline}}}})}if(false){b.push({key:"COMMUNITY_SOCIAL_LOGOUT_POST",result:{}})}if(TEST_LOYALTY||false){b.push({key:"CMS_COUPONS_GET",result:{items:[{id:"asd2",couponType:couponsEnums.couponType.DISCOUNT,claim:true,title:"Main title",description:"Description: In marketing, a coupon is a ticket or document that can be exchanged for a financial discount or rebate when purchasing a product. Customarily, coupons are issued by manufacturers of consumer packaged goods or by retailers, to be used in retail stores as a part of sales promotions. They are often widely distributed through mail, coupon envelopes, magazines, newspapers, the Internet, directly from the retailer, and mobile devices such as cell phones. Since only price conscious consumers are likely to spend the time to claim the savings, coupons function as a form of price discrimination, enabling retailers to offer a lower price only to those consumers who would otherwise go elsewhere. In addition, coupons can also be targeted selectively to regional markets in which price competition is great.",imageUrl:"https://encrypted-tbn1.gstatic.com/images?q=tbn:ANd9GcR5pd7BeJq7Wh1kbFYuo1iE68tkfpd8ye3S0q1UPPEAFxm8IgEU",largeImageUrl:"http://4.bp.blogspot.com/-0iGBZFMUnBU/UVoUKl7je-I/AAAAAAAACdg/892VnLbLGhk/s1600/Gift_Giving_Tips.jpg",dealDetails:"Deal details: Australian consumers first came in contact with couponing when Shop A Docket promoted offers and discounts on the back of shopping receipts in 1986.",disclaimer:"disclaimer text: Coupon manufacturers may or may not place restrictions on coupons limiting their transferability to ensure the coupons stay within the targeted market. Since such restrictions are not universal and are difficult and/or costly to enforce, limited coupon trading is tolerated in the industry. Organized coupon exchange clubs are commonly found in regions where coupons are distributed. Often coupons are available for purchase at some online sites, but since most coupons are not allowed to be sold, the fee is considered to be for the time and effort put into cutting out the coupons.",productDiscount:{discountType:couponsEnums.discountType.PERCENT,offerType:couponsEnums.offerType.DISCOUNT,price:200,discount:40,upperTitle:null,lowerTitle:null,offerTitle:"",currency:"USD",currencySymbol:"$"},validity:{validFrom:1369438194,validUntil:1369538194,hours:[{days:[1,2,3,4,5,6,7],startHour:"8:00",endHour:"16:30"}]},linkCaption:"",linkUrl:"http://www.nba.com",socialInfo:{title:"Buy a new giraffe in only 60$",imageUrl:"http://4.bp.blogspot.com/-0iGBZFMUnBU/UVoUKl7je-I/AAAAAAAACdg/892VnLbLGhk/s1600/Gift_Giving_Tips.jpg",url:""}},{id:"asd3",couponType:couponsEnums.couponType.DISCOUNT,claim:true,title:"Main title",description:"Description: In marketing, a coupon is a ticket or document that can be exchanged for a financial discount or rebate when purchasing a product. Customarily, coupons are issued by manufacturers of consumer packaged goods or by retailers, to be used in retail stores as a part of sales promotions. They are often widely distributed through mail, coupon envelopes, magazines, newspapers, the Internet, directly from the retailer, and mobile devices such as cell phones. Since only price conscious consumers are likely to spend the time to claim the savings, coupons function as a form of price discrimination, enabling retailers to offer a lower price only to those consumers who would otherwise go elsewhere. In addition, coupons can also be targeted selectively to regional markets in which price competition is great.",imageUrl:"https://encrypted-tbn1.gstatic.com/images?q=tbn:ANd9GcR5pd7BeJq7Wh1kbFYuo1iE68tkfpd8ye3S0q1UPPEAFxm8IgEU",largeImageUrl:"http://4.bp.blogspot.com/-0iGBZFMUnBU/UVoUKl7je-I/AAAAAAAACdg/892VnLbLGhk/s1600/Gift_Giving_Tips.jpg",dealDetails:"Deal details: Australian consumers first came in contact with couponing when Shop A Docket promoted offers and discounts on the back of shopping receipts in 1986.",disclaimer:"disclaimer text: Coupon manufacturers may or may not place restrictions on coupons limiting their transferability to ensure the coupons stay within the targeted market. Since such restrictions are not universal and are difficult and/or costly to enforce, limited coupon trading is tolerated in the industry. Organized coupon exchange clubs are commonly found in regions where coupons are distributed. Often coupons are available for purchase at some online sites, but since most coupons are not allowed to be sold, the fee is considered to be for the time and effort put into cutting out the coupons.",productDiscount:{discountType:couponsEnums.discountType.PERCENT,offerType:couponsEnums.offerType.CUSTOM_ICON,price:100,discount:40,imageUrl:"https://encrypted-tbn1.gstatic.com/images?q=tbn:ANd9GcTuT6Y_hEzyjx0IQZIMP4xVN840leccJXsNbI-IJzG1c2oWUvJofA",upperTitle:"{$HtmlTextCouponsTitleOffer}",lowerTitle:"{$HtmlTextCouponsPriceOff}",offerTitle:"",currency:"USD",currencySymbol:"$"},validity:{validFrom:3376543210,validUntil:3386543210,hours:[{days:[7,1,3],startHour:"13:00",endHour:"16:00"},{days:[7,5,6],startHour:"8:00",endHour:"12:00"},{days:[3],startHour:"23:45",endHour:"23:59"},{days:[1,2,4,6,7],startHour:"5:00",endHour:"5:30"}]},linkCaption:"{$HtmlTextCouponsTermsTitle}",linkUrl:"http://www.nba.com",socialInfo:{title:"Buy a new giraffe in only 60$",imageUrl:"http://4.bp.blogspot.com/-0iGBZFMUnBU/UVoUKl7je-I/AAAAAAAACdg/892VnLbLGhk/s1600/Gift_Giving_Tips.jpg",url:""}},{id:"asd",couponType:couponsEnums.couponType.DISCOUNT,claim:true,title:"Main title2",description:"Description..",imageUrl:"https://encrypted-tbn1.gstatic.com/images?q=tbn:ANd9GcR5pd7BeJq7Wh1kbFYuo1iE68tkfpd8ye3S0q1UPPEAFxm8IgEU",largeImageUrl:"http://4.bp.blogspot.com/-0iGBZFMUnBU/UVoUKl7je-I/AAAAAAAACdg/892VnLbLGhk/s1600/Gift_Giving_Tips.jpg",dealDetails:"Deal details: Australian consumers first came in contact with couponing when Shop A Docket promoted offers and discounts on the back of shopping receipts in 1986.",disclaimer:"disclaimer text: Coupon manufacturers may or may not place restrictions on coupons limiting their transferability to ensure the coupons stay within the targeted market. Since such restrictions are not universal and are difficult and/or costly to enforce, limited coupon trading is tolerated in the industry. Organized coupon exchange clubs are commonly found in regions where coupons are distributed. Often coupons are available for purchase at some online sites, but since most coupons are not allowed to be sold, the fee is considered to be for the time and effort put into cutting out the coupons.",productDiscount:{discountType:couponsEnums.discountType.MONEY,offerType:couponsEnums.offerType.DISCOUNT,price:10000,discount:4500,imageUrl:"",upperTitle:null,lowerTitle:null,offerTitle:"",currency:"USD",currencySymbol:"$"},validity:{validFrom:3376543210,validUntil:0,hours:null},linkCaption:"link",linkUrl:"http://www.google.com",socialInfo:{imageUrl:"http://4.bp.blogspot.com/-0iGBZFMUnBU/UVoUKl7je-I/AAAAAAAACdg/892VnLbLGhk/s1600/Gift_Giving_Tips.jpg"}},{id:"123",couponType:couponsEnums.couponType.DISCOUNT,claim:true,title:"Main title2",description:"Description: In marketing, a coupon is a ticket or document that can be exchanged for a financial discount or rebate when purchasing a product. Customarily, coupons are issued by manufacturers of consumer packaged goods or by retailers, to be used in retail stores as a part of sales promotions. They are often widely distributed through mail, coupon envelopes, magazines, newspapers, the Internet, directly from the retailer, and mobile devices such as cell phones. Since only price conscious consumers are likely to spend the time to claim the savings, coupons function as a form of price discrimination, enabling retailers to offer a lower price only to those consumers who would otherwise go elsewhere. In addition, coupons can also be targeted selectively to regional markets in which price competition is great.",imageUrl:"https://encrypted-tbn1.gstatic.com/images?q=tbn:ANd9GcR5pd7BeJq7Wh1kbFYuo1iE68tkfpd8ye3S0q1UPPEAFxm8IgEU",largeImageUrl:"http://4.bp.blogspot.com/-0iGBZFMUnBU/UVoUKl7je-I/AAAAAAAACdg/892VnLbLGhk/s1600/Gift_Giving_Tips.jpg",dealDetails:"Deal details: Australian consumers first came in contact with couponing when Shop A Docket promoted offers and discounts on the back of shopping receipts in 1986.",disclaimer:"disclaimer text: Coupon manufacturers may or may not place restrictions on coupons limiting their transferability to ensure the coupons stay within the targeted market. Since such restrictions are not universal and are difficult and/or costly to enforce, limited coupon trading is tolerated in the industry. Organized coupon exchange clubs are commonly found in regions where coupons are distributed. Often coupons are available for purchase at some online sites, but since most coupons are not allowed to be sold, the fee is considered to be for the time and effort put into cutting out the coupons.",productDiscount:{discountType:couponsEnums.discountType.MONEY,offerType:couponsEnums.offerType.FINAL_PRICE,price:10000000,discount:5,imageUrl:"",upperTitle:"",lowerTitle:"",offerTitle:"",currency:"USD",currencySymbol:"$"},validity:{validFrom:0,validUntil:0,hours:[{days:[1,2,3,4,5],startHour:"08:00",endHour:"16:30"}]},linkCaption:"",linkUrl:"",socialInfo:{}}],nextUrl:"http://...."}})}if(TEST_LOYALTY||false){var e={id:"123456789",title:"Itsik-Bitsik-Coffee loyalty card",offerTitle:"9+1",icons:{"default":{whole:{bg:"http://storage.conduit.com/mobile/anyorigin/resources/bg.svg"},punched:{bg:"http://storage.conduit.com/mobile/anyorigin/resources/bg.svg",overlay:"http://storage.conduit.com/mobile/anyorigin/resources/stamp.svg"}},bonus:{whole:{bg:"http://storage.conduit.com/mobile/anyorigin/resources/bg.svg",overlay:"http://storage.conduit.com/mobile/anyorigin/resources/bag.svg"},punched:{bg:"http://storage.conduit.com/mobile/anyorigin/resources/bg.svg",overlay:"http://storage.conduit.com/mobile/anyorigin/resources/bag.svg"}},bonus2:{whole:{bg:"http://storage.conduit.com/mobile/anyorigin/resources/bg.svg",overlay:"http://storage.conduit.com/mobile/anyorigin/resources/icecream.svg"},punched:{bg:"http://storage.conduit.com/mobile/anyorigin/resources/bg.svg",overlay:"http://storage.conduit.com/mobile/anyorigin/resources/paw.svg"}}},images:{header:"data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAkGBwgHBgkIBxQWCgkLGSAZDQwYGSIfIRwgIBwkIicnHyojJCgsJCYmKCklKjUtLCwrLjowJCI4PDMsPTQwLisBCgoKDg0OGxAQGywlICQ3LC02ODQvLCwsNTQ0NSwsLCwtNCwsLCwsLC8sLCwsLCw0LCwsLCwsNDQsLCwsLDQsLP/AABEIACgAoAMBEQACEQEDEQH/xAAbAAABBQEBAAAAAAAAAAAAAAAGAAEEBQcDAv/EADkQAAEDAgQDBgMHAgcAAAAAAAECAwQFEQAGITESQVEHEyJhcYEUMkIjUmKRobHBM9EVJHKCkuHx/8QAGgEAAgMBAQAAAAAAAAAAAAAAAAMBBAUCBv/EADARAAICAgEDAwMCBAcAAAAAAAECAAMEERIhMUEFE1EyYXEUIpGhsdEjJDNCgeHx/9oADAMBAAIRAxEAPwDccEIsEIx0wQkGr1SFSITkyeoNso3PXyHU45ZlUbMbRQ9zcax1mdxarmHtAmONU5SqTRmzZx1PzHyv19NvPFcM1h0O02nx6MBd2fuf4kmn06NTs7xaZRW3ErjDjnTVLJ4kkHwnkbnXEpWFaLsve3GL2nYPYTRknXXFqYY+D3j6YiG4+CEbBJ6dzFdIFzoBg1qA6mZ/XM8S51T/AMFyegSJR+eUflT6dfXb1xWe4k8VmzR6eiJ7uSdDwJAGWTLXITLfXMejgmbUlKNmyBcpZTe3EBueWm+wj2x3EYM729FV0D2Hz+ZMYyG1XKHDly332qk4gKLpcKrEjof4tjr2ARsRY9TaiwqijjKNdVzZkCQlqpXqFOOiVqJIPordJPQ398J5WV/iXTVhZyck/a8vqrnZ6cpunUi0F1QHxct0izF+XQq30uNvya12/plOr03gOdnX4HzI9Mr9MoVRltQnXay++EJZaCytS1DiKlEnRINwPbbEBwvaTfi23IOahQP5Q5ojU/ulSKqR8U7u0k+FA+6Ovmef6YsLvuZlXGvlqvtLPHUTFghFghGOCE4y5DUVhyQ+eBpsXWs8gMQTobkqpYgDzMTlyZ3aTmlEdq7MFq5SN+BH3j+I4o7959eJ6xUX02jkfqM0mt1elZGoLLaAAEjhjxwbcRHX+TiztahoTAopszLSf4mUtLnV+TFptdffATNdSlFPSgcPASb673A19j7cVsT1Mt5FNNbtQq/T5kvMObZUiqpoGVQl+er+tIOqWx/Nv7Yl7Ty4rF42CqV+9f0Xx95HyxmYxotXlVOQqfT4XCkSlICbr8XElFvmHy29cC2FT1k5WJydVrXRPj7feU87NNfdpLmZFuimwieGDD4QouH8RPK3THBsYjlLSYdHIUAbbyfAl9BdzfIyc3IaKXqpKIUniskIR/JP84YvNlBlO0Yq5OtftEHc5ZkqTrcbK0JXxM9dkzHk6cSj9Keg6/8AuFXWHfETQwcStWORYNL4hPTKAMmZRmrhjval3ZU46BubcvIYctftr95nW5Jy8gA9F8T3EbYqsCNRqPddIQP81M5Oc+FP3irdStrdb6AHgdotmNTGx/q8CGCdBpthvaUTvcB+0XMb8RLFCow7yqTtBb6Adj6nl0sThNz/AOwdzNT03ERt3WHSr/OV68jUpmNT6LYyJw8bygohIBOqlAf8U++wvjj2gBod44+pWljb47CGtGy9SqIgppjSWCfmWBqfU74eECzMuyrbv9RtiWoFjjrrK8fEwiwQiwQjHBCZt2zVtUaBGpLBsqVdTp/Cm2nuf2OK2S+hxm76JjCxzY3YS07L6Kij5bEx7R+b9o4ron6R+Wvvgx04JsxHq2S2RfxHYdIK5bvnrPb9Tl+KFB8TTR6X8I97FR9MJU+6+/iaGR/ksQIvdu89Z0VCbiTapDKmoylluGlCyErcN+NwAHYC4031wy4Beoi/T+bOKyNnz+PiEPZdRWaNl01STZD0wcSlH6UDYeQ5n1x1jpxTZlT1XIN9oqTsvQQYfdaz5mximQh3NCiErUE6BXVWm3FsPInC2PuNoS+gbCxzY3V26TrJfh5uzUVulLWXKGm5OySP7KI/JOA6sfQ7CcgPiY/y7wuzNmh+k5UXUHEfDS5B4YrJ3F9irzA1I5bYda/FZm4eF7+QEB2PMEOzmFFo1MlZtrR4U7ME6k66nzKjp+Z54TjjQLNNP1Ow2WDGq/5hXRc11WpPw5L8VMalTVcDKyu69iQSLWsbWw+tyeszLsOpEYK23Xx4k3MWa2qVOYpcBHx1VkH7OODYDzUdbDEvdroIvHwjahsc6URm8yvwqZVZFeQhl6nkBQQokKukEWvz1tiDaddZP6RXtQVHfKBGR/iptSk1x9IlViZcRmjsgbFa+iRsBubHrhFQ2eXmavqBCItHZV/n9pcs5kXGnP07LaE1WWjx1GouK4UXGnK+g1A5Dz3wz3NNxEqHD5pzv/aD0UCWuR83y81SJKgwI0Jm1neO5JPK3CBpz16Y7qtLyvm4SYwC72YYjDtzNA0I+CTFghFghGVtghMN7XFKdziWnNEBtAHve+M/JP8AiAT1voo1jEj5mzPw0uUxyG34EKQUJI5Ai2L3canluf8Aicz8zN8q9nFXgyHU1B/uITmjrTRN3AOR2sP1xWroZSevSbmZ6tVcgCrsjzCPPmUl12iRYlM4WVxFXabOgtw2t5YZfTyXSyl6bnii0vZvrOVByzWTTmIeY3kuRWAA3EQNDbbjP1AdLW64gVvx0TJyMuk2c6VO/kwaovZtW4qJ6XnwwHUFASgn7TpxHkL721wtcd16gzQyPV6W4HhvXzLjJGQnqUC7Wlh0BQWiIn5QofUr7xHLkMMppK9DKmf6mtvSoaHz5g12zTXJFejQkXKYzdwnqVn/AKGEZB24E0fQ6gtLW+YR5jyhOrLlKocVXw1LgNjvXrfMo6eEcyAD5eLDmQtodpnY2etXO09WaSs1VlilgOxwDHowshPIvKTwpSP9Kbk+oxLvwHGLxaGubTd3/pKDLFAW3Q3c2VJ0t1JZ71h0i+mosRfXj2t6W2xwi9OfmXcvLUWfpkH7exlZmv8AxmbUIeX5fAmVOWHX0oubKXoAq/JCR+mOHJZwssYS1JU2Qm9L0/8APzLzOcqPlelsZYy2i02bo4ofNY6C55qVt6Xx3aAv7F7mVcJGyrDk3/SJAzGyMuUGFlCj/aVOfYy1jnewt7/sDjhv2pwHeOxT+otbJs+le0PcnRItKiGjxLrVDA797kVq1Pv19sWqlCjpMTNsa9/cbzCMYZKkfBCLBCLBCMcEgwA7S8mSK/3M+mWMtpJSto6caeVjyI1/PFe+nl1E2vS/URjko/Yzll7NlfisIgVqBIddaAAfbF7263sPcE4iu1x0KwycOgsXqtHXwYRoqldlgfCQ/hwfqfdAt7ICr/mMMDOZRamlfqff4/7idpWYJgPxEwRgfpZaAt7qUr9sQUdu5gt1KHom/wAmCmYuz6tOtrehznpTgH9FwkX9CFWv7YU1D+Gmnj+p0A6eoD8Sky1lnO62xKiurhDklxZ1t+HXHCV3DzLeXmYX0kA/iaNQ51aaCY2Ymgh06JlNm6Feo3Sf0xbRm8iYF1dRO6j0+IHdquVKhOnNValoL4KeF5CfmFtiOu+EX1knkJrej51aIarTqW9Iqebq/FSw4wKVpZ2cskn/AGIIGp89B546RncaI1Kl1WNSdhuX2/vKztNy7KTRKXDora3o7KlF1KfEoqI0UepPiufPC8hG4gCWvSMtVuZrCBv5/pLzK1Jq8qNBczEEstw0gRoaeoFgpzU3I5DYanpZ1aka3KWVbUjMKTvfc/2gxUqXmFvtMdqEFjvxe7LqvkAKbany10whlY27AmjVkY74IrsbWvHmQxl7MzWflSUI+KebXxCW4LIN02vpyF9ANdMc+24s5ajf1eKcLh2+3mesv0HNL+bpcx5PdvXUFz3E6C5txIF9TbYbDHSI5fZE5ysnEGMET+H95rFMgM02G3Fj34EczqSTuSeZO5OLk85ZYbG5GSxiZxHwQiwQn//Z",background:"data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAkGBhISERUTEhQWFRUVFRcaGBgYFxcXFBcYFBcXGBgYGxgXHicfGBwkGhYaIC8hJicpLCwsFx8xNTAqNSYrLCkBCQoKDgwOGg8PGi8kHyQvMi0vMCwsLSksLC8wLy0pLCw0LywsLCwsLCwtLCwsLywsKiwsKSwqLCwsKSwsLCwsLP/AABEIAQsAvQMBIgACEQEDEQH/xAAbAAACAwEBAQAAAAAAAAAAAAAFBgADBAcCAf/EAEoQAAIAAwQECAkJBgYDAQAAAAECAAMRBBIhMQUGQVETIjJhcYGRoRVCUnKSsbLB0QcUIzNTYnOiw4KDk7PC0iQ0Q2Ph8BZEo+L/xAAbAQABBQEBAAAAAAAAAAAAAAAFAAIDBAYBB//EADgRAAEDAgMDCgUEAQUAAAAAAAEAAgMEEQUhMRJBURMiYXGBkaGx0fAGFDLB8SMzNOFCFSRScrL/2gAMAwEAAhEDEQA/APdlsaNLRmRGZkUklVJJKgkkkVJJ2xb4PlfZy/QX4RZYF+il/hp7IjRdjSNAsMljnl20c1j8Hyvs5foL8Ing+V9nL9BfhGy7Euw6w4Jt3cVj8Hyvs5foL8Ing+V9nL9BfhGy7EuwrDgld3FY/B8r7OX6C/CJ4PlfZy/QX4RsuxLsKw4JXdxWPwfK+zl+gvwieD5X2cv0F+EbLsS7CsOCV3cVj8Hyvs5foL8Ing+V9nL9BfhGy7EuwrDgld3FY/B8r7OX6C/CJ4PlfZy/QX4Rsux8pHLBK7uKyeD5X2cv0F+ETwfK+zl+gvwjYiVpTGuVMaw46G1KUANPxPkA0A6SMz/3GIpZY4xdynhhlmNmlIaaMlk0EpCdwlqT6o1pqs5ysv8A8R/bHVrNZ5acVFVabFAHqi+KBruDUUbhh/yeVyJ9V2Gdlp+5H9sZG0bLBoZSA86KD6o7RFFpsUuYKOisOcAwm13FqTsMP+LyuO+D5X2cv0F+ETwfK+zl+gvwh701qUKF5FajxCag+aTt5jCgUi/FKyUXahc0MsJs4rH4PlfZy/QX4QI1gYygnBEy716vB8StLtK3aVpU9ph20Zq1On4qt1fKbAdW0wK191V4ESKzKluEyWgFOD3nniKeaINLd6s0kExeHWNl80ev0Mv8NPYEaLsV6PX6GV+GnsCNF2JwclUcOcVXdiXYsuxLsdum2Vd2PPUc6VphWlaV30xjVZJcu/SYMGyYMwKnKhoeSe49OF8ywFJhlULrMU0IpeUoaqzbBQnPbWlKjHO12OtpZTC9pDhnno5u+xvqBuPCyK0+GmZgeDcHLLUHdfoQ5RlgRUBhXarYg9Bj6dnPlvPQNsErfo51SWQAzKgRgDSpqLtK5ipI68oJ2DRyyhvcjjNtPRuXcPfAyX4tijpWyAbTySLDICx1PWLK03BXOmLb2aLZpdezsoBZGUE0BIpjQmlDjkDsjzdjdpO08JMoOSlQNxbxj1cn0t8ZbsaPC6ioqKZs1QAHOzsNw3aoXWQxxSlkRuB5qu7Hxl3ZxbdiXYJXVSytl6KdpYdGD1HJpdYEYEZkEg4Uwyzj7KsClZRpQk0Ipi4LBlYjmBxJ34xbokzL5Eul08smt1TTMb2pTDorTaak2dUrTMnEnNjnie3DIbI8uxbFqqlmdTvftlpu0i17EEEOt0HruFsKOjhlYJQ21xmN2RvcKaPs1nl35pW9NE03UBpiygjijADM1I2ExonWiZM5bHzVqqY9GLdZ6hGIMvCFjUkC6tFJ4uBNCAc2z80Ro0LdtlSh+iVir5hyRmoGag1zOzIY1A8VddXiOmiuA0AE38b/AGRAQxQ3fbUrdq/o8XuGugChCUAF6vKfDYaADmqdog9HxVAFBkI+xtaWnbTRCJu7x6VRe4uNypEiRIspqkYG0DZyxYylJJqSRWpOcb4kdDiNCmua12ouvirTAQg/Kr/6/wC9/Sh/hA+VX/1/3v6UcTkH0cv0Mr8KX7CxouxXo1foZX4Uv2FjTdg8Dkss4ZlVXYl2PbUGfRvJJyAAzPNGqRot2xbiDdgX/tX80UK7FKahbed1uA1J7FYp6OWoNmD0WJZJc3FFSRtyAO1ubm2+o5ZLKspKVyHGZjiabzsAGQyAiyz2ZUFFFN+0k7yTiTFjKCKHEHOPKsbxx+JyAWswaDf1n0WtoaFtK3i46oXO0uhmmTisxCrXXFK1ANM86ODTPmNCIx6x6XmyODrdCuWDFbxYAUyY5Z7q4YGDBkS1cNcW+2F6gv0AzvZ0Aw6wIy6xaMM+Qyry14ydI2dYJHXFWKenZURuazmj/lndXCwuaQT3IYiCgplTCmVNkfbsYtXyTIAIIusyiu5Tl1ZdUWaW0mkhVZ71GYLxQC2JAwrhXH155R7N8y0QcsRla6wpp3csYhreyvJFabTkACWPQBiY22bRDti/EXdXjnrGCjv6I9as6Zs1oRzZwQEa614UY7mJqSwIxFT2QYjznFfiqqeXQwt5P/1/XvNaOlweJlnSHaPgvMqUFAVQABkBkIH6Y0SZ6Ml4KCVxukkBaEqOMBQkerOkbGta1IBvEbFF49dMB10jyRMfDkDmNX7sF6cYyUMssL+UBseJz160ZIBFl9sVm4NApYuQFF5qVN0BRWnMBC7qbpX5pbpsqa1EmF12kXkJZDl5F6D9pt8mSovuiAYAEgZbAMzCiukZVotpmS0N0JdvEUvPsNNlUDAbSFOVI0Pw+ZZK3afeztSfe9Vat4jgcQNAutybdLfkup6CIurHNrsfRWPTDR8Cs0MQO9viujvMAzIHSaREcEVBBB2jKOblY02PSE2VyGIG7New4Q00ZtkU4YgL5tyXQYkK0jW5xy0B5wSO41jamtsrarjqB98QGnkG5Wm1UR3o5CB8qv8A6/739KGb/wAqk/f9H/mEf5StPS5nAXQ2HC5028HzwwxPGoTxPGTYFe9GL9DK/Cl+wsabsadE6EnGzySEwMqXtXyF549T7C6cpWHSMO2CjZGnQoK+JwJJCDaUkzjwZkTFlsJi1ZsgtRXYcwLv7VKipi/VC22oypgttAyTCFY3ReWla4YEA5HaOiNZSKE0dKBBEtARkQoBHRSM7i+Cf6g4uDgL21GeXA/ZEqOv+XZsEXRZraKcUFufkp6TUB6qxne2DxpgHNLq7dbUPqHTGb5uta0BO8ip7THu7AmH4Pjb9cncPW/krL8YP+Le8qWnSsuSjuJbtQVagF4gZkl2qaD1QsaQ+UN2BEhAn3mIZh0DIHprDLMkhgVIqCCCN4OB7o5BbLMZE55e1GK9IBw7RQ9cOqvh2lprPbd3/Y39ArFFXPnuHeC6Pq9ZXSSrOSeGvTMcTUnHnxFG62gmyHArdvKai8Ly1ptHwOwRunyKyFujFFVlHmrl1rUdcZ1oRUZHLrgjgNa3EKR0MovskgjoOnp2IdiMJgnEjMr59qw6JsnzYMsmXLQO15qXzU815jQbhkI2PNZuVRvOJYegt1fXHu7Euxc/0CgL9ssuekn1UJxGotba8AvJnzMr9BuUKo9RPfFM+z3wVYsagjFmOeGRNI0XYl2L0WHUkP7cTR2DzVZ9RM/6nHvXIFthDUcDOh3gjAx1HReiBIsSkjj1WY2/ZXsQkdu+OcaW0aRapq0oOFbrBNR6469pG1y5Un6Vrqlbu8kkUoAMzGAxWV1PPEI9Q69h0Fa5rRLEb7x5rDdiXY82Gdflo/lKD2jHvi+7HpgcCLhYotsbFVXYl2LbsS7HbrllVdiXYtuxLsK6VlVdhY13XCT0zP04bLsK2vIwk9Mz9OGSHmlTQDnhdZ1e/wApZ/wJXsLG9lBFDiIG6vzl+aWfEfUSto8hYIo4IqCCObGA6PZIX/45Lv3qm7Xk7Oiu6CEqyIooqqOoRdEh5e52pTGxsboFVMsqMKMqnpAgZP1almpUlebMfHvgnabUqLVjT1nmEDX1jXYp66CHx8p/io5eS0egVssLS2ut1HYRHPtd9FhZ6zafWLT9pKD2SvZHRbXaWmNeb/gCF/W2w8JZmIzl8cdC8r8pPZEtXGZKcg66qpTPEc4I00Xq16ZeVYJMyXymWWoOd3iYnHbxe+KtWLcZkoqxqyGh6Dip9Y/ZjzqsEtViMiZ4jXcMxjeRhzjEdUW6P1cayvf4QOhopF2hxIoxxOR7mMYXA6yKjqnRPyLjbrvoj1fDysBI1Gfqit2Jdiy7Eux6PdZSyruxLsWXYl2FdKyQNZpIW245NwbHuUn8p7IPa+yXrLfxAGHMGJBx6QPywJ+UTiNJenKV1w+6QR7UPWjrUs6TLcUZXRTvGIxHbUdUeb/EBNNVtltcXPiFrqB21C1L2qc69Z6eQ7DqNHHtQaux9myFSYLoC3k2AAEoebmePd2NphNWKqjZKOFu7JZ2tj2J3Dpv3qu7EuxZdiXYKXVOyruxLsWXYl2FdKyruwq69jCT0zP04brsKmvowkdMz9OI5DzVLCOeEzaKT6CT+DK9hY3SprLySR0Rm0Sv+Hk/gyv5axquxwWITzcHJaRped5XcPhHx9Kzj41OgARnuxLsN2G8E7bfxXiYxY1JJPPjHm7Ft2Jdh90yyquxGl1FCKg59Bi27EuwrrllzHVec9j0kbP4ruZZG8YmWw3YEdpjp82WGUqciCD0GELXvR/B2iVaVFCQBXc8s1U9N00/Zg5pzWVkkSnlUrOFanG6ABXDImpp1GPMseonfON5PIn8jw8lq6STlIgSi9nJK48oVDdK4E9efXFl2FnVPTbzJry5rXiy3lNACSmBHFAB4tPQhrux6FRTmaBrna2z696zlTDyUpaqrsS7Ft2Jdi3dV7JO+Uqy1sqNTkTV/MrD10gnqAP8DLFcQXrzG+TTsIjRrXZr9jmjcoYfsMG9QMLWrluZbDaQhoyEEEZgOApPNQKcdmcYv4oiMgaBvI9PutBhjuYR0pstukZN9F4RL4cC7eW9xqpSmebA05o1XY5arlcVwK4jZiuI7xHVJLhlDDJgCOhhUeuCPw9GIIHQg3sb9/4VfFY7Pa7iF5uxLsW3Yl2NHdB7Kq7H27Fl2JdhXSsqrsKev64SOmb+nDjdhR+UEYSOmb+nDHnmqSIc4Jm0T/l5P4Mr+Wsaoy6J/wAvJ/Blfy1jVHRouHVSJEjJpTSsqzyzNmtdUdpOxVG0ndCJtmUmtLjYaqy3W6XJltMmsFRRiT6ucnYNsLMj5TrE3K4VOlAaeiTCFrNrTNtj1biy1PEl1wHOd7U29nOFDEYg0MDJK07XM0WqpMDYWXqCbnhuXa7LrlYphAWelSaAG8pqfOAgzHAg4IzXnBA+MdA1H10Bu2e0OpOUp657kapz3Hq3VkgrNs7L8kzEsA+Xj5aA7QGul+vJMmt2j+Fsr0FWTjrvqmfat4Qu6t2VbXZjIZrryWvI2dFmZgjaKg90PZG+ONzrM1ktzy1LLdchSDQ3TxkNRzEQNxukMrQ9hsRv99oQ/DJMyxO+jdT5sqYJhdapxlC1N4iuBJAoDltzhrlTAwDDEEAjoOIjBq9pMz5Cu3KBKtuJXb1gg9capHFZk57w6HJr2NXqIgR8O4jIah9LMc9R1jXvGfYpcTiu0SDdkr4kSJG5QJVWuziZLdD46svpAj3xzjUjTkqVOdZporpQkg3ag7dwxOJwjplY4za7NwVumpumTAOgkkd1IBY1Ttmhs5FsMdzi1dSlasWUMHEsbwKsU3jik090bbGKKV8lmXqBqv5SIw6qMxskq9uYDzQ7Bfy0jcmExh5QVusVU9wWMr8OVL48QdC917gjuz9VcxJm1DtcCr49FDuPZG/RryRQtyufLqgqJ6HC8p6xHoDpS02sgrIQ4XulmJDLLsiLkojDbnkY+V93f05QhNc5BddBsi5KEQofKFlI6Zv6cN8KHyhZSOmb+nEj9FFF9QTLon/LyfwZX8tY1Rl0T/l5P4Mr+WsaocNEw6ofpvTkqyyzMmnmVRynO5R78htjj+sGsM21zL8w0ArcQclAd287zt6KAdG+UGxS2kozS1ZhMABoL1Crkip2VANOaEP5jL+y9n+6AuIVRY/k9y0mDtiY3lSLu8kBiQdNil/Z94/uj4LBK+zPpD+6BnLjgtB803ggiuRiM+4xes+vjL0Ef8wUOjpf2bel/wDqNuiNDSWdrwZeKKVY4mvM0cdVMaLkFWoK7ZOzuKZNSNdRMu2ee4MzKW/l/davjbjt6c8fymaMImyrQg5QuN0pxl7QT6MaNHavWdpssFCQWNQQ4BorNmTzQy606P4WyzFGai+vSmNOsVHXBWnmNZSuPDS/QsjiLYaatBiyBzI3C/DMr3qzYeCsyCoJfjkjKrgGg6BQdUedJ6alSp0tSxvkgEAVAV8KsdmIU78N0ZNRrfwllC7ZZK9R4y9xp1QraxyyLTODbXJ6VIF38tB1RgKFrmYgZHHNpv1/1ZX3sErC0710mJA7V7SHDWdHPKHFbzlwJ68D1wRj1djg9ocN6yLmlri07lI5vp/RIOlheJCTGlE0wNGAQ0OzEGOkQj6+pctEib93vluG/qgdijSaZ1ve5XKB1ph0p1RFlpQUVEXoCqo9QAhcsWtQnWpECUQh1VjyjUBhUbAbmWeUGtNSy9nmhczLanPhWnWI5vY7TwcxJg8VlbqBBPdWPPcBa1swndqD+VoZ2cpG5vQuqRIkSPVVkF9LHeY+RIkcSUhQ+ULKR0zf04b4UPlCykdM39OGv0UkX1BMuif8vJ/Blfy1jVGXRP8Al5P4Mr+WsaocNEw6pc18WtmXCv0q7aeK+0Qg3D5A9M/COga9AfNcafWJnl40c9ov+13fGM3in73YtFhn7PaiWj7MpTFRW8dpPik54bo926xqJRIUVqm0jM447I+aNcBDTHjHkqSOTzA7++Lra4Mhgf8Ab5SkDBlG0CM+S4SdqOgDY7EHuHyB6Z+EE9AtSY2SVTeWrRlyBp74FcX/AGu74wT1fYCYxBQcQ4gfeXnief8AbKhh+sJr0Qaz05R5WYAHJOygO2GWFrQqVnqeNgr4thsHi7OwQyxosCFqTtKz2NG9V2BIGitJpYLdOkTLwRsiBUAcpDTPksRhuhq0noSTa1V6404sxKGoOI5mH/cIVflNsN15NpHmN1VZe68OoQb1EnEyXHiq/F/aUEjtx/ajJ4/R/LSmoiNiiFHJykQK26H0OLKbocsJhxqAKMowoBvUEHHxRBePFplFlIGeY5mGI7wIkmaGUMNo7ObpGXVB74ZxB1TTmOQ3c0+B0QrEodmTbG9e4UPlLWlnlvSt2bTqdW96iG+AOvUi/YJ33Qrei6k91Y0dQ3bicOhUad2zK09K+6qayLaJaqRdmKimlahgAAWB6cxsqM41ztWrK7FmlCpNTQsAd9VBA7oS/k8lM01GGSI947MaqB1k9x3R0ePIK9vytQRCSL8CtcNFRYq8GoOJXik7yhK17oujPZ2AeYoIrVWI3X195QmNEes0E/L00cvED+1kZ2bEjm9KkSJEi6oVIUPlCykdM39OG+FD5QspHTN/Thj9FJF9QQ+wWyZwUv6SZ9Wn+o/kjni/55N+0mfxH+MBJi2gyZYk3V+jTjE8bkjLCg6YBzNX7SKnPbW+K98Y5rnuJvLbtPquPcQbAJp0zaXMujTHIvDlMzDbsJgJe+8vo/8AMYrNoq0h1JVwAccQaZg4VOW6kEWs7j7T0K+pYbICDm7a8fVHMNlaIyHZG+9ENG0KHI8bdTxTF1sX6B8hhL2ffSM+jmIBBrWtReBU0u0yujCpEaLW30LjaQlKVJwZdlOaB7geU7R5o82aMs+oacUFvfeX0f8AmCWgG+kY3lwTOlKcZefGBpY+VM/hn+yN2hZ12YTxm4ppVCKGq5cUY9YixK0lhCgjlY1wJI70cnTCCCpcHHjXipOWAApQdmyPnzyb9rM/iP8AGKGJJqefnOO89WQoOnOPsQxSSRtDQ4jqKz+IzMmnL2aLPpoPNksrO7U4wBZjiuORPSOuGzUsJ8zlXBvvbywJBJ56Ad0LZFcI3/J3a+JNknNGvDr4rd6jtiniZfLTkkk2IP2U+Gv1amHT1oaXZprIaMFwO0VIFRzisIuirfMAKCZMAGIAdgKE45Hysf2o6LaLOroyMKqwII5jCRadSp6v9GVYVwa8FYdIPurXuinhNUyFrml2yTv0V+phEzNnfuXr55N+1mfxH+MUW20O0t1aZMIKMCC70IIPPBGbq7PRRlMwFSmBrt4pzHOOwQJ0m3BqyzKoSjUDArXAjCvPBqOtdJ9EhPaUAdBJG7MJg+T6Qq2MXQAS7VO00OFTtwg/bZ9yW7jxUZvRUn3QufJ5OrZmXyZntKp9xhodAQQcQQQRvBwMZWtyqnbXFaZv0rmOj7a4mk32BmA3iGILMDXGhxzaC3zyb9rM/iP8Y9WrUWbeIlsjJXAsSGA56DMbx3RrmasTkUUYTTTHJWrzVNCOeoPNGlGJMAAZLbouR+EKraVzncowXWL55N+1mfxH+MT57N+1mfxH+MZ7W/BELNBQkVowIwrStRhmN8fJc5W5LA9BB9UWBUTEXDzbrKEljm6hafns37WZ/Ef4wv62WlyJVXc4vm7HyN5g1AHWrKV0v/RFimnldIAXHvK6z6kXsP1Uv8NPZEENGSL85RsXjn9mlPzEHqgbYxWXJFbt5UFQAT9XhnhmBBbRlnaXOQl7wNV5NDxhUYg71Ay2wMqn7IcL552RKho3yOEtrtBzWjTej6Vmrl44/r+PNjsNRUNzoCCDkRQ9BwhPk2abdAuqRSh4+OGBwK59cU6GfaZsuOis11A979uJt76onYNECZKLnBnxRvJArd6mqSd4I3CBxBBIIoQaEbiP++qGbRjEyZd6lbgBplVRQ94gTrAtJikKTeQ1uqSeIVzpzPDaeoc6ZzHdNuiydV0Q5FpYMx4oeFJIVeUxoOk+4ZnmBjTb9H8CQKllOROdRmD6xzV3RZoIgzsQahGIqrCmKg8oZ0Prg3brMHlsp3VG8EYgjrh81UY5g3dv99Cip6APpyXZO8rJXj3KszveuCt0VPPuUfeONOjnimVNDAGoxAyO+GTQsoCShHjqHJ3lwD8B0ARPVTcgy41VShpRO8h2gS6pqKiMurts4K345O5Q/vKEfmKwX0tZBLmYZPVqbiCL3USQekmF+z6KM/SAWpVQiu1DQlVotBzk0FdmJiZrmSwuJ0LSpKeN0NQY10uz25XZlFcMjsYDAld4DYdmwiNECZyFQDLAvJyRkDhS5XYCMObA7I3aOtonSkmgEB1DUOYrGUkjAG23TT31o4RsmxV0yYFBLEAAVJOQAgVrJoqXPkMWwKo5VhmOLWnODTKLrRMvtTxEPpOD6lPf5sYNKz7ljtKZXZEwp5rKRTqY06CsTU8bmvaWmzrjxXHA7N0J+Teb9cvmH2hDtHHtVNOTbPMYpdIu0IYE4V5iD646NJnzmVZswXXArwak0C+MDXNiOwgDeSQxSjcJy8kWPnZNZchG4kfEcEAg1BFQd4ORjxaLQEWp6ABmScgOeAQaSbJyxaa0IlpQAm6y1usMxXMEbQaDDm2QhaV0HMkH6VQRXBxip69h5jQ9MdBsNpYsyvStLwplTIrXbQ0x23h1a5ksMCGAIOBBFQRzg5wTp62SlOwc2+9Fyy5VLtDrkx6G4w78R1GB+sekAwl1BUgvvI8TIgQ9ab1SljGSSrmtJeanoJxQDacQKjDIFK1n0FPRZJKghwxBDA7E30IOO6NPQ1UUz2kHvyOipz00ThtWsUbsi1lS9nElkHcQFIPaI1G2zRQ1Q3SG5LA8UgnG8dg3RmsP1Uv8NPZEXkRFI0FxuEHiqpYbhjrApvhbtNq4OZMQISA5OBXx6PkxHlwa0VNvSUJzugHpXinvECNOJSdXykB9EkHuKwEpGgSujd7stJU1L4oeVj6O4ojoS0XpZwIo7ChpXHjbCR42+PGm3C8G5yDEVoTylJ2eaIp1emYzF81u2oPsjtjRp+XWTXyXQ/mCnuYxwsDavZ3E+a7HUOdByw1tfuWOwW5GmpdcHlAjbySculRB2kK1jek2WfvgelxffDTHK6MMe23D7rtLVmqaXkWS5ZrIhRSUUmgzUZgY7INaNAEpAMgoHZh7oVjZVDNgKh5mOR5bbRDNob6hOg9zGJq6PZZe981yGtbO8sDbELHpuzh5kuteRMyJHjSt0Z9E6NRLTfBYkymXE1FA6Ed5izWJiHlUJXCZlTfK3g7oo0LOc2gAtUcFMOIFah5O4DYYfGH/AC1wcrHLtKRnpxLyZbz+NvumImBdh0vPWWgAlEBFGIdTgoGd4+qCc08U9B9UYZWhZoRSDLPFG1l2DmMD4SzZIfbtVv8ATv8AqLRYCTLUnMipplViT74F62qzSTLRSzTEYAVUZNLJJLEYfGCtg+ql+YvsiBGsekkkurzK3QtKgVoXOApn/pnsiWnBNRdouQSU0hpFnGwS5qjoObLtC8LLoKk4lSKqrEZE41oeqOgwD0NaVmurqGu3HoSrKCbyDxgMc4Nu9ATuFezGH4hK+WUbYsbaLoa1tw03C8aO0rJCXeFQFWcULAUo7UGO4UiCaJjlwQwBKrQ1WlBeIpmSaivMBvqAsc9bii+pN0Vowzpjt3wZ0YlJS84vdbkt74imhbHdwvclc5ENsb3V7YNLIzvgdTYMOzH9kRvtE64palaDLedg7YA6XxMtedmzI5IujLz+6M8mUTMQXnpeqRfcghQTkWpyguyGCAPa1xKToXOBeEXRTUs2LHM7MMgNwH/O2FjW3/TTyWmEdDiWaekG7RDVCHrhaXJUhqAzJtBQHBRLTPPG5Xri9hQLqgE+8ioZ47x2arrD9VL/AA09kRfFFh+ql/hp7Ii+DD/qKxx1RrV6ZxHXyXr1OAfXejxrFL+rbnZfSW9/RFGgptJpHlJ7B+DGN+nkrIY+SVbsYV7qwFf+nWA8fvktJH+tRW6PJDtCTKTqeUjDrBB9QPZBbS6VkTKZhGI6VF4eqAVhmXZss/fA9Kq+siGdlqCN4p2xyt5kzX9XgUsNO3TlvWEo36UO4q3osG90N5hLTGWPN76fGHGRMvKreUoPaKw/Em/SetQ4SbbbUsWtaTZn4jHtNffBrQJ+hHM8z22I7jAfSK0nzfOU9stPeDBXQB+jPM59Sn3xJV50zT1eSbR82seOvzVOsS4yz547Qp90Z9CfXfu39qXGrWHKX5zezGXQn137t/alwov4nYfulL/PHZ5I7aTxG81vUY3K9JQO5K9i1gdpA/RTPw39kwmaI0/Ns16zzgxQgpdOaGhHFrsxxEUIaR08ZLdx04opO6xCdrMtEUblUdgEKevDzLyig4Pi1O2+BMIHRRjDhSFbXIEyq7rQB/8AAH1sYlw93+4unT5Mst2qlOAl8yEn9qbM9yQVtteDYDNhdHS5C++B2q0ulnTDNR2YsPbMEZ8wBpYJAvTVArtIq9OniRHPnUG3H+11uUa26QReDc0BorUqAQDTDPnjMiXQAMgAOzCNGkjxAPKZR1A3j3KYpik0nYHWlENSkzWu2zPnIWWs5iktfqw5ALkk1u8wXONGpc95rTHe/wAUKFv/AH+MSOpRDfowgJWvLdj00N0U38VRA3RNluK43zXp0K1xe5YKuqm8g6LZsRYX48VG1zy+27NarTNuoxGYBp07O+kKWuuheDWQoetL4xXcJe4wS1y0gZclQpozzFoRmLnHJHWo7YD6e1hW0SZBYhXUzA4qBjSXRhzH4xPhkUjXskGhJv3G33TaiQi4BX2w/VS/w09kRfFFh+ql/hp7Ii+Cb/qKyR1V1im3Zss/fAPQ/F/qr1Qy2mTfRl8pSPSBHvhScGhpns6dnfDdJm3lVh4wB7RWA+ICxa8I/hL7scw+7pPSdxQ+4Buyje6HOsKU6XR3Xc7jqJJHcRDJo2ZWTLP3F7hQ94juIi7WuHu6WF818kZ3fhLcxKO43TH9on1GGLRTVky/NA9HD3QD0klJ8znKntRfeDBfQTEyQDsZx1XiR3ER2t50DXdXkuUPMqZGe9UM00tJ550T1uPdG/V9uI43P60Qxj099cvPL9lj/dGjV1vrBzqe0Ef0wpc6MHoHolFza9wX3WLKX5x9kxl0J9d+7f2pca9YhxZfn/0PGTQn137t/alx2L+Ieork389qL6VekiaTslv7JhatJWazkG8rTHINM/pDQ0OUMOnv8tO/DbvEKeimJov+8g6ndK+to7hw/Tc7gfRT4i0nZI4hPZhb1vlf4O8Mf8SSeYUdfWAIY4U9JaW4bR9qApWVPJHmmfUH1jqinQtdygcNxHjkrs+lkZ1cX/Dpzj2QF/pgfrmrMktVPGDM4G03ABgdh4+EEtXUIskiufBKT+0K++MGnWrOA8mWPzM39oiWDOsJ4EqGqeYqe46FfoPWD50ksN9ZLqX+9xbqsOm+a8454LTpl1S24E9grC/qpYbkye2wlAOatWYdpEHp4rdXynUdhvHuUxDVMY2fZZp7JUsD9qEP4pR1Ls5mtw8ytLODWuP0gB4oJ2DP0Yb7OhCqDmAK9O3vhU0aDJtc2SvInu/UVmFm/LeHQw3Q3xLiJJkvuOY6vzdcpnBw2uxLOsspZsy42IRRTeGfEkHYaBe3nhI0xoByRVqKCQpGZwUmo3ioy3w4TJt9mfy2JHRkv5QIx6fk0kSDtczW7eDu/lCwconmHYZ2eBJQdj3TTvN8vYC92H6qX+GnsiL4osP1Uv8ADT2RF8J/1FCDqpDBoOZWSo8kleoHD8pEL8FtXpmMxfNbtBU+yIH1zdqEnhmieFv2ZrcQsml0pPb7yo3cV/ognoFvoqbnYdpvf1Rl1hTjS23hl9TDuDd8etXmxmDzT2gr/SIgl59IDwt4ZK5F+nXOHH8rPpxaTh96WPyswPtLGzV9+I43P61UxVrEuMs+eO5W/pMTV48aYOZD3vCdzqMH3rZJvMrz0+i+awrxpZ20cd8sxNXuVM5wncXj3rFlL85h2qT/AExVoD6x/MHc3/MIZ0Xvik7LEB0+iv1j5Ev8X9ObGPQn14/Df2pUbNYx9GnNNX2XHvjHoT68fhv7UqHQfxD2rk/85nvit+szEWSdTO4adJIhT1fmgz5e52XtU3h/V2Q26ySy1lmqMyAB0llpAPVmxLMSTOFA0uYUYbwVJQ+cK06BzR2jeGUrieJ8kQms5+weg+KbqxzO0twQmg8ifJbqYi+OyYAeho6Pa5l2W7bkY9gJhHt9gMxEA5StLpszIVh2HuELCrAOJ0y8M1WrpdiRg43+yeLLJuS0UeKqr6IA90LuknrPmHcVX0VX3kw0GFB515neuBdz1XiB3ARDh42nud7zTcVdaIN6Ub0An0ZPlO3YtF9amCUoVmqPJVm9Sj2m7DGbRSUky653QT0txj64D6V1meTPdJYU0VASwJoaM1KAjY4iDk3VEzwzp9FcY3Yha3oC1WeTW2zTTkFz1vQA9haN2k5xSS7Lygpp0nAd5ED9WJjzFmzphBaZMzAAwRQtKDc16CjOpnSpbHE32pvuLT1uD1R2f94A57IHgLlciZycR6b+JSqsqtEXbRR10APZj1RbrwgCyAMAOEA6AJdI0aHs30wB/wBK9XpUmWPeeqKNe8pPTM/TgqyS9ZG0dJ7wUPootiBzjvPksNmnKsmWWIA4NMTgOSIpfSy30UVIYkE0NOTeFN5OEXWavApdpXg0zyxUZ/CKZeh1BBLzGINRVzhnTAYYVpF/mXO0gWW9aJjXlrdYAFTQ4FgCCRQGuIqKGhgnol5KzluE1cMtCX3Xhg2XI2b4wy1IGJrz0oeumHqixJt1lbO6ymnQRXurFWZm20tCv0dXyB2S0G513hHNPSb0oYkUdTUUqKm5tB8qMeh7OUm4veDKRiADUEEYjPCvbGi3aTkTJUxOEXFWHGquNMOVTbAfR91JstwAvGAJoBg4K9XKHZA6CN5gcw3Gu5GJqiFkrTsgk6G+iNafkFpa0pUTBSuWIZTl50Y9Bo6ziHCiqGhDE8ll3qKZmCWmZd6Q9NgDAjDkENn1QH0U5E9KuxBvChIpySd1dm+GwbTqZzeF/VOlMDZ2lwO0dDuRHWFCZakAmkxcBSuKsu0jyoxaAmHhiCrLWW3KUjJkyORzglpwkSSRmGQ44jlr8YG6JtLmeoa7Qq4wBBrgdpPkwoC40rhbLP1SlbAKhrnEh+7gVu1iIEmpNAHTE9NPfA7QE5Wn8Vgfo3yIPjSt0FdOTLsqoFaOmGXjiMGiLRenjiFTwb48U140vaDXujsBPyrhbj5JSwxuqGvL7OG7iiGmz9C3Sn8xYWdXmZLWZQ5D1fsVqd7MIYtYLvA0bkl5dc/LB2Y7IG6HkyTaEaXWoR61L5GgybnIjtM4CleCDnfq0T5Ii6cP2hkLW3oxpj6iZzoR6Qp74A2VKzUH+4p9E3vdBzTdOBYE0vFBXDa674F6PsJE6Wb5YVY0KgZIwzFNpEcpHBsDjfj5KKqpZJpWvbo3XvR+bMCqWOSgk9AFTClPlEVUijELgPKYBW/+l7shn0m9JT9FPSIWnfAmaWmWiWxRVBfYxJ4pab5I54bQu2Gl3vLNOrad0wFhoUfC0wHRCFouzG2W+0Am6gmFmO0IhuCnOQF6K16Xe1zrkt2GaqSOkDDvhN0PKmS7S3EcCYhS8VObqq1JH3hDqC4ZI4a2y8yppi7aAAThYJQWWoACilQBkLxvU6qwBtVvI0pJHirROuYDe9peyGXAcwHcIR3nS3YTrwv3i60bGrG8MBnkBTmhtDHyrnuO8Ed6hrJuRa0dKb7NZrsyc3lzMOgD+8vCt8o2kFl8AGqSeEyFfs4brLKKooJqQMScyxxY9ZJMc/15n35obYC6DoS6D+YtE2Ft5SsBO70sFypeIYQBv/K32H6qX+GnsiL4Vp+mJyMyK1FQlVF1TQKaAVIqcBHjw/P8v8qfCNA6jeSTce+xZoxlNkSFPw/P8v8AKnwieH5/l/lT4Q35KTiPfYucmU2ViEQp+H5/l/lT4RPD8/y/yp8IXyUnEe+xLkymlZCitABXOgpXppnHvcQSCDUEEgg8xHTCn4fn+X+VPhE8Pz/L/KnwjvyUnEe+xO2Xa3TfMtExlKtMYqaVBu7CDndrmN8fJU5kYMtLwrSoqMQQcKjYd8KPh+f5f5U+ETw/P8v8qfCG/IOtbK3voTy6UuDi7MJ2tek5kxLjBM1NReB4rA5Endviqx2oynD3b3FYUqAeMVNccPF74TvD8/y/yp8Inh+f5f5U+ENGGkNLRax61IZZi8SE3IT1pLSomywoRlN5TjdpRTXMMYr0Za1lzKuaLcYVoTjVD4oOwHshJ8Pz/L/KnwieH5/lj0U+EMGFkRmMWsek+ieaiR0olda4XQNM2+XMlhVYNV1NOYAmpB5wIy6AkIs8kKqm42QAJ4ybs4SfD8/y/wAqfCPLacnHNgelEP8ATDW4W5sRiDsj74KQ1T3TCUjTculawn6ICpFXXEYHi1fMebGDQYJnYszAIxxoQKlQMaV2nvhDXTc4ZMB+wn9sfW1mtKcZJpU5YBRUc4pjDW4S9sJjBHWpjWudMH5hvC66Zp6YRJIBoWZRvHKDHCorgpgdouY7zlDXaKGbAEGowGBJwqw27I55K1ytk17rzbwFSBcl55bF3EwU0brHaFZiHFbqjkJlVt6/9pEbcJkjhLSRfPjvy4Kwa15nAabN3jiuh6an3ZD0FSRdAwHLN3bzEnqgVZZwmTEW4Rxqmt00CcbYTtAHXCppXWe0sFBmYXq8hNituWKtHaxWhXJDit2nITaRXxeYQ2HCpGQnMXz3n0Urq14mDG/SdeK6ZbrVwctn8lSRtx2Cm3Gkc71olSbsq6a8upvOKniY0rtiaT1otLIAZmF5fETZU+TvEedFn5ze4fj3KXfFperXk0ryRnuixhuGvgO0493V1KOprM9kNBHSv//Z"},disclaimer:"disclaimer text. orth America, North Africa, central and eastern Europe, Australia, and Asia. Fruit bodies of Ramaria botrytis are edible, and young specimens have a mild, fruity taste. Some authors war!",description:"this is the description: was an English maidservant who claimed to!",validity:{validFrom:1378210000,validUntil:1388210000},totalSlots:10,limits:{punchesPerDay:3,codeAttempts:4,codeAttemptsCoolDown:25000},defaultOverrides:{style:"normal"},overrides:[{at:[2,5,7],icon:"bonus",slotType:"mid-freebie"},{at:[1,10],icon:"bonus2",punchText:"",afterPunchText:"X",slotType:"freebie"}]};var d={id:"9898989898",title:"title",offerTitle:"11+1",upperTitle:"",icons:{"default":{whole:{bg:"https://encrypted-tbn3.gstatic.com/images?q=tbn:ANd9GcT8nKKpo0BIjRjKbWtafFJxyI6KtDFPc7ucxXwcAC6FIiWYQocW_Q"},punched:{overlay:"data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAkGBggGBQkIBwgKCQkKDRYODQwMGSQTFBAWHxwtIB8cHh4jJzIqIyUvIykoMTssKTssNjg4Jys9QTctOCo4NjUBCQoKDQsNGQ4OGTUkHiQ1NTU1NTU1NTU1NTU1LTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTUvNTU1NTA1NTY2Nf/AABEIADIAMgMBIgACEQEDEQH/xAAcAAACAgMBAQAAAAAAAAAAAAAABgUHAQMEAgj/xAA4EAABAwMCAwUFBAsAAAAAAAABAgMEAAUGERIHITETQVFhgRQiMnGRFRZCYiMkJTNScpOiscHw/8QAGgEAAwADAQAAAAAAAAAAAAAAAAMGAQQHBf/EACoRAAEEAQIEBAcAAAAAAAAAAAEAAgMRBAUxEiFBURRhofETMoGRscHw/9oADAMBAAIRAxEAPwC7n324zC3n3ENNNpKlrWdEpA6knuFIxyi95i4oYsEWy0glP2tJRvcf82Wzy0/Mr6cqMoKsxyz7tpURabclEi6beXbrVzbY+WnvK9OldmWZJEwvF3ri8zubYCW2mG/d3KPJKR4D/AFeBqepvikGNji3n0v9prGAiyuFXDm1TPfvUm5Xl09VzX1keiUkJA8tKwOGONM+9BiyLe6PhdhvONKT9FaVp4dcRGc9iSv1X2OXFUO0a3bwUq6KB0Hgf+NTeU5FHxXHJV2lpUtEdI0bTyK1E6AepNTMk2eyf4Tnu4+1/wAE4BtWowqyrEh2sWS5k1tR8caTomYhPihwaBw+Shqe402WDIIGTWpE+2PdqyolKgeSm1DqlQ7lDwpH4c8Smc8TKaVE9ilxtFFvdvC0HvB0HQ9fTxrfekfcvIm8nhjZAlLSxeWU/CUk6Jf0/iSTz8QaoMHUpo5/C5m/QpTmAjiarCooB1GooqlSUg8OVe2Y7Iu6+bt3nSJaj5FwpSPkEpFeuI+KO5jhz9virSiSlaXmd/JJUnuPzBNRGKX1rFOFsdyW0tabbLXCkhPVr9OUFR8hqDT9XOcp8sWY6bqHGvofZbbaLaVc8IOH0/DmZ0q8BCJUvahLSDu2ITqdSRy1JPd4edMufYyvLsOl2xhxLb69q2VK+Hek6gHyPT1phopEmZLJkeIPzWD9lkNAFKs+EHDm44g/On3kNtyH0BltpCgrROupJI5czppVhXW3t3a0S4D4BblMraVr4KGldVRDWSxnb7dLf2awLUw27IfOm0FYKtvz2jX1rM082VKZjv5dNggANFKvLPxsXbrHBhyEJW9GjttOKVzJUlIBJ9azSbD4XXa7wmLi3Hc2TG0vp0Hcsbv91mulhaatm7W6PasuuNnuSP2NlYK2ldEolbdriNe4qACgfEHSveI3x63yBi2QL2XSInbGeVyTOZHwrSe9QHJQ68vno5ZBYIWTWd23XFsqZc0IUk6LbUOi0nuUD0NV5e47lvhC2cQIa7hbmTrFv0ZJ1b8C5t95pY5e8OR+tTup6eXkyMFg7gbg9x38wnMf0T/RSRbmMgDAXjGWW69xPwJuKe0UkebrRBUfmK3vs5u60TPvFgtDA+J+M2pxQ/qEJqVOMAa4x6/irTrUtlGURsagpUpKpM6QeziQ2+bj7ncAPDxPdSm5a5cW0N412wdyPKHlPXF5vn2DR/eq8kpR7ifE9KLY5b4tzd+6bT+WZE4NjtzkK3tMfzO/ClP5Ucz0p5xLEvsD2idcJPt95naGXLI0Gg6IQPwoHcPX5UOm6aSQ5wpu/PkXEbcuw357pT3qdixmocRqNHQEMsoDaEjolIGgH0orbRVYkIoI1GhoooQqQ42We3W51D8GBFivLTuU4yhKFE+JIFJ3C6HHvGRMIubDU1G8DbISHB/drRRWKQvpuNFYhx0sRWW2GUDRLbYCUpHkBW2iisoRRRRQhf/Z"}},bonus:{punched:{overlay:"https://encrypted-tbn1.gstatic.com/images?q=tbn:ANd9GcT_YMmhnppQhDz42uNrhqojWzQm10jX7UiB1Fr5WVVB3hZSmDUioQ"}}},images:{header:"data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAkGBhISERUUExQWFBIVGBwVGBgYFx0cGhwhFBobGR4ZFBsZHSYeGxsvIBkYIjsiJCcpLiwuFx80NTAqNSgrLCkBCQoKDgwOGg8PFCwkHCQpKSwsKSouLykpLCkpKiktLCkpLDU1LCwpKSkpNTUpMiwpNCwsKSwsLCwpKSkpLCksLP/AABEIAFABAAMBIgACEQEDEQH/xAAcAAEAAwADAQEAAAAAAAAAAAAABAUGAgMHAQj/xAA/EAACAQMCBQICBQgJBQAAAAABAgMABBESIQUGEzFBIlEyYQcjcYGRFDNCYnOhsbIVFiU0UnKCg8EkY+Hj8P/EABgBAQEBAQEAAAAAAAAAAAAAAAABAwIE/8QAHxEBAQACAgIDAQAAAAAAAAAAAAECEQMSIjEhQUIT/9oADAMBAAIRAxEAPwD3GvPvpE+kuSwmWCGJWcoJC0mdIDEgBVXGT6Tvn8a9Bry76ReRp72+EiuiRiFVBOS2zOTsPt9xWfJ26+Pt3x9d+Xpl1+m7iKtutuw9tDD94kr1H6Pec/6StmkMfTeN+mwBypOA2VJ3xhhse1ePXX0burEdXJ/Z/wDsr0j6GuDSW9tOrsjK02pdPf4FB1e3YbfL51xxzk35NM+mvF6DSlK3YFKUoFKUoFKUoFKUoFKUoFKUoFKUoFKUoFKUoFKUoFKUoOEsoVSzHAAJJ+Q3NeTcQ+nc5PQtQU8NJJgke+lVOPxNerXgJjfSMtpOB7nBwK/PKfRpe9IM2hNhsWJI286VI/fWPLc/jo245h89mw4Z9PY1AXFroQnd45NWB76WUZ+4/jXranNfmKfke6A9Oh2zgKCRk/aygfvr9NxZ0jVjVjfHbPnHyrrj7fpzydfy51WRPqLyeDsD8l7fvyfvrnxy60RHHdiEH+r/AMZqLLexxr0y2GA7YPyP/I/GtGakdvr2+7+NS+W7np3EsPZXOtft8/u/lqnfiCdZjq8Z7HxvXziV6FkWWNhqXB/Dff7s1R6HSumzuOpGj/4lDfiM13VApSoXGhL+TzdAZm6b9PJwNRU6cnxvjeg4cN4/BcEiF9eBnIVsYzjIJGD9xqwrAty7MLOOFIbn6vQoSSWGRMRIQodGcoYyTuAc5UHxUey4TLLMSYdJimhVJA+lFW0RDIlurNr9UnUXJGCrbk4wQ9GpXn0/KU3QtRpaXKM10EeNi8rgMpPXyjRhmmGPGpSBts/qrOrsFjmZBEYuo0kRnGI1iU2suoEHGpiJBjOT3NB6DUc38YlEWr6woZAuD8KkKT7d2ArPcM4ZcxWE8aLHDdOJTEFCrvpwjSBCUDZ0507dvnVFLyjPl3igaFGMCNGJI2leOJZGcuWJRmMki51H1CPf2oN3d8ViiYK7aWZWcDB+GMqGOw8F0H+oVLrBQcozB4goIjQQr65F1qpuHuZhhMDGVgQKu2FI3Ar5PyzeC3cFzlZTHGqyDJgafqNhn9PVZSq4OwVAufU2Q31KxnB+UykkZkV1t40lk0SOu0ksinBSLEYVVjyANh1TTl3hEptcyq0wkHQjQuyabdpDhzn1CQoQxGx9KLtig1d9fpCmuQ4XIGcE9/koJqHw7ma2nZVikDlwWXCthgmnLKSMEetN/wBYV2cfhla1mSDHWaNlj3wAzKQDnxgnP3VmONcmPISqKNEcEFtAdWCoEoaaQDwwRIsfNKDb1A4lx2CAgSPhiMhQrM2B3bSgJC/rYx86zvC+XZvy5ppxLqWSR0cPF0yjZVE2HVwFI9Bwupc77ZniG4hu7iRYDMs/T0OJFXQETQUkDHIUNqfKhvzjbZ7hfwzK6hlOVYBgR2IIyCKj3/FooRmVwoxq7HsGVfA/xOo++sJfcsX800spQRu0c8WVdFB6rJEhVl+sYCLW/rOzKMAVM45yvL1G6cWq2DW46YlwSsTvNI3rYeov0V3OcJQbqlec3HKF0yGPpApIknSUSjTayTysdeMgkqhj0lM4ZHAwGzVvY8JuzdDqKREt1LcM5kBDKIunEqqDkdwSCAAV85oNfSlKCPfz6UOPiPpX7T/9n7qqOKwqsOkAbDHb2GKkXNyGn0k4WIaj7ZPv9gqDxy/jKHDr2x3oKOW0V7c+kZADdvbvW14RfdaFH8kb/aNj++shw25QrgsuCp8+3f8AjUnk/iBSVoDurZZftXvj7Rj8KtF5zJ+aX/Ov/NQ+LcLd8sJCudPvsACDjBxvnOamcyfml/zr/wA1F5qlRbKbWwVTGUJP64042381BjLe01ys0c5ddRGck4KMwZdj38f6ak8TtWjRdTaift8A+5+z8Peslb8We1kkRbKSHVIzJLGpEBBUBQySBc79yNJydq23MAPTj1D1YOcds43x8s105xy22nBf7vD+zX+UVNqFwT+7w/s1/lFTa5dFQOPXckVtNJCmuVI2ZFwTlgCQMDc7+Buan1H4hcGOKR1ALKjMAexKqSAcfZQYq84rIAgS4u3idJGMiwetpYwgSKMdIaQxdm3GPq8ZxqquvuAXN05a419WR7a0bTGNKokay3DIWQ4QuZFyDhtgc7AWR+kslWZYQQITcg6u8axZ1DbuZ8RAedz4rlw3iU73SRGVyOuUO4xos7dVk8b5nkAP2DtQVtpxW/RJWT0mJXXodJ8J9YqKwUQBcquXOgvr3wCMCtJwO9uVs7iVmNyw1vCoDajoQYjy0aFsuGwdPZgMnFdt/wA1FJpY1QHRLbQKSTu9wcvn/LGVb579qrTztOCytCBOzrGsOltadTqMGck6ZV0xOcoRkqRt3oK22NzJcJJHJO7FYIRK0JAUzsZrgxqyABNMMS7g4LYzmpbTXQeTBnVNdw7SLH9Y0dpGkaKDoI1NIxYYGSFONs1dXHHZ04bJcSxiOdUkwnuwJWPycajp2JONWN6obDmK5gaaKV3acdJURwspzoZ5XzFpAGMHSxGnCnPrAoPnBmvTextOroGiggeZY8lnij6zpjTiONnlcGTtmLT6Tg1J53tppJw0auwtoGkjHTDoZ536UTYKkEph2ON1BB2B3hLzRcXTQFWMXVS1Uqh21XMhnc7jORBD9wmNXjcUuIbtYXOUlk2kdWKsX1HoxFCREVRB8edRJO2aCBf3d2lwYVlmMitD0vqholDsDK8rKmkIq6lwCCNOdyy10TXl8w6nUuVVorucosQyFjcCCNMxkiUg5xuTg1I5x4vcLcFYnKxwwq7KrFWaW6lMMIJAOwKsdPnO/ipMnM910mlSJGiErxKw1SMFhZkMzouCwyhGFP6QOcZoO7jpmFnbibUwLRC7MYOdOn17J6tJcAHT2Unxmqu/uooios0ktoJElZnt7Yq0kkWgRxqpjwM63OogaunjOM1acu8YuLi5kbVE1qkcI9Ibd5I+sWQt4KyR7HsAPOaqrjm+SOeVsl06smhSwC4h6Fqqk4OFaeYkt40E74xQc4+O3CdRrhp/yiBV+oii+rf6pNb6umwKmRnOQdgmACQQZfK91ftHMTpf64LH1mcegRqWKt0EZxrJxlAO+DUO75ju3mEAaFHS4w0i6ghWGAzSawcnSC8SnBGST8NcIecrple5xGIYrOGaSM6sh5wZCAcZGECnfw4oO23WFmlM9u01+JZWQPExIEbMYRFIV0ohRYzlSASxzk5qB+U3NwioTNPDKbbq6oSuHV2mmSNSqkR6I1XByMuoySWqwb6Q3JkCQatBAAycn8odEtvGxcF3I8Kg8sKXHOVxHo60WhwZG050B1DRQxawdRjBkuFzknAjJ37UHfybxS6uLiV31rbmJHVXDbPI7nSpaGPBVVAKjUAWHqJ3OxrCXfMd28wgDQo6XGGkXUEKwwGaTWDk6QXiU4IySfhqbyzx+6u51Y9NIRbQSSJuSJLhWkwDjwoTY+H96DXUpSgoGjJuJwuAxTAz2yVwM1Q8c4ZKoP1iqPSFzg5JxnJx8jjv3/HRw/3uX7B/AVifpYkjwNYLmNNYRZdDA9RcSBQ2WYBDjY/F43NPtLdR2cM4fMQu6nbfPnYasenbJH7/ADgYm8uDF8gONg429wviqvk/mdLqTEIcxAMcyJodcaQAcZVwc9xggg5z3q24Cf7QH+5/CuiXbSc1TKkIZiFVXBJJwABncmuXE0Elu4HqDxkbHGQ6kbHtvnvUHn+WEWhWdwkbsFJ+4nbY77Z+6qODn60SDpqHxE0cILlQCH7SagT6cDPYeBtWdsnt3MbZ8KCRZjKySyStGO4YGTVg/pAKqkbb7EdqvePIFjjC7KBgDfsFwBvv296zlxzoReNpAlhLFE6fxkquonfvjf5e3vXdzDx6S4tYZbZQFy3ULEEpoAJGOzZHt7ir3lScevp6pwY/9PD+zT+UVMqt5auRJZ27jIDxIwz33UHerKqhXCVgFJbGkAk57Y85zXOonFeGpcQvDJnRIpVsHB39jQZSPmi2lULBDHnqw2pBEbpowZsBomZCqoHIGfSfFTo+arRRHIkLapI45VCxqHxfSYUd9mZkLEZ/Qye1TF5Pt9y3UdizuWaQkkyRdAk4/wC36RjtnauNjyZbxFWzI7IY2BdyT9QjIg9sAOxx7nPegqX5ksjIZpbQo4E2ZXijJzZq3UXUpLHC6gCNu4z4r7ZXdlhbZrNAryLG+IUEPVEIlxpJ1bAEZwdOnGat5OTbZkCEOVCSJ8Z3FxIssmT5JZRv7EjsTXOTlO3buH+KaTZ2HquVZXbv3wzAe2dqCssuYrSW1CNErRFYMRiIaCt25EKBG2zp0MRjABB+Qgzcc4esekWGqFFmnQCGEJi2bRLIikgL8QwSBqB2zV4nJdssiuOoArRuEDnp6oEEaMV8kKF+XpBxmuX9Tbbp9PS2joC1xrP5sHJGc9z5Pc+aDp41dpBFDJDAjSSSwrGOmM+oBSQNsMIQ4zkYA9tqgnmWyDG5Fq3WQEzuIk6kQV2hJlbOTujgBSxKoT2rQcW4Klx09TSI0TF0ZG0kEqyZ7EHZm7jzUH+pVtlcawoCKyBzpk6TM6mYHdjqZmJz6snOaCouOasu2LIyE3gtlbCZfoamL7nOpSkmM9ttxviJPzXY6NFzBE6rJIY4xGh0xiVodYVz6mZkk2QEkA7e+kj5RiVkIeYGOd7lPX2aXVrUbfAdbbH/ABHBFLTlGGJkMTSx6ESMhZDhxGzMvUzkscu++xOo5zQWkXDolkaVY0ErAKzhQGIXsGbGSNh+FRr7gMUkbIFCagVJVEzhm1spDKVKkkkgg5yfNWNKCr4XyzbwR6EjUj15LKpJ6uNecAAA6VGAAMKBjau88FtyWYwxanTpMdC5KdtDbbp+qdqm0oI03DIXDq8aMsmNYKAhtIAGsEerAA7+1RLnlyBojEiLEpXR6I0+EtqK4ZSpUnOQRg5NWlKCr4XyzbwR6EjUj15LKpJ6uNecAAA6VGAAMKBjapcXDIVk6ixIsmkJrCgNpXsuQM6flUmlApSlBSQsPyuUecD+Aqi51EkbLNESjhWViEQ6gShAZmOxBG2x7tXVxm7toOIm6ll0mJNBRRqYhvOAchRnfb27V95i5tg6c5jIZokRvUdIbqDKgZ9WcEbY+VTeqtw3PSs5XYyS9WRw0pX9E4OPZwFVWG+e2QfNWXAT/aA/3P4VScvc6QkqkoMcmrQdvQCfds7dx95rv5Z4q/8AS/TkQxqxkWPI3YouWOe2nGDV7SnSz40t/pcVDb26yMVje5RGI7gMj7gAHOO+MV52BNa6yjRrN1TCVcIdkXWr6SCue2+diQMbivauY+Ex3EBjkj6m4K+CrDsynuCPeslffRshGV6yNkvhJAQGYbsAw2J871nljbdxrhnJNV5M7OzlyMJMzEKoPpYlSSVGSB3GxyfuxUy4t5XgkmWX6lcDGNJJXSfzY2DAHOf0vvNa5+QbjVjXdFR23A39/h79qmWf0bK0qdWF2Re41ac52JIXAJPnff2qdKv9I3/Ko/6K27fmY+wwN1HYeB8qta4QQqiqqgKqgKoHYADAA+WK51qwKUpQKUpQKUpQKUpQKUpQKUpQKUpQKUpQKUpQKUpQKUpQeGc6Weu+vpAQWjdFZAMnS6D6zK7gA4Bz7996q+OysqvbtDEWUiNZQB1CY8MPUrYI0nt27ZORXqXMHJEU1xIydVDMB1dHwkoQVODsTtuOxyKy/FeQZYyzLKxLNrbVbr3PkYOB7/jWNwu3onJNMNaztuCydQFgVbt1CSNSBdtWw9WwyMdsVruR1uP6XhFyQ0gjdvUfUPSy5221Y7++c+K6oOUJXz1GLg7kdELk74IIO3f5g43rYch8nLFKbiUyvOMhDIcgB/ixjb7t8ZPvtZjZXOWcsf/Z"},disclaimer:"disclaimer text",validity:{},totalSlots:5,limits:{},defaultOverrides:{},overrides:[{at:[5],icon:"bonus",slotType:"freebie"}]};var c={id:"1111222333",title:"this is a very long title. it will end with '9': Itsik-Bitsik-Coffee loyalty card 123 123123 32432453 5464565 6576767867 787878 78888 88888 9",offerTitle:"12+1",icons:{"default":{whole:{bg:"bad_url_fall_to_default.svg"}},bonus:{whole:{bg:"bad_url_fall_to_default.svg"},punched:{bg:"https://encrypted-tbn1.gstatic.com/images?q=tbn:ANd9GcT_YMmhnppQhDz42uNrhqojWzQm10jX7UiB1Fr5WVVB3hZSmDUioQ"}}},images:{background:"https://encrypted-tbn1.gstatic.com/images?q=tbn:ANd9GcTOHgmzjqmHmLpDhZCxLR4PLEelnTB2wmFbrboARGN2u5QPim8N"},description:"this is the description. it can be a very long text. it will end with 9: 1111111 1212121112 2131231 3453453 56565465 67676767677 77778888 888888 9",validity:{validFrom:1178210000,validUntil:1188210000},totalSlots:13,limits:{punchesPerDay:20,codeAttempts:2,codeAttemptsCoolDown:5000},defaultOverrides:{},overrides:[{at:[10],icon:"bonus",slotType:"freebie"}]};b.push({key:"CMS_LOYALTYCARDS_GET",result:function(){var f=[];if(Math.random()>0){f.push(e)}if(Math.random()>0){f.push(d)}if(Math.random()>0){f.push(c)}return{items:f}}})}if(TEST_LOYALTY||false){b.push({key:"CONTENTHOST_LOYALTYCARDS_VALIDATE_POST",result:function(f,g){if(g.code==="111"){return{invalidCode:true}}else{return{invalidCode:false}}}})}this.createOverride=function(h){var g=null;if(typeof(h.result)==="object"){var f=h.result;h.result=function(){return f}}g=function(j,l,i,k,m){setTimeout(function(){var n=h.result(l,m);i(n)},1000);return true};ServiceOverrideManager.registerOverride(h.key,"1",g);ServiceOverrideManager.overrideServices([{version:1,key:h.key,params:{}}])};for(var a=b.length-1;a>=0;a--){this.createOverride(b[a])}}()); var AppInit=(function(){var s={};var q=null;var l=0;var g=null;s.init=function(){DeviceInfo.init();DeviceSupport.init();if(typeof(ImagesLoader)==="object"){ImagesLoader.init()}if(typeof(ResumeManager)==="object"){ResumeManager.init()}DeviceReady.ready(f)};var f=function(){Config.onChange(s.onConfigReady)};s.onConfigReady=function(t){_.extend(window,t);if(!APP_ID){console.log("No APP_ID, quitting...");return}c();DataDumper.dumpInitialData();s.initLocalization();AppConfiguration.init();UserManager.init(a)};var a=function(){ProfileManager.init();r(b)};var b=function(){usage.init();StateManager.loadSavedState(h)};var h=function(t){s.launchApp(t)};s.launchApp=function(t){if(t){l=t.pageState?t.pageState.tabIndex:0;q=t.pageId}else{l=0;q=null}AmsLoader.loadApp(o,APP_ID)};var o=function(u){g=u;if(DEBUG&&window.TestAmsData){TestAmsData.addTestData(g)}if(g.jsCode){CodeRunner.runCode(g.jsCode)}UrlGenerator.emptyAppParams();InappPurchaseManager.init(g);var t=$.Deferred(),v=$.Deferred();LocalizationManager.updateLocalizationData(g.meta.culture,function(){t.resolve()});LayoutTemplate.onChange(function(w){v.resolve(w)});$.when(t,v).done(m)};var m=function(t,u){AppSettingsManager.createSettings(g.settings);k();if(typeof(ResumeManager)==="undefined"||!ResumeManager.onResumeFired()){conduitApi.analytics.addEvent(null,null,conduitApi.analytics.usageEventTypeEnum.UserLoggedIn,null,true)}d(u)};var d=function(u){var v=AppManager.app();var t=new Layout({layout:g.layout,meta:g.meta,template:u});v.setAppData(g,q,l,t);$(document).ready(function(){LayoutApplier.apply(v);if(window.SmartBanner){SmartBanner.initOptionsWithAppData(v)}window.Scrolling=ScrollingFactory.createScroller();var w=$("body");w.addClass("ui-mobile-viewport");if(LAYOUT===layoutFormat.wide){w.addClass("wideLayout")}else{w.addClass("narrowLayout")}w.addClass(Utils.Helpers.inverseDict(deviceTypeEnum)[DEVICE]);if(IS_RTL){w.removeClass("ltr").addClass("rtl").attr("dir","rtl")}else{w.removeClass("rtl").addClass("ltr").attr("dir","ltr")}var x=AppViewFactory.getAppView(v);document.title=v.get("appLabel");i(AppSettingsManager.getSettings().get("startupDialog"));v.trigger("appLaunched");setTimeout(function(){Scrolling.triggerWrapperResize();var y=v.get("fullScreenAd");if(y&&typeof FullScreenAdView!=="undefined"){y.ready(function(A){if(A){var z=new FullScreenAdView({model:y});x.$el.prepend(z.render().el)}var B=!A;e(B)})}else{e(true)}},100)})};var k=function(){var u=AppSettingsManager.getSettings();var x=u.get("overrideTranslation");if(x){LocalizationManager.addOverrideTranslation(x)}var y=u.get("ga");if(y&&window.googleAnalytics&&googleAnalytics.setCode){googleAnalytics.setCode(y.trckId)}var w={appId:Utils.Helpers.getPath(g,"social.facebook.appId")||u.get("fbAppId"),appAccessToken:Utils.Helpers.getPath(g,"social.facebook.appAccessToken")||u.get("fbAccessToken")};FacebookLib.init(w);var v=g.globalAppId;if(v){ProfileManager.setGlobalAppId(v);UrlGenerator.extendAppParams({globalAppId:v})}j(u.get("params"));var t=u.get("overrideServices");if(t){ServiceOverrideManager.overrideServices(t)}if(u.get("ads").enabled&&typeof(AdsManager)!=="undefined"){AdsManager.init({settings:u.get("ads")})}if(u.get("showAdd2Home")===false){window.add2HomeIsDisabled=true}};var i=function(z){if(!z){return false}var A="startupDialog_start_"+z.id;var u="startupDialog_end_"+z.id;var t=new Date().getTime();var w=conduitApi.platform.storage.getItem(null,null,u);if(w&&(w<t)){return false}var v=conduitApi.platform.storage.getItem(null,null,A);if(v&&(v>t)){return false}if(!v&&(typeof(z.startDueDate)==="number")&&z.startDueDate){v=t+(z.startDueDate*1000);conduitApi.platform.storage.setItem(null,null,A,v);return false}if(typeof(z.interval)==="number"){v=t+(z.interval*1000);conduitApi.platform.storage.setItem(null,null,A,v)}else{conduitApi.platform.storage.setItem(null,null,u,t)}var y=Utils.String.translateIfNeed(z.title);var B=Utils.String.translateIfNeed(z.message);var x=$.map(z.buttons,function(C){C.text=Utils.String.translateIfNeed(C.title);C.cb=function(){if(C.url){if(conduitApi.app.isSupported()){conduitApi.app.openLink(null,null,{url:C.url,title:C.url,useExternalBrowser:true})}}if(C.stop){conduitApi.platform.storage.setItem(null,null,u,t)}};return C});conduitApi.UI.showDialogBox(null,null,{title:y,message:B,buttons:x})};var e=function(t){if(window.WebAppPreloader){WebAppPreloader.onAppReady()}if(window.SmartBanner){SmartBanner.show()}if(navigator.appManager&&navigator.appManager.hideSplashScreen){navigator.appManager.hideSplashScreen()}if(t&&navigator.appManager&&navigator.appManager.unlockScreen){navigator.appManager.unlockScreen()}};var j=function(t){if(!t){return}var v={};for(var u=t.length-1;u>=0;u--){v[t[u].key]=t[u].val}UrlGenerator.extendAppParams(v)};function r(t){navigator.serviceMap.registerServiceMapReady(function(u){ServiceMap.parseServiceMap(u);Utils.Helpers.funcWrapper(t)()},{SERVICEMAP_URL:SERVICEMAP_URL,FORCE_NO_CACHE:FORCE_NO_CACHE,APP_ID:APP_ID,APP_VERSION:APP_VERSION})}function p(){var t;t=comTypeEnum.postMessage;return t}function n(t){var u;switch(t){case comTypeEnum.iframeMessage:u=function(x,w,v){x.setPageId=function(y){y(w)};comMaster.addSlave(w,w,x.contentWindow,v)};break;case comTypeEnum.postMessage:u=function(x,w,v){comMaster.addSlave(w,x.contentWindow,x.contentWindow,v)};break;case comTypeEnum.nativeMessage:u=function(x,w,v){comMaster.addSlave(w,w,w,v)};break}return u}function c(){ConduitApiImpl.initApiImpl();conduitApi.__BCAPI=ConduitApiImpl;var t=p();AppManager.addSlave=n(t);comMaster.init(t)}s.initLocalization=function(){LocalizationManager.initLocalizationData()};return s}());AppInit.init(); 